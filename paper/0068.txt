NEER WORKING PAPER SERIES

ON A GENERAL COMPUTER AIJOR[THN FOR ThE
ANALYSIS OF MODELS WITh EftflTED DEPDENT VAlUABLES

Forrest D. Nelson

Working Paper No. 68

COMPUTER RESEARCH CENTER FOR ECONOt'tLCS AND MANAGENENT SCIENCE

National Bureau of Economic Research, Inc.
575 Techrio1o>i Square

Cambridge, Massachusetts 02139

October l97

Preliminary: not for quotation
NBER working papers are distributed informally and in limited
numbers for corrments only. They should not be quoted without
written permission.
This

report has not undergone the review accorded official NBER

publications; in particular, it has not yet been submitted for
approval by the Board of Directors.

*NEER Computer Research Center. Research supported in part by
National Science Foundation Grant GJ-115X3 to the National

Bureau of Economic Research, Inc.

Abstract
Several

econometric models for the analysis of relationships with limited

dependent variables have been prosed including

the

probit, Tobit, two-

limit probit, ordered discrete, and friction models. Widespread application
of these methods has been hampered by the lack of suitable computer programs.
This paper provides a concise survey of the various models; suggests a
general

functional model under which they may be

formulated and

analyzed;

the analytic problems and the similarities and dissimilarities of
the models; and outlines the appropriate and necessary methods of analysis
including, but not limited to, estition. It is thus intended to serve as
a guide for users of the various models, for the preparation of suitable
computer programs, for the users of those programs; and, more specifically,
for the users of the program package utilizing the functional model as
reviews

implemented on the NBER TROLL system.

AcJowledgnent

The author is indebted to Professor G.S. Maddala for his generous counsel

in the preparation of this paper.

Contents

Introduction

•

I.

Review of Some Limited Lpendent Variable Models .

II.

A General Functional Model

1

13

III. Features of a Computational L\lgoritbm

19

References

28

Tables

Table 1. Components of Likelihood Function and Corresponding

First arid Second [rivatives of the Log LikelThood .

.

22

Introduction
Economic

relationships involving limited dependent variables are

receiving widespread attention in the Econometrics literature. Much

of the discussion has focused on methodoloi with only scattered
application to real problems, the one exception being the qualitative
variable problem frequently treated with

and probit analysis.
Since potential applications for these rrodels abound, it is likely
logit

that the shortage of corrputer programs and their limited dissemination

is partly responsible for the infrequent emperical studies using them.
In turn, useable computer routines may be scarce because the models

though similar in many respects are dissimilar enough so as to seem

to require a separate algoritim for each model.
The purpose of this note is to suggest a general functional model
which is readily adaptable to computer coding and flexible enough to

fit a wide variety of limited dependent variable problems.

1

It should

be emphasized that the model presented here is functional as opposed

to theoretical. That is, it is not advocated as the structural model
1. Tom Johnson [1] presents a general discussion of many
of the models but falls of short describing in detail a central
model around which a computer algorithm can be constructed.

—2—
underlying

any limited dependent variable relationship. Rather we

suggest that many of the theoretical relationships may be reformulated
to fit this functional model so that a single computer program may be

used to analyze all of them.

The terminolo, "limited dependent variable" is used here to
denote variables endogenous to sone underlying economic relationship

which are not continuously neasureable (or observable) over the entire

real line either directly or even after soire transformation such as

logaritbns. Thus it applies to discrete (ordinal) variables, qualitative (non-ordinal) variables and to variables subject to threshold
constraints such as non-negativity. Such discontinuities may result
from

theoretical considerations, from physical constraints on the

variable or simply from measurenent difficulties.

The effect of the discontinuities on estimation is that when such

a dependent variable enters the usual sort of regression model the
properties of the implied

needed

disturbance

term cannot satisfy the assumptions

for least squares estimation. The atterriative estimation nethod

generally proposed is maximum likelihood. After a suitable choice for

the distribution of the disturbances is specified the distribution of
the limited dependent variable is derived and the likelihood function
is constructed. This typically involves both probabi ilty density and
distribution functions and yields non-linear normal equations so that
iterative maximization algorithris, generally Newton-Raphson, are

suggested for obtaining estimates. These procedures are of course
straight forward but they may becorre quite expensive and. time consuming

if computer programs to not exist for the particular model being examined.

—3—

Section I of this paper presents a brief review of a nu]ther of
limited dependent variable models. Such a survey will serve to
motivate the types of models to be treated and highlight their sim-

ilarities and dissimilarities. In Section II the functional model is
introduced. It is of course possible to outline a completely general
model but the aim here is for a model which rry be easily impleinted
in a single computer algorithm. With this goal in mind reasonable
restrictions on the model ars imposed and nny of the details needed

for implenntation are discussed. A final section outlines features
which should be included in a general computer algorithm.

—

Review

A.

of Some Limited Lpendent Variable Models

Binomial choice models2

In these models each measuring unit or individual is faced

with the choice of one of two mutually exclusive alternatives and
the choice made is thought to depend on some vector of exogenous

variables. One way to formalize the choice mechanism is to view

the decision maker as having associated with each alternative
sorre preference function, say

I li f.1(X.)
i+

v

I 2i

v

f 2(X.)
1 +

ii
2m,

and choosing that alternative which yields the higher preference.

Assuming f(X1) jl,2, is of the fore f.(X1)
2 is chosen if
I2i
.>Ili a'X.—ct'X.
2i 11 + v2i.—vli.>O
—

alternative

,xi+ui>o

where FcL
i v2i.-v li..
2 1-a and u.

The

model can be rewritten in the

alternative fonyi:
Y.
z $T.
+ u.1
1
1
W.

1

= 0

if Y.<0
1

=1 ifY.>0

where Y.
1 is sorre latent (i.e •,
observed

unobserved)

variable and W.
is the
1

dependent variable which indicates the choice made. Maxi-

2. These models appear to have been first examined in the context of

economics by Tobin [8] who outlined the method of estimation which

he termed "probit regression analysis." Theil [7], among others,
treated the same problem with "logit" analysis. The distinction
between the two lies in the assumptions made regarding the distribution
of the underlying disturbance.

—5—

mum likelihood estimation requires sorre assumption about the

If that

distribution of .

distribution is nol, i.e., uIN(O,a2),

the likelihood function is given by

II P(<i n P(i

L(,aW,X)

w.O\ a w1l a

P(x) represents the standard normal cumulative density

where

function,

lexp(-u2/2)du.

P(x):

-

)/TiT

founatly S'X1/ais observationafly equivalent to (k )/(ka)
where 1K is any

positive

constant so that a is not estimable and

is estimable only up to a scale factor. Thus we estimate

,

say, which is equivalent to normalizing a at unity.

An interesting related ndel is
Y.

'X.1 +

W.

1 if Y.1<

Z.

if Y.1 >

Z.
1

1
1

0

where

u.1

1

Z1 is sorre observed variable. A concrete example might be

the estimation of a wage expectation function for say new labor
force

entrants. Expectations (Y1) are

argue that

not observable but we might

when faced with a job offer (that is an offered wage

of Z1) the entrant will accept the job (W1l) only
meets or exceeds his

function,

if that offer

expectation. The appropriate likelihood

under the assumption of normality, is given

L(,al W ,X ,Z )

z.—'x.
1
a

')

by

.111-P
(Z±_ X)

In this case a is estimable because observations on Z1 provide
information on the scale of Y..
1

—6—

In another variation on the same model Z1 is replaced by sorr

constant threshold. If
again not

includes an intercept term then a is

estimable since (c-0-6'X)/a is observationally equivalent

to (c-c0--ct'X')/(ka) where a0k60+(l-k)c and ck .

If that con-

stant is also unknown and to be estimated the identification
problem is further compounded and estimation will require some
normalization

B.

on either

or the threshold paramster.

Multinomial choice models3

An obvious generalization of the binomial choice model is to

allow for

more than two alternatives in

the set of possible choices.

Such models fit a large and important set of problems encountered
in economics and are mentioned here for that reason. Regretably
the functional model to be presented here cannot be used to analyze

these models. This is the one class of limited dependent variable
models,

however, for which there seems to be wide dissemination

of suitable corrputer programs. The approach used in these programs
is logit analysis, a choice dictated in part by the fact that a
specification of the underlying disturbance distributions such that
the selection probabilities are of the logistic form leads to tractable

likelihood functions,

distributions

while almost every other choice of

leads to nearly insurmountable computational diff-

iculties.

3. Refer to McFadden [31 for

a description of the most general
muitinomial model, an extensive bibliography of practical
applications and a discussion of the estimation problems.

—7—
C.

Ordinaly discrete dependent variables

Another extension of the binary choice model is to all for
more than two alternatives but to require that those alternatives
be ranked in sorre well defined order. Such models might arise
when the nagnitude of the observed dependent variable reflects the
magnitude but not the scale of sorre underlying but unobserved

dependent variable. As an example years of schooling might be a
proxy rreasure for accumulated human capital but it may not be

reasonable to assurre that twice as much education implies twice

as much capital. Alternatively the observed dependent variable

may have the scale relevant to a particular relationship being
examined but it may be rreasurable only in coarse discrete units.
In the case with unkncwn scale the model appears as:
Y.

1

'X.+
1
1

W.l
1

if

2

if

11

Y.<p

S—l if ps—2—

S

i

s—i

if ps—i—<Y.i

If the u. 's are independently and normally distributed with mean
zero the likelihood function is

(1_'Xj

P\ a 111

L(,pIX,W)fl

1

1

(51-'
X (s-2a X\
a

P\
W.=s—i

.11

1

L• See

NcKelvie t1

(p2_Xf (1_'xA
I -p\
,,/...

for

/_P\

)

•fl

(5_1—' Xj
l_P\ a J

1

a detailed discussion of the models.

—8—
As

in the

choice model, a

binomial

set of thresholds
After suitable

is not identifiable and

the

and the intercept cannot all be estimated.
we can

normalization, for example al and

up to a multiplicative scale factor and the difference

estimate

between the thresholds up to the same scale. Estimates of the
i.'s

by

would represent the

the observed

relative scale among

dependent

the values taken on

variable.

When the scale of the variable W is known the model is the
same except

for replacing the uni<riown

i.'s with appropriate known

constants and in this case a is estimable.
D.

Truncated dependent variables 5

In many economic relationships the dependent variable is

necessarily non negative. Thus we might write the
'X.1 + u.

W.

1

model as

if PHS>O

1

0

otherwise

Alternatively we might concieve of an unconstrained latent variable
Y. and reformulate the model as
1

'X.1

y.1

z

W.

Y.1 if Y. 1—
>L.1

1

where

L.

+ u.
1

if Y.<L.
1
1

the threshold of 0 has been replaced by a more general variable

threshold and only X, W. and L are observed. For independent
normal u1 ' s the likelihood function is given by

(w_'x

(L._tX\

L(',aJW,X,L)

II p\'
W.L.
11

5.

a

a

W.>L.
1 1

These models were investigated by Tobin 191 and
called "Tobitt' models.

have

coma to be

.

—9—

where

Z (x) is the standard normal density function

Exanples

of problems to which this

model might

exp (-x2/2).

be applied

include consumer expenditure on some class of goods, which is

constrained to be non negative, and interest rates paid by cornnercial
banks on savings deposits, which are constrained by regulation Q
not to exceed a certain rate fixed by the Federal Reserve. Note

that for purposes of estimation alone the pardcular value assigned
toW1 for limit observations is not used while the threshold value

is. On the other hand for non limit observations the threshold
value need not be known. Thus the model may under certain cir-

curnstances be utilized to estimate seperately the two equations
of the following disequilibrium market model:

u

D=

+

S=

+u
Min(S,D)

Q

u1 and U2 independent

The observed variables are Q ,X1 and X2 and we assume that X1 and

X2 are independent of U1 and u2. For estition of the demand
equation D is the latent variable and S the threshold with the roles
reversed

for estimation of the supply equation. We must, for the

truncated

model to apply, know

correspond to demand (ie

which observations in a given sample

excess supply) and

which correspond to

supply. Furtherrrüre information on this sample separation must be
eXOgenOUS.

6

Suppose that in the sirrple truncated dependent variable model

6. See Maddala and Nelson [2] for a detailed discussion of disequilibrium
market

model estimation under these and other assumptions.

— 10

—

the threshold is an unithown constant to be estimated with limit

observations on W somehow distinguishable, though not equal to

the threshold,. Then direct maximization of the likelihood function

with respect to ,
for p

and p

a

threshold) would lead to an estimate

(the

infinity. But this would be inconsistent with model

of

specifies that the constant threshold must necessarily
or equal to the minimum observed value of W.

which

be less than

over the set of non-

limit observations. Thus the maximum likelihood estimate of p
would be this minimum value of W.
1 and the other estimates would be
obtained by maximizing the likelihood with respect to

paraireters

the other

holding p fixed.

E. Iub1y truncated dependent variables.
Some dependent variables of interest may

be

truncated both

7
at high and at low values. The model becomes
+
W.

1

=

L

.

li

=Y.1

if Y.<L
1 ii
ifL.<Y.L.
li—i 2i

=L.
2 ifL.<Y.
2 1
and the likelihood function is given by

L(,aW,X,L)

II

P1

W.=L
1 11

W1=L

a

1
a Z

11

1

a

1

(L;t Xi)

In some probleus the intermediate or non-limit observations may also

7. See Rosett and Nelson [6] for a detailed treatment of this class
of models.

— 11

be

—

unobserved. Provided the sarrle may

the three

still

be separated into

subsets of observations and the thresholds are J<nown

constants or

observable

variables, all parameters of

the irodel are

'

still estimable. The middle term in the likelihood function is
L .-'X.
L .-'X.
replaced in this case by [P(
—P(
1)], and the model
is seen to be a specific case of the ordered discrete variable
model with J<nown scale.

An example of a problem to which this model has been applied

is the demand for health insurance by people on madicare. A certain
minimum coverage (the lower threshold) is provided to all participants.
They may purchase supplemantal insurance only up to some maximum

which falls short of full coverage.
F. Models of Friction
Rosett [5] considered a model in which the dependent variable

responds only to numarically large values of the exogenous variables.
His model may be written as:
=

Yi
W.

'Xi li
+

=Y.1 -

1

1

ifY.1 <a 1

if

i2

=y.—a
Denote

a1 < Y.
1

<

a2

if a 2<Y.1

the sample separation into

of integers l '2 and

.

The

the three

subsets by three sets

likelihood function is given by

- 12

L(1,a2,,aIW ,X)

(w1+a1'x 2 f2_TxA
IIi Z\
a ) P a ) - P1-'x.1
11

3
The

—

_______

model provides for a different intercept in the two sets of

continous observations. One might assume no difference in the

intercepts by setting 1Y1 in both extreme cases and deleting
aid °2 from the corresponding teniis in the likelihood.
Going the other direction even the slope coefficients might be
permitted to change between the two sets by appropriate modification

of the model and the likelihood function.
Exai1es of problems to which this model might apply are

changes in the holdings of some asset in response to changes in

its price or rate of return and changes in wage offers by a firm
in response to changes in market conditions.

.

— 13 —

II.

A General Functional Model

Most of the limited dependent variable models may be specified,

perhaps after reformulation, as

(i)

a single regression equation relating a latent, i.e., not
directly

observable, endogenous variable to a stochastic

function of some vector of exogenous variables, say

f
and

(ii) a

discontinuous mapping from the latent variable Y to an

observable dependent variable W, say

g (Y,Z.)
The role played by the vector of exogenous variables Z will
be discussed below. Observed variables include X.1']
Z. and W.
and para1

meters to be estimated include the vector and perhaps parameters of

the distribution of U1 and of the function g.
The functional form of both g and f must be }<nown and constant

over all observations. If the rmdel is to conform to the various limited
dependent variable models and be operationally feasible we will require

certain restrictions on the form of these two functions. Consider
first the function f. Since the estimation method to be used is maximum
likelihood the distribution of the stochastic component must be specified.

We will assume that the disturbance term u appears, perhaps after a
suitable transformation, additively and follows an independent normal

distribution with zero mean and constant variance.8 Restrictions on

8. The choice of distributions may of course be changed but is an
integral part of the analysis and thus must be held fixed for
implementation of the model. Note that the normal distribution
leads to probit analysis for the binomial choice model and is
the distribution suggested most often for eKtensions of the limited
dependent variable models. A choice of the logistic (sech2) distribution would lead to logit analysis for the binomial choice model.

-1the degree

of non-linearity of f

may also be desireable. The

iterative niaxinuization algorithims used for obtaining estimates

generally require at least first and perhaps second derivatives. Thus

if nonlinear specifications for f are to be alled implementation
will require a computer system with analytic differentiation capability,

nuirical derivatives or user supplied derivativatives. Restricting f
to be linear would avoid this problem but we will not impose that

constraint here. The regression equation to be used in the nodel is

thus of the form

(1) Y f(X.,)

In

+

2

u

,

uIN(O,a

).

the limited dependent variable models the mapping W1g(Y) is

necessarily discontinuous with the discontinuities appearing at well

defined points, to be called thresholds, in the range of Y.

that

there are S-l

threshold

the S disjoint intervals. Then g(Y1 ,Z

(2) g(Y,Z1) =
where t. .
1J

if

tj1

,j1,... ,S-l

defined to be -

into

points and partition the range of
may be written as
<

tj

j=l,...

are the threshold points and t. and t. are
10
iS
and +
respectively.

jzl,... ,S must hold across

tj
threshold

The constraint -

all observations i but the

points

need not be constant across observations. Any conüination of the following
specifications for the t 's should be permissable:
(i) known nureric constants
(ii) observable variables (ie. one of the variables in the vector
Z.)

1

(iii)

constant but unknown paramsters to be estimated.

- 15
The individual

jl,... ,s are of two

called continuous and

the

-

mass point

basic

types, to be

as determined by the distribution of

random variable W.
.
1 within the relevant interval on Y.
1
specifies

mass point

that within the jth interval of the range of Y

a constant function of Y(i . e.,

specifications

A

for mass

point

independent of thelevel

WI

is

of Y1). 7pica1

g.'s are

t< (where tik is one of the threshold points of

(i)

the type (i) or (ii) as given above)

Zik (where Zik is soma observable exogenous variable)

(ii) g (Y1)

(iii) (Y) c (soma known constant)
Continuous

of

g (Y1)

's specify continuous and strictly increasing functions

within the corresponding interval on

The most corrmon specifi-

cation will be
=
We will in

fact require that all continuous

g5

be

of this form, delaying

for the moment a discussion of the advantages and disadvantages of such

a restriction.
Derivation of the likelihood function for the functional model is

straight forward. We need first to derive the distribution of W1. For
mass point intervals we have

Pr(W.g.(Y.))
1 : 1
=(t..

Pr(t..
<Y.<t..)
ij—l—i ij

-f(X.,)
<—u.1
1

< t.

.-f(X.,))
1

1J

which under the Normality assunption on u. becorrs
1

Pr(W.=g.(Y.))
1] 1
9.

p(

The term mass point

t.1J.-f(X.,)
1

- p

( 1J 0

1

and continuous will be loosely applied to the sub-

functions g., to the corresponding interval on Y. and to the values taken
on by W.. What is implied in all cases is that,'within some intervals of
the rane of Y. ,W1 is defined by g. to be a constant so that its associated
measure of proabi1ity is probabi1ty mass. In other intervals W1 is a
continuous function of Y. within that interval so that the appropriate

measure

of

probability i its probability density.

- 16

-

P() is the standard normal cumulative density function. A general
derivation of the density function for over continuous intervals

where

requires strong assunptions about the specification of continuous g (Y) 's.

If these

functions are strictly increasing

interval on
Y.1

(decreasing) over

the relevant

Y. then the inverse function
1

g (W.)
1
J

exists and is differentiable so that the p. d. f. of continuous W, say
h(W.), is given by

h(w) J z (wi_fXi))
where J is the Jacobian of the

transformation, J.

I,

and

Z is the

standard normal density function. Construction of the likelihood requires
knowledge of the sanple separation. That is for each observation on
we must be, able to determine the interval in which the corresponding
unobserved value for

lies.10 For notational convenience define the

of integers 1,... ,n, where n is the sanle size, as

subsets

if t_1

<

t..

,

i

1,... ,n , :F:l,... ,s

The likelihood function is given by
(3) L(eJW,X,Z) = ii

ii
1
A.

i2 •. ..

A.

Ti

2

ii

A.

s

where 0 is a vector of all paraireters to be estimated and the A. . 's are
1J

defined as
A..
1]

if j

=

t. .—f(X.1 ,)

P(

corresponds

i1

t. .
—

—f(X.1 ,)

to a mass point interval on Y1 and
Z

((Wi) - f(X6)

10. Determination of the sample separation is

made by comparing, for each observation, W1 with each g. (Y.). For mass point g. 's a matching of Wj and g. (Y) for
some j determines that *he observation correponds to a value of Yj inthe th
interval. This leaves only the continuous observations to be classified but, as
be of the
will be pointed out later, so long as we restrict continuous gj 'S
is
a
continuous
one is
form gj (Y) Y1 the knowledge that an observation on Wj

to

all that is required; we need not know to which continuous interval it belongs.

— 17

if j

corresponds

—

to a continuous interval on Y..

It should nc be clear why the restrictive specification

g (Y) Y for continuous intervals was imposed. Such a restriction
makes it easy to distinguish mass point from continuous intervals
and permits all continuous observations be to be grouped into a single sub-

set, for purposes of estimation, since they all enter the likelihood in
exactly the sane form (Jl and g (W1) = W1 for every continuous

interval j.)

Thus

we can avoid a good deal of pethaps nessy corrputer

coding and additional user supplied infornition. Note too that this
restriction creates difficulty with only one of the limited dependent
variable models reviewed in section I, the friction model. But even this
problem is easily surmounted by judicious use of dunmy variables.

The friction model, with intercepts which differ in the two

continuous intervals, is repeated here.
Y.
1=
w.

1

=

'X.1 + U.1
Y.
1 -a1 ifY. 1<a1

zQ ifa1<Y1<a2

Y.
ifa 2<Y.1
1 —a
2
Reformulate the regression equation as
Y.

1

where D.

il

a1D.ii+ a 2i2
D. + 'X.1

+ U.

1

-l when Y.
1 lies in the lcwer continuous interval
0 otherwise

-l when Y lies in the upper continuous interval
0 otherwise.

— 18 -

The

rest of the model is then written as
W.

1

Y.

if

Y.1 <ct1

0

if

c<Y.<c
2
1—i

if

cL<Y.

1

=Y.1

2i

Note that the two continuous intervals on

are not properly defined

in this formulation but recall that for continuous intervals the
threshold points do not appear in the corresponding terms in the likelihood function. Thus with regard to estimation the inconsistency is only
transparent. The inconsistency could in fact be removed by redefining
the two intervals as Y.<0
But this would make the model more
1 and 0<Y..
—1

difficult to irxplemant since then, without specifically accounting for
the specification of f(X1,), the intervals on Y1 would appear to either

overlap or fail to exhaust the entire range of Y1. Several other points
should not include an intercept
are worth noting. In this model

term or indentification problems among o'l and 02 will arise. The
friction model is unique in that threshold parameters and parameters of

the function f overlap. Finally, similar use of dunj variables can
provide for slope coefficients which differ in the two continuous intervals
while if all intercept and slope coefficients are the same the restriction
on

the specification of the continuous g 's is satisfied

reformulation

using duimj

variables.

without a

- 19 -

III.

Features of a Computational Algorithm

In
a

this section we will discuss the specific details involved in

suitable conputer program for the

functional model. First

the

model is restated.
The functional model is defined as

(1) Y.1

f(X.,)
+
1

u.1

if t1 <

(2) Wi = g.(Y)

Y1

<

t.., j1,... ,S

2

1

IN(O,o

)

is a latent variable and W, the vector X and perhaps some vector
Z.1 are the observed variables. Parameters to be estimated include

and/or some of the t's. The threshold points t0 and

and

perhaps

t1

are defined as -

and +

respectively

for all i=l,. .

. ,n where n

is the sanple size. The remaining threshold points t11,... ,t51 may

be

any

of

the following:

(1)

known numeric constants

(ii) observable exogenous variables (one of the Zts)
(iii) constant but unknown parameters to be estimated
The

g (Y1) 's define W1 to be either a mass point observation or a

continuous observation when the unobserved

falls in the conesponding

th interval. Continuous g (Y1) 's must be of the form
g(Y1)
while mass

(1)

point g(Y1)'s may be either
known constants,i.e.,g.(Y.)
Ji

C

or

(ii)

observable exogenous variab1es,i.e.,g(Y)

ZJ<

- 20 -

the mass point g (Y) 's must be such that a comparison of
W for each observation with each mass point g will determine uniquely
Furthermore

a sample separation defined by the following subsets of the integers

1,...

Note

ic' 1ff W. g (Y.)

for mass point interval j

ik 1'o

for any mass point interval j.

iff WI g (Y1)

that 1'. will be empty for any continuous interval j.
The

components of the likelihood function were presented in Section

II. Estimation involves maximization of the logarithm of the likelihood
function. The normal equations obtained by setting the derivatives of

log L with respect to each estimable paraiiter equal to zero will be nonlinear so that soma iterative maximization algorithm is required.
Experience has

well on

that the Newton-Raphson algorithm11 works quite

these models with fairly rapid convergence when starting from

reasonable

and

shown

initial estimates. This algorithm does require both first

second derivatives which, though messy, are fairly easy

to derive.

Table 1 presents the components of the likelihood function corresponding

to each type of interval on Y1 and the associated terms in the first and
second derivatives of the log likelihood function. Several points should
be noted. First the parameters to be estimated are denoted by the by

the vector e with elements 0. Secondly, the derivatives presented there
make the following use of the chain rule: The terms in the log likelihood
function

involve the functions P(A) and Z(B), where A and B are represent-

ative argunts, and have the following derivatives:
11. As was noted earlier the constraint t. .1<t.. must hold for jl,... ,s and
all i1,... ,n. If these thresholds includparaters to be estimated the
constant should be taken into account in the maximization algorithm. This
is awkward to do however, in the general model since not all problems will
require estimation of threshold parameters. There is no danger that straight
forward application of Newton's mathod will produce estimates which violate
the constraint since this would require taking logarithms of negative numbers.
We therefore suggest using Newton's method with the provision of allowing some
user control in the iterative process for handling those occasional problems
which the constraint causes difficulty.

in

— 21

P(A)

o.1

We

Z(A)
— P(A)
-

—

A and Z(B)
1

—Z(B)

B .

o.1

1

have carried the differention only this far, since the arguments A

and B involve the unspecified function f(X1 ), and assume that the
derivatives of these arguments can be readily obtained thru some corrination

of user supplied derivatives, restrictions on the functional form of f
and internal differentiation capability 12 Finally, note that lower and
upper mass point intervals have been distinguished in tht table from

interior mass point intervals since recognition of their sirrpler
structure generally will achive significant economies in computer time.

As was suggested by the discussion in Section I, not all parameters
in the functional rrodel are necessarily estimable. In parLicular can
be estimated only if the observed variable W contains some information

regarding the scale of the latent variable

In general any one of

the following conditions on the model will be sufficient
estimation

(i)
(ii)

to permit

of a.
At least one continuous interval

At least one threshold is an observable, varying threshold

(iii) At least two threshold points are known constants
If none of these conditions

are met

then estimation may proceed only after

normalization of a, e.g., ail. If the model includes both threshold parameters
to

be estimated and an intercept term in the regression equation there

will generally be an identification problem airng this set of parameters
12. The TROLL system on which the authors have implemented the functional

model does have the internal capability of obtaining analytic derivatives.
This feature is exLremely useful for such simple functions as the arguments
like A and B in that it renders unnecessary further restrictions of f or
alternatively, heavy user input. On the other hand it cannot be used to
avoid the progranirning of derivitive calculation to the level presented in
table I without resulting in prohibative computer time.

belongs

ipe of interval
to which an
observation

,

B.

Z(u)du,

point

point

Lier mass point

ss

Interior mass

per

fX

t.-f(X,)

-

Continuous

P()
A.

a

=

TABLE

1.

S

,

1

.

etc.

<<1/a >>

2

P(B.)

-Z(B.)

[1k

1]

-

-

-

(w.r.t.O

and

I]]

k

BP(A)

Ok)

P(A)
.
1

.i

k

l-P(B.)

B[P(A.)-P(B.)]

Z(B.)•[B—B.•BB]
I
I

A.•A•A] -

—

jlc +
1k
(C.C
C.C )

- B.BB] + l-P(B.)

[P(A)-P(B)]

P(A.)- P(B.)

Z(A.)•[A-A.AA1
1]]

1

P(A.)

Z(A)

Second derivative

COMPONTS OF LJKELDIOOD FUNCrION AND CORRESPONDING
FIRST AND SECOND DERIVATIVES OF THE LOG LIKELIHOOD

Corresponding
in

component

First derivative (w.r.t.O.)

2A

likelihood

A

11

Z(BJ•B
ii

P(B.)

—

A
i

A
Oi

A

Z(A)
I

P(A.)

1

Z(A.)A
i

P(A.)

-Z(B.)

P(B.)
I

a

,

<—1/a> —C•C

=

W-f(X,)

exp(—x2/2)
C =

a

O

,

P(A)

P(A.)—P(B.)

)

l-P(B.)

1 Z(C

a

Z()
,

=

for ik,

t1_f(X)
a
for 0
appears

the term -1/a appears only
only
the term 1/a2

- 23

-

- only the difference between each pair of parameters

in the set can be estimated. Again a normalization is required on
one parameter in this set.

The iterative maximization algoritii will require starting values
for the parameters to be estimated. We have not been successful in
obtaining a straightforward routine for selecting good starting values

for all parameters in the functional model. Tobin [9], in the context
of the Tobit model, suggested approximating the non-linear terms in the
normal equations by some simple functions to allow analytic solution of

those equations but this approach becomes quite difficult to implement

in the more general functional model, especially if the regression

equation is itself non-linear. Similarly some expansion of the normal
equations

In

with a low order truncation is

also difficult to implement.

lieu of a general solution we offer the following suggestions for

implementation

on a case by case basis.

(a) If the model includes continuous intervals, least squares
regression of W1 on X1 over just the subset of continuous

observations will often provide satisfactory, thoui biased,
starting values for the regression coefficients and for a.
(b) For threshold parameters choose starting values such that the
spacing between adjacent threshold points is proportional to

the percentage of observations falling in each interval.
(c) In models with no continuous intervals and values for W1 which

correspond ordinafly to Y try a straightforward least squares
regression of W1 on X1 for starting values for the regression
coefficients.

— 2'- —

Cd)

for many

data sets and if the iterative maximization

algorithm is fairly stable, zero starting values for many of
the paranEters will generally suffice.

Generally paraneter estimation is only part of the analysis to
be performed on a given model. The remainder of this section discusses
vamious other analyses which may often be desired and which are reason-

ably easy to isplerrent in the functional model.

It is often quite informative to examine simple descriptive statistics,
such as mean, variance and range, of various variables in the model both

over all observations and over the subsets of observations corresponding
to each interval on Y. Furthermore while such information may be of

use by itself it can as well serve to detect or explain failures in the
estimation process. To see this consider a simple binomial choice model

with a single regressor variable. The likelihood function is given by
L(a,W,X)
Suppose

II P(—a—X.)
1 .

11

1

1

[l—P(—a—X.)]
1

that in a given set of data the observations are as pictured in

the figure to the right.
It is easy in this case to
find values for a and

W

xx xx x

X

such that whenever W.O
1

(_a_X) is positive and when Wl (_a_X) is negative. All observations
can thus be perfectly classified on the basis of the sean value (ct+X)

for such a and . In fact the likelihood is maximized as a and tend
to negative and positive infinity respectively. This failure in the
estimation process could easily be predicted, in this simple model, by

- 25

range of X within the two

coirparing the

sane
and

problem

all the

-

arises in this model

with

sets

of observations. The

more than one exogenous variable

other models as well, suggesting that as a prelude to

estimation one should always critically examine simple statistics,
expecially the range, of the exogenous variables within each subset

of observations. In addition, even if the individual exogenous
variables do overlap,

there may be

sorre combination which provides

perfect classification of the observations. Such a situation is often
difficult to detect until after the estimation process has failed.
Performing

=

the sane analysis on

f(x,) where

is the vector of

regression coefficient estimates when the iterative maximization
procedure began to diverge may often reveal the source of the problem.
Estimated classification probabilities(i .e . Pr(W. g.

1-J

or

alternatively Pr(t.1< Y <

t..!X.,ZJ)

(Y.1 ) IX.
1,Z.)
1

are often as important to

the analysis as estimates of the parameters themselves. The expressions
for obtaining them are given by the components of the likelihood function
for

mass point intervals and similar expressions for continuous intervals.

In addition to their independent use they serve an important role in
an examination

of the estimation results analogous to residual analysis

least squares regression. They provide, for example, one rreasure of
classification error. Let j be the interval in which an observation
in

falls

and

j be the interval with largest associated classification

probability.

An obervation may be

viewed as being misclassified if j j.

13

13. Whether this is an appropriate measure of misclassification will depend
on the model being examined. For example it may be a useful measure for the
binomial choice model while in the ordinally discrete model, since the

frequency of misclassification under this measure is easily altered by
arbitrarily collapsing adjacent intervals, it may not be at all appropriate.

- 26

-

variety of maasures of "residuals" may be readily obtained. Using
estimated coefficients to conpute Y = f(X,6) we can obtain directly
A

1 ii

u.

the

W. -Y. for continuous observations. For mass

may be "bracketed" by t. .-Y. and Y.-t..
1 ij—1
13 1

estimated residual

Another

point observations

indicator of misclassification is given by a conparison of j

and j where
observed

the

j

interval in which

Y falls and, as before, j* is the

interval.

An important part

calculation

of

the analysis for a given problem might be the

of mean values for the observed dependent variables. These

might be needed, for example, for prediction purposes or for the calculation

of elasticities. LLf The expected value of
E(W. IX. ,Z.) =1 — Z

y-f(X.,6)
1
(

ij 1

s

= I

j=l t1

g(y) dy

y—f(X. ,6)
Z(

for given X (and Z) is

)

g.(y) dy

s

jl

A.

For mass point intervals g (y) is a constant so that the coresonding
term in the expected value of is

31

'

t.'.-f(X. 6)

A. = g.(Y.) . [P(
3

t.. -f(X.,6)
1

) - p ( ijl

or elasticity is for a single individual or.
l.observation
If the prediction
then the appropriate value for W to be used should by Wg(Y1).

the other hand if we need the mean predicted value or aggregate
elasticity the appropriate value is E(WIX±ZI) as is given here.
On

— 27

For

—

continuous intea1s, iteation over the 1evant range yields15
A f(X1,8) [p(t1-f(X1) ) - p (tij_l_f(xis)) ]

t. .—f(X.,)
1

-a[Z(11

t.
15. We have

A

f

)-Z('

t. . —f(X.,)

1 y-f(X,)
y a Z(

dy IL2[f(X,) ÷ ax] Z() dx

)

j—1

1
L

L

f(X1) 2 Z()d + a
L1
where Lj1[t. 1—f(X,)]/a and L2[It.—f(X,)]/a.

Since Z() —dZ()/d, !XZ(X)d —

Z()

and we obtain

f(X,)•[P(L2) -

P(L1)]

-

)]

a[Z(L2)

- Z

(L1)]

— 28

—

References

[1]

Johnson, Thomas. "Qualitative and Limited Dependent Variables in
Economic Relationships, "Econömetri-ca, May, 1972.

[2]

Maddala, G.S. and F.D. Nelson. "Maximum Likelihood Mathods for
Models of Markets in Disequilibrium," (forthcoming) Econoiietrica,

November, l97.
[3]

[]

McFadden, Daniel. "Conditional Logit Analysis of Qualitative choice
Behavior," Frontiers in Econoutrics, P. Zareithka (Ed.), Academic
Press, 1973.
McKelvey,

Richard D. "A Statistical Model for the Analysis of

Ordinal Level Dependent Variables ," discussion paper, Political

Science Departnnt, University of Rochester, May, 1973.
[5]

Rosett, Richard N. "A statistical Model of Friction in Economics,"
Econouetrica

1959.

[6]

Rosett, Richax N. and F.D. Nelson. "Estimation of the Two-Limit
Probit Regression Model," (forthcoming) Econontrica.

[7]

Theil, Henri.

[8]

Tobin, J. "The Application of Multivariate Probit Analysis to
Economic Survey Data," Cowles Foundation Discussion Paper no. 1,
New Haven, Conn., 1955.

[9]

Tobin, J. "Estimation of Relationships for Limited Dependent

Principles of Econoiietrics, chapter 12; Wiley, 1971.

Variables," Econorretrica 1958.

