NBER WORKING PAPER SERIES

THE AFFINE ARBITRAGE-FREE CLASS OF
NELSON-SIEGEL TERM STRUCTURE MODELS
Jens H. E. Christensen
Francis X. Diebold
Glenn D. Rudebusch
Working Paper 13611
http://www.nber.org/papers/w13611

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
November 2007

The views expressed are those of the authors and do not necessarily reflect the views of others at the
Federal Reserve Bank of San Francisco. Georg Strasser provided excellent research assistance. The
views expressed herein are those of the author(s) and do not necessarily reflect the views of the National
Bureau of Economic Research.
© 2007 by Jens H. E. Christensen, Francis X. Diebold, and Glenn D. Rudebusch. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

The Affine Arbitrage-Free Class of Nelson-Siegel Term Structure Models
Jens H. E. Christensen, Francis X. Diebold, and Glenn D. Rudebusch
NBER Working Paper No. 13611
November 2007
JEL No. G1,G12
ABSTRACT
We derive the class of arbitrage-free affine dynamic term structure models that approximate the widely-used
Nelson-Siegel yield-curve specification. Our theoretical analysis relates this new class of models to
the canonical representation of the three-factor arbitrage-free affine model. Our empirical analysis
shows that imposing the Nelson-Siegel structure on this canonical representation greatly improves
its empirical tractability; furthermore, we find that improvements in predictive performance are achieved
from the imposition of absence of arbitrage.

Jens H. E. Christensen
Federal Reserve Bank of San Francisco
Economic Research, MS 1130
101 Market Street
San Francisco, CA 94105-9967
jens.christensen@sf.frb.org
Francis X. Diebold
Department of Economics
University of Pennsylvania
3718 Locust Walk
Philadelphia, PA 19104-6297
and NBER
fdiebold@sas.upenn.edu

Glenn D. Rudebusch
Federal Reserve Bank of San Francisco
Economic Research, MS 1130
101 Market Street
San Francisco, CA 94105-9967
glenn.rudebusch@sf.frb.org

1

Introduction

Understanding the dynamic evolution of interest rates and the yield curve is important for many
diverse tasks, such as pricing long-lived assets and their financial derivatives, managing financial
risk, allocating portfolios, conducting monetary policy, purchasing capital goods, and structuring
fiscal debt. To investigate yield-curve dynamics, researchers have produced a vast literature and
a wide variety of models. However, many of these models have tended to be either theoretically
rigorous but empirically disappointing or empirically appealing but not well grounded in theory.
In this paper, we introduce a hybrid model of the yield curve that displays theoretical consistency
as well as empirical tractability and fit.
Since nominal bonds trade in deep and well-organized markets, the theoretical restrictions that
rule out opportunities for riskless arbitrage across maturities and over time hold a powerful appeal,
and they provide the foundation for a large finance literature on arbitrage-free (AF) models that
started with Vasiček (1977) and Cox, Ingersoll, and Ross (1985). These models specify the riskneutral evolution of the underlying yield-curve factors as well as the dynamics of risk premiums.
Following Duffie and Kan (1996), the affine versions of these models are particularly popular
because yields are convenient linear functions of underlying latent factors (state variables that are
unobserved by the econometrician) with parameters, or “factor loadings,” that can be calculated
from a simple system of differential equations.
Unfortunately, the canonical affine AF models can exhibit poor empirical time series performance, especially when forecasting future yields (Duffee, 2002). In addition, the estimation of
these models is known to be problematic, in large part because of the existence of numerous
model likelihood maxima that have essentially identical fit to the data but very different implications for economic behavior (Kim and Orphanides, 2005). These empirical problems appear
to reflect an underlying model over-parameterization, and as a solution, many researchers (e.g.,
Duffee, 2002, and Dai and Singleton, 2002) simply restrict to zero those parameters with small
t -statistics in a first round of estimation. The resulting more parsimonious structure is typically
somewhat easier to estimate and has a more robust economic interpretation (fewer troublesome
likelihood maxima). However, these additional restrictions on model structure are arbitrary from
both a theoretical and a statistical perspective. Furthermore, their arbitrary application, along
with the computational burden of estimation, effectively precludes thorough simulation studies
of the finite-sample properties of the estimators of the canonical affine model, thus, complicating
model validation. In part to overcome such problems, this paper considers the application of a
new, arguably less arbitrary, structure to the affine AF class of models.
Our new AF model structure is based on the workhorse yield-curve representation introduced
by Nelson and Siegel (1987). The Nelson-Siegel model is a flexible curve that provides a remarkably
good fit to the cross section of yields in many countries, and it is very popular among financial
market practitioners and central banks (e.g., Svensson, 1995, Bank for International Settlements,
2005, and Gürkaynak, Sack, and Wright, 2006). Moreover, Diebold and Li (2006) develop a
dynamic version of this model and show that it corresponds exactly to a modern factor model,
with yields that are affine in three latent factors, which have a standard interpretation of level,
slope, and curvature. Such a dynamic Nelson-Siegel (DNS) model is easy to estimate, and Diebold
1

and Li (2006) show that it forecasts the yield curve quite well. Unfortunately, despite its good
empirical performance, the DNS model does not impose the desirable theoretical restrictions that
rule out opportunities for riskless arbitrage (e.g., Filipović, 1999, and Diebold, Piazzesi, and
Rudebusch, 2005).
In this paper, we show how to reconcile the Nelson-Siegel model with the absence of arbitrage
by deriving the class of AFDNS models, which are affine AF term structure models that maintain
the Nelson-Siegel factor-loading structure. These models combine the best of both yield-curve
modeling traditions. They maintain the AF theoretical restrictions of the canonical affine models but can be easily and robustly estimated because the Nelson-Siegel structure helps identify
the latent yield-curve factors. In particular, empirical implementation of the AFDNS models is
facilitated by the fact that zero-coupon bond prices have analytical solutions, which we provide.
After deriving the new class of AFDNS models, we examine their in-sample fit and out-ofsample forecast performance relative to standard DNS models. For both the DNS and the AFDNS
models, we estimate parsimonious and flexible versions (with independent factors and more richly
parameterized correlated factors, respectively). We find that the flexible versions of both models
are preferred for in-sample fit; however, the parsimonious versions exhibit significantly better outof-sample forecast performance. Finally, and most importantly, we find that the parsimonious
AFDNS model outperforms its DNS counterpart in forecasting, which supports the imposition of
the AF restrictions.
We proceed as follows. Section 2 introduces the DNS model and derives the main theoretical
result of the paper, which defines the AFDNS class of models. Section 3 derives the relationship
between the AFDNS class of models and the canonical representation of affine AF models introduced by Dai and Singleton (2000). For the four specific DNS and AFDNS models used in our
empirical analysis, Section 4 describes the estimation method, data, and in-sample fit, while Section 5 examines out-of-sample forecast performance. Section 6 concludes, and appendices contain
additional technical details.

2

Nelson-Siegel term structure models

In this section, we review the DNS model and introduce the AFDNS class of arbitrage-free affine
term structure models that maintain the Nelson-Siegel factor loading structure.

2.1

The dynamic Nelson-Siegel model

The original Nelson-Siegel model fits the yield curve with the simple functional form
y(τ ) = β0 + β1

 1 − e−λτ 
λτ

+ β2

 1 − e−λτ
λτ


− e−λτ ,

(1)

where y(τ ) is the zero-coupon yield with τ years to maturity, and β0 , β1 , β2 , and λ are model
parameters.
As noted earlier, this representation is commonly used by financial market practitioners to
fit the yield curve at a point in time. Although for some purposes such a static representation

2

appears useful, a dynamic version is required to understand the evolution of the bond market over
time. Therefore, Diebold and Li (2006) reinterpret the β coefficients as time-varying factors Lt ,
St , and Ct , so
yt (τ ) = Lt + St

 1 − e−λτ 
λτ

+ Ct

 1 − e−λτ
λτ


− e−λτ .

(2)

Given their Nelson-Siegel factor loadings, these factors can be interpreted as level, slope, and
curvature. Diebold and Li assume an autoregressive structure for these three factors, which yields
the DNS model—a fully dynamic Nelson-Siegel specification.
Empirically, the DNS model is very tractable and provides a good fit to the data; however, as
a theoretical matter, it does not require that the dynamic evolution of yields and the yield curve
at any point in time cohere such that arbitrage opportunities are precluded. Indeed, the results
of Filipović (1999) imply that whatever stochastic dynamics are chosen for the DNS factors,
it is impossible to rule out arbitrage at the bond prices implicit in the resulting Nelson-Siegel
yield curve. Hence, the discounted prices of zero-coupon bonds in the DNS model are not semimartingale processes under the pricing or Q-measure. The next subsection shows how to remedy
this theoretical weakness.

2.2

The AFDNS model

Our derivation of the AFDNS model starts from the standard continuous-time affine AF structure
(Duffie and Kan, 1996).1 To represent an affine diffusion process, define a filtered probability space
(Ω, F , (Ft ), Q), where the filtration (Ft ) = {Ft : t ≥ 0} satisfies the usual conditions (Williams,
1997). The state variable Xt is assumed to be a Markov process defined on a set M ⊂ Rn that
solves the following stochastic differential equation (SDE)2
dXt = K Q (t)[θQ (t) − Xt ]dt + Σ(t)D(Xt , t)dWtQ ,

(3)

where W Q is a standard Brownian motion in Rn , the information of which is contained in the
filtration (Ft ). The drift terms θQ : [0, T ] → Rn and K Q : [0, T ] → Rn×n are bounded, continuous
functions.3 Similarly, the volatility matrix Σ : [0, T ] → Rn×n is assumed to be a bounded,
continuous function, while D : M × [0, T ] → Rn×n is assumed to have the following diagonal
structure
 p
γ 1 (t) + δ11 (t)Xt1 + . . . + δn1 (t)Xtn

..

.

0

...
..
.
...

1 Krippner

0
..
.

p
γ n (t) + δ1n (t)Xt1 + . . . + δnn (t)Xtn




.


(2006) derives a special case of the AFDNS model with constant risk premiums.
affine property applies to bond prices; therefore, affine models only impose structure on the factor dynamics
under the pricing measure.
3 Stationarity of the state variables is ensured if all the eigenvalues of K Q (t) are positive (if complex, the real
component should be positive), see Ahn, Dittmar, and Gallant (2002). However, stationarity is not a necessary
requirement for the process to be well defined.
2 The

3

To simplify the notation, γ(t) and δ(t) are defined as



γ 1 (t)
 . 
. 
γ(t) = 
 . 
γ n (t)




δ11 (t) . . . δn1 (t)
 .
.. 
..

.
and δ(t) = 
.
. ,
 .
δ1n (t) . . . δnn (t)

where γ : [0, T ] → Rn and δ : [0, T ] → Rn×n are bounded, continuous functions. Given this
notation, the SDE of the state variables can be written as
 p
γ 1 (t) + δ 1 (t)Xt

..
dXt = K Q (t)[θQ (t) − Xt ]dt + Σ(t) 
.

0

...
..
.
...

0
..
.

p
γ n (t) + δ n (t)Xt




 dWtQ ,


where δ i (t) denotes the ith row of the δ(t)-matrix. Finally, the instantaneous risk-free rate is
assumed to be an affine function of the state variables
rt = ρ0 (t) + ρ1 (t)′ Xt ,
where ρ0 : [0, T ] → R and ρ1 : [0, T ] → Rn are bounded, continuous functions.
Duffie and Kan (1996) prove that zero-coupon bond prices in this framework are exponentialaffine functions of the state variables
P (t, T ) =


EtQ exp

−

Z

T

ru du

t




= exp B(t, T )′ Xt + C(t, T ) ,

where B(t, T ) and C(t, T ) are the solutions to the following system of ordinary differential equations (ODEs)
n

dB(t, T )
dt

1X ′
= ρ1 + (K ) B(t, T ) −
(Σ B(t, T )B(t, T )′ Σ)j,j (δ j )′ ,
2 j=1

dC(t, T )
dt

= ρ0 − B(t, T )′ K Q θQ −

Q ′

B(T, T ) = 0

(4)

n

1X ′
(Σ B(t, T )B(t, T )′ Σ)j,j γ j ,
2 j=1

C(T, T ) = 0,

(5)

and the possible time-dependence of the parameters is suppressed in the notation. These pricing
functions imply that the zero-coupon yields are given by
y(t, T ) = −

1
B(t, T )′
C(t, T )
log P (t, T ) = −
Xt −
.
T −t
T −t
T −t

Therefore, for a three-factor affine model with Xt = (Xt1 , Xt2 , Xt3 ), the closest approximation to
the Nelson-Siegel yield function is a yield function of the form
y(t, T ) = Xt1 +

i
1 − e−λ(T −t) 2 h 1 − e−λ(T −t)
C(t, T )
Xt +
− e−λ(T −t) Xt3 −
,
λ(T − t)
λ(T − t)
T −t

4

so the ODEs for the B(t, T ) functions have these solutions:
B 1 (t, T ) =

−(T − t),

B 2 (t, T ) =

−

B 3 (t, T ) =

(T − t)e−λ(T −t) −

1 − e−λ(T −t)
,
λ
1 − e−λ(T −t)
.
λ

As described in the following proposition, there exists a unique class of affine AF models that
satisfy these ODEs.
Proposition 1:
Assume that the instantaneous risk-free rate is defined by
rt = Xt1 + Xt2 .
In addition, assume that the state variables Xt = (Xt1 , Xt2 , Xt3 ) are described by the following
system of SDEs under the risk-neutral Q-measure


dXt1





0

0

0


 
 dX 2  =  0 λ
t 


dXt3
0 0

 

θ1Q





Xt1





dWt1,Q



  Q  



2,Q 

  2 

−λ 
  θ2  −  Xt  dt + Σ  dWt
,
Q
3,Q
3
λ
θ3
Xt
dWt

λ > 0.

Then, zero-coupon bond prices are given by
P (t, T ) =


EtQ exp

−

Z

T

ru du
t




= exp B 1 (t, T )Xt1 + B 2 (t, T )Xt2 + B 3 (t, T )Xt3 + C(t, T ) ,

where B 1 (t, T ), B 2 (t, T ), B 3 (t, T ), and C(t, T ) are the unique solutions to the following system of
ODEs:

and






dB 1 (t,T )
dt
dB 2 (t,T )
dt
dB 3 (t,T )
dt





1





0

   
= 1 + 0
   
0
0

0

0



B 1 (t, T )





 2

0 
  B (t, T ) 
3
−λ λ
B (t, T )
λ

(6)

3


dC(t, T )
1X ′
= −B(t, T )′ K Q θQ −
Σ B(t, T )B(t, T )′ Σ j,j ,
dt
2 j=1

(7)

with boundary conditions B 1 (T, T ) = B 2 (T, T ) = B 3 (T, T ) = C(T, T ) = 0. The unique solution

5

for this system of ODEs is:
B 1 (t, T ) =

−(T − t),

B 2 (t, T ) =

−

B 3 (t, T ) =

(T − t)e−λ(T −t) −

1 − e−λ(T −t)
,
λ
1 − e−λ(T −t)
,
λ

and
C(t, T ) = (K Q θQ )2

Z

T

B 2 (s, T )ds + (K Q θQ )3

t

Z

T

B 3 (s, T )ds +

t

3 Z
´
1X T` ′
Σ B(s, T )B(s, T )′ Σ j,j ds.
2 j=1 t

Finally, zero-coupon bond yields are given by
y(t, T ) = Xt1 +

i
1 − e−λ(T −t) 2 h 1 − e−λ(T −t)
C(t, T )
Xt +
− e−λ(T −t) Xt3 −
.
λ(T − t)
λ(T − t)
T −t

Proof: See Appendix A.

This proposition defines the AFDNS model and has several interesting implications. First,
the three state variables are Gaussian Ornstein-Uhlenbeck processes with a constant volatility
matrix Σ.4 The instantaneous interest rate is the sum of level and slope factors (Xt1 and Xt2 ),
while the curvature factor (Xt3 ) is a truly latent factor in the sense that its sole role is as a
stochastic time-varying mean for the slope factor under the Q-measure. Second, Proposition
1 only imposes structure on the dynamics of the AFDNS model under the Q-measure and is
silent about the dynamics under the P -measure. Still, the observation that curvature is a truly
latent factor generally accords with the empirical literature where it has been difficult to find
sensible interpretations of curvature under the P -measure (Diebold, Rudebusch, and Aruoba,
2006). Similarly, the level factor is a unit-root process under the Q-measure, which accords with
the usual finding that one or more of the interest rate factors are close to being nonstationary
processes under the P -measure.5 Third, Proposition 1 provides insight into the nature of the
parameter λ. Nelson and Siegel (1987) allowed λ to vary at each point in time, but subsequent
dynamic implementations of the Nelson-Siegel model tended to fix λ over the sample (e.g., Diebold
4 Proposition 1 can be extended to include jumps in the state variables. As long as the jump arrival intensity is
state-independent, the Nelson-Siegel factor loading structure in the yield function is maintained since only C(t, T )
is affected by the inclusion of such jumps. See Duffie, Pan, and Singleton (2000) for the needed modification of the
ODEs for C(t, T ) in this case.
5 With the unit root in the level factor, as maturity increases, − C(t,T ) → −∞, which implies that, strictly
T −t
speaking, this model is not arbitrage-free. However, if we modify the mean-reversion matrix K Q to
0
1
ε 0
0
Q
@
0 λ −λ A
K (ε) =
0 0
λ

and consider a converging sequence εn > 0, εn ↓ 0, then there is a converging sequence of AF models with a limit
given by the result in Proposition 1. Thus, by choosing ε > 0 sufficiently small, we can obtain an AF model that
is indistinguishable from the AFDNS model in Proposition 1.

6

and Li, 2006). In the AFDNS model, λ is indeed a constant, namely, the mean-reversion rate of
the curvature and slope factors as well as the scale by which a deviation of the curvature factor
from its mean affects the mean of the slope factor. Fourth, relative to the Nelson-Siegel model,
)
the AFDNS model contains an additional maturity-dependent term − C(t,T
T −t in the function for

the zero-coupon bond yields. The nature of this “yield-adjustment” term is crucial in assessing
differences between the AFDNS and DNS models, and we now turn to a theoretical analysis of
this term.

2.3

The AFDNS yield-adjustment term

The only parameters in the system of ODEs for the AFDNS B(t, T ) functions are ρ1 and K Q ,
i.e., the factor loadings of rt and the mean-reversion structure for the state variables under the
Q-measure. The drift term θQ and the volatility matrix Σ do not appear in the ODEs but in
)
the yield-adjustment term − C(t,T
T −t . Therefore, in the AFDNS model, the choice of the volatility

matrix Σ affects both the P -dynamics and the yield function through the yield-adjustment term.
In contrast, the DNS model is silent about the real-world dynamics of the state variables, so the
choice of P -dynamics is irrelevant for the yield function.
As discussed in the next section, we identify the AFDNS models by fixing the mean levels of
the state variables under the Q-measure at 0, i.e., θQ = 0. This implies that the yield-adjustment
term will have the following form:
3

−

C(t, T )
1 1 X
=−
T −t
2 T − t j=1

Z

T

Σ′ B(s, T )B(s, T )′ Σ

t



j,j

ds.

Given a general volatility matrix


σ11

σ12


Σ=
 σ21

σ22

σ31

σ32

σ13




σ23 
,
σ33

the yield-adjustment term can be derived in analytical form (see Appendix B) as
C(t, T )
T −t

=

=
+
+
+
+

1 1
2T −t

Z

t

T

3
X
` ′
´
Σ B(s, T )B(s, T )′ Σ j,j ds

j=1

t)2

h 1
(T −
1 1 − e−λ(T −t)
1 1 − e−2λ(T −t) i
A
+B
− 3
+
2
6
2λ
λ
T −t
4λ3
T −t
h 1
1 −λ(T −t)
1
3
2 1 − e−λ(T −t)
5 1 − e−2λ(T −t) i
C
+ 2e
−
(T − t)e−2λ(T −t) −
e−2λ(T −t) − 3
+
2
2
2λ
λ
4λ
4λ
λ
T −t
8λ3
T −t
h 1
i
−λ(T
−t)
1 −λ(T −t)
1 1−e
D
(T − t) + 2 e
− 3
2λ
λ
λ
T −t
h 3
1
1
3 1 − e−λ(T −t) i
−λ(T −t)
E 2e
+
(T − t) + (T − t)e−λ(T −t) − 3
λ
2λ
λ
λ
T −t
h 1
1 −λ(T −t)
1 −2λ(T −t)
3 1 − e−λ(T −t)
3 1 − e−2λ(T −t) i
F 2 + 2e
−
e
− 3
+
,
2
λ
λ
2λ
λ
T −t
4λ3
T −t

where
7

2
2
2
• A = σ11
+ σ12
+ σ13
,
2
2
2
• B = σ21
+ σ22
+ σ23
,
2
2
2
+ σ32
+ σ33
,
• C = σ31

• D = σ11 σ21 + σ12 σ22 + σ13 σ23 ,
• E = σ11 σ31 + σ12 σ32 + σ13 σ33 ,
• F = σ21 σ31 + σ22 σ32 + σ23 σ33 .
This result has two implications. First, the fact that zero-coupon bond yields in the AFDNS
class of models are given by an analytical formula will greatly facilitate empirical implementation
of these models. Second, the nine underlying volatility parameters are not identified. Indeed,
only the six terms A, B, C, D, E, and F can be identified; thus, the maximally flexible AFDNS
specification that can be identified has a triangular volatility matrix given by6


0

σ11


Σ=
 σ21
σ31

σ22
σ32

0




0 
.
σ33

In Section 4, we quantify the yield-adjustment term and examine how it affects the empirical
performance of two specific AFDNS models relative to their corresponding DNS models. These
models are introduced next.

2.4

Four specific Dynamic Nelson-Siegel models

In general, the DNS and AFDNS models are silent about the P -dynamics, so there are an infinite
number of possible specifications that could be used to match the data. However, for continuity
with the existing literature, our econometric analysis focuses on two specific versions of the DNS
model that have been estimated in recent studies, and, for consistency, we also examine the two
corresponding versions of the AFDNS model.
In the independent-factor DNS model, all three state variables are assumed to be independent
first-order autoregressions, as in Diebold and Li (2006). Using their notation, the state equation
is given by


Lt − µL





a11


 
 St − µS  =  0

 
Ct − µC
0

0
a22
0

0



Lt−1 − µL





ηt (L)




 


 

0 
  St−1 − µS  +  ηt (S)  ,
a33
Ct−1 − µC
ηt (C)

where the error terms ηt (L), ηt (S), and ηt (C) have a conditional covariance matrix given by


2
q11


Q=
 0

0
2
q22

0

6 The

0

0




0 
.
2
q33

choice of upper or lower triangular is irrelevant for the fit of the model.

8

The correlated-factor DNS model has factor P -dynamics described by a first-order vector autoregression (VAR(1))


Lt − µL





a11

a12


 
 St − µS  =  a21

 
Ct − µC
a31

a13



Lt−1 − µL





ηt (L)




 


 

a23 
  St−1 − µS  +  ηt (S)  ,
a33
Ct−1 − µC
ηt (C)

a22
a32

as in Diebold, Rudebusch, and Aruoba (2006). The innovations ηt (L), ηt (S), and ηt (C) are allowed
to be correlated with a conditional covariance matrix given by Q = qq ′ , where the Cholesky factor
q of the covariance matrix Q is



0

q11


q=
 q21
q31

0

q22
q32




0 
.
q33

In both of these DNS models, the measurement equation takes the form


yt (τ1 )


 yt (τ2 )


..

.

yt (τN )





 
 
 
=
 
 

1−e−λτ1
λτ1
1−e−λτ2
λτ2

1−e−λτ1
λτ1
1−e−λτ2
λτ2

1−e−λτN
λτN

1−e−λτN
λτN

1
1
..
.
1

..
.

− e−λτ1
− e−λτ2
..
.
− e−λτN









εt (τ1 )



  Lt   εt (τ2 )


  St 
..
+


.


Ct
εt (τN )






,



where the measurement errors εt (τi ) are assumed to be i.i.d. white noise.
The corresponding AFDNS models are formulated in continuous time and the relationship
between the real-world dynamics under the P -measure and the risk-neutral dynamics under the
Q-measure is given by the measure change
dWtQ = dWtP + Γt dt,
where Γt represents the risk premium specification. In order to preserve affine dynamics under the
P -measure, we limit our focus to essentially affine risk premium specifications (see Duffee, 2002).
Thus, Γt will take the form


γ10





1
γ11

1
γ12


 
0 
 1
Γt = 
 γ2  +  γ21
1
γ30
γ31

1
γ22
1
γ32

1
γ13



Xt1





1 
2 
γ23
  Xt  .
1
γ33
Xt3

With this specification, the SDE for the state variables under the P -measure,
dXt = K P [θP − Xt ]dt + ΣdWtP ,

(8)

remains affine. Due to the flexible specification of Γt , we are free to choose any mean vector θP
and mean-reversion matrix K P under the P -measure and still preserve the required Q-dynamic
structure described in Proposition 1. Therefore, we focus on two AFDNS models that correspond
to the specific two DNS models above.

9

In the independent-factor AFDNS model, all three factors are assumed to be independent under
the P -measure

 
dXt1
κP

  11
 dX 2  =  0
t 


dXt3

0

0

0

 

θ1P





Xt1





0

σ1

 
 


 P   2 

0 
  θ2  −  Xt  dt +  0
κP
θ3P
Xt3
0
33

κP
22
0

σ2
0

0





dWt1,P



2,P 

0 
  dWt
.
3,P
σ3
dWt

This model is the AF equivalent of our first DNS model.
In the correlated-factor AFDNS model, the three shocks may be correlated, and there may be
full interaction among the factors as they adjust to the steady state


dXt1





κP
11

κP
12


 
 dX 2  =  κP
t 

 21
dXt3
κP
31

κP
22
κP
32

κP
13

 

θ1P





Xt1





0

σ11

 
 


   P   2 

κP
23   θ2  −  Xt  dt+ σ21
κP
θ3P
Xt3
σ31
33

σ22
σ32

0



dWt1,P





2,P 

0 
  dWt
.
3,P
σ33
dWt

This is the most flexible version of the AFDNS models where all parameters are identified.
For both AFDNS models, the measurement equation takes the form


yt (τ1 )


 yt (τ2 )


..

.

yt (τN )





 
 
 
=
 
 

1
1
..
.
1

1−e−λτ1
λτ1
1−e−λτ2
λτ2

1−e−λτ1
λτ1
1−e−λτ2
λτ2

1−e−λτN
λτN

1−e−λτN
λτN

..
.

− e−λτ1
− e−λτ2
..
.
− e−λτN









1


  Xt  
 2  
  Xt  − 




Xt3

C(τ1 )
τ1
C(τ2 )
τ2

..
.

C(τN )
τN





εt (τ1 )

 
  εt (τ2 )
 
+
..
 
.
 
εt (τN )






,



where, again, the measurement errors εt (τi ) are assumed to be i.i.d. white noise.

3

The AFDNS subclass of canonical affine AF models

Before proceeding to an empirical analysis of the various DNS and AFDNS models, we first answer
a key theoretical question: What, precisely, are the restrictions that the AFDNS model imposes on
the canonical representation of three-factor affine AF models—the A0 (3) representation (with three
state variables and zero square-root processes) as defined in Dai and Singleton (2000). Denoting
the state variables by Yt , the canonical A0 (3) model is given by
rt

= δ0Y + (δ1Y )′ Yt

dYt

= KYP [θYP − Yt ]dt + ΣY dWtP

dYt

= KYQ [θYQ − Yt ]dt + ΣY dWtQ ,

with δ0Y ∈ R, δ1Y , θYP , θYQ ∈ R3 , and KYP , KYQ , ΣY ∈ R3×3 . If the essentially affine risk premium
specification Γt = γY0 + γY1 Yt is imposed on the model, the drift terms under the P -measure
(KYP , θYP ) can be chosen independently of the drift terms under the Q-measure (KYQ , θYQ ).
Because the latent state variables may rotate without changing the probability distribution of
bond yields, not all parameters in the above model can be identified. Dai and Singleton (2000)
impose identifying restrictions under the P -measure but not under the Q-measure. Specifically,
10

they set the mean θYP = 0, the volatility matrix ΣY equal to the identity matrix, and the meanreversion matrix KYP equal to a triangular matrix.7 Thus, their canonical representation has
P -dynamics given by


dYt1





κY,P
11

κY,P
12

0

κY,P
22

0

0

κY,Q
12

κY,Q
13




 dY 2  = − 
t 


3
dYt

κY,P
13



Yt1





1




  Y 2  dt +  0
κY,P
23
 t 

Y,P
3
κ33
Yt
0

0 0



dWt1,P





2,P 

1 0 
  dWt
,
3,P
0 1
dWt

and Q-dynamics given by


dYt1





κY,Q
11


 
 dY 2  =  κY,Q
t

  21
3
dYt
κY,Q
31

κY,Q
22
κY,Q
32

 

θ1Y,Q





Yt1





1 0

  Y,Q  


  θ
 −  Y 2  dt+ 0 1
κY,Q
t
2
23
 
 


κY,Q
θ3Y,Q
Yt3
0 0
33

0



dWt1,Q





 dW 2,Q  .
0 
t


1
dWt3,Q

The instantaneous risk-free rate is given by
Y
Y
Y
Yt2 + δ1,3
Yt3 .
rt = δ0Y + δ1,1
Yt1 + δ1,2

Appealing to mathematical symmetry and the latent nature of the state variables, it seems
that the canonical identifying restrictions could have been imposed on the Q-dynamics instead
of the P -dynamics, namely fixing θYQ = 0 and requiring KYQ to be triangular. However, from an
economic point of view, these two identifications may not be equivalent, because the yield function being fit to the observed yields is determined solely by the dynamics under the Q-measure
so imposing restrictions on the Q-measure drift terms could limit the ability of the model to fit
observed yields. The following proposition provides a simple condition under which the two types
of identifying restrictions are indeed equivalent.8
Proposition 2:
Consider an A0 (3) model with dynamics given by the canonical representation described in Dai
and Singleton (2000)
dYt

= −KYP Yt dt + IdWtP

dYt

= KYQ [θYQ − Yt ]dt + IdWtQ ,

with the risk-free rate given by rt = δ0Y + (δ1Y )′ Yt . If the eigenvalues of the 3 × 3 matrix KYQ are
all real, then there exists an equivalent representation of this model with dynamics given by

7 Without

dZt

=

dZt

=

P
cP
− Zt ]dt + IdW
KZP [θZ
t

ctQ ,
−KZQ Zt dt + IdW

loss of generality, we will take it to be upper triangular in the following.
representations generate the same distributions for the short-rate process and bond yields and,
in estimation, have identical fit (Dai and Singleton, 2000).
8 “Equivalent”

11

where KZQ is an upper-triangular 3 × 3 matrix, and the risk-free rate is given by rt = δ0Z + (δ1Z )′ Zt .
Proof: See Appendix C.9
Proposition 2 shows that if the eigenvalues of the mean-reversion matrix under the Q-measure
are real, then it does not matter under which measure we impose the identifying restrictions. This
is useful because Q-measure identification is imposed in Proposition 1 for the AFDNS model. The
AFDNS mean-reversion matrix under the Q-measure is


0

0

0


 0 λ

0 0




−λ 
.
λ

The eigenvalues of this matrix, 0 and λ, are both real numbers; thus, by construction, any canonical
representation equivalent of the AFDNS model must satisfy the requirement in Proposition 2.10
Hence there is no loss of generality when we fix the AFDNS model mean under the Q-measure at
0 and leave the mean under the P -measure, θP , to be estimated.
Proposition 2 also facilitates the identification of the restrictions on the canonical affine representation that are required to obtain the class of AFDNS models. Indeed, we can, without loss of
generality, limit our focus to A0 (3) models where the identifying restrictions have been imposed
under the Q-measure, namely


dZt1








 dZ 2  = − 
t 


dZt3

κZ,Q
11

κZ,Q
12

0

κZ,Q
22

0

0

κZ,Q
13



Zt1





1




  Z 2  dt +  0
κZ,Q
23

 t 
3
Z
κZ,Q
0
t
33

0 0



dWt1,Q





2,Q 

1 0 
,
  dWt
3,Q
dWt
0 1

while the P -dynamics are given by


dZt1





κZ,P
11

 

 dZ 2  =  κZ,P
t 
 21

dZt3
κZ,P
31

κZ,P
12
κZ,P
22
κZ,P
32

κZ,P
13

 

θ1Z,P





Zt1





1 0



  Z,P  
 −  Z 2  dt+  0 1
  θ
κZ,P
23

  t 
  2
Z,P
3
Z
κZ,P
θ
0 0
t
33
3

0



dWt1,P





2,P 

0 
.
  dWt
3,P
dWt
1

The procedure through which the restrictions are identified is based on so-called affine invariant transformations. Appendix C describes such transformations, and Appendix D derives the
restrictions associated with the AFDNS model, which are summarized in Table 1.
Table 1 shows that for the correlated-factor AFDNS model, there are three key parameter
restrictions on the canonical affine model (which itself has a total of 22 free parameters). First,
9 We are grateful to Peter Feldhütter for helpful discussions about this proof, which obviously generalizes to the
A0 (n) model.
10 This follows from the fact that the relationship between the mean-reversion matrix of a model and its transformed equivalent is K Z = AK Y A−1 , where Y refers to the original model, Z refers to the transformed model, and
A is a nonsingular square matrix defining the transformation (see appendix C for more details). The eigenvalues
of the transformed mean-reversion matrix are given by the solutions to the characteristic equation

|K Z − γI| = |A−1 K Y A − γA−1 A| = |A−1 | · |K Y − γI| · |A| = |K Y − γI| = 0.
Hence K Z will have the same eigenvalues as K Y .

12

AFDNS Model
Independent-factor
Correlated-factor

δ0Z , δ1Z
δ0Z = 0,
Z =0
δ1,3

κZ,Q
1,1

δ0Z = 0

κQ
Z
Z,Q
= κ1,2 = κZ,Q
1,3
Z,Q
κZ,Q
2,2 = κ3,3
κZ,Q
1,1 = 0,
Z,Q
κZ,Q
2,2 = κ3,3

= 0,

κP
Z
κP
Z is
diagonal

P
θZ
No
restriction

No
restriction

No
restriction

No. restrictions
12
3

Table 1: AFDNS Model Parameter Restrictions on the Canonical Representation
These are the restrictions on the A0 (3) model needed to obtain the independent-factor and
correlated-factor AFDNS specifications.
δ0Z = 0, so there is no constant in the equation for the instantaneous risk-free rate. There is no
need for this constant because, with the second restriction κZ,Q
1,1 = 0, the first factor must be a
unit-root process under the Q-measure, which also implies that this factor can be identified as the
Z,Q
level factor. Finally, κZ,Q
2,2 = κ3,3 , so the own mean-reversion rates of the second and third factors

under the Q-measure must be identical. The independent-factor AFDNS model maintains these
three parameter restrictions and adds nine others under both the P - and Q-measures. (For both
specifications, there is a further modest restriction described in Appendix D: κZ,Q
2,3 must have the
Z,Q
opposite sign of κZ,Q
2,2 and κ3,3 , but its absolute numerical size can vary freely.)

The Nelson-Siegel parameter restrictions on the canonical affine AF model greatly facilitate
estimation.11 They allow a closed-form solution and, as described in the next section, eliminate
in an appealing way the surfeit of troublesome likelihood maxima in estimation.12

4

Estimation of the DNS and AFDNS models

Here we describe estimation methods and results for the DNS and AFDNS models.

4.1

Estimation methods

The Kalman filter is an efficient and consistent estimator for both the DNS and AFDNS models.
For the DNS models, the state equation is
Xt = (I − A)µ + AXt−1 + ηt ,

ηt ∼ N (0, Q),

where Xt = (Lt , St , Ct ), while the measurement equation is given by
yt = BXt + εt .
Following Diebold, Rudebusch, and Aruoba (2006), we start the algorithm at the unconditional
mean and variance of the state variables. This assumes the stationarity of the state variables,
which is ensured by imposing that the eigenvalues of A are smaller than 1.
11 Note

that in the AFDNS model, the connection between the P -dynamics and the yield function is explicitly tied
to the yield adjustment term through the specification of the volatility matrix, while in the canonical representation
Q
it is blurred by an interplay between the specifications of δ1Z and KZ
.
12 This contrasts with the common practice, mentioned earlier, of zeroing out an arbitrary set of individual
coefficients.

13

For the continuous-time AFDNS models, the conditional mean vector and the conditional
covariance matrix are given by
E P [XT |Ft ] =

(I − exp(−K P ∆t))µP + exp(−K P ∆t)Xt
Z ∆t
P
P ′
e−K s ΣΣ′ e−(K ) s ds,

V P [XT |Ft ] =

0

where ∆t = T − t. By discretizing the continuous dynamics under the P -measure, we obtain the
state equation
Xi = (I − exp(−K P ∆ti ))µP + exp(−K P ∆ti )Xi−1 + ηt ,
where ∆ti = ti − ti−1 is the time between observations. The conditional covariance matrix for the
shock terms is given by
Q=

Z

∆ti

e−K

P

s

ΣΣ′ e−(K

P ′

)s

ds.

0

Stationarity of the system under the P -measure is ensured by restricting the real component of
each eigenvalue of K P to be positive. The Kalman filter for these models is also started at the
unconditional mean and covariance13
b0 = µP
X

b0 =
and Σ

Z

∞

e−K

P

s

ΣΣ′ e−(K

P ′

)s

ds.

0

Finally, the AFDNS measurement equation is given by
yt = A + BXt + εt .
For both types of models, the error structure is
ηt
εt

!

∼N

"

0
0

!

,

Q

0

0

H

!#

,

where H is a diagonal matrix



σ 2 (τ1 ) . . .
0


..
..
..
.
H=
.
.
.


2
0
. . . σ (τN )
The linear least-squares optimality of the Kalman filter requires that the transition and measurement errors are orthogonal to the initial state, i.e.,
E[f0 ηt′ ] = 0,
13 In

the estimation

R∞
0

e−K

P

s ΣΣ′ e−(K P )′ s ds

E[f0 ε′t ] = 0.

is approximated by

14

R 10
0

e−K

P

s ΣΣ′ e−(K P )′ s ds.

A
Lt
St

Lt−1
0.9827
(0.0128)
0

Ct

0

St−1
0

Ct−1
0

0.9778
(0.0166)
0

0
0.9189
(0.0284)

µ
0.06958
(0.0137)
-0.02487
(0.0151)
-0.01075
(0.00786)

2

1
0.002485
(0.000153)
0

3

0

q
1

2
0

3
0

0.003329
(0.000194)
0

0
0.007471
(0.000396)

Table 2: Parameter Estimates of the Independent-Factor DNS Model.
The left-hand panel contains the estimated A matrix and µ vector. The right-hand panel contains
the estimated q matrix. Estimated standard deviations of the parameter estimates are given
in parentheses. The associated estimated λ is 0.06040 (when yield maturities are measured in
months) with a standard deviation of 0.00100. The maximized log-likelihood value is 16332.94.
A
Lt
St
Ct

Lt−1
0.9874
(0.0165)
0.0066
(0.0228)
0.0152
(0.0526)

St−1
0.0050
(0.0183)
0.9332
(0.0229)
0.0401
(0.0418)

Ct−1
-0.0097
(0.0157)
0.0819
(0.0202)
0.9011
(0.0377)

µ
0.0723
(0.0145)
-0.0294
(0.0159)
-0.0120
(0.0126)

q
1
2
3

1
0.002457
(0.000147)
-0.002227
(0.000255)
0.002752
(0.000706)

2
0

3
0

0.002265
(0.000110)
0.000618
(0.000610)

0
0.006554
(0.000441)

Table 3: Parameter Estimates of the Correlated-Factor DNS Model.
The left-hand panel contains the estimated A matrix and µ vector. The right-hand panel contains
the estimated q matrix. Estimated standard deviations of the parameter estimates are given
in parentheses. The associated estimated λ is 0.06248 (when yield maturities are measured in
months) with a standard deviation of 0.00109. The maximum log-likelihood value is 16415.36.
Finally, parameter standard deviations are calculated as
T
b ∂ log lt (ψ)
b ′ i−1
1 h 1 X ∂ log lt (ψ)
b
Σ(ψ) =
,
T T t=1
∂ψ
∂ψ

where ψb denotes the estimated model parameter set.

4.2

DNS model estimation results

In this subsection, we present estimation results for the two versions of the DNS model. These
specifications, along with the two AFDNS specifications described in the next subsection, are estimated using monthly data on U.S. Treasury security yields from January 1987 to December 2002.
The data are end-of-month, unsmoothed Fama-Bliss (1987) zero-coupon yields at the following 16
maturities: 3, 6, 9, 12,18, 24, 36, 48, 60, 84, 96, 108, 120, 180, 240, and 360 months.
The estimates of the DNS models with independent and correlated factors are shown in Tables
2 and 3, respectively. In both models, the level factor is the most persistent factor, while the
curvature factor has the fastest rate of mean-reversion. Interestingly, for the correlated factors
DNS model, the only significant off-diagonal element (the 0.0819) in the estimated A-matrix is
ASt ,Ct−1 , which is the key non-zero off-diagonal element required in Proposition 1 for the AFDNS
specification.
Volatility parameters will be most easily compared by using the one-month conditional covari15

ance matrices for the independent-factor model



S
′

QDN
indep = qq = 
and the correlated-factor model


6.17 × 10−6

0

0

0

1.11 × 10−5

0

0

6.03 × 10−6


S
′
−6

QDN
corr = qq =  −5.47 × 10
−6
6.76 × 10

0

5.58 × 10

−5.47 × 10−6
1.01 × 10−5
−4.73 × 10

−6


−5

6.76 × 10−6





(9)




−4.73 × 10−6 
.
−5
5.09 × 10

(10)

Across the two models, the variances of each state variable are similar, with the level factor the
least volatile and the curvature factor the most volatile. The covariance estimates obtained in
the correlated-factor DNS model translate into a correlation of -0.701 for innovations to the level
and slope factor, a correlation of 0.385 for innovations to the level and curvature factor, and a
correlation of -0.208 for innovations to the slope and curvature factor.
The two DNS models are nested, so we can test the independent-factor restricted parameter
set θindep. versus the correlated-factor unrestricted parameter set θcorr. with a likelihood ratio test
LR = 2[log L(θcorr ) − log L(θindep )] = 164.8 ∼ χ2 (q),
where q, the number of parameter restrictions, equals nine. The associated p-value is less than
.0001, so the restrictions imposed in the independent-factor DNS model are not supported by the
data.14 Still, the increased flexibility of the correlated-factor DNS model provides little advantage
in fitting the observed yields.15 Table 4 reports summary statistics for the fitted errors for each
of the four models considered in this study. For the two DNS models, the differences in RMSEs
at any maturity are not large (less than 0.58 basis points), and there is no consistent advantage
for the correlated factors model. Interestingly, both models have difficulty fitting yields beyond
the 10-year maturity, which suggests that a maturity-dependent yield adjustment term, as in the
AFDNS models that we turn to next, could improve fit.

4.3

AFDNS model estimation results

As many have noted, estimation of the canonical affine A0 (3) term structure model is very difficult
and time-consuming and effectively prevents the kind of repetitive re-estimation required in a
comprehensive simulation study or out-of-sample forecast exercise, which we pursue with the
AFDNS model in the next section.16 By comparison, the estimation of the AFDNS model is
14 This rejection reflects an elevated negative correlation between the innovations to the level and slope factor
and a significant positive correlation through the mean-reversion matrix between changes in the slope factor and
deviations of the curvature factor from its mean.
15 The similarity in fit is not too surprising, since there is no direct connection in these DNS models between the
yield function and the assumed P -dynamics of the state variables. Indeed, across the two models, the level, slope,
and curvature factors are very highly correlated.
16 For example, Rudebusch, Swanson, and Wu (2006) report being unable to replicate the published estimates
of a no-arbitrage model even though they use the same data and programs that generated the model’s parameter

16

DNS
indep.-factor
Mean RMSE
-1.64
12.26
-0.24
1.09
-0.54
7.13
4.04
11.19
7.22
10.76
1.18
5.83
-0.07
1.51
-0.67
3.92
-5.33
7.13
-1.22
4.25
1.31
2.10
0.03
2.94
-5.11
8.51
24.11
29.44
25.61
34.99
-29.62
37.61

Maturity
in months
3
6
9
12
18
24
36
48
60
84
96
108
120
180
240
360

DNS
corr.-factor
Mean RMSE
-1.84
11.96
-0.29
1.34
-0.51
6.92
4.11
10.86
7.28
10.42
1.19
5.29
-0.19
2.09
-0.85
4.03
-5.51
7.31
-1.30
4.25
1.29
2.02
0.07
3.11
-5.01
8.53
24.40
29.66
26.00
35.33
-29.12
37.18

AFDNS
indep.-factor
Mean RMSE
-2.85
18.54
-1.19
7.12
-1.24
3.44
3.58
9.60
7.15
10.44
1.37
5.94
0.31
1.98
-0.39
3.72
-5.27
6.82
-1.50
4.29
1.02
2.11
-0.11
3.02
-4.96
8.23
27.86
32.66
35.95
42.61
1.37
22.04

AFDNS
corr.-factor
Mean RMSE
-2.47
11.53
-0.04
0.75
-0.35
6.86
3.69
10.11
5.49
8.31
-1.20
4.37
-1.10
3.16
0.94
4.14
-1.99
5.20
0.90
3.83
1.05
1.83
-3.24
5.28
-11.67
14.02
3.76
16.50
4.20
23.93
-0.81
23.02

Table 4: Summary Statistics of In-Sample Fit.
The means and the root mean squared errors for 16 different maturities. All numbers are measured
in basis points.
straightforward and robust in large part because the role of each latent factor is not left unidentified
as in the maximally flexible A0 (3) model. Even though the factors are latent in the AFDNS model,
with the Nelson-Siegel factor loading structure, they can be clearly identified as level, slope, and
curvature. This identification eliminates the troublesome local maxima reported by Kim and
Orphanides (2005), i.e. maxima with likelihood values very close to the global maximum but with
very different interpretations of the three factors and their dynamics.17
The estimated parameters of the independent-factor AFDNS model are reported in Table 5.
The factor means are close to those of the DNS model. To compare the mean-reversion parameters,
we translate the continuous-time matrix in Table 5 into the one-month conditional mean-reversion
matrix




1 
exp − K P
=

12

0.994

0

0

0

0.983

0

0

0

0.903




.


(11)

We also convert the volatility matrix into a one-month conditional covariance matrix

DN S
QAF
=
indep

Z

0

1
12

e−K

P

s

ΣΣ′−(K

P ′

)s




ds = 


2.15 × 10−6

0

0

0

9.97 × 10−6

0

0

0

5.28 × 10


−5


.


(12)

These too appear little different from the ones reported for the independent-factor DNS model.
estimates.
17 Other strategies to facilitate estimation include adding survey information (Kim and Orphanides, 2005) or
assuming the latent yield-curve factors are observable (Ang, Piazzesi, and Wei, 2006).

17

KP
P
K1,·
P
K2,·

P
K·,1
0.06734
(0.0623)
0

P
K3,·

0

P
K·,2
0

P
K·,3
0

0.2083
(0.179)
0

0
1.230
(0.423)

µP
0.07243
(0.0148)
-0.02825
(0.0173)
-0.009266
(0.00609)

Σ
Σ1,·
Σ2,·

Σ·,1
0.005095
(0.000139)
0

Σ3,·

0

Σ·,2
0

Σ·,3
0

0.01103
(0.000580)
0

0
0.02647
(0.00137)

Table 5: Parameter Estimates of the Independent-Factor AFDNS Model.
The left-hand panel contains the estimated K P matrix and µ vector. The right-hand panel contains
the estimated Σ matrix. Estimated standard deviations of the parameter estimates are given in
parentheses. The associated estimated λ is 0.5971 with a standard deviation of 0.0115. The
maximum log-likelihood value is 16279.55.
KP
P
K1,·

P
K·,1
4.729
(1.14)
-0.8584
(1.12)
-32.89
(9.68)

P
K2,·
P
K3,·

P
K·,2
8.046
(1.19)
-0.3617
(1.96)
-59.34
(1.01)

P
K·,3
-9.730
(1.23)
0.5775
(2.38)
72.49
(1.02)

µP
0.07982
(0.00738)
-0.03798
(0.0200)
-0.02636
(0.0189)

Σ
Σ1,·
Σ2,·
Σ3,·

Σ·,1
0.01542
(0.000364)
-0.003763
(0.00480)
-0.1615
(0.00658)

Σ·,2
0

Σ·,3
0

0.01088
(0.00174)
-0.05981
(0.0102)

0
0.01457
(0.0430)

Table 6: Parameter Estimates of the Correlated-Factor AFDNS Model.
The left-hand panel contains the estimated K P matrix and µ vector. The right-hand panel contains
the estimated Σ matrix. Estimated standard deviations of the parameter estimates are given in
parentheses. The associated estimated λ is 0.8219 with a standard deviation of 0.0122. The
maximum log-likelihood value is 16492.00.
Still, although the two independent-factor models are non-nested, they contain the same number
of parameters, and the lower log-likelihood value obtained for the AFDNS model (16279 vs. 16332)
suggests a slightly weaker in-sample performance for that model, which appears consistent with
the RMSEs in Table 4.
Similar fit to the data by the two models is not too surprising because they make identical
assumptions about the P -dynamics, so the only difference between the two models is the inclusion
of the yield-adjustment term in the AFDNS model yield function. For the independent-factor
AFDNS model, this term is given by
−

C(t, T )
T −t

=

−

2
σ11
1
2 T −t

=

2
−σ11

−

2
σ33

(T −
6

Z

t
t)2

T

B 1 (s, T )2 ds −

2
− σ22

2
σ22
1
2 T −t

Z

T

t
e−λ(T −t)

h 1
1 1−
− 3
2λ2
λ
T −t

2
σ33
1
2 T −t
1 1 − e−2λ(T −t) i
+
4λ3
T −t

B 2 (s, T )2 ds −

Z

T

B 3 (s, T )2 ds

t

h 1
1
1
3 −2λ(T −t)
2 1 − e−λ(T −t)
5 1 − e−2λ(T −t) i
+ 2 e−λ(T −t) −
(T − t)e−2λ(T −t) −
e
− 3
+
.
2
2
2λ
λ
4λ
4λ
λ
T −t
8λ3
T −t

The estimated yield-adjustment term and its three components associated with the variances of
the three state variables are shown in Figure 1. All three components are negative, regardless of
the size of the volatility parameters. In general, the rather simple functional form of the yieldadjustment term suggests that the lack of improvement in fit of this model is not too surprising.
Greater flexibility is allowed in the correlated-factor AFDNS model, and the estimated parameters of this model are reported in Table 6. Since this model nests the independent-factor version,
18

0.000
−0.001
−0.002
−0.003

Yield−adjustment term

−0.004
−0.005

Total yield−adjustment
Level only
Slope only
Curvature only

0

5

10

15

20

25

30

Maturity in years

Figure 1: The Yield-Adjustment Term for the Independent-Factor AFDNS Model.
)
The yield-adjustment term − C(τ
and its three components.
τ
a standard likelihood ratio test can be performed,
LR = 2[log L(θcorr ) − log L(θindep )] = 424.9 ∼ χ2 (q),
where q, the number of parameter restrictions, equals nine. The associated p-value is again
minuscule, so the independent factor restrictions are not supported by the data in sample.
The greater flexibility is apparent in the complexity of the yield-adjustment term for this
model:
−

C(t, T )
T −t

h 1
(T − t)2
1 1 − e−λ(T −t)
1 1 − e−2λ(T −t) i
2
2
− (σ21
+ σ22
)
− 3
+
6
2λ2
λ
T −t
4λ3
T −t
2
2
+ σ32
+ σ33
)

=

2
−σ11

−

2
(σ31
h 1
1
1
3 −2λ(T −t)
2 1 − e−λ(T −t)
5 1 − e−2λ(T −t) i
×
+ 2 e−λ(T −t) −
(T − t)e−2λ(T −t) −
e
− 3
+
2λ2
λ
4λ
4λ2
λ
T −t
8λ3
T −t
h 1
i
−λ(T
−t)
1
1 1−e
σ11 σ21
(T − t) + 2 e−λ(T −t) − 3
2λ
λ
λ
T −t
h 3
1
1
3 1 − e−λ(T −t) i
σ11 σ31 2 e−λ(T −t) +
(T − t) + (T − t)e−λ(T −t) − 3
λ
2λ
λ
λ
T −t
h 1
1 −λ(T −t)
1 −2λ(T −t)
3 1 − e−λ(T −t)
3 1 − e−2λ(T −t) i
(σ21 σ31 + σ22 σ32 ) 2 + 2 e
−
e
− 3
+
.
λ
λ
2λ2
λ
T −t
4λ3
T −t

−
−
−

Figure 2 displays this yield-adjustment term and its various components. This term has an interesting hump with a peak in the 15- to 20-year maturity range, which appears to improve the
fit of those long-term yields in particular, but also of yields with fairly short maturities. This
19

0.04
0.02
0.00

Yield−adjustment term

−0.02
−0.04

Total yield−adjustment
Level only
Slope only
Curvature only
Level and slope
Level and curvature
Slope and curvature

0

5

10

15

20

25

30

Maturity in years

Figure 2: The Yield-Adjustment Term for the Correlated-Factor AFDNS Model.
)
The yield adjustment term − C(τ
and its six components.
τ
added flexibility allows the level factor to become less persistent, as is evident in the estimated
one-month conditional mean-reversion matrix


0.915
−0.170
0.124


1 
exp − K P
=
0.0499 0.992 −0.00222 

.
12
0.451
0.765
0.0556

(13)

It appears that to the extent long-term yields are fit through the yield-adjustment term, the level
factor becomes less persistent because it blends with slope and curvature in an effort to provide
an improved fit for maturities up to nine years.
The one-month conditional covariance matrix is given by

DNS
QAF
=
corr

Z

0

1
12

e−K

P

s

ΣΣ′−(K

P ′

) s

0

7.44 × 10−6

B
−6
ds = B
@ −6.37 × 10

−6

−8.35 × 10

−6.37 × 10−6

−8.35 × 10−6

1.09 × 10−5

2.80 × 10−6

−6

−4

2.80 × 10

2.04 × 10

1

C
C.
A

(14)

The conditional variances in the diagonal are about the same for the level and slope factors as
those obtained in the correlated-factor DNS model, but the conditional variance for curvature is
much larger. In terms of covariances, the negative correlation between the innovations to level
and slope is maintained. For the correlations between shocks to curvature and shocks to level and
slope, the signs have changed relative to the unconstrained correlated-factor DNS model. This
suggests that the off-diagonal elements of Σ are heavily influenced by the required shape of the
20

yield-adjustment term rather than the dynamics of the state variables. This interpretation will be
supported by our out-of-sample forecast exercise in the next section.

5

Forecast performance

In this section, we investigate whether the in-sample superiority of the flexible correlated-factor
models carries over to out-of-sample forecast accuracy. We first describe the recursive estimation
and forecasting procedure employed, and then we proceed to the results.

5.1

Construction of out-of-sample forecasts

We construct one-, six-, and twelve-month-ahead forecasts from the four DNS and AFDNS models
for six yields with maturities of 3 months and 1, 3, 5, 10, and 30 years. We use a recursive
procedure. For the first set of forecasts, the model is estimated from January 1987 to December
1996; then, one month of data is added, the models are reestimated, and another set of forecasts is
constructed. The largest estimation sample for the one-month-ahead forecasts ends in November
2002 (72 forecasts in all). For the six- and 12-month horizons, the largest samples end in June 2002
and December 2001 (67 and 61 forecasts), respectively. This recursive estimation strategy is greatly
facilitated for the AF model by the addition of the Nelson-Siegel factor loadings. For the usual
method of estimating the canonical A0 (3) model, each additional month requires reexamination
of the zero exclusion restrictions, which is prohibitively time consuming.
For the DNS models, the period-t forecast of the τ -maturity yield h periods ahead is simply
the conditional expectation
 1 − e−λτ

 1 − e−λτ 
DN S
ybt+h
(τ ) ≡ EtP [yt+h (τ )] = EtP [Lt+h ] + EtP [St+h ]
+ EtP [Ct+h ]
− e−λτ .
λτ
λτ

Given parameter estimates for A and µ from a sample that ends in period t, the discrete-time
state equation for the DNS model can be written
Xt = (I − A)µ + AXt−1 + ηt ,
where Xt = (Lt , St , Ct ). Recursive iteration (and i.i.d. innovations) imply that the conditional
expectation of the state variables in period t + h are
EtP [Xt+h ] =

h−1
X
i=0


Ai (I − A)µ + Ah Xt ,

so it is straightforward to calculate forecasted yields.
For the AFDNS models, the forecast of the τ -maturity yield in period t+h based on information
available at time t is simply the conditional expectation
 1 − e−λτ 
 1 − e−λτ
 C(τ )
AF DN S
1
2
3
ybt+h
(τ ) ≡ EtP [yt+h (τ )] = EtP [Xt+h
]+EtP [Xt+h
]
+EtP [Xt+h
]
−e−λτ −
.
λτ
λτ
τ
21

In this case, the requisite conditional expectations are given by
E0P [Xt ] = (I − exp(−K P t))θP + exp(−K P t)X0 ,
where Xt = (Xt1 , Xt2 , Xt3 ). Thus, with estimates for K P , θP , λ, and Σ along with the optimally
filtered paths of the three factors, it is easy to calculate future factor expected values and yields.

5.2

Evaluation of out-of-sample forecasts

Out-of-sample forecast accuracy has been a key metric to evaluate the adequacy of AF yield-curve
models.18 The forecast performances of the four models are compared using the root mean squared
error (RMSE) of the forecast error εt (τ, h) = ŷt+h (τ ) − yt+h (τ ), for τ = 3, 12, 36, 60, 120, 360, and
h = 1, 6, 12 (in months). These RMSEs are shown in Table 7. For each of the 18 combinations of
yield maturity and forecast horizon, the most accurate model’s RMSE is underlined. The results
are quite striking. In 14 of the 18 combinations, the most accurate model is the independent-factor
AFDNS model. In particular, the in-sample advantage of the correlated-factor AFDNS model
disappears out of sample. Evidently, the correlated-factor AFDNS model is prone to in-sample
overfitting, due to its complex yield-adjustment term and rich P -dynamics. Furthermore, the cases
in which the independent-factor AFDNS model is not the most accurate all pertain to shortermaturity yields. Specifically, it is only for the 3-month yield, that the correlated-factor models
have lower RMSEs. This advantage likely reflects idiosyncratic fluctuations in short-term Treasury
bill yields from institutional factors that are unrelated to yields on longer-maturity Treasuries, as
described by Duffee (1996). The more flexible models appear to have a slight advantage in fitting
these idiosyncratic movements.
In examining forecast performance, we are interested in two broad comparisons. First, how do
the correlated-factor models do against the independent-factor models, and second, how does the
imposition of the AF structure affect forecast performance. Table 8 brings these two questions into
sharper focus by showing the ratios of the forecast RMSEs of various models. The two columns
on the left divide the DNS and AFDNS independent-factor model RMSEs by their respective
correlated-factor model RMSEs. These are almost uniformly below one (outside of the 3-month
yield noted above), which supports the parsimonious versions of these models. These differences
in forecast accuracy are also generally statistically significant. For each maturity and horizon
combination, we use the Diebold-Mariano (1995) test to compare model performance.19 The
asterisks in Table 8 denote significant differences in out-of-sample model performance at the 1,
5, and 10 percent levels. For both the DNS and AFDNS models, the preponderance of evidence
supports the parsimonious models.20
The two columns on the right divide the RMSEs of the AF versions of the independent- and
18 Recent

analyses of the forecast performance of AF models include Ang and Piazzesi (2003), Hördahl, Tristani,
and Vestin (2005), Mönch (2006), De Pooter, Ravazzolo, and van Dijk (2007).
19 We implement this test by regressing the differences between the squared forecast errors for two models on
an intercept and examining the significance of that intercept using standard errors that are corrected for possibly
heteroskedastic and autocorrelated residuals.
20 We also examined model accuracy using the generalized Diebold-Mariano test proposed by Christensen et al.
(2007), which can pool observations across all maturities or horizons simultaneously. This test supported our
conclusions from the individual comparisons.

22

Forecast horizon
Six months
Twelve months

Model

One month

DNSindep
DNScorr
AFDNSindep
AFDNScorr

22.93
20.43
22.84
20.56

3-month yield
96.87
87.43
91.60
88.67

173.39
166.91
164.97
162.33

DNSindep
DNScorr
AFDNSindep
AFDNScorr

29.41
27.06
29.12
33.89

1-year yield
103.25
102.71
98.58
98.87

170.85
173.14
164.01
165.99

DNSindep
DNScorr
AFDNSindep
AFDNScorr

30.64
30.59
30.29
36.95

3-year yield
92.22
99.55
87.23
91.00

135.24
145.82
127.78
136.44

DNSindep
DNScorr
AFDNSindep
AFDNScorr

30.77
31.23
30.13
32.37

5-year yield
87.87
94.95
82.68
88.46

122.09
132.40
113.83
125.42

DNSindep
DNScorr
AFDNSindep
AFDNScorr

28.35
29.06
27.18
35.08

10-year yield
74.71
79.48
67.72
90.42

105.02
112.37
93.36
124.28

DNSindep
DNScorr
AFDNSindep
AFDNScorr

38.42
38.73
30.42
38.30

30-year yield
71.35
72.71
48.82
71.35

96.90
99.68
63.50
96.86

Table 7: Out-of-Sample Forecast RMSE for Four Models.
For each maturity and horizon, the most accurate model’s RMSE is underlined. All numbers are
measured in basis points.

23

Ratios of out-of-sample forecast RMSEs
AFDNSindep
AFDNSindep
AFDNScorr
AFDNScorr
DNSindep
DNScorr

Forecast horizon
(in months)

DNSindep
DNScorr

1
6
12

1.12∗
1.11
1.04

3-month yield
1.11∗∗
1.03∗∗
1.02

1.00
0.95∗
0.95∗

1.01
1.01
0.97

1
6
12

1.09∗∗
1.01
0.99

12-month yield
0.86∗∗
1.00
0.99

0.99
0.95
0.96

1.25∗∗
0.96
0.96

1
6
12

1.00
0.93∗∗
0.93∗∗

36-month yield
0.82∗∗∗
0.96
0.94

0.99
0.95
0.94

1.21∗∗
0.91
0.94∗∗

1
6
12

0.99
0.93∗∗∗
0.92∗∗

60-month yield
0.93∗
0.93
0.91

0.98∗∗
0.94∗
0.93

1.04
0.93∗∗
0.95∗∗∗

1
6
12

0.98∗∗∗
0.94∗∗∗
0.93∗∗∗

120-month yield
0.77∗∗∗
0.75∗∗∗
0.75∗∗∗

0.96∗∗∗
0.91∗∗
0.89∗

1.21∗∗∗
1.14∗∗∗
1.11∗∗∗

1
6
12

0.99
0.98∗∗
0.97∗∗∗

360-month yield
0.79∗
0.68∗∗∗
0.66∗∗∗

0.79
0.68∗∗∗
0.66∗∗∗

0.99
0.98
0.97

Table 8: RMSE Ratios for Out-of-Sample Forecast Errors.
The ratios of the RMSEs for two different models are shown for each forecast horizon and yield
maturity. The statistical significance of these forecast comparisons (based on tests of equal forecast
accuracy using quadratic loss) are denoted by ∗ at the 10% level, ∗∗ at the 5% level, and ∗∗∗ at
the 1% level.

24

correlated-factor models by their non-AF counterparts. Here the story is more mixed, but for the
independent-factor case, which is arguably the one of interest given the generally poor performance
and overparameterization of the correlated-factor models, the AF version dominates. The bottom
line is that out-of-sample forecast performance is improved by imposing the AF restrictions—
especially at longer horizons and for longer maturities.

6

Concluding Remarks

Asset pricing, portfolio allocation, and risk management are the fundamental tasks in financial
asset markets. For fixed income securities, superior yield-curve modeling translates into superior
pricing, portfolio returns, and risk management. Accordingly, we have focused on two important
and successful yield curve literatures: the Nelson-Siegel empirically based one and the no-arbitrage
theoretically based one. Yield-curve models in both of these traditions are impressive successes,
albeit for very different reasons. Ironically, both approaches are equally impressive failures, and
for the same reasons, swapped. That is, models in the Nelson-Siegel tradition fit and forecast well,
but they lack theoretical rigor insofar as they admit arbitrage possibilities. Conversely, models in
the arbitrage-free tradition are theoretically rigorous insofar as they enforce absence of arbitrage,
but they fit and forecast poorly.
In this paper we have bridged this divide, proposing hybrid Nelson-Siegel-inspired models that
simultaneously enforce absence of arbitrage. We analyzed our models theoretically and empirically,
relating them to the canonical Dai-Singleton representation of three-factor arbitrage-free affine
models and documenting that predictive gains may be achieved by imposing absence of arbitrage,
particularly for moderate to long maturities and forecast horizons.

25

Appendix A: Proof of Proposition 1
Start the analysis by limiting the volatility to be constant. Then the system of ODEs for
B(t, T ) is given by
dB(t, T )
= ρ1 + (K Q )′ B(t, T ),
dt

B(T, T ) = 0.

Because
i
Q ′
Q ′
d h (K Q )′ (T −t)
dB(t, T )
e
B(t, T ) = e(K ) (T −t)
− (K Q )′(K ) (T −t) B(t, T ),
dt
dt
it follows from the system of ODEs that
Z

Z T
i
Q ′
d h (K Q )′ (T −s)
e
B(s, T ) ds =
e(K ) (T −s) ρ1 ds
ds
t

T
t

or, equivalently, using the boundary conditions
B(t, T ) = −e

−(K Q )′ (T −t)

Z

T

e(K

Q ′

) (T −s)

ρ1 ds.

t

Now impose the following structure on (K Q )′ and ρ1 :


0

0

0





λ



 

and ρ1 = 
 1 .
0


0 

−λ λ


(K Q )′ = 
 0
0

1

It is then easy to show that

e(K

Q ′

) (T −t)

0

1

0
eλ(T −t)

B
=@ 0
0

−λ(T −

1

0

t)eλ(T −t)

0

C
A

eλ(T −t)

e−(K

and

Q ′

) (T −t)

0

1

B
=@ 0
0

0

0

e−λ(T −t)
λ(T −

0

t)e−λ(T −t)

e−λ(T −t)

Inserting this in the ODE, we obtain

B(t, T )

=

0

1

B
−B
@ 0
0

=

0

1
B
B
−@ 0
0

1

0

0

e−λ(T −t)

0

λ(T − t)e−λ(T −t)

e−λ(T −t)

0
e

λ(T − t)e−λ(T −t)

1

0

−λ(T −t)

0
e−λ(T −t)

Because

Z

C
C
A

C
C
A

Z

T

Z

T

t

t

0

1

B
B 0
@
0
0

0

0

eλ(T −s)

0

−λ(T − s)eλ(T −s) eλ(T −s)
1
1
C
B
C ds.
B
eλ(T −s)
A
@
λ(T −s)
−λ(T − s)e

T

ds = T − t,

t

and

and

Z

T

eλ(T −s) ds =
t

h −1
λ

eλ(T −s)

26

iT
t

=−

1 − eλ(T −t)
,
λ

10

1

1

C
CB
C B 1 C ds
A
A@
0

1

C
A.

Z

T

Z

1
λ

−λ(T −s)eλ(T −s) ds =

t

0

xex dx =

λ(T −t)

1
1
[xex ]0λ(T −t) −
λ
λ

Z

0

ex dx = −(T −t)eλ(T −t)−

λ(T −t)

1 − eλ(T −t)
,
λ

the system of ODEs can be reduced to
0

1

0

B
B(t, T ) = − @ 0
0

0

e−λ(T −t)

0

λ(T − t)e−λ(T −t)

e−λ(T −t)

10
CB
AB
@

1

T −t
λ(T −t)

− 1−e

−(T −

λ
t)eλ(T −t)

−

1−eλ(T −t)
λ

0

C B
C=B
A @

1

−(T − t)
−λ(T −t)

− 1−e

(T −

λ
−λ(T −t)
t)e−λ(T −t) − 1−e λ

C
C,
A

which is identical to the claim in Proposition 1. QED

Appendix B: The AFDNS yield-adjustment term
In the AFDNS models the yield-adjustment term is in general given by
C(t, T )
T −t

=

=

=
+

1 1
2T −t

Z

T

1 1
2T −t

Z

T

3
X
` ′
´
Σ B(s, T )B(s, T )′ Σ j,j ds

t

j=1

20
σ11
3
X
6B
4@ σ12

t

j=1

σ21

σ31

σ22

σ32

1
B 1 (t, T )
“
CB 2
C
A @ B (t, T ) A B 1 (t, T )
10

B 2 (t, T )

B 3 (t, T )

”

0

σ11
B
@ σ21

σ13

σ22

C7
σ23 A5

σ33
B 3 (t, T )
σ31 σ32
Z T
Z T
Z T
A 1
B 1
C 1
B 1 (s, T )2 ds +
B 2 (s, T )2 ds +
B 3 (s, T )2 ds
2 T −t t
2 T −t t
2 T −t t
Z T
Z T
Z T
1
1
1
D
B 1 (s, T )B 2 (s, T )ds + E
B 1 (s, T )B 3 (s, T )ds + F
B 2 (s, T )B 3 (s, T )ds,
T −t t
T −t t
T −t t
σ13

σ23

σ33

where
2
2
2
• A = σ11
+ σ12
+ σ13
,
2
2
2
• B = σ21
+ σ22
+ σ23
,
2
2
2
• C = σ31
+ σ32
+ σ33
,

• D = σ11 σ21 + σ12 σ22 + σ13 σ23 ,
• E = σ11 σ31 + σ12 σ32 + σ13 σ33 ,
• F = σ21 σ31 + σ22 σ32 + σ23 σ33 .
To derive the analytical formula for
I1 =

I2 =

B 1
2 T −t

A 1
2 T −t

Z

T
t

Z

C(t,T )
T −t ,

T

B 1 (s, T )2 ds =

t

B 2 (s, T )ds =

B 1
2 T −t

Z

T
t

six integrals need to be solved:

A 1
2 T −t

Z

t

T

(T − s)2 ds =

A
(T − t)2 .
6

h 1 − e−λ(T −s) i2
h 1
1 1 − e−λ(T −t)
1 1 − e−2λ(T −t) i
−
ds = B
−
+
.
λ
2λ2 λ3
T −t
4λ3
T −t

27

13

σ12

j,j

=

I3

=

I4 =

Z T
Z Tn
C 1
C 1
1 − e−λ(T −s) o2
B 3 (s, T )ds =
(T − s)e−λ(T −s) −
ds
2 T −t t
2 T −t t
λ
h 1
−λ(T
−t)
1
1
3 −2λ(T −t)
2 1−e
5 1 − e−2λ(T −t) i
C
+ 2 e−λ(T −t) −
(T − t)e−2λ(T −t) −
e
− 3
+
.
2
2
2λ
λ
4λ
4λ
λ
T −t
8λ3
T −t

D
T −t

Z

t

T

B 1 (s, T )B 2 (s, T )ds =

D
T −t

Z

t

T

h
ih 1 − e−λ(T −s) i
h 1
1
1 1 − e−λ(T −t) i
−(T −s) −
ds = D
(T −t)+ 2 e−λ(T −t) − 3
.
λ
2λ
λ
λ
T −t

Z T
Z Th
ih
1
1
1 − e−λ(T −s) i
1
3
B (s, T )B (s, T )ds = E
− (T − s) (T − s)e−λ(T −s) −
ds
= E
T −t t
T −t t
λ
h3
1
1
3 1 − e−λ(T −t) i
= E 2 e−λ(T −t) +
(T − t) + (T − t)e−λ(T −t) − 3
.
λ
2λ
λ
λ
T −t

I5

Z T
Z Th
1 − e−λ(T −s) ih
1 − e−λ(T −s) i
1
1
B 2 (s, T )B 3 (s, T )ds = F
−
(T − s)e−λ(T −s) −
ds
T −t t
T −t t
λ
λ
h1
1
1
3 1 − e−λ(T −t)
3 1 − e−2λ(T −t) i
= F 2 + 2 e−λ(T −t) − 2 e−2λ(T −t) − 3
+ 3
.
λ
λ
2λ
λ
T −t
4λ
T −t

= F

I6

Combining the six integrals, the analytical formula reported in subsection 2.3 is obtained.

Appendix C: Proof of Proposition 2
Before we can turn to the proof of Proposition 2 and the subsequent derivation of the restrictions that need to be imposed on the canonical representation of the A0 (3) class of affine models
to arrive at the models equivalent to the AFDNS model, we need to introduce the concept of
so-called affine invariant transformations.
Consider an arbitrary affine diffusion process represented by
dYt = KYQ [θYQ − Yt ]dt + ΣY dWtQ .
Now consider the affine transformation TY : AYt + η, where A is a nonsingular square matrix of
the same dimension as Yt while η is a vector of constants of the same dimension as Yt . Denote
the transformed process by Xt = AYt + η. By Ito’s lemma it follows that
dXt

=

AdYt = [AKYQ θYQ − AKYQ Yt ]dt + AΣY dWtQ = AKYQ A−1 [AθYQ − AYt − η + η]dt + AΣY dWtQ

=

Q Q
AKYQ A−1 [AθYQ + η − Xt ]dt + AΣY dWtQ = KX
[θX − Xt ]dt + ΣX dWtQ .

Thus, Xt is itself an affine diffusion process with the following parameter specification:
Q
KX
= AKYQ A−1 ,

Q
θX
= AθYQ + η,

28

and ΣX = AΣY .

A similar result holds for the dynamics under the P -measure.
In terms of the short rate process there exists the following relationship:
rt

= δ0Y + (δ1Y )′ Yt = δ0Y + (δ1Y )′ A−1 AYt = δ0Y + (δ1Y )′ A−1 [AYt + η − η]
= δ0Y − (δ1Y )′ A−1 η + (δ1Y )′ A−1 Xt .

Thus, defining δ0X = δ0Y − (δ1Y )′ A−1 η and δ1X = (δ1Y )′ A−1 , the short rate process is left unchanged
and may be represented in either way
rt = δ0Y + (δ1Y )′ Yt = δ0X + (δ1X )′ Xt .
Because both Yt and Xt are affine latent factor processes that deliver the same distribution for
the short rate process rt , they are equivalent representations of the same fundamental model.
The upshot is that the canonical representation provided by Dai and Singleton (2000) is just
one way of representing this model. There are an infinite number of representations of the same
model that all share the property that the risk-free short rate process and, by consequence, all
bond yields will have the same distribution independent of the choice of representation. Hence TX
is called an affine invariant transformation.
We now proceed to a proof of Proposition 2. Consider the canonical representation of maximal
flexibility under the Q-measure, namely that with identifying restrictions imposed under the P measure with θYP = 0, ΣY = I, KYP upper triangular, and KYQ any 3 × 3 matrix:
dYt

= −KYP Yt dt + IdWtP

dYt

= KYQ [θYQ − Yt ]dt + IdWtQ .

By Schur’s decomposition, the KYQ -matrix can be written as
KYQ = A′ [D + N ]A,
where A is an orthogonal matrix, D is a diagonal matrix containing the eigenvalues of KYQ , and
N is an upper-triangular matrix. Although the Schur decomposition is not unique, the argument
below only relies on the existence of such matrices. If the eigenvalues of KYQ are real (as assumed
in Proposition 2), then D + N and A are real matrices and, in particular, T = D + N is an
upper-triangular matrix.
Now consider the invariant affine transformation given by TA (Yt ) = AYt . Given the transformed
process Xt = AYt , the factor loadings in the risk-free rate are given by
δ0X = δ0Y ,

δ1X = (δ1Y )′ A−1 = (δ1Y )′ A′ ,

and the volatility matrix is given by
ΣX = A,
while the P - and Q-dynamics are given by

29

P
KX
= AKYP A−1 = AKYP A′ ,

P
θX
= AθYP = 0,

Q
KX
= AKYQ A−1 = AKYQ A′ ,

Q
θX
= AθYQ .

However, because KYQ = A′ T A by the Schur decomposition, it follows that
Q
KX
= AKYQ A′ = A[A′ T A]A′ = T.

Hence we have obtained an upper-triangular mean-reversion matrix under the Q-measure.
The next step in the proof is to transform the volatility matrix ΣX = A into the identity
matrix without affecting any of the drift terms. This can be done through a so-called Brownian
Motion Rotation.21 This consists in defining an affine transformation of the Brownian motion
TO (Wt ) = OWt ,
where O must be an orthogonal matrix. The orthogonality of O maintains the independence of the
transformed Brownian motions and thereby makes the transformation invariant. In the current
case the rotation is performed with the orthogonal matrix A and the rotated Brownian motion is
ctP = AWtP and W
ctQ = AWtQ . Applied to the Xt -process, it follows that
given by W
dXt

dXt

P
P
P
cP ,
= −KX
Xt dt + AdWtP = −KX
Xt dt + A[A′ A]dWtP = −KX
Xt dt + IdW
t

Q
Q
Q
ctQ .
= T [θX
− Xt ]dt + AdWtQ = T [θX
− Xt ]dt + A[A′ A]dWtQ = T [θX
− Xt ]dt + IdW

Q
The only remaining problem is to eliminate the mean vector under the Q-measure, θX
. To that end
Q
Q
apply the invariant affine transformation TA (Xt ) = Xt −θX
. The transformed process Zt = Xt −θX

is characterized by the following vectors and matrices:
δ0Z

Q
= δ0X + (δ1X )′ θX
= δ0Y + [Aδ1Y ]′ AθYQ = δ0Y + (δ1Y )′ θYQ ,

δ1Z

= δ1X = Aδ1Y .

ΣZ

= ΣX = I

KZP
P
θZ

KZQ
Q
θZ

P
= KX
= AKYP A′
Q
P
= θX
− θX
= −AθYQ
Q
= KX
=T
Q
Q
= θX
− θX
= 0,

or equivalently,
dZt
dZt
21 See

ctP
= AKYP A′ [−AθYQ − Zt ]dt + IdW
cQ,
= −T Zt dt + IdW
t

Appendix A in Dai and Singleton (2000) for details.

30

with the instantaneous risk-free rate given by
rt = δ0Y + (δ1Y )′ θYQ + (δ1Y )′ A′ Zt .
Hence the dynamics of the Zt -process are identical to the canonical representation with the identifying restrictions imposed under the Q-measure, and since all the transformations that converted
the original Yt -process into the Zt -process have been invariant transformations, Yt and Zt are
equivalent representations of the same underlying model. QED

Appendix D: Parameter restrictions imposed in AFDNS
This appendix derives the connection between the AFDNS models and the canonical representation of the A0 (3) class of affine term structure models. In the canonical representation of the
subset of A0 (3) affine term structure models considered here, the dynamics under the Q-measure
are given by


dZt1








 dZ 2  = − 
t 


dZt3

κZ,Q
11

κZ,Q
12

0

κZ,Q
22

0

0

κZ,Q
13



Zt1





1




  Z 2  dt +  0
κZ,Q
23
 t 

3
0
κZ,Q
Z
t
33



0 0

dWt1,Q





2,Q 

1 0 
  dWt
,
3,Q
dWt
0 1

and the P -dynamics are given by
dWt1,P

κZ,P
11

κZ,P
12

κZ,P
13

1

0

0

B
C B Z,P
@ dZt2 A = @ κ21

κZ,P
22

C 6B Z,P C B 2 C7
B
κZ,P
A 4 @ θ2
A − @ Zt A5 dt + @ 0
23

1

CB
C
0 A @ dWt2,P A .

0

dZt1

1

0

κZ,P
31

dZt3

κZ,P
32

1 20

κZ,P
33

θ1Z,P

1

θ3Z,P

0

Zt1

13

0

Zt3

0

0

10

1

dWt3,P

1

Finally, the instantaneous risk-free rate is given by
Z
Z
Z
rt = δ0Z + δ1,1
Zt1 + δ1,2
Zt2 + δ1,3
Zt3 .

There are 22 parameters in this maximally flexible canonical representation of the A3 (0) class
of models. We seek to find the parameter restrictions that need to be imposed on the canonical
representation of this maximally flexible A0 (3) model to arrive at a model equivalent to the affine
AFDNS models considered in this paper. We first consider the independent-factor case, and then
we examine correlated factors.

(1) The AFDNS model with independent factors
The independent-factor AFDNS model has P -dynamics given by
1 0 X,P
κ11
dXt1
C B
B
0
@ dXt2 A = @
0

dXt3

0

0

0

κX,P
22

0

0

κX,P
33

0 X
13
1 0
σ11
Xt1
θ1X,P
B
7
C
C 6B X,P C B
A − @ Xt2 A5 dt + @ 0
A 4@ θ2
1 20

θ3X,P

Xt3

31

0

0

0

X
σ22

0

0

X
σ33

1
dWt1,P
CB
2,P C
A,
A @ dWt
10

dWt3,P

and the Q-dynamics are given by Proposition 1 as


dXt1





0

0



0

Xt1





X
σ11





 2 
λ −λ 
  Xt  dt +  0
0 λ
Xt3
0




 dX 2  = −  0
t 


dXt3
0

0
X
σ22

0

0



dWt1,Q





2,Q 

0 
  dWt
.
3,Q
X
σ33
dWt

Finally, the short rate process is rt = Xt1 + Xt2 . This model has a total of 10 parameters. Thus,
the task is to determine the 12 parameter restrictions that need to be imposed on the canonical
A0 (3) model to arrive at this model.
It is easy to verify that the affine invariant transformation TA (Zt ) = AZt + η with


X
σ11


A=
 0

0
X
σ22

0

0

0






0 

X
σ33

0



 

η=
 0 
0

will convert the canonical representation into the independent-factor AFDNS model. For the
mean-reversion matrices, the relationship between the two representations is
P
KX
= AKZP A−1

⇐⇒

P
KZP = A−1 KX
A

Q
KX
= AKZQ A−1

⇐⇒

Q
KZQ = A−1 KX
A.

The equivalent mean-reversion matrix under the Q-measure is then given by


1
X
σ11


KZQ = 
 0
0

0
1
X
σ22

0

0



0

0



0 
 0 λ
1
0 0
σX
33

0



X
σ11

0



−λ 
 0
λ
0

X
σ22

0

0





0

 

0 
= 0
X
σ33
0

0

0




σX 
.
λ −λ σ33
X
22 
0
λ

Thus, four restrictions need to be imposed on the upper triangular mean-reversion matrix KZQ :
Z,Q
= 0,
K11

Z,Q
K12
= 0,

Z,Q
K13
=0

Z,Q
Z
and K33
= K22
.

Z,Q
Z,Q
Z,Q
Furthermore, notice that K23
will always have the opposite sign of K22
and K33
, but its
P
absolute size can vary independently of these two parameters. Since KX
, A, and A−1 are all

diagonal matrices, KZP is a diagonal matrix, too. This gives another six restrictions.
Finally, we can study the factor loadings in the affine function for the short rate process. In
all AFDNS models, rt = Xt1 + Xt2 , which is equivalent to fixing

δ0X = 0,



1



 

δ1X = 
 1 .
0

32

From the relation (δ1X )′ = (δ1Z )′ A−1 it follows that

(δ1Z )′ = (δ1X )′ A =



1

1 0



X
σ11


 0

0

0

0

X
σ22

0



 
X
0 
 = σ11
X
σ33

X
σ22

0



.

For the constant term it holds that
δ0X = δ0Z − (δ1Z )′ A−1 η ⇐⇒ δ0Z = δ0X = 0.
Thus, we have obtained two additional parameter restrictions
Z
= 0.
δ0Z = 0 and δ1,3

(2) The AFDNS model with correlated factors
In the correlated-factor AFDNS model, the P -dynamics are given by
0

1

0

1 20

1

0

13

0

κX,P
11

κX,P
12

κX,P
13

C B
B
B dXt2 C = B κX,P
A @ 21
@
dXt3
κX,P
31

κX,P
22

B
C 6B X,P C B 2 C7
C 6B θ
C − B Xt C7 dt+B
κX,P
23
@
A5
A 4@ 2
A @
Xt3
κX,P
θ3X,P
33

dXt1

κX,P
32

θ1X,P

Xt1

10

dWt1,P

1

X
σ11

X
σ12

X
σ13

0

X
σ22

0

0

CB
C
2,P C
X CB
σ23
A @ dWt
A,
3,P
X
dWt
σ33

X
σ13



and the Q-dynamics are given by Proposition 1 as


dXt1





0




 dX 2  = −  0
t 


dXt3
0

0

0



Xt1





X
σ11





 2 
λ −λ 
  Xt  dt +  0
3
0
Xt
0 λ

X
σ12

dWt1,Q





2,Q 
X 
σ23
.
  dWt
3,Q
X
dWt
σ33

X
σ22

0

This model has a total of 19 parameters. Thus, there are three parameter restrictions to be
determined as compared to the maximally flexible canonical representation of the A0 (3) class.
It is easy to verify that the affine invariant transformation TA (Zt ) = AZt + η with


X
σ11


A=
 0
0

X
σ12
X
σ22

0

X
σ13




X 
σ23

X
σ33



0



 

and η = 
 0 
0

will convert the canonical representation into the correlated-factor AFDNS model. For the meanreversion matrices the relationship between the two representations is
P
KX
= AKZP A−1

⇐⇒

P
KZP = A−1 KX
A

Q
KX
= AKZQ A−1

⇐⇒

Q
KZQ = A−1 KX
A.

33

The equivalent mean-reversion matrix under the Q-measure is then given by

KZQ

=

=



1
X
σ11

σX

− σX12
σX

−



X
σ13
X σX
σ11
33

X X
σ12
σ23
X σX σX
σ11
22 33
X
σ23
X σX
σ22
33

−


1
 0
−
X

σ22
1
0
0
X
σ33


X X
X X
X
σ σ −σ σ
σ
λ 12 σ33X σX22 13
0 −λ σ12
X
11
11 22


(σX )2
.
 0
λ
−λ σX23σX


22 33
0
0
λ
11

22

 

0


 0

0

0

0



X
σ11



λ −λ 
 0
0 λ
0

X
σ12
X
σ22

0

X
σ13




X 
σ23

X
σ33

Thus, two restrictions need to be imposed on the upper triangular mean-reversion matrix KZQ :
Z,Q
K11
= 0,

Z,Q
Z
K33
= K22
.

Z,Q
Z,Q
Z,Q
Furthermore, notice that K23
will always have the opposite sign of K22
and K33
, but its

absolute size can vary independently of the two other parameters.
Next we study the factor loadings in the affine function for the short rate process. In the
AFDNS models, rt = Xt1 + Xt2 , which is equivalent to fixing

δ0X = 0,



1



 

δ1X = 
 1 .
0

From the relation (δ1X )′ = (δ1Z )′ A−1 , it follows that

(δ1Z )′ = (δ1X )′ A =



1 1


X
  σ11
0 
 0
0

X
σ12
X
σ22

0

X
σ13



 
X
X  =
σ11
σ23

X
σ33

X
X
σ21
+ σ22

X
X
σ13
+ σ23



.

This shows that there are no restrictions on δ1Z . For the constant term, we have
δ0X = δ0Z − (δ1Z )′ A−1 η ⇐⇒ δ0Z = δ0X = 0.
Thus, we have obtained one additional parameter restriction,
δ0Z = 0.
Finally, for the mean-reversion matrix under the P -measure, we have
P
P
KX
= AKZP A−1 ⇐⇒ KZP = A−1 KX
A.
P
Since KX
is a free 3 × 3 matrix, KZP is also a free 3 × 3 matrix. Thus, no restrictions are imposed

on the P -dynamics in the equivalent canonical representation of this model.

34

References
Ahn, Dong-Hyun, Robert F. Dittmar, and A. Ronald Gallant, 2002, “Quadratic Term Structure
Models: Theory and Evidence,” Review of Financial Studies, Vol. 15, No. 1, 243-288.
Ang, Andrew and Monika Piazzesi, 2003, “A No-Arbitrage Vector Autoregression of Term Structure Dynamics with Macroeconomic and Latent Variables,” Journal of Monetary Economics,
Vol. 50, 745-787.
Ang, Andrew , Monika Piazzesi, and Min Wei, 2006, “What Does the Yield Curve Tell Us About
GDP Growth?,” Journal of Econometrics, Vol. 131, 359-403.
Bank for International Settlements, 2005, “Zero-Coupon Yield Curves: Technical Documentation,” BIS papers, No. 25.
Christensen, Jens H., Francis X. Diebold, Glenn Rudebusch, and Georg Strasser, 2007, “Multivariate Comparisons of Predictive Accuracy,” manuscript, University of Pennsylvania.
Cox, John C., Jonathan E. Ingersoll, and Stephen A. Ross, 1985, “A Theory of the Term Structure
of Interest Rates,” Econometrica, Vol. 53, No. 2, 385-407.
Dai, Qiang and Kenneth J. Singleton, 2000, “Specification Analysis of Affine Term Structure
Models,” Journal of Finance, Vol. 55, 1943-1978.
Dai, Qiang and Kenneth J. Singleton, 2002, “Expectations Puzzles, Time-Varying Risk Premia,
and Affine Models of the Term Structure,” Journal of Financial Economics, Vol. 63, No. 3,
415-441.
De Pooter, Michiel, Francesco Ravazzolo, and Dick van Dijk, 2007, “Predicting the Term Structure of Interest Rates: Incorporating Parameter Uncertainty and Macroeconomic Information, ” Tinbergen Institute Discussion Papers.
Diebold, Francis X. and Canlin Li, 2006, “Forecasting the Term Structure of Government Bond
Yields,” Journal of Econometrics, Vol. 130, 337-364.
Diebold, Francis X. and Roberto S. Mariano, 1995, “Comparing Predictive Accuracy,” Journal
of Business and Economic Statistics, Vol. 13, 253-265.
Diebold, Francis X., Monika Piazzesi, and Glenn D. Rudebusch, 2005, “Modeling Bond Yields
in Finance and Macroeconomics,” American Economic Review, Vol, 95, 415-420.
Diebold, Francis X., Glenn D. Rudebusch and S. Boragan Aruoba, 2006, “The Macroeconomy
and the Yield Curve: a Dynamic Latent Factor Approach,” Journal of Econometrics, Vol.
131, 309-338.
Duffee, Gregory R., 1996, “Idiosyncratic Variation of Treasury Bill Yields,” Journal of Finance,
Vol. 51, 527-552.

35

Duffee, Gregory R., 2002, “Term Premia and Interest Rate Forecasts in Affine Models,” Journal
of Finance, Vol. 57, 405-443.
Duffie, Darrell and Rui Kan, 1996, “A Yield-factor Model of Interest Rates,” Mathematical
Finance, Vol. 6, 379-406.
Duffie, Darrell, Jun Pan, and Kenneth J. Singleton, 2000, “Transform Analysis and Asset Pricing
for Affine Jump-Diffusions,” Econometrica, Vol. 68, 1343-1376.
Fama, Eugene F. and Robert R. Bliss, 1987, “The Information in Long-Maturity Forward Rates,”
American Economic Review, Vol. 77, 680-692.
Filipović, Damir, 1999, “A Note on the Nelson-Siegel Family,” Mathematical Finance, Vol. 9,
349-359.
Gürkaynak, Refet S. , Brian Sack, and Jonathan H. Wright, 2006, “The U.S. Treasury Yield
Curve: 1961 to the Present,” Finance and Economics Discussion Series 2006-28, Board of
Governors of the Federal Reserve System.
Hördahl, Peter, Oreste Tristani, and David Vestin, 2005, “A Joint Econometric Model of Macroeconomic and Term-Structure Dynamics,” Journal of Econometrics, Vol. 131, 406-436.
Kim, Don H. and Athanasios Orphanides, 2005, “Term Structure Estimation with Survey Data
on Interest Rate Forecasts,” Finance and Economics Discussion Series, No. 48, Board of
Governors of the Federal Reserve System.
Krippner, Leo, 2006, “A Theoretically Consistent Version of the Nelson and Siegel Class of Yield
Curve Models,” Applied Mathematical Finance, Vol. 13, No. 1 (March), 39-59.
Mönch, Emanuel, 2006, “Forecasting the Yield Curve in a Data-Rich Environment: A NoArbitrage Factor-Augmented VAR Approach,” manuscrupt, Humboldt University.
Nelson, Charles R. and Andrew F. Siegel, 1987, “Parsimonious Modeling of Yield Curves,” Journal of Business, Vol. 60, 473-489.
Rudebusch, Glenn D., Eric Swanson, and Tao Wu, 2006, “The Bond Yield ‘Conundrum’ from a
Macro-Finance Perspective,” Monetary and Economic Studies, Vol. 24 (December), 83-128.
Svensson, Lars E. O., 1995, “Estimating Forward Interest Rates with the Extended Nelson-Siegel
Method,” Quarterly Review, No. 3, Sveriges Riksbank, 13-26.
Vasiček, Oldrich, 1977, “An Equilibrium Characterization of the Term Structure,” Journal of
Financial Economics, Vol. 5, 177-188.
Williams, David, 1997, Probability with Martingales, Cambridge University Press.

36

