NBER WORKING PAPER SERIES

NONPARAMETRIC IDENTIFICATION AND ESTIMATION IN A GENERALIZED
ROY MODEL
Patrick Bayer
Shakeeb Khan
Christopher Timmins
Working Paper 13949
http://www.nber.org/papers/w13949

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
April 2008

We would like to thank Richard Blundell, James Heckman, Hide Ichimura, Robert Moffitt, Tiemen
Woutersen, and seminar participants at SUNY Albany, Duke University, Johns Hopkins University
and the University of Chicago for their helpful comments. All remaining errors and omissions are
our own. The views expressed herein are those of the author(s) and do not necessarily reflect the views
of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2008 by Patrick Bayer, Shakeeb Khan, and Christopher Timmins. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.

Nonparametric Identification and Estimation in a Generalized Roy Model
Patrick Bayer, Shakeeb Khan, and Christopher Timmins
NBER Working Paper No. 13949
April 2008
JEL No. C1,C13,C14,J24,J3,J32
ABSTRACT
This paper considers nonparametric identification and estimation of a generalized Roy model that
includes a non-pecuniary component of utility associated with each choice alternative. Previous work
has found that, without parametric restrictions or the availability of covariates, all of the useful content
of a cross-sectional dataset is absorbed in a restrictive specification of Roy sorting behavior that imposes
independence on wage draws. While this is true, we demonstrate that it is also possible to identify
(under relatively innocuous assumptions and without the use of covariates) a common non-pecuniary
component of utility associated with each choice alternative. We develop nonparametric estimators
corresponding to two alternative assumptions under which we prove identification, derive asymptotic
properties, and illustrate small sample properties with a series of Monte Carlo experiments. We demonstrate
the usefulness of one of these estimators with an empirical application. Micro data from the 2000
Census are used to calculate the returns to a college education. If high-school and college graduates
face different costs of migration, this would be reflected in different degrees of Roy-sorting-induced
bias in their observed wage distributions. Correcting for this bias, the observed returns to a college
degree are cut in half.

Patrick Bayer
Department of Economics
Duke University
213 Social Sciences
Durham, NC 27708
and NBER
patrick.bayer@duke.edu
Shakeeb Khan
Department of Economics
Duke University
213 Social Sciences
Durham, NC 27708
shakeeb.khan@duke.edu

Christopher Timmins
Department of Economics
Duke University
209 Social Sciences Building
P.O. Box 90097
Durham, NC 27708-0097
and NBER
christopher.timmins@duke.edu

1. Introduction
In the original application of his model, Roy (1951) showed that the self-selection of
individuals into occupations generally implies that observed wages (conditional on occupation
choice) differ markedly from the underlying distribution of wages in the population. The Roy
model has subsequently been applied to a wide class of problems in economics as its structure fits
any setting in which individuals choose among a set of alternatives to maximize an outcome
associated with that choice. Given its wide applicability, an important line of recent research has
analyzed identification in the Roy model. Beginning with Heckman and Honore (1990), this
literature has produced a series of results that clarify the conditions under which the underlying
population distribution of wages can (or cannot) be identified in observational data.
In this paper, we study the nonparametric identification and estimation of a generalized
Roy model that includes a non-pecuniary component of utility associated with each alternative.
An important limitation of the pure Roy model is that it assumes that individuals maximize only
economic returns (e.g., wages). Yet non-pecuniary aspects of decisions are important in many
economic applications. In the choice of occupation, for example, non-pecuniary components of
utility would include the amenity value or injury risk associated with different jobs.1 As with the
pure Roy model, this generalized version is also applicable to settings in which the outcome of
interest is not economic returns. In studying the choice of health behaviors or medical treatments,
for example, the relevant outcome might be the survival rate, while the “non-pecuniary”
component of utility might capture the enjoyment associated with a behavior (such as smoking)
or disutility of side-effects associated with various treatments.2 In this way, the generalized
model developed here can be applied to a wide class of problems in economics.

1

In modeling the choice of labor market/residence, the non-pecuniary component of utility would capture
variation in amenities and cost-of-living across cities.
2
Likewise, in the study of school choice, the relevant outcome might be achievement scores, while other
factors affecting the choice of school (e.g., availability of special education programs) might be included as
part of a separate component of utility.

1

The starting point for our analysis is the well-known result for the pure Roy model in
Heckman and Honore (1990) – that any cross-sectional dataset (consisting of the observed
distribution of wages in each sector and the probability that each sector is chosen) can be
rationalized by an underlying population wage distribution in which wages are distributed
independently across sectors. Thus, the correlation of wage offers across sectors is unidentified
in a single cross-section.
A common interpretation of this important result is that, without parametric restrictions
or access to covariates, all of the useful content of cross-sectional data is absorbed in a restricted
specification of the Roy model (i.e., one that imposes independence). While this interpretation is
correct if the data is generated in a pure Roy model, one can in fact glean additional information
from a single cross-sectional dataset when non-pecuniary considerations matter. In the analysis
that follows, we provide two distinct sets of conditions under which the non-pecuniary values
associated with each choice alternative are non-parametrically identified. As in Heckman and
Honore (1990), the identification of the full population wage distribution requires additional
identifying assumptions; the key insight of our paper is that the non-pecuniary value of
alternatives in a generalized Roy model can be identified even in a single cross-section.
Throughout the paper, we consider the nonparametric identification of the model in a
relatively demanding setting in which (i) the set of available choices is large and (ii) covariates
are not available to the researcher.3

The objects to be identified are the population wage

distributions and a common non-pecuniary utility associated with each choice. In developing a
first set of conditions for identification, we impose only the relatively innocuous requirement that
3

The related problem when covariates are available has been studied extensively in the literature,
especially in the binomial choice problem. [See, for example, Heckman and Honore (1989) and Heckman
(1990)] As there is a close link between Roy models and competing risk models, several many of the
papers in the survey in Powell(1994) are also related to the models we explore here. Some more recent
related work includes Honore et al.(2002), Lee(2006), Honore and Lleras-Muney (2007), and Khan and
Tamer (2007). While identification strategies that rely on the use of covariates can be extended to the
multinomial choice setting, the requisite demands on the data are enormous, requiring, for example, the
availability of distinct combinations of covariates that compel individuals to select each choice with
certainty.

2

the distribution of pecuniary returns has a finite lower bound.

Given this assumption, we

demonstrate that the difference in the minimum order statistic for any two alternatives exactly
identifies the difference in the non-pecuniary value of those choices. Intuitively, this follows
directly from the observation that no individual will choose a less-preferred choice (on the basis
of non-pecuniary considerations) unless the wage offered there exceeds this threshold. Thus, the
minimum wage observed in the less-preferred sector should be exactly the minimum wage
observed in the more-preferred sector plus the difference in non-pecuniary components.4 Having
identified the non-pecuniary component of utility, we show that it is then straightforward to (i)
back-out underlying unconditional population wage distributions using transformed versions of
the observed conditional wages distributions for each sector and the Kaplan-Meier (1958)
procedure, if one assumes independence, or (ii) apply Petersen (1976) bounds to the transformed
data to bound the unconditional population wage distribution.
While this estimator works very well in controlled data environments, relying exclusively
on differences in minimum order statistics to identify the non-pecuniary component of utility
raises concerns about measurement error. As a result, we consider a second set of formal
identifying assumptions. Our second identification proof is based on two key assumptions. First,
we assume independence.5 Second, we assume that information is available for (at least) two
subsets of the population that differ in their non-pecuniary valuation of the set of choice
alternatives. In the application that we present below, we consider the choice of regional labor
market; in that context, moving costs (broadly defined) naturally imply that birth region affects
the non-pecuniary value one ascribes to a particular destination. We then exploit the fact that

4

Note that, within the pure Roy model, the minimum order statistics would be identical for all choices and
the full empirical content of the data would in fact be absorbed by a specification including independent
population wage distributions, as suggested by Heckman and Honore (1990).
5
Again, following the existing literature, the independence assumption can be relaxed in more generous
data environments (e.g., when data is available for more than a single cross-section or when covariates are
available). See, for example, Khan and Tamer (2007) who achieve identification results under strong
support conditions in a semi-parametric Roy model. Honore and Llera-Muney (2007) establish set
identification when the independence assumption is relaxed.

3

wage offers are likely to be similar for individuals with similar characteristics from neighboring
regions while the non-pecuniary value of residing in these regions will vary significantly with an
individual’s birthplace.

We refer to this second assumption as “commonality”, i.e., that a

common wage distribution characterizes wage offers for all individuals regardless of birthplace.
Given this assumption, we prove that both the non-pecuniary components of utility for each
population subset and the overall population wage distributions are identified.
In this case, some intuition for why the model is identified by the commonality
assumption can again be gained by referring back to Heckman and Honore (1990). Without nonpecuniary components of utility, the observed conditional wage distributions and choice
probabilities map uniquely to a set of independent population wage distributions. With at least
two subsets of the population that differ in their non-pecuniary valuations of alternatives,
however, the resulting unconditional wage distributions that would reconcile the two subsets of
the data would differ. What our identification proof ensures is that the identical unconditional
wage distributions for each subset can only be reconciled at the true values of the non-pecuniary
components of utility for each population subset.
Estimation of this model follows directly from the identification proof. As we show
below, it is possible to write a system of equations based on the observed conditional wage
distributions that must equal zero identically at the true values of the non-pecuniary parameters
for each population subset. These equations serve as natural moments for a minimum distance
estimator.
These results add to a sparse literature that has studied the nonparametric identification of
a generalized Roy model with many alternatives and non-pecuniary components of utility. Dahl
(2001) proposes a multinomial version of the estimator developed in the binomial context by Ahn
and Powell (1994). His extension relies on the key assumption that a non-parametric selection
correction term can be based on the first-best choice probability.

This assumption is not,

however, based on a model of utility maximizing behavior. Other work has examined spatial

4

sorting behavior based on wages and non-pecuniary benefits.

Falaris (1987) and Davies,

Greenwood, and Li (2001) study the determinants of migration decisions in Venezuela and the
US, respectively.

Falaris applies Lee’s (1983) generalized polychotomous choice model to

control for non-random selection bias in conditional wage distributions, while Davies,
Greenwood, and Li essentially ignore it. The entire literature on wage-hedonics, beginning with
Roback (1982), has similarly ignored this problem. In those papers, wage and housing price
gradients across cities are used to back-out the value of urban amenities. Wage distributions
conditional on non-random selection into cities are typically used to calculate the first of these
gradients, leading to biased estimates.
We conclude this paper by applying our estimator to US Census data to study the effect
of spatial sorting on returns to a college education, addressing the same question as Dahl (2001).
College graduates are more likely to migrate than are high-school graduates, meaning that the
bias in their conditional wage distributions induced by Roy sorting will be greater. Controlling
for this bias for both high-school and college graduates, we find that the estimated returns to a
college education at the median fall from 42% to only 18%.
The remainder of the paper is organized as follows. Section 2 introduces the generalized
Roy model, proves identification for the case in which wage distributions are assumed to have a
finite lower support, and develops a corresponding estimator. Section 3 proves identification
under the alternative assumptions of independence and commonality, and develops a
corresponding estimator. Section 4 outlines the asymptotic properties of our estimators, and
section 5 shows how each estimator performs in finite samples and under less-than-ideal data
circumstances. Section 6 uses the unbounded support estimator to recover an unbiased estimate
of the returns to a college education.

Section 7 concludes with a discussion of possible

extensions to this research.

5

2. Identification and Estimation – Finite Lower Support
We begin our analysis by describing the generalized Roy model and data environment
that we study. We then prove identification under two separate sets of assumptions. The first
case is characterized by the assumption that the distribution of the endogenously determined
payoffs (e.g., wages in a classic Roy model) has a finite lower support. In this case, our
estimation strategy is transparent and easily applied. Our second set of assumptions, described in
Section 3, is applicable in situations where a finite lower support cannot be assumed, or where the
minimum order statistic provides a noisy measure of the lower bound. In both cases, we first
prove identification with a simple model describing the sorting of individuals from a single origin
location into one of two destinations (k = 1, 2). We indicate the wage earned by individual i,
should he choose to settle in locations #1 and #2 as ω1,i and ω2,i, respectively. In contrast to the
classic Roy model, where sorting is simply across employment sectors and driven entirely by
pecuniary compensation, we model sorting in a geographic context where the individual’s
location decision depends in part on his wage draw in each location, but also on non-wage
determinants of utility specific to a particular location, which we label as “tastes”.6 Utility from
choosing to settle in location k is given by the sum of wages (ωk,i) and tastes (τk):

(1)

U k ,i = ω k , i + τ k

6

Tastes would certainly include natural amenities and local public goods associated with the destination
location. In addition, they may include “migration costs”; i.e., costs specific to someone moving from a
particular origin to a particular destination. In a narrow sense, these costs would be comprised of relocation expenditures. In broader terms, these costs would likely involve the psychological costs of living
far from one’s birth location. 2000 Census data indicate that a majority of US household heads live in the
narrowly defined region in which they were born. [Bayer, Keohane, and Timmins (2007)]

6

Without loss of generality, we normalize τ1 = 0.7 The goal of our exercise is to recover estimates
of τ2, f1(ω1), and f2(ω2) (i.e., the taste parameter associated with location #2 and the unconditional
wage distributions in each location). The difficulty arises from the fact that we only see (i) wage
distributions conditional upon optimal sorting behavior, and (ii) an indicator of which location an
individual chooses.

2.1 Identification of Tastes Based on a Finite Lower Support
Our first approach uses only the conditional wage distributions and an indicator of
location choice to recover τ2, f1(ω1), and f2(ω2) according to the following argument based on
minimum order statistics. For an individual i, we only observe ω2,i if:

(2)

ω 2,i + τ 2 ≥ ω1,i

and we only observe ω1,i if:

(3)

ω 2,i + τ 2 < ω1,i

Denote the smallest wage (i.e., the minimum order statistic) that we observe from someone
choosing to settle in location #1 or #2 by w1 and w 2 , respectively. Assuming that f1(ω1) and
f2(ω2) have finite lower points of supports (denoted by ω1* and ω 2* , respectively), we know that
the smallest value of ω1 that we could ever see given that individuals maximize utility:

7

As in all random-utility frameworks, utility is only identified up to an additive constant. This requires
some sort of a normalization, which we use to eliminate one of the τ’s from the two-destination example.
In the more general N x N case, we estimate (N-1) τ’s for each of the N origins.

7

(4)

w1 = ω1*

if

ω1* > ω 2* + τ 2

w1 = ω 2* + τ 2

if

ω1* ≤ ω 2* + τ 2

Similarly, the smallest value of ω2 that we could ever see would be:

(5)

w 2 = ω 2*

if

ω1* ≤ ω 2* + τ 2

w 2 = ω1* − τ 2

if

ω1* > ω 2* + τ 2

In order to make sense of (4) and (5), define the following two cases:

(6)

A : ω1* > ω 2* + τ 2
B : ω1* ≤ ω 2* + τ 2

We are not able to tell whether case A or B prevails in the data without recovering an estimate of
τ2. Conveniently, we are able to recover an estimate of τ2 in either case. In particular:

(7)

τ 2 = w1 − w 2

Equation (7) therefore describes our first estimator of τ2 in the simplest 1 x 2 case. The same
logic

extends

easily

to

any

number

of

potential

destinations

τ k = w1 − w k , k = 1, 2, ..., K ). Begin by defining the following indicator variables:

(8)

d 1,i = I [ω1,i > max (ω 2,i + τ 2 , ω 3,i + τ 3 , ..., ω K ,i + τ K )]

(9)

d j ,i = I ω j ,i + τ j > max (ω1,i , ..., ω j −1,i + τ j −1 , ω j +1,i + τ j +1 , ..., ω K ,i + τ K )

[

]

8

(i.e.,

where we continue to normalize τ 1 = 0 . The observed wage of individual i is defined by:

K

(10)

wi = ∑ ω k ,i d k ,i
k =1

We next define the following indicator variables, which refer to the finite lower bounds in each
location:

(11)

δ 1 = I [ω1* > max(ω 2* + τ 2 , ω 3* + τ 3 , ..., ω K* + τ K )]

(12)

δ k = I [ω k* + τ k > max(ω1* , ..., ω k*−1 + τ k −1 , ω k*+1 + τ k +1 , ..., ω K* + τ K )]

We then proceed by evaluating the minimum order statistic for an individual choosing to settle in
location #1:

K

(13)

w1 = min(wi | d 1,i = 1) = ω1*δ 1 + ∑ (ω k* + τ k ) δ k
k =2

and in each location j > 1 :

K

(14)

w j = min( wi | d 1,i = j ) = ω *j δ j + ∑ (ω k* + τ k − τ j ) δ k
k =1
k≠ j

By simple inspection, one can see that τ k = w1 − w k , ∀ k = 1, 2, ..., K .

9

2.2 Identification of f1(ω1) and f2(ω2) with Kaplan-Meier
Having recovered an estimate of τ2, it is a simple matter to recover f1(ω1) and f2(ω2) by
employing a variation of the Kaplan-Meier (1958) procedure typically used in competing-risks
models under independence assumptions.8

The Kaplan-Meier can be interpreted as a

nonparametric maximum likelihood estimator of a censored distribution, and has been proven be
asymptotically normally distributed- see, e.g. Gill(1980).
Our variation will be to apply the Kaplan Meier procedure to draws from ω1+τ1, where τ1
can be estimated using the proposed procedure. In particular, we estimate f1(ω1) by first creating
a new data vector which corresponds to only those values of utilities (i.e., ω1 + τ1) that are
“uncensored” for destination #1 (i.e., observed for individuals who optimally chose destination
#1). Note that, because we were able to recover tastes with equation (7), we can treat utility (i.e.,
the sum of wages and tastes) as observed for the remainder of the exercise – our only goal is to
recover its unconditional distribution, from which we can recover the unconditional distribution
of wages. This vector of utilities will be of smaller dimension than the vector of all utilities,
which includes draws for individuals who chose destination #1 or destination #2.
To implement the Kaplan Meier procedure, we can simply use standard software
packages such as Stata. The resulting value of S is the Kaplan-Meier estimate of the c.d.f. of U2 at
x. In the final step, we simply deduct our estimate of τ2 from utility U2 at each point in the
support of its distribution. The resulting distribution is a non-parametric representation of f2(ω2).
We then repeat this process in order to recover f1(ω1), recalling that τ1 had been normalized to
zero.
Note that a portion of the unconditional distribution for one of these two locations will
necessarily be censored. Suppose we are in case A, where ω1* is large relative to ω 2* + τ2. We
are therefore able to observe the complete distribution f1(ω1), beginning with w1 = ω1* . We are,
8

As we mentioned previously, an alternative approach in this stage would be to relax independence and
apply the Petersen (1976) bounds to the transformed data to bound the unconditional distributions.

10

however, unable to observe f2(ω2) to the left of w 2 = ω1* − τ 2 > ω 2* . While we are unable to
determine the shape of the distribution f2(ω2) between ω 2* and w 2 in the above case, we are able
to bound from above the value of ω 2* (i.e., the lower point of support for the censored
distribution). In particular, knowing that ω1* = w1 , we know that ω 2* < w1 − τ 2 . We are unable
to determine more about the shape of the distribution f2(ω2) between ω 2* and w 2 without
resorting to parametric assumptions.

3. Identification and Estimation – Unbounded Support
While clean and transparent, there are two practical problems with the technique outlined
in Section 2. First, the payoff variable in question may not naturally have a finite lower support
(e.g., theory might dictate using the natural log of wages in the utility function). Second, the
minimum order statistic can be a very noisy statistic.9 Unless one has tremendous confidence in
the estimate of the minimum order statistic, that noise will be translated directly through to the
estimates of the taste parameters and, subsequently, on to the Kaplan-Meier estimates.
As an alternative, we propose in this section an estimator that employs data from the full
distribution of conditional wages. Importantly, this approach is valid for an unbounded support.10
With that flexibility, however, comes the need for an additional identification assumption. In
particular, we begin by showing that, without an additional assumption, τ2, f1(ω1), and f2(ω2) are
not identified.

This negative proof, however, reveals just how easily identification can be

achieved by exploiting the assumption of “commonality” described in Section 3.2.

9

For example, the bottom 2-3% of wage observations in the US Census data used for our empirical
application in Section 7 are implausibly low (i.e., less than 50¢ per hour).
10
In practice, this means that poorly measured data in the lower tail of the wage distribution will not have a
significant impact on the estimation algorithm, whereas it can have severe effects on the minimum order
statistic approach.

11

3.1 Non-Identification in the 1 x 2 Case
We begin with a simple model of individuals sorting over two locations, indexed by 1 and 2.
We assume for simplicity that the individuals are from location 1, and we therefore normalize
their taste for staying there to zero (τ1 = 0). Our interest is in recovering estimates of τ2, f1(ω1),
and f2(ω2).
We define a variable di, which functions as an indicator that individual i remained in his
origin location:

(15)

d i = I [ω1,i > ω 2,i + τ 2 ]

Using this indicator, we can write down an expression for individual i’s observed wage:

(16)

wi = d i ω1,i + (1 − d i )ω 2,i

i.e., the individual receives his draw from location #1 if it was utility maximizing to stay there.
Next, define the following joint probability distributions, both of which are easily observed in the
data:

(17)

Ψ1 (t ) = P (d i = 1, wi ≤ t )

Ψ2 (t ) = P (d i = 0, wi ≤ t )

We will also work with the derivatives of these expressions, which we denote by:

(18)

ψ 1 (t ) =

∂
P (d i = 1, wi ≤ t )
∂t

ψ 2 (t ) =

12

∂
P (d i = 0, wi ≤ t )
∂t

Assuming independent wage draws, we can re-write Ψ1(t) as:

Ψ1 (t ) = P (d i = 1, wi ≤ t )
(19)

= P (ω1,i > ω 2,i + τ 2 , ω1,i ≤ t ) =
ω1 −τ 2

t

∫

=

P (ω1,i − τ 2 > ω 2,i , ω1,i ≤ t )

∫

f1 (ω1 )dω1

−∞

t

f 2 (ω 2 ) dω 2

=

−∞

∫ f (ω ) F (ω
1

1

2

1

− τ 2 ) dω1

−∞

This means that we can define ψ1(t) as follows:

(20)

∂
ψ 1 (t ) =
∂t

t

∫ f (ω ) F (ω
1

1

2

1

− τ 2 ) dω1 = f 1 (t ) F2 (t − τ 2 )

−∞

An analogous argument defines ψ2(t):

(21)

∂
∂t

ψ 2 (t ) =

t

∫f

2

(ω 2 ) F1 (ω 2 + τ 2 ) dω 2 = f 2 (t ) F1 (t + τ 2 )

−∞

Going back to the final integral in equation (19) and carrying out integration-by-parts yields:

t

(22)

Ψ1 (t ) =

∫ f (ω ) F (ω
1

1

2

1

t

− τ 2 )dω1 = F1 (t ) F2 (t − τ 2 ) −

−∞

∫ F (s) f
1

−∞

Performing a change of variables u = s − τ 2 , equation (22) becomes:

13

2

( s − τ 2 )ds

t −τ 2

(23)

∫ F (u + τ

Ψ1 (t ) = F1 (t ) F2 (t − τ 2 ) −

1

2

) f 2 (u )du

−∞

Next, we use the expressions for ψ1(t) and ψ2(t) defined in (20) and (21) to re-write equation (23)
as follows:

(24)

F (t )ψ 1 (t )
Ψ1 (t ) = 1
−
f 1 (t )

t −τ 2

∫ψ

2

(u )du

−∞

Noting that the second integral in (24) is simply Ψ2 (t − τ 2 ) , we can solve for the distribution of
ω1 as a function of τ2:

(25)

λ1 (t ) =

f 1 (t )
ψ 1 (t )
=
F1 (t ) Ψ1 (t ) + Ψ2 (t − τ 2 )

where λ1(t) is a function of the unconditional wage distribution in location #1. (25) is a single
equation in two unknowns (λ1(t) and τ2) for a particular value of t, and it is therefore not
surprising that we cannot identify both of these values without making an additional assumption.
One solution would involve making a parametric assumption about F1(t). For example, assuming
F1(t) ~ N(µ1, σ12) would reduce the equation to three parameters. The number of parameters
would not increase, however, as one considered the expression evaluated at different values of t.
By forcing the equation to hold for many values of t, we would have more equations than
unknowns and could identify the model’s parameters.
In the following section, we show how the assumption of commonality can be used to
non-parametrically recover λ1(t) and τ2 .

14

3.2 Identification via Commonality in the 2 x 2 Case
Consider now the case of individuals born into one of two locations (again indexed by 1 and
2), who decide where to reside based on the maximization of utility. This introduces the need for
additional notation – we use a superscript to indicate origin location and a subscript to indicate
destination location.
The dummy variable indicating that an individual originating in location #1 chooses to stay
in that location is given by:

(26)

d i1 = I [ω11,i > ω 21,i + τ 21 ]

while the indicator that an individual originating in location #2 chooses not to migrate is given
by:

(27)

d i2 = I [ω 22,i > ω12,i + τ 12 ]

As before, we normalize the taste parameter for those choosing not to migrate to zero (i.e.,

τ 11 = τ 22 = 0 ). With these indicators, we can now write the expression for the observed wage of
an individual i who originates in location #1:

(28)

wi1 = d i1ω11,i + (1 − d i1 )ω 21,i

Based on these definitions for d and w, we define the following expressions analogously to the
previous sub-section:

15

(29)

Ψ11 (t ) = P(d i1 = 1, wi1 ≤ t )

Ψ21 (t ) = P(d i1 = 0, wi1 ≤ t )

Ψ12 (t ) = P(d i2 = 0, wi2 ≤ t )

Ψ22 (t ) = P(d i2 = 1, wi2 ≤ t )

Continuing in a manner similar to the previous sub-section, we can use equation (29) to derive the
following four expressions:

(30)

f11 (t )
ψ 11 (t )
λ (t ) = 1 = 1
F1 (t ) Ψ1 (t ) + Ψ21 (t − τ 21 )

(31)

λ12 (t ) =

f 21 (t )
ψ 21 (t )
=
F21 (t ) Ψ21 (t ) + Ψ11 (t + τ 21 )

(32)

λ12 (t ) =

f 12 (t )
ψ 12 (t )
=
F12 (t ) Ψ12 (t ) + Ψ22 (t + τ 12 )

(33)

λ22 (t ) =

f 22 (t )
ψ 22 (t )
=
F22 (t ) Ψ22 (t ) + Ψ12 (t − τ 12 )

1
1

By itself, the expansion of the 1 x 2 case to the 2 x 2 case does nothing to help with identification.
It does, however, allow us to introduce an additional assumption – commonality. Under the
assumption of commonality, λ11 (t ) = λ12 (t ) and λ12 (t ) = λ22 (t ) ∀ t . Under this assumption, we
can re-write equations (30)-(33) as the following two equations:

(34)

λ11 (t ) =

(35)

λ12 (t ) =

ψ 11 (t )
1
1

1
2

1
2

Ψ (t ) + Ψ (t − τ )

ψ 21 (t )
1
2

1
1

1
2

Ψ (t ) + Ψ (t + τ )

=

=

ψ 12 (t )
2
1

2
2

2
1

Ψ (t ) + Ψ (t + τ )

ψ 22 (t )
2
2

2
1

2
1

Ψ (t ) + Ψ (t − τ )

16

= λ12 (t )

= λ22 (t )

Estimation proceeds by forming minimum distance criterion functions based on equations (34)
and (35):

(36)

λ11 (t ; τ 21 ) − λ12 (t ; τ 12 ) = 0

(37)

λ12 (t ; τ 21 ) − λ22 (t ; τ 12 ) = 0

and then relying on the properties of M-estimators to recover τ 21 and τ 12 . [Davidson and
MacKinnon (1993)] We then use these taste parameters along with a Kaplan-Meier procedure to
recover estimates of f 1 (ω1 ) and f 2 (ω 2 ) as described in Section 2.2.
We now provide sufficient conditions for identification and estimation of the taste
parameters in the 2 x 2 setting with commonality. We begin by rearranging the expressions (34)
and (35):

(38)

Ψ21 (t − τ 21 )ψ 12 (t ) − ψ 11 (t ) Ψ22 (t + τ 12 ) = Ψ12 (t )ψ 11 (t ) − Ψ11 (t )ψ 12 (t ) = H (t )

(39)

Ψ11 (t + τ 21 )ψ 22 (t ) − ψ 21 (t ) Ψ12 (t − τ 12 ) = Ψ22 (t )ψ 21 (t ) − Ψ21 (t )ψ 22 (t ) = J (t )

Note that the right-hand-side of each of these expressions is an observable function of the data for
a particular value of t. Our identification result begins with the following lemma:

17

Lemma 1: At the true parameter values ( τ 21 *, τ 12 * ), we have

(Ψ (t − τ
1
2

1
2

)

2

*)ψ 12 (t ) − ψ 11 (t )Ψ22 (t + τ 12 *) − H (t )

+

(40)

(Ψ (t + τ
1
1

1
2

*)ψ 22 (t ) − ψ 21 (t )Ψ12 (t − τ 12 *) − J (t )

)

2

=0

∀ t ∈ ℜ in the intersection of the supports of ψ 11 (t ) , ψ 21 (t ) , ψ 12 (t ) , and ψ 22 (t ) .

This is simply a re-statement of our minimum distance criterion function described above. We
will now show that, for each set of values of the taste parameters different from ( τ 21 *, τ 12 * ),
denoted by ( τ~21 , τ~12 ), we must have:

(Ψ

1
2

(t − τ~21 )ψ 12 (t ) − ψ 11 (t ) Ψ22 (t + τ~12 ) − H (t )

)

2

+

(41)

(Ψ (t + τ~ )ψ
1
1

1
2

2
2

(t ) − ψ 21 (t ) Ψ12 (t − τ~12 ) − J (t )

)

2

>0

for some t ∈ ℜ in the intersection of the supports of ψ 11 (t ) , ψ 21 (t ) , ψ 12 (t ) , and ψ 22 (t ) . To
prove this result, first note that if τ~21 = τ 21 * , then only τ~12 = τ 12 * will make equation (40) hold,
by the monotonicity of the conditional c.d.f.’s that make-up that expression.

By a similar

argument, if τ~12 = τ 12 * , then τ~21 = τ 21 * in order for equation (40) to hold. Therefore, we need
only consider the case in which τ~21 ≠ τ 21 * and τ~12 ≠ τ 12 * . I.e., is it possible that an imposter
pair ( τ~21 , τ~12 ) could satisfy equation (40)?
Consider the following condition which we argue will be sufficient to rule out this
possibility:

18

(42)

ψ 21 (t − τ 21 *)ψ 12 (t )ψ 21 (t )ψ 12 (t − τ 12 *) ≠ ψ 11 (t + τ 21 *)ψ 22 (t )ψ 11 (t )ψ 22 (t + τ 12 *)

for some t ∈ ℜ in the intersection of the supports of ψ 11 (t ) , ψ 21 (t ) , ψ 12 (t ) , and ψ 22 (t ) . This
condition has a simple interpretation – i.e., that the Jacobian matrix associated with equations
(38) and (39) is non-singular. There are situations in which this condition will not hold; for
example, when the two conditional wage distributions are identical and τ 21 = -τ 12 .11 We consider
this to be a pathological case.
To establish the sufficiency of the above condition for identification, consider a local
linearization of equations (38) and (39) around the true values of τ 21 and τ 12 and evaluated at t.
For any pair of perturbations, ∆12 and ∆21 , we require the net effect on the left-hand-side of each
equation to be zero (since H(t) and J(t) are functions of only t).

(43)

ψ 21 (t − τ 21 *)ψ 12 (t ) ∆12 + ψ 11 (t )ψ 22 (t + τ 12 *) ∆21 = 0

(44)

ψ 11 (t + τ 21 *)ψ 22 (t ) ∆12 − ψ 21 (t )ψ 12 (t − τ 12 *) ∆21 = 0

If condition (42) holds, then the only solution to these expressions is given by ∆12 = ∆21 = 0,
implying that no imposter values of ( τ~21 , τ~12 ) could satisfy the system. Of course, we do not
know the value(s) of t where equation (42) holds, requiring that we evaluate our minimum
distance estimator at all available values of t. In doing so, we are restricted to only using values
of t ∈ ℜ in the intersection of the supports of ψ 11 (t ) , ψ 21 (t ) , ψ 12 (t ) , and ψ 22 (t ) . Without any
overlap, this identification strategy is not applicable.

11

This would be the case if we took a single location and arbitrarily divided it into two locations with the
exact same wage distributions and amenities. This condition therefore places a practical constraint on the
level of geographic precision at which we can apply our estimator – i.e., at the level at which we can
observe different spatial wage distributions.

19

4. Asymptotics
Having described two identification strategies for both the taste parameters and
unconditional wage distributions, we now outline the arguments that will be used in developing
the asymptotic properties of our proposed estimators.

We begin with a discussion of our

minimum order statistic estimator. In practice, we simply replace population extreme quantiles in
the identification argument with sample minimum order statistics. Asymptotic properties of
minimum or maximum order statistics have been studied in recent work by Porter and Hirano
(2003). Chernozhukov and Hong (2004) obtain similar results. As a preliminary step, we
establish the rate of convergence of the estimator. The result is based on the following regularity
conditions:

A1
A2
A3
A4

The K+1 vectors of observed wage and choice indicators (wi, dk,i) are i.i.d. across
individuals.
The unconditional wage distributions for alternatives k = 1, 2, …, K are continuously
distributed with positive density on [ℓk, ∞).
mink=1,2,…K ℓk > -∞
mink=1,2,…K P(dk,i = 1) > 0

Theorem 0.1

(45)

Under Assumptions A1-A4, we have

τˆk − τ k = O p (n −1 )

A proof that our estimator attains this rate of convergence under Assumption A2 follows from
arguments similar to those used in van der Vaart (1998), Section 21.4.
Turning attention to the second stage estimator of the unconditional wage distributions,
we proposed applying Kaplan-Meier to yield a consistent estimator of the distribution of ωk,i+τk.
We note the first stage estimator, which was shown to be “super-consistent”, will have no effect

20

on the limiting distribution of the second stage estimator. The next theorem establishes the
limiting distribution of this estimator.

Theorem 0.2 Under Assumptions A1-A4, our second stage estimator of the unconditional wage
distribution has the following linear representation. Let π(t) = P(ωk,i ≤ t) and define the set
Ω = {t : π (t ) < 1} . Then for any t ∈ Ω ,
(46)

n ( Fˆω k ,i +τ k (⋅) − Fω k ,i +τ k (⋅)) ⇒ Fω k ,i +τ k (⋅)W (ϕ (⋅))
∞

∫

where W is Brownian motion, and ϕ (t ) = π −1 ( s )ds .
t

A proof of the above theorem can be found by using the same arguments as in Fleming and
Harrington (1991). We omit the details here.
We now turn our attention to the asymptotic properties of the unbounded support
estimator. To illustrate the basic arguments involved, we will focus on the two-region setting.
Our estimator of the taste parameter vector, τˆ = (τˆ21 , τˆ12 ) , is obtained by minimizing the
minimum distance objective function:

(47)

τˆ = arg min
τ

1 n
∑ Q(τ , t i )
n i =1

The asymptotic properties of our unbounded support estimator are based on the following
assumptions:

B1

The K+1 vectors of observed wage and choice indicators (wi, d kj, i ) are i.i.d. across

B2
B3

individuals.
The true vector τ0 lies in the interior of a compact parameter space.
The functions ψ ml (⋅) , l, m = 1, 2 are assumed to be uniformly bounded and twice
continuously differentiable, with uniformly bounded first and second derivatives.

21

B4

The kernel function K (⋅) used to approximate ψ ml (⋅) has bounded support, integrates to
one, and has mean zero.

B5

The bandwidth h associated with kernel function K (⋅) satisfies
nh → ∞ .

Theorem 0.3

(48)

n h 2 → 0 and

Under Assumptions B1-B4,

p
τˆ 
→
τ0

The proof of the above result can be shown by establishing the four sufficient conditions in
Theorem 2.1 in Newey and McFadden (1994), which can be characterized as compactness,
identification, uniform convergence, and continuity.
Furthermore, by Newey and McFadden (1994) Theorem 8.11, we can establish the
parametric rate of convergence as well as the asymptotic normality of our estimator. The
parametric rate is attainable despite the nonparametric rate of convergence achieved by some
components because the parameter of interest ( τ 0 ) is a smooth functional of the nonparametric
components. Our next theorem is based on the following assumptions:

B7

The functions ψ ml l , m = 1, 2 are assumed to be uniformly bounded and p times
continuously differentiable, with uniformly bounded pth order derivatives.
The kernel function K integrates to one, has mean zero, and is of pth order.

B8

The bandwidth h associated with the kernel function satisfies

B6

n h p → 0 and nh → ∞ .

The following theorem establishes the root-n consistency and asymptotic normality of our
estimator. Its proof is omitted as it follows from the same arguments used in proving Theorem
8.11 in Newey and McFadden (1994).

22

Theorem 0.4
(49)

Under Assumptions B1, B2, B4-B8,

n (τ − τ 0 ) ⇒ N (0, Ω x )

Where Ω x > 0 .

Remark 1

The exact form of Ω x is complicated, as it involves higher order derivates of the

functions ψ ml . Consequently, for inference on τ 0 in our application, we employ sampling
methods to avoid using further nonparametric methods.

Remark 2

Note that, in this case, the first stage estimator converges at the parametric rate,

and consequently will affect the limiting distribution of the second stage estimator. While the
precise effect on the limiting distribution can be derived using arguments similar to those used by
Newey and McFadden (1994) Section 8, we omit the details here.

5. Monte Carlo Results
In this section, we use Monte Carlo experiments to describe the properties of both
estimators in small samples and with less-than-ideal data. We consider a simple setting with just
three locations that serve as both origins and destinations, and we model the sorting decisions of
individuals who care about both pecuniary returns (i.e., wages) and non-pecuniary factors (i.e.,
migration costs and amenities) in deciding where to live. In each experiment, we consider some
number of identical individuals (N) originating in each location, and we use their simulated
behavior to recover the matrix of taste parameters:

23

(50)

τ 11 τ 21 τ 31 
− 0 .5 − 0 .2 
 0
 2

2
2
0
− 0.6
τ 1 τ 2 τ 3  = − 0.4
τ 13 τ 23 τ 33 
 − 0.3 − 0.1
0 



For the sake of simplicity in exposition, we focus our attention on the performance of the
estimators in recovering these taste parameters.

Unconditional wage distributions in each

location could be recovered by applying the Kaplan-Meier technique described in section 2.2 for
each set of Monte Carlo estimates.
We begin by looking at the minimum order statistic estimator. The results of nine Monte
Carlo experiments are described in Table 1.

The first three experiments use the baseline

framework in which wages are random variables determined by the following (j denotes origin
location):

ω1j = x 2 + 2.25
(51)

ω 2j = x 2 + 1.75

x ~ N (0, 12 )

j = 1, 2, 3

ω 3j = x 2 + 2.75

Columns describe the various taste parameter estimates, while rows summarize the mean,
standard deviation, and mean squared error of 500 Monte Carlo simulations for each experiment.
With an increasing number of individuals in each origin location, the minimum order
statistic becomes a better measure of the true lower bound on wages in a particular location, and
our estimates of the taste parameters improve accordingly. This is evident in the declining MSE
as N increases from 1,000 to 10,000 to 50,000 for each parameter. Even with as few as 1,000
observations, however, taste parameter estimates based on the minimum order statistic are quite
precise.

24

The fourth and fifth experiments in Table 1 relax the assumption of a finite lower bound
for the unconditional wage distribution. In particular,

f (ω1j ) ~ N (2.25, 0.5)
(52)

f (ω 3j ) ~ N (1.75, 0.5)

j = 1, 2, 3

j
3

f (ω ) ~ N (2.75, 0.5)

The impact of this model mis-specification is evident in an increase in the MSE by a factor of 100
to 10,000, depending upon the parameter. Conditional upon this mis-specification, however,
MSE’s still fall as N increases from 10,000 to 50,000.
The sixth and seventh experiments address an important concern with our minimum order
statistic estimator – measurement error. Because the estimator relies on a single value of wages
for each origin and destination combination, it could become severely biased if that value were
mis-measured. In these experiments, we return to the same wage distributions used in the first
three experiments (i.e., assuming a finite lower bound), but we add to each wage an i.i.d.
normally distributed random variable with zero mean and variance equal to 0.25. This has a
significant impact on the precision of our estimates, raising the MSE’s associated with our taste
parameters by nearly as much as the absence of a finite lower bound. In contrast to that model
mis-specification, however, this is primarily the result of an increase in the bias of our estimator,
as opposed to its standard deviation.
In the eighth and ninth experiments, we demonstrate a desirable feature of the minimum
order statistic estimator – the fact that it is robust to arbitrary forms of correlation in wage draws.
Using the same wage distributions as in our baseline specifications, we assume a correlation of
0.25 between wage draws in all locations. As is evident from the table, taste parameter estimates
are virtually identical to the baseline case.

25

Table 2 describes the results of nine Monte Carlo experiments that similarly illustrate the
properties of our unbounded support estimator. Using the same matrix of taste parameters, we
assume in our baseline experiment that wages are drawn from the same distributions as described
in equation (52). The first three experiments demonstrate the effect of increasing the number of
individuals originating from each location (N) from 1,000 to 50,000.

MSE’s of all taste

parameter estimates fall with an increase in the sample size. In general, however, results are not
as precise as under the (properly specified) minimum order statistic estimator (conditional upon
N).
In the next two experiments, we show the implications of violating our key identifying
assumption – commonality. In particular, we allow non-migrants to receive a higher wage on
average than individuals migrating into their birth location (i.e., a “home advantage” in the labor
market).

(53)

f (ω11 ) ~ N (2.5, 0.5)

f (ω1j ) ~ N (2.25, 0.5)

if

j = 2, 3

f (ω 3j ) ~ N (1.75, 0.5)

if

j = 1, 3

otherwise

f (ω 22 ) ~ N (2, 0.5)

f (ω 3j ) ~ N (2.75, 0.5)

if

j = 1, 2

otherwise

f (ω 33 ) ~ N (3, 0.5)

otherwise

We assume, moreover, that the researcher properly identifies this home advantage and uses only
moments formed between pairs of migrant groups (e.g., migrants from locations #2 and #3 living
in location #1) in forming our minimum distance objective function. Not surprisingly, with this
limited set of moments the model does not perform as well as in the baseline specification. It
does, however, do a reasonable job of estimating all parameters (even with only 10,000
observations per origin location). When N is set equal to 50,000, the estimates become quite
precise, indicating that our estimation strategy is indeed valid under situations of “limited
commonality”.

26

The sixth and seventh experiments describe what happens when another key assumption
used in the derivation of the unbounded support estimator – independence – is violated. Recall
that, in the derivation of equation (19), we assumed individuals received draws from independent
wage distributions. Here, we assume that wage draws exhibit a positive correlation (0.25) across
locations. MSE’s for all taste parameters rise dramatically, highlighting this as an important
shortcoming of our estimation strategy. In current research, we are exploring how correlation
might be better handled using panel data. With only cross-sectional data, these results highlight
the importance of controlling for as many forms of observable heterogeneity as possible (i.e.,
wages may be systematically higher for certain groups – the estimation algorithm should be run
separately for them). Our final set of experiments describe the effect of measurement error on
our unbounded support estimator. As was the case for the minimum support estimator, we simply
add to each wage an i.i.d. normal measurement error with mean zero and variance 0.25. In
contrast to the minimum order statistic estimator, however, the results of the unbounded support
estimator are affected very little.
In summary, Monte Carlo simulations suggest that our minimum order statistic estimator
performs extremely well when properly specified. It is, moreover, robust to arbitrary forms of
correlation in an individual’s wage draws, but it performs very poorly when wages are observed
with error or when they are drawn from a distribution without a finite lower bound. These
failures motivate our derivation of the unbounded support estimator. When properly specified,
experiments show that it also performs well. Moreover, its performance is not adversely affected
by measurement error in wages or by limited commonality (if the researcher properly recognizes
this in forming the minimum distance objective function). In contrast to the minimum order
statistic estimator, however, it performs poorly when wage draws are correlated across locations
(motivating our current work with panel data).

27

6. Empirical Application: Measuring the Returns to College Education
In order to demonstrate the performance of our estimator in an empirical setting, we
examine a question similar to that posed by Dahl (2001) – i.e., what are the returns to a college
education (relative to graduating from high school) before and after controlling for the nonrandom spatial sorting of workers across the United States? The results of the basic Roy model
(1951) suggest that sorting shifts the means of the (observed) conditional wage distributions up
from their (unobserved) unconditional values. Whether spatial sorting increases or reduces the
estimated returns to a college education will depend upon whether this shift is proportionally
bigger for high school or college educated individuals.

If, for example, college educated

individuals were more mobile and, hence, more able to migrate in response to favorable
idiosyncratic wage draws, we would expect spatial sorting to create an upward bias in the
estimated returns to a college education. Whether or not this is the case (and how big is the
resulting bias) is an empirical question.
In order to answer that question, we use data extracted from the 2000 US Census 1%
microsample, available from the IPUMS (www.ipums.org). Specifically, we consider a sample
of 470,918 high school graduates taken from each of nine divisions of the United States used by
the Census Bureau, along with a corresponding sample of 429,584 college graduates.12 We use
only data describing male household heads.13 For each individual, we observe annual income
from wages and salary, the individual’s region of residence, and the individual’s region of birth.14

12

Regional Definitions: (1) New England (CT, ME, MA, NH, RI, VT), (2) Middle Atlantic (NJ, NY, PA),
(3) East North Central (IL, IN, MI, OH, WI), (4) West North Central (IA, KS, MN, MO,NE, SD, ND), (5)
South Atlantic (DE, DC, FL, GA, MD, NC, SC, VA, WV), (6) East South Central (AL, KY, MS, TN), (7)
West South Central (AR, LA, OK, TX), (8) Mountain (AZ, CO, ID, MT, NV, NM, UT), and (9) Pacific
(AK, CA, HI, OR, WA).
13
We use only household heads because we assume they are more likely to have made their own
geographic location decision, and we use only individuals less than 35 years of age as they are more likely
to have recently migrated. Older individuals may have migrated further in the past in response to different
wage or amenity distributions.
14
We drop any individuals reporting zero annual income, self-employed individuals, individuals not born
in the United States, and individuals who worked fewer than 45 weeks in the previous year. The US
Census describes both the individual’s birth state as well as the PUMA in which he/she was living five
years prior. We use birth state to define birth region, which becomes our measure of “origin location”, but

28

Tables 3 and 4 summarize the long-run migration probabilities observed in the data for high
school and college graduates, respectively, for each of four summary birth and destination
regions. In particular, each row indicates the birth region while each column indicates the region
in which the individual is observed in the 2000 Census. Each entry describes the fraction of
individuals originating in the row birth region who are found to be living in the column
destination region. 80.6% of high-school graduates born in New England are found to be living
in New England. The fraction of high school graduate “stayers” is similarly high for other
regions.15 For college graduates, a noticeably lower percentage remains tied to their respective
birth regions.
Because Census wage data, which are derived from self-reported income and hours
information, are quite noisy in the lower tail (see footnote 5), and because we see individuals
from multiple birth places, we opt for our unbounded support estimator. This estimator makes an
independence assumption and assumes that individuals from different birth regions will receive
wage draws from a common destination wage distribution. Note that, with different data, the
extreme quantile estimator (which only assumes that wage distributions have a finite lower
bound) might be used instead. Deleire and Timmins (2007) use this estimator, along with CPS
wage data, to recover an estimate of the value of a statistical life (VSL) controlling for Roy
sorting across occupations.
Tables 5 and 6 report the estimates of the taste parameters for high school and college
graduates, respectively. Results are measured in terms of the natural log of hourly wages,
standard errors are derived from the results of 750 bootrstrap simulations, and point estimates are
bias-corrected. A college graduate from the mid-Atlantic, for example, faces a statistically
significant cost of -0.622 per year in moving to the Pacific region. Considering the mean wage

a similar analysis could be performed using location five years prior as the “origin”, leading to a short-run
measure of mobility cost.
15
Note that the fraction of “stayers” would be smaller if we had used a finer geographic division (e.g.,
states), but would still constitute a clear plurality.

29

amongst all college graduates ($26.22), this amounts to a compensating variation of $22.62 per
hour. All off-diagonal taste parameters are negative and significant, revealing the tendency for
individuals of all levels of education to remain in their birth regions.
Next, we use these estimates to recover the unconditional income distributions for each
region and education group with the Kaplan-Meier procedure described in Section 2.2. Results
are reported in Figures 1 and 2. In every case, the unconditional wage distribution lies below the
observed distribution. Importantly, the correction for Roy sorting is generally larger for college
graduates, who are more prone to migrate from their birth regions. We record the medians and
75th percentiles of each of these distributions in Table 7. The median log-wage for a high-school
graduate from the South Atlantic, for example, falls from 2.63 to 2.55. Defining the returns to a
college education at the median to be the difference between the median of the college and highschool graduate log-wage distributions, we report those returns in Table 8.

Returns are

analogously defined at the 75th percentile. In every region, the returns to a college education fall
once we control for Roy sorting. On average, they fall from 42% to 18% at the median, and from
45% to 34% at the 75th percentile. These results suggest that observed wage distributions, which
are distorted by Roy sorting, seriously overstate the true returns to a college education,
particularly for those in the heart of the wage distribution.

7. Conclusion
This paper considers nonparametric identification and estimation of a generalized multisector Roy model which includes a non-pecuniary component of utility associated with each
alternative. Two identification results are established – one under a support condition and the
other under a commonality/independence assumption. Estimation procedures based on both
identification results are proposed, and their asymptotic properties are derived.

The latter

estimator is used to recover an estimate of the returns to a college education, controlling for
different migration rates of high-school and college graduates. The results suggest that an

30

estimate based on conditional distributions may overstate returns by more than a factor of two at
the median. An application of our extreme quantile estimator to sorting across occupations,
where individuals care about pecuniary returns and other job attributes (including fatality risk)
yields similarly stark results. The wage-hedonic estimate of the value of a statistical life rises by
a factor of three and becomes statistically significant. (Deleire and Timmins, 2007)
Our work here leaves many import areas for extensions and future research. In particular,
it would be useful to explore how the presence of covariates would aide in achieving
identification of our generalized Roy model, as has proven to be the case in the standard Roy
model (i.e., might they enable us to relax the independence assumption in the unbounded support
estimator). Furthermore, it would be useful to derive efficiency bounds for the non-pecuniary
parameters to see if more efficient estimators than those proposed here can be constructed.

References
Ahn, H. and J.L. Powell (1993). “Semiparametric Estimation of Censored Selection Models with
a Nonparametric Selection Mechanism.” Journal of Econometrics. 58:3-29.
Bayer, P., N. Keohane, and C. Timmins (2006). “Migration and Hedonic Valuation: The Case of
Air Quality.” NBER Working Paper 12106.
Borjas, George (1987). “Self-Selection and the Earnings of Immigrants.” American Economic
Review. 77:531-553.
Chernozhukov, V. and H. Hong (2004). “Likelihood Estimation and Inference in a Class of
Nonregular Econometric Models.” Econometrica. 72(5):1445-1480.
Dahl, Gordon (2001). “Mobility and the Return to Education: Testing a Roy Model with
Multiple Markets.” Econometrica. 70(6):2367-2420.
Davies, Greenwood and Li (2001). “A Conditional Logit Approach to U.S. State-to-State
Migration.” Journal of Regional Science. 41(2):337-360.
Falaris, Evangelos (1987). “A Nested Logit Migration Model with Selectivity.” International
Economic Review. 28:429-43.
Fleming, T.R. and D.P. Harrington (1991). Counting Processes and Survival Analysis. WileyInterscience.

31

Heckman, James (1990). “Varieties of Selection Bias.” American Economic Review. 80(2):31318.
Heckman, James and Bo Honore (1989). “The Identifiability of the Competing Risk Model.”
Biometrika. 76:325-30.
Heckman, James and Bo Honore (1990). “The Empirical Content of the Roy Model.”
Econometrica. 58:1121-49.
Honore, Bo and Andrea Lleras-Muney (2007). “Bounds in Competing Risks Models and the War
on Cancer” Econometrica. Forthcoming.
Kaplan, E.L. and P. Meier (1958). “Nonparametric Estimation from Incomplete Data.” Journal
of the American Statistical Association. 53:457-481.
Kennan, John and James Walker (2005). “The Effect of Expected Income on Individual
Migration Decisions.” NBER Working Paper 9585.
Khan, Shakeeb and Elie Tamer (2007). “Inference on Randomly Censored Regression Models
Using Conditional Moment Inequalities”. manuscript.
Lee, Simon (2006). “Identification of Competing Risks Model with Unknown Transformation of
Latent Failure Times”, Biometrika, 93:996-1002.
Newey, W.K. and D. McFadden (1994). “Estimation and Hypothesis Testing in Large Samples.”
In Engle, R.F. and D. McFadden (eds.), Handbook of Econometrics, Vol. 4. Amsterdam: NorthHolland.
Petersen, A.V. (1976). “Bounds for a Joint Distribution with Fixed Sub-Distribution Functions.”
Proceedings of the National Academy of Science. 73:11-13.
Porter, J. and K. Hirano (2003). “Asymptotic Efficiency in Parametric Structural Models with
Parameter Dependent Support.” Econometrica. 71(5):1307-1338.
Roback, Jennifer (1982).
Economy. 90:1257-78.

“Wages, Rents, and the Quality of Life.”

Journal of Political

Roy, A.D. (1951). “Some Thoughts on the Distribution of Earnings.” Oxford Economic Papers.
3:135-146.
van der Vaart, A.W. (1998). Asymptotic Statistics. Cambridge, U.K.: Cambridge University
Presss.

32

Table 1: Monte Carlo Simulations
Minimum Order Statistic Estimator

1

2

3

4

5

6

7

8

9

τ 21

τ 31

-0.5

-0.2

Mean
Std Dev
MSE

-0.542
0.031
0.003

Mean
Std Dev
MSE

-0.510
0.007
1.40 x 10-4

Mean
Std Dev
MSE

-0.503
0.002
1.79 x 10-5

Mean
Std Dev
MSE

-0.595
0.202
0.050

Mean
Std Dev
MSE

-0.569
0.193
0.042

Mean
Std Dev
MSE

-0.668
0.062
0.032

Mean
Std Dev
MSE

-0.660
0.050
0.028

Mean
Std Dev
MSE

-0.516
0.011
3.78 x 10-4

Mean
Std Dev
MSE

-0.506
0.004
4.83 x 10-5

τ 12

τ 32

-0.4
-0.6
Baseline (N = 1,000)
-0.203
-0.408
-0.610
0.002
0.006
0.007
-5
-4
1.28 x 10 1.03 x 10 1.53 x 10-4
Baseline (N = 10,000)
-0.201
-0.402
-0.602
-4
4.06 x 10
0.001
0.001
5.36 x 10-7 4.68 x 10-6 7.26 x 10-6
Baseline (N = 50,000)
-0.200
-0.400
-0.600
-4
-4
1.45 x 10 4.19 x 10 5.00 x 10-4
6.63 x 10-8 5.54 x 10-7 8.12 x 10-7
Unbounded Support (N = 10,000)
-0.173
-0.389
-0.564
0.212
0.204
0.198
0.046
0.042
0.040
Unbounded Support (N = 50,000)
-0.177
-0.383
-0.572
0.189
0.202
0.187
0.036
0.041
0.036
Measurement Error (N = 10,000)
-0.248
-0.502
-0.711
0.048
0.050
0.055
0.005
0.013
0.015
Measurement Error (N = 50,000)
-0.248
-0.491
-0.697
0.043
0.044
0.044
0.004
0.010
0.011
Correlated Wage Draws (N = 10,000)
-0.201
-0.402
-0.603
3.89 x 10-4
0.001
0.002
-7
-6
4.61 x 10 5.38 x 10 9.76 x 10-6
Correlated Wage Draws (N = 50,000)
-0.200
-0.401
-0.601
-4
-4
1.40 x 10 4.68 x 10 5.76 x 10-4
5.54 x 10-8 6.87 x 10-7 1.02 x 10-6

33

τ 13

τ 23

-0.3

-0.1

-0.316
0.011
3.63 x 10-4

-0.113
0.009
2.50 x 10-4

-0.303
0.002
1.71 x 10-5

-0.103
0.002
1.23 x 10-5

-0.301
7.70 x 10-4
2.02 x 10-6

-0.101
6.51 x 10-4
1.33 x 10-6

-0.350
0.215
0.048

-0.184
0.208
0.050

-0.354
0.183
0.036

-0.161
0.199
0.043

-0.439
0.057
0.023

-0.228
0.056
0.020

-0.430
0.046
0.019

-0.223
0.047
0.017

-0.305
0.003
2.96 x 10-5

-0.104
0.002
1.97 x 10-5

-0.302
0.001
3.41 x 10-6

-0.101
7.84 x 10-4
2.12 x 10-6

Table 2: Monte Carlo Simulations
Unbounded Support Estimator

1

2

3

4

5

6

7

8

9

τ 21

τ 31

-0.5

-0.2

Mean
Std Dev
MSE

-0.731
0.444
0.250

Mean
Std Dev
MSE

-0.620
0.079
0.021

Mean
Std Dev
MSE

-0.614
0.047
0.015

Mean
Std Dev
MSE

-0.576
0.163
0.032

Mean
Std Dev
MSE

-0.510
0.073
0.005

Mean
Std Dev
MSE

-1.362
0.487
0.980

Mean
Std Dev
MSE

-1.368
0.290
0.838

Mean
Std Dev
MSE

-0.643
0.077
0.026

Mean
Std Dev
MSE

-0.632
0.052
0.020

τ 12

τ 32

-0.4
-0.6
Baseline (N = 1,000)
-0.230
-0.441
-0.652
0.332
0.422
0.544
0.111
0.180
0.298
Baseline (N = 10,000)
-0.199
-0.390
-0.584
0.066
0.081
0.063
0.004
0.007
0.004
Baseline (N = 50,000)
-0.197
-0.381
-0.573
0.033
0.043
0.032
0.001
0.002
0.002
Home Advantage (N = 10,000)
0.175
-0.103
-0.218
0.415
0.347
0.460
0.313
0.208
0.358
Home Advantage (N = 50,000)
-0.101
-0.309
-0.426
0.204
0.156
0.157
0.078
0.032
0.055
Correlated Wage Draws (N = 10,000)
-0.441
-0.959
-1.367
0.322
0.625
1.032
0.162
0.702
1.652
Correlated Wage Draws (N = 50,000)
-0.419
-0.950
-1.268
0.057
0.155
0.107
0.051
0.327
0.458
Measurement Error (N = 10,000)
-0.206
-0.401
-0.601
0.068
0.083
0.066
0.005
0.007
0.004
Measurement Error (N = 50,000)
-0.202
-0.395
-0.592
0.035
0.046
0.034
0.001
0.002
0.001

34

τ 13

τ 23

-0.3

-0.1

-0.404
0.323
0.115

-0.173
0.156
0.029

-0.373
0.053
0.008

-0.171
0.057
0.008

-0.375
0.029
0.006

-0.181
0.042
0.008

-0.290
0.133
0.018

-0.303
0.269
0.114

-0.354
0.112
0.015

-0.193
0.128
0.025

-0.814
0.657
0.696

-0.356
0.176
0.096

-0.706
0.171
0.194

-0.421
0.135
0.121

-0.382
0.055
0.010

-0.176
0.060
0.009

-0.385
0.029
0.008

-0.187
0.042
0.009

Table 3: Mobility Matrix, High School Graduates
2000 US Census, 5% IPUMS Random Sample

Destination Region

Birth
Region

New
England
MidAtlantic
E North
Central
W North
Central
South
Atlantic
E South
Central
W South
Central
Mountain
Pacific

New
England
0.806

MidAtlantic
0.035

E North
Central
0.011

W North
Central
0.005

South
Atlantic
0.083

E South
Central
0.008

0.016

0.809

0.011

0.005

0.100

0.008

0.012

0.019

0.020

0.004

0.013

0.766

0.024

0.072

0.034

0.026

0.031

0.031

0.002

0.006

0.053

0.770

0.028

0.011

0.034

0.053

0.043

0.008

0.036

0.016

0.007

0.863

0.029

0.017

0.010

0.015

0.003

0.009

0.065

0.009

0.082

0.776

0.032

0.008

0.015

0.002

0.007

0.022

0.025

0.035

0.022

0.814

0.030

0.043

0.004

0.009

0.017

0.032

0.027

0.010

0.049

0.747

0.105

0.006

0.011

0.021

0.027

0.035

0.012

0.040

0.097

0.750

35

W South Mountain
Central
0.012
0.017

Pacific
0.024

Table 4: Mobility Matrix, College Graduates
2000 US Census, 5% IPUMS Random Sample

Destination Region

Birth
Region

New
England
MidAtlantic
E North
Central
W North
Central
South
Atlantic
E South
Central
W South
Central
Mountain
Pacific

New
England
0.619

MidAtlantic
0.073

E North
Central
0.033

W North
Central
0.012

South
Atlantic
0.129

E South
Central
0.012

0.060

0.546

0.053

0.012

0.182

0.014

0.030

0.035

0.070

0.017

0.033

0.600

0.040

0.112

0.028

0.043

0.051

0.077

0.010

0.020

0.091

0.537

0.074

0.018

0.075

0.085

0.090

0.020

0.049

0.046

0.014

0.709

0.043

0.043

0.028

0.049

0.009

0.019

0.068

0.017

0.189

0.560

0.076

0.024

0.038

0.008

0.016

0.032

0.028

0.078

0.032

0.696

0.047

0.064

0.012

0.021

0.037

0.040

0.062

0.014

0.074

0.562

0.179

0.014

0.021

0.032

0.022

0.061

0.012

0.042

0.091

0.706

36

W South Mountain
Central
0.024
0.029

Pacific
0.070

Table 5
Taste Parameter Estimates
High School Graduates

Destination Region

Birth
Region

New
England
MidAtlantic
E North
Central
W North
Central
South
Atlantic
E South
Central
W South
Central
Mountain
Pacific

New
England
0
-0.803
(0.06)
-1.036
(0.17)
-0.390
(0.05)
-0.847
(0.08)
-0.405
(0.04)
-0.763
(0.08)
-0.878
(0.15)
-0.710
(0.18)

MidAtlantic
-0.863
(0.05)
0
-0.895
(0.18)
-0.823
(0.07)
-0.742
(0.08)
-0.585
(0.04)
-1.231
(0.15)
-0.555
(0.05)
-0.804
(0.07)

E North
Central
-0.562
(0.05)
-0.877
(0.08)
0
-0.631
(0.06)
-0.727
(0.05)
-0.445
(0.06)
-0.682
(0.09)
-0.644
(0.05)
-0.550
(0.05)

W North
Central
-0.899
(0.15)
-1.092
(0.13)
-0.960
(0.12)
0
-1.069
(0.09)
-0.433
(0.03)
-1.009
(0.09)
-0.774
(0.10)
-0.806
(0.06)

37

South
Atlantic
-0.967
(0.06)
-0.902
(0.05)
-1.203
(0.08)
-1.119
(0.11)
0
-0.874
(0.07)
-1.108
(0.09)
-0.952
(0.07)
-0.775
(0.06)

E South
Central
-0.972
(0.10)
-0.988
(0.09)
-1.055
(0.08)
-0.830
(0.13)
-0.704
(0.06)
0
-0.969
(0.08)
-0.774
(0.11)
-0.994
(0.10)

W South Mountain
Central
-0.865
-0.686
(0.08)
(0.05)
-0.921
-0.324
(0.08)
(0.03)
-1.011
-0.685
(0.07)
(0.06)
-0.815
-0.788
(0.10)
(0.05)
-0.808
-0.801
(0.06)
(0.07)
-0.816
-0.995
(0.06)
(0.09)
0
-0.699
(0.07)
-0.859
0
(0.06)
-0.648
-0.305
(0.05)
(0.03)

Pacific
-0.948
(0.08)
-0.976
(0.09)
-1.211
(0.10)
-0.899
(0.09)
-0.528
(0.08)
-0.932
(0.17)
-1.075
(0.08)
-0.784
(0.05)
0

Table 6
Taste Parameter Estimates
College Graduates

Destination Region

Birth
Region

New
England
MidAtlantic
E North
Central
W North
Central
South
Atlantic
E South
Central
W South
Central
Mountain
Pacific

New
England
0
-0.614
(0.01)
-0.562
(0.02)
-0.475
(0.01)
-1.097
(0.02)
-1.129
(0.04)
-0.781
(0.02)
-1.106
(0.03)
-1.253
(0.05)

MidAtlantic
-0.745
(0.02)
0
-1.087
(0.03)
-0.672
(0.02)
-0.975
(0.03)
-1.063
(0.03)
-1.330
(0.04)
-1.186
(0.04)
-1.125
(0.08)

E North
Central
-0.578
(0.01)
-0.602
(0.01)
0
-0.420
(0.01)
-0.821
(0.02)
-0.631
(0.01)
-0.972
(0.03)
-0.663
(0.01)
-0.861
(0.02)

W North
Central
-1.361
(0.03)
-0.351
(0.01)
-0.798
(0.03)
0
-1.303
(0.03)
-0.450
(0.01)
-0.632
(0.02)
-0.840
(0.02)
-0.809
(0.02)

38

South
Atlantic
-0.540
(0.01)
-0.347
(0.01)
-0.515
(0.01)
-0.908
(0.02)
0
-0.513
(0.01)
-0.630
(0.01)
-0.542
(0.01)
-0.654
(0.02)

E South
Central
-1.068
(0.03)
-1.004
(0.04)
-0.932
(0.02)
-1.238
(0.05)
-0.958
(0.02)
0
-0.136
(0.00)
-0.898
(0.02)
-0.499
(0.01)

W South Mountain
Central
-0.492
-0.435
(0.01)
(0.01)
-0.700
-0.294
(0.02)
(0.01)
-0.647
-0.679
(0.02)
(0.02)
-0.861
-0.573
(0.02)
(0.01)
-0.890
-0.858
(0.02)
(0.02)
-0.646
-0.924
(0.02)
(0.02)
0
-0.823
(0.02)
-0.666
0
(0.02)
-0.761
-0.443
(0.02)
(0.01)

Pacific
-0.448
(0.01)
-0.622
(0.01)
-0.341
(0.01)
-0.647
(0.02)
-0.835
(0.02)
-0.803
(0.02)
-0.693
(0.02)
-0.442
(0.01)
0

Table 7
Log Wages by Education and Region
2000 US Census, 5% IPUMS Random Sample
Raw Data and Corrected for Spatial Selection

New England
Mid-Atlantic
E. North Central
W. North Central
South Atlantic
E. South Central
W. South Central
Mountain
Pacific
Average

High School
Median
75th Percentile
Raw
Selection
Raw
Selection
Data
Corrected
Data
Corrected
2.77
2.67
3.03
2.97
2.76
2.65
3.04
2.97
2.74
2.61
3.03
2.96
2.63
2.50
2.92
2.83
2.63
2.55
2.93
2.87
2.60
2.48
2.91
2.82
2.60
2.48
2.92
2.84
2.67
2.49
2.96
2.86
2.79
2.63
3.07
2.97
2.69
2.56
2.98
2.90

39

College
Median
Raw
Selection
Data
Corrected
3.20
2.87
3.24
2.76
3.14
2.76
2.98
2.53
3.09
2.83
3.01
2.59
3.04
2.78
3.04
2.63
3.22
2.97
3.11
2.75

75th Percentile
Raw
Selection
Data
Corrected
3.51
3.32
3.56
3.32
3.44
3.25
3.31
3.05
3.43
3.3
3.36
3.11
3.39
3.24
3.36
3.14
3.52
3.4
3.43
3.24

Table 8
Percentage Returns to College Education
Median
Raw Data
New England
Mid-Atlantic
E. North Central
W. North Central
South Atlantic
E. South Central
W. South Central
Mountain
Pacific
Average

0.43
0.48
0.40
0.35
0.46
0.41
0.44
0.37
0.43
0.42

Selection
Corrected
0.20
0.11
0.15
0.03
0.28
0.11
0.30
0.14
0.34
0.18

40

75th Percentile
Raw Data
Selection
Corrected
0.48
0.35
0.52
0.35
0.41
0.29
0.39
0.22
0.50
0.43
0.45
0.29
0.47
0.40
0.40
0.28
0.45
0.43
0.45
0.34

Figure 1: High School Graduates
Conditional and Unconditional Log Wage Distributions by Destination Region
New England
High School Graduates

East North Central
High School Graduates

Mid-Atlantic
High School Graduates

1

1

1

0.9

0.9

0.9

0.8

0.8

0.8

0.7

0.7

0.7

0.6

0.6

0.6

0.5

0.5

0.5

0.4

0.4

0.4

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0.1

0

0

0

0.5

1

1.5

2

2.5

3

Cond.

3.5

4

4.5

0
0

5

0.5

1

1.5

2

Uncond.

2.5

3

Cond.

3.5

4

4.5

0

5

1

1

0.9

0.9

0.8

0.8

0.8

0.7

0.7

0.7

0.6

0.6

0.6

0.5

0.5

0.5

0.4

0.4

0.4

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

1.5

2

2.5

3

Cond.

3.5

4

4.5

3

3.5

4

4.5

5

Uncond.

0

0

5

2.5

0.1

0

0

2

East South Central
High School Graduates

1

1

1.5

Cond.

0.9

0.5

1

South Atlantic
High School Graduates

West North Central
High School Graduates

0

0.5

Uncond.

0.5

1

1.5

2

2.5

3

Cond.

Uncond.

West South Central
High School Graduates

3.5

4

4.5

5

0

0.5

1

1.5

2

Uncond.

2.5

3

Cond.

3.5

4

4.5

5

Uncond.

Pacific
High School Graduates

Mountain
High School Graduates

1
1

1

0.9

0.9

0.8

0.8

0.7

0.7

0.6

0.6

0.5

0.5

0.4

0.4

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0.1

0

0

0.9
0.8
0.7
0.6
0.5
0.4
0.3

0

0.5

1

1.5

2

2.5
Cond.

3
Uncond.

3.5

4

4.5

5

0
0

0.5

1

1.5

2

2.5
Cond.

41

3
Uncond.

3.5

4

4.5

5

0

0.5

1

1.5

2

2.5
Cond.

3
Uncond.

3.5

4

4.5

5

Figure 2: College Graduates
Conditional and Unconditional Log Wage Distributions by Destination Region
Mid-Atlantic
College Graduates

New England
College Graduates

East North Central
College Graduates

1

1

1

0.9

0.9

0.9

0.8

0.8

0.8

0.7

0.7

0.7

0.6

0.6

0.6

0.5

0.5

0.5

0.4

0.4

0.4

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0
0.01

0.51

1.01

1.51

2.01

2.51
Cond.

3.01

3.51

4.01

4.51

0
0.01

0.1

0.51

1.01

1.51

Uncond.

2.01

2.51
Cond.

West North Central
College Graduates

3.01

3.51

4.01

4.51

0
0.01

1

1
0.9

0.8

0.8

0.8

0.7

0.7

0.7

0.6

0.6

0.6

0.5

0.5

0.5

0.4

0.4

0.4

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0.1

1.51

2.01

2.51
Cond.

3.01

3.51

4.01

4.51

0
0.01

0.51

1.01

1.51

2.01

Uncond.

2.51
Cond.

3.01

3.51

4.01

4.51

0
0.01

1

1

0.9

0.9

0.8

0.8

0.8

0.7

0.7

0.7

0.6

0.6

0.6

0.5

0.5

0.5

0.4

0.4

0.4

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0.1

0.51

1.01

1.51

2.01

2.51
Cond.

3.01
Uncond.

3.51

4.01

4.51

0.51

1.01

1.51

2.01

2.51
Cond.

42

3.01
Uncond.

3.01

3.51

4.01

4.51

Uncond.

1.01

1.51

2.01

2.51

3.01

3.51

4.01

4.51

Uncond.

Pacific
College Graduates

1

0
0.01

2.51

Cond.

0.9

0
0.01

0.51

Uncond.

Mountain
College Graduates

West South Central
College Graduates

2.01

East South Central
College Graduates

0.9

1.01

1.51

South Atlantic
College Graduates

1

0.51

1.01

Cond.

0.9

0
0.01

0.51

Uncond.

3.51

4.01

4.51

0
0.01

0.51

1.01

1.51

2.01

2.51
Cond.

3.01
Uncond.

3.51

4.01

4.51

