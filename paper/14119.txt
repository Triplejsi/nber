NBER WORKING PAPER SERIES

CRASHES AND RECOVERIES IN ILLIQUID MARKETS
Ricardo Lagos
Guillaume Rocheteau
Pierre-Olivier Weill
Working Paper 14119
http://www.nber.org/papers/w14119

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
June 2008

We thank Ruilin Zhou for comments and Monica Crabtree-Reusser for editorial assistance. We also
thank seminar participants at Universidad Torcuato Di Tella, Singapore Management University, National
University of Singapore, Banque de France, Mannheim University, Toulouse School of Economics,
Duke University Fuqua School of Business, the 2006 Workshop on Money, Banking and Payments
at the Federal Reserve Bank of Cleveland, the 2007 Midwest Macro Conference, the 2007 Conference
on Microfoundations of Markets with Frictions in Montreal, the 2007 SED meetings, and the UC Santa
Barbara LAEF Conference on Trading Frictions in Asset Markets. The views expressed herein are
those of the authors and not necessarily those of the Federal Reserve Bank of Cleveland or the Federal
Reserve System. Lagos thanks the C. V. Starr Center for Applied Economics at NYU for Financial
support. The views expressed herein are those of the author(s) and do not necessarily reflect the views
of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2008 by Ricardo Lagos, Guillaume Rocheteau, and Pierre-Olivier Weill. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

Crashes and Recoveries in Illiquid Markets
Ricardo Lagos, Guillaume Rocheteau, and Pierre-Olivier Weill
NBER Working Paper No. 14119
June 2008
JEL No. C78,D83,E44,G1
ABSTRACT
We study the dynamics of liquidity provision by dealers during an asset market crash, described as
a temporary negative shock to investors aggregate asset demand. We consider a class of dynamic market
settings where dealers can trade continuously with each other, while trading between dealers and investors
is subject to delays and involves bargaining. We derive conditions on fundamentals, such as preferences,
market structure and the characteristics of the market crash (e.g., severity, persistence) under which
dealers provide liquidity to investors following the crash. We also characterize the conditions under
which dealers incentives to provide liquidity are consistent with market efficiency.

Ricardo Lagos
Department of Economics
New York University
19 W. 4th Street, 6th Floor
New York, NY 10012
ricardo.lagos@nyu.edu
Guillaume Rocheteau
Department of Economics
University of California at Irvine
3151 Social Science Plaza
Irvine, California 9269

Pierre-Olivier Weill
Department of Economics
University of California, Los Angeles
Bunche Hall 8283
Los Angeles, CA 90095
and NBER
poweill@econ.ucla.edu

1

Introduction

Liquidity in …nancial markets is often provided by dealers who trade assets from their own
inventories. Even in markets where liquidity provision by dealers may be inconspicuous in
normal times, it becomes critical during times of large …nancial imbalances. During market
crashes, for instance, it can take a long time for an investor to …nd a counterpart for trade,
either because of the technological limitations of order-handling systems or, as is the case
in over-the-counter markets, due to the decentralized nature of the trading process.1 These
situations appear to be very costly to investors, who concede striking price discounts to unwind
their positions (e.g., the 23% price drop of the Dow Jones Industrial Average on October 19,
1987). Some have argued that the social cost could be even larger because of the risk that
the …nancial crisis propagates to the macroeconomy (see, e.g., Borio (2004)). It is commonly
believed that liquidity provision by dealers plays a crucial role in mitigating these costs.
In this paper we study the equilibrium and the socially optimal inventory policies of dealers
during a market crash, which we model as a temporary negative shock to investors’willingness
to hold the asset. We derive conditions under which dealers will …nd it in their interest to
provide liquidity in the aftermath of a crash, as well as conditions under which their incentives
to provide liquidity are consistent with market e¢ ciency. We also study how liquidity provision
by dealers depends on the market structure, e.g., dealers’degree of market power or the extent
of the trading frictions, and the characteristics of the crash, e.g., severity and persistence of the
shock to investors’demands.
Our work is related to a recent literature that studies trading frictions in asset markets.2
In particular, the market setting we consider is similar to that of Du¢ e et al. (2005) (DGP
hereafter). Investors rebalance their asset holdings periodically in response to random changes
in their utility from holding assets, and they must engage in a time-consuming process to contact
dealers and bargain over the terms of trade. Dealers get no direct utility from holding assets,
and they can trade continuously in a perfectly competitive interdealer market. DGP focused
on steady states, so their analysis is silent about liquidity provision by dealers.
1

For a description of the various trading problems that arose during the market crashes of October 1987 and
October 1997, see the report of The Presidential Task Force on Market Mechanisms (1988) and the US Securities
and Exchange Commission Sta¤ Legal Bulletin No. 8 (September 9, 1998).
2
Examples include, Gârleanu (2006), Longsta¤ (2005), and Vayanos and Weill (2007). Conceptually, our
analysis is also related to the inventory models of Stoll (1978) and Ho and Stoll (1983) (see Chapter 2 in O’Hara
(1997) for a review of this earlier market-microstructure literature).

2

Weill (2007) studies the timing of liquidity provision by dealers in a dynamic version of
DGP. He asks under which conditions dealers will, and ought to, lean against the wind in the
immediate aftermath of the crash. Weill (2007) and the literature spurred by DGP, however,
keep the framework tractable by imposing a stark restriction on asset holdings, namely, that
investors can only hold either 0 or 1 unit of the asset. Lagos and Rocheteau (2007) study a
version of DGP where investors can hold unrestricted asset positions and …nd that, as result of
this restriction on asset holdings, existing search-based theories of …nancial liquidity neglect a
critical aspect of investor behavior in illiquid markets, namely the fact that market participants
can mitigate trading frictions by adjusting their asset positions so as to reduce their trading
needs. This e¤ect of trading frictions on the demand for liquidity has been pointed out in a
di¤erent context by Constantinides (1986).
In this paper, we go beyond previous studies by allowing both dealers and investors to hold
unrestricted asset positions. This turns out to generate new implications for both the demand
and the supply of liquidity. Absent extraneous upper bounds on asset holdings, in times of
crisis, investors with high utility for the asset may absorb the selling pressure coming from
investors with low utility by holding positions that are large relative to what they would hold
during normal times. In other words, by removing the typical restrictions on investors’ asset
holdings, we …nd that investors may provide liquidity to other investors in times of crisis, much
like dealers do. These new e¤ects on the supply and demand of liquidity imply that, in contrast
to Weill (2007), dealers may sometimes not …nd it in their interest to provide liquidity during
a crash. Also, it may sometimes be e¢ cient for them not to lean against the wind. Whether or
not dealers will provide liquidity, and whether or not they ought to, depends on fundamentals,
including the details of market structure and the characteristics of the crash.
Our stylized description of a market crash consists of an aggregate negative preference shock
to investors’ asset demands, followed by a (possibly stochastic) recovery path.3 We …nd that
the amount of liquidity provided by dealers following the crash varies nonmonotonically with
the magnitude of trading frictions. When frictions are small, investors choose to take more
3

This scenario could represent, for instance, an international shock such as the 1997 Asian crisis or the 1998
Russian sovereign default, domestic turbulence such as that triggered by the September 11 terrorist attack, or
even some company-speci…c shock, such as the collapse of Enron. Our “crash” follows the spirit of Grossman
and Miller’s (1988) crash dynamics. In Grossman and Miller, dealers provide liquidity in order to share risk
with outside investors. In our model, dealers have no such utility motive for holding assets; instead, they allow
investors to trade faster. In related work, Bernardo and Welch (2004) use the feature of nonsequential access of
investors to market makers to describe a market crash as a …nancial run.

3

extreme positions because they know that they can rebalance their asset holdings very quickly.
Speci…cally, investors with higher-than-average utility for assets become more willing to hold
larger-than-average positions and absorb more of the selling pressure coming from investors
whose demands for the asset are lower than normal. In some cases, the former end up supplying
so much liquidity to other investors, that dealers don’t …nd it pro…table to step in. If, on the
contrary, trading frictions are large enough, dealers do not accumulate inventories either, but
for a di¤erent reason: Trading frictions reduce investors’demand for liquidity. Indeed, in order
to reduce their exposure to the trading frictions, investors choose to take less extreme asset
positions. In fact, it is possible that they demand so little liquidity that dealers don’t …nd it
pro…table to accumulate inventories following a crash. Thus, if one considers a spectrum of asset
markets ranging from those with very small frictions, such as the New York Stock Exchange
(NYSE), to those with large trading frictions, such as the corporate bond market, one would
expect to see dealers accumulate more asset inventories during a crash in markets which are in
the intermediate range of the spectrum.
We also …nd that, from the standpoint of investors, an increase in dealers’ bargaining
strength is equivalent to an increase in trading frictions. Hence, just as with trading frictions,
dealers are less likely to accumulate inventories if their bargaining strength is either very small
or very large. This …nding contrasts with the commonly held view that the market power of
dealers (e.g., NYSE specialists) is what gives them incentives to provide liquidity. In our model,
an increase in the dealers’bargaining strength may reduce the aggregate amount of inventory
they accumulate, because investors endogenously take less extreme positions and demand less
liquidity. Similarly, a market reform that reduces dealers’market power, as observed in equity
markets in the 90’s, can raise dealers’incentives to provide liquidity during a market crash.
Our model can rationalize why dealers intervene in some crises and withdraw in others. In
line with Hendershott and Seasholes’s (2006) empirical evidence on the inventory strategies of
NYSE specialists, in our model, dealers’incentives to provide liquidity are driven by anticipated
capital gains. Therefore, dealers are more likely to accumulate inventories when the crisis is
severe and expected to be short-lived: A large price drop and the expectation of a quick rebound
make it more pro…table for dealers to buy low early in the crash and sell high later, as demand for
the asset recovers. From a normative standpoint, we …nd that the equilibrium asset allocation
across investors and the dealers’ inventory policies are socially e¢ cient if and only if dealers’
bargaining strength is equal to zero. Given the nonmonotonic equilibrium relationship between

4

dealers’ asset inventories and their bargaining strength, this means that dealers may fail to
build up inventories in situations where it would be socially e¢ cient to do so, and vice-versa.
The rest of the paper is organized as follows. Section 2 lays down the environment. Section 3 characterizes investors’and dealers’behavior and Section 4 de…nes equilibrium. Section
5 characterizes the socially optimal allocation. Sections 6 and 7 provide two alternative descriptions of a market crash and determine the conditions under which dealers act as providers
of liquidity. Section 8 concludes. Appendix A contains all proofs and Appendix B contains
supplementary material.

2

The environment

Time is continuous and the horizon in…nite. There are two types of in…nitely-lived agents: a
unit measure of investors and a unit measure of dealers. There is one asset and one perishable
good, which we use as a numéraire. The asset is durable, perfectly divisible and in …xed supply,
A 2 R+ . The numéraire good is produced and consumed by all agents. The instantaneous

utility function of an investor is ui (a) + c, where a 2 R+ represents the investor’s asset holdings,
c 2 R is the net consumption of the numéraire good (c < 0 if the investor produces more than
he consumes), and i 2 f1; :::; Ig indexes a preference shock. The utility function ui (a) is
strictly increasing, concave, continuously di¤erentiable and satis…es the Inada condition that

u0i (0) = 1. We also assume that it is either bounded below or above. Investors receive

idiosyncratic preference shocks that occur with Poisson arrival rate . Conditional on the
P
preference shock, the investor draws preference type i with probability i , and Ii=1 i = 1.

These preference shocks capture the notion that investors value the services provided by the

asset di¤erently over time, and will generate a need for investors to periodically change their
asset holdings.4 The instantaneous utility of a dealer is

(a) + c, where

(a) is increasing,

4
Our speci…cation associates a certain utility to the investor as a function of his asset holdings. This is a
feature that we have borrowed from DGP. The utility the investor gets from holding a given asset position could
be simply the value from enjoying the asset itself, as would be the case for real assets such as cars or houses.
Alternatively, we can also think of the asset as being physical capital. Then, if each investor has linear utility
over a single consumption good (as is the case in most search models), we can interpret ui ( ) as a production
technology that allows the agent to use physical capital to produce the consumption good. The idiosyncratic
component “i” can then be interpreted as a productivity shock that induces agents with low productivity to sell
their capital to agents with high productivity in an OTC market. As yet another possibility, one could adopt
the preferred interpretation of DGP, namely that ui (a) is in fact a reduced-form utility function that stands
in for the various reasons why investors may want to hold di¤erent quantities of the asset, such as di¤erences
in liquidity needs, …nancing or …nancial-distress costs, correlation of asset returns with endowments (hedging
needs), or relative tax disadvantages (as in Michaely and Vila (1996)). By now, several papers that build on

5

concave and continuously di¤erentiable. All agents discount at the same rate r > 0.

I
N
V
E
S
T
O
R
S

D
E
A
L
E
R
S

Asset
Market

D
E
A
L
E
R
S

I
N
V
E
S
T
O
R
S

Figure 1: Trading arrangement

There is a competitive market for the asset. Dealers can continuously buy and sell in this
market at price p (t), while investors can only access the market periodically and indirectly,
through a dealer. Speci…cally, we assume that investors contact a randomly chosen dealer
according to a Poisson process with arrival rate . Once the investor and the dealer have made
contact, they negotiate the quantity of assets that the dealer will acquire (or sell) in the market
on behalf of the investor and the intermediation fee that the investor will pay the dealer for his
services. After completing the transaction, the dealer and the investor part ways.5 The trading
arrangement is illustrated in Figure 1.

3

Dealers, investors, and bargaining

In this section we describe the decision problems faced by investors and dealers, and the determination of the terms of trade in bilateral meetings between them. Investors readjust their asset
the work of DGP have formalized the “hedging needs” interpretation. Examples include Du¢ e, Gârleanu and
Pedersen (2006), Gârleanu (2006) and Vayanos and Weill (2007). (See also Lo, Mamaysky and Lang (2004).)
Notice that investors in DGP, and therefore the investors in our paper, are akin to the liquidity traders which
are commonplace in the large body of the …nance microstructure literature that uses asymmetric information
instead of search frictions to rationalize bid-ask spreads, such as Glosten and Milgrom (1985) and Easley and
O’Hara (1987).
5
In actual …nancial markets, there are position traders who hold asset inventories in the hope of making capital
gains. There are also pure spread traders who don’t hold inventories but instead pro…t exclusively from “buying
low and selling high.” Stoll (1978), for example, calls the former dealers and the latter brokers. In our model,
the agents that we refer to as dealers engage in both of these activities. The analysis would remain unchanged
if we were to assume that these activities are carried out by two di¤erent types of agents with continuous direct
access to the asset market.

6

holdings infrequently, at the random times when they meet dealers. In between those times, an
investor enjoys the utility ‡ow associated with his current asset position. A dealer’s problem
consists of continuously managing his own asset position by trading in the asset market. At
random times, the dealer contacts an investor who wishes to buy or sell some quantity of assets.
At these times, the dealer executes the desired purchase or sale in the asset market on behalf
of the investor and receives a fee for his services.6
We begin with the determination of the terms of trade in bilateral trades between dealers
and investors. Consider a meeting at time t between a dealer who is holding inventory ad and an
investor of type i who is holding inventory a. Let a0 denote the investor’s post-trade asset holding
and

be the intermediation fee.7 The pair (a0 ; ) is taken to be the outcome corresponding

to the Nash solution to a bargaining problem where the dealer has bargaining power

2 [0; 1].

Let Vi (a; t) denote the expected discounted utility of an investor with preference type i who is
holding a quantity of asset a at time t. Then, the utility of the investor is Vi (a0 ; t) p (t) (a0 a)
if an agreement (a0 ; ) is reached, and Vi (a; t) in case of disagreement. Therefore, the investor’s
gain from trade is Vi (a0 ; t)

Vi (a; t)

p (t) (a0

a)

. Analogously, let W (ad ; t) denote the

maximum attainable expected discounted utility of a dealer who is holding inventory ad at time
if an agreement (a0 ; ) is reached and W (ad ; t)

t. Then, the utility of the dealer is W (ad ; t) +

in case of disagreement, so the dealer’s gain from trade is equal to the fee, .8 The outcome of
the bargaining is given by
[ai (t);

i (a; t)]

= arg max [Vi (a0 ; t)

Vi (a; t)

(a0 ; )

p (t) (a0

a)

]1

:

Hence, the investor’s new asset holding solves
ai (t) = arg max
Vi (a0 ; t)
0
a

6

p(t)a0 ;

(1)

In principle, the dealer may …ll the investor’s order partially or in full by trading out of, or for his own
inventory of the asset. For example, if at some time t the dealer contacts an investor who wishes to buy some
quantity a0 and the dealer’s inventory is ad (t) > a0 , then in that instant, the dealer may …ll the buy order by
giving the investor a0 from his inventory and charging him p (t) a0 plus the fee, and instantaneously buying back
ad (t) a0 for his own account in the asset market. Alternatively, the dealer may instead choose not to trade out
of his inventory and simply buy a0 in the market on behalf of the investor at cost p (t) a0 (and charge him this
cost plus the intermediation fee). Clearly, the dealer is indi¤erent between these modes of execution because he
has continuous access to the asset market and all the transactions he is involved in are instantaneous.
7
In our formulation we assume that the investor pays the dealer a fee. However, the bargaining problem can
be readily reinterpreted as one in which the dealer pays the investor a bid price which is lower than the market
price if the investor wants to sell, and charges an ask price which is higher than the market price if the investor
wants to buy. See Lagos and Rocheteau (2007) for details.
8
The outcome of the bilateral trade does not a¤ect the dealer’s continuation payo¤ because he has continuous
access to the asset market and his trades are executed instantaneously (see footnote 6).

7

and that the intermediation fee is
i (a; t)

= fVi [ai (t) ; t]

Vi (a; t)

p(t) [ai (t)

a]g :

(2)

According to (1), the investor’s post-trade asset holding is the one he would have chosen if
he were trading in the asset market himself, rather than through a dealer. According to (2),
the intermediation fee is set so as to give the dealer a share
readjusting the investor’s asset

of the gains associated with

holdings.9

The value function corresponding to a dealer who is holding asset position at at time t
satis…es
W (at ; t) =

sup
q(s);ad (s)

E

Z

T

e

r(s t)

t

f [ad (s)]

p(s)q(s)g ds + e

r(T t)

[ (T ) + W (ad (T ); T )] ;

subject to the law of motion a_ d (s) = q (s), the short-selling constraint ad (s)

0, and the

initial condition ad (t) = at . Here, ad (s) represents the stock of assets that the dealer is holding
and q (s) is the quantity that he trades for his own account at time s. The expectations
operator, E, is taken with respect to T , which denotes the next random time at which the
dealer meets an investor, where T

t is exponentially distributed with a mean of 1= . Since

the intermediation fee determined in a bilateral meeting depends on the investor’s preference
type and asset holdings, and given that the investor is a random draw from the population of
R
investors, at time T the dealer expects to extract the average fee (T ) =
j (ai ; T )dHT (j; ai ),
where HT denotes the distribution of investors across preference types and asset holdings at

time T . The dealer enjoys ‡ow utility [ad (s)] from carrying inventory ad (s), and gets utility
p (s) q (s) from changing this inventory.
Since intermediation fees are independent of the dealer’s asset holdings, we can write
Z 1
W (at ; t) = max
e r(s t) f [ad (s)] p(s)q(s)g ds + (t) ;
q(s)

subject to a_ d (s) = q (s), ad (s)

0 and ad (t) = at . The function

(t) is the expected

present discounted value of future intermediation fees from time t onward and satis…es
Efe

r(T t) [

(T ) +

(3)

t

(t) =

(T )]g, where the expectation is with respect to T . This formulation makes

it clear that dealers trade assets in two ways: continuously, in the competitive market, or at random times, in bilateral negotiations with investors. Since dealers have quasi-linear preferences
9

Our choice of notation for the bargaining solution in (1) and (2) emphasizes the fact that the terms of
trade depend on the investor’s preference type but are independent of the dealer’s inventories. In addition, the
investor’s post-trade asset holding is independent of his pre-trade holding, while the intermediation fee is not.

8

and they can trade instantaneously and continuously in the competitive asset market, their optimal choice of asset holdings is independent from what happens in bilateral negotiations with
investors. The following lemma describes the solution dealer’s inventory accumulation problem
which is in the …rst term on the right-hand side of (3).
Lemma 1 Suppose that p(t) is a given, piecewise continuously di¤ erentiable price path. An
inventory path, ad (t), solves the dealer’s inventory accumulation problem if and only if
1. for all t such that p(t) is di¤ erentiable, ad (t) satis…es
0

[ad (t)] + p_ (t)

rp (t) with equality if ad (t) > 0;

(4)

2. ad (t) = 0 for any t for which the price has a negative jump, i.e., if
p(t+ )

p(t ) < 0; then ad (t) = 0;

(5)

3. ad (t) satis…es the transversality condition
lim e

t!1

rt

p(t)ad (t) = 0:

(6)

There is no bounded inventory path, ad (t), that solves the dealer’s inventory accumulation
problem if p(t) has a positive jump, p(t+ )

p(t ) > 0.

The last part of Lemma 1, states that if the asset price had a positive jump, a dealer could
improve his utility from any bounded inventory path by buying assets just before the jump and
re-selling just after.10 The opposite trading strategy implies that the short-selling constraint
must be binding whenever the price jumps down. According to (4), whenever the price path
is di¤erentiable and a dealer …nds it optimal to hold strictly positive inventory, the ‡ow cost
of buying the asset, rp (t), must equal the direct utility ‡ow from holding the asset,

0 [a (t)],
d

plus the capital gain, p_ (t). As it is well known from Mangasarian’s results (see Theorem 13,
Chapter 3 of Seierstad and Sydsaeter (1987)), together with the other …rst-order conditions,
the transversality condition (6) is su¢ cient for optimality. Here, we show that it is necessary
as well.11
10

Note that, because there is a …nite measure of assets, and agents face short-selling constraints, dealers’asset
holdings will have to be bounded in an equilibrium. This observation, together with the last part of the lemma
will imply that a price paths with upward jumps cannot be part of an equilibrium.
11
The necessity of such transversality conditions for general formulations of in…nite-horizon optimal control problems has been regarded as a delicate issue since Halkin’s (1974) counterexample. See Benveniste and
Scheinkman (1982) for fairly general results.

9

We now proceed with an analysis of an investor’s problem. The value function corresponding
to an investor with preference type i who is holding a assets at time t, Vi (a; t), satis…es
Z

Vi (a; t) = Ei
e

T

e

r(s t)

uk(s) (a)ds +

t

r(T t)

fVk(T ) [ak(T ) (T ); T ]

p(T )[ak(T ) (T )

a]

k(T ) (a;T )g

;

(7)

where T denotes the next time the investor meets a dealer, and k(s) 2 f1; :::; Ig denotes the
investor’s preference type at time s. The expectations operator, Ei , is taken with respect to the

random variables T and k(s), and is indexed by i to indicate that the expectation is conditional
on k(t) = i. Over the interval of time [t; T ] the investor holds a assets and enjoys the discounted
sum of the utility ‡ows associated with this holding a (the …rst term on the right-hand side
of (7)). The length of this interval of time, T

t, is an exponentially distributed random

variable with mean 1= . The ‡ow utility is indexed by the preference type of the investor,
k(s), which follows a compound Poisson process. At time T the investor contacts a random
dealer and readjusts his holdings from a to ak(T ) (T ). In this event the dealer purchases a
quantity ak(T ) (T )

a of the asset in the market (or sells if this quantity is negative) at price

p(T ) on behalf of the investor. At this time the investor pays the dealer an intermediation fee,
k(T ) (a; T ).

Both the fee and the asset price are expressed in terms of the numéraire good.

Substituting the terms of trade (1) and (2) into (7), we get
Vi (a; t) = Ei
e

Z

T

e

r(s t)

uk(s) (a)ds +

(8)

t

r(T t)

f(1

) max
Vk(T ) (a0 ; T )
0
a

p(T )(a0

a) + Vk(T ) (a; T )g :

From the last two terms on the right-hand side of (8), it is apparent that the investor’s payo¤
is the one he would get in an economy in which he meets dealers according to a Poisson
process with arrival rate

, and instead of bargaining, he readjusts his asset holdings and

extracts the whole surplus with probability 1

; whereas with probability

he cannot readjust

his holdings (and enjoys no gain from trade). Therefore, from the investor’s standpoint, the
stochastic trading process and the bargaining solution are payo¤-equivalent to an alternative
trading mechanism in which the investor has all the bargaining power in bilateral negotiations
with dealers, but he only gets to meet dealers according to a Poisson process with arrival rate

10

= (1

). Consequently, we can rewrite (8) as

Vi (a; t) = Ei

Z

T~

uk(s) (a) e

r(s t)

ds + e

r(T~ t)

fp(T~)a + max
[Vk(T~) (a0 ; T~)
0
a

t

p(T~)a0 ]g ;

(9)

where the expectations operator, Ei , is now taken with respect to the random variables T~ and
k(s), where T~ t is exponentially distributed with mean 1= . From (9), the problem of an
investor with preference shock i, who gains access to the market at time t, consists of choosing
a0 2 R+ in order to maximize
Ei

Z

T~

r(s t)

e

n
p(t)

uk(s) (a0 ) ds

t

or equivalently,
Ei

"Z

T~

e

r(s t)

uk(s) (a0 )

r(T~ t)

Et e

[rp(s)

p(T~)

o

a0 ;

#

p(s)]
_
a0 ds :

t

(10)

If the investor had continuous access to the asset market, he would choose his asset holdings so
as to continuously maximize ui (a) [rp(t)

p(t)]
_
a, his ‡ow utility net of the ‡ow cost of holding

the asset. But since the investor can only trade infrequently, his objective is to maximize (10)
instead. Intuitively, the investor chooses his asset holdings in order to maximize the present
value of his utility ‡ow net of the present value of the cost of holding the asset from time t
until the next time T~ when he can readjust his holdings. The following lemma o¤ers a simpler,
equivalent formulation of the investor’s problem.
Lemma 2 Let
Ui (a) =

(r + ) ui (a) +

PI

r+ +
Z
(t) = (r + ) p(t)

j=1

j uj (a)

1

(r+ )s

e

p(t + s)ds ;

(11)
(12)

0

and assume that p(t)e

rt

is decreasing. Then a bounded process a(t) solves the investor’s prob-

lem if and only if
1. a(t) = ai (t), when the investor contacts the market with current type i, with
Ui0 [ai (t)] = (t)

11

(13)

2. a(t) satis…es the transversality condition
h
lim E p( t )a( t )e
t!1

where

t

r

t

i

= 0;

(14)

denotes the investor’s last contact time with a dealer before t.

The assumption that p(t)e

rt

is decreasing is without loss of generality, because it will be true

in an equilibrium (this follows from the dealer’s …rst-order conditions (4) and (5)). Intuitively,
Ui (a) is the ‡ow expected utility the investor enjoys from holding a assets until his next opportunity to rebalance his holdings, and

(t) is the cost of buying the asset minus the expected

discounted resale value of the asset (expressed in ‡ow terms). Notice that we do not need to
know the path for the price of the asset, p (t), to solve for the investor’s optimal asset holdings.
It is su¢ cient to know (t). The following lemma establishes the relationship between (t) and
p (t).
Lemma 3 Condition (12) implies
rp (t)

p_ (t) = (t)

_ (t)
r+

:

(15)

Lemma 3 allows us to rewrite (4) as
0

[ad (t)] +

_ (t)
r+

(t) with an equality if ad (t) > 0:

(16)

Equations (13) and (16) illustrate the main di¤erences between dealers and investors in our
setup. Relative to investors, dealers get an extra return from holding the asset, captured by
_ (t) = (r + ). This re‡ects a dealer’s ability to make capital gains by exploiting his continuous
access to the asset market. Another di¤erence is the fact that the utility function for investors
on the left-hand side of (13) is a weighted-average of the marginal utility ‡ows that the investor
enjoys until the next time he is able to readjust his asset holdings.

4

Equilibrium

In this section, we study the determination of the asset price, de…ne equilibrium, and show
how to characterize it. Since each investor faces the same probability to access the market
irrespective of his asset holdings, and since these probabilities are independent across investors,
we appeal to the law of large numbers to assert that the ‡ow supply of assets by investors
12

is

[A

Ad (t)], where Ad (t) is the aggregate stock of assets held by dealers. (Note that

Ad (t) = ad (t), since there is a unit measure of identical dealers facing the same strictly concave
optimization problem). The measure of investors with preference shock i who are trading in
the market at time t is

ni (t), where ni (t) is the measure of investors with preference type i
PI
at time t. Therefore, the investors’ aggregate demand for the asset is
i=1 ni (t)ai (t), and
PI
the net supply of assets by investors is [A Ad (t)
i=1 ni (t)ai (t)]. The net demand from
dealers is A_ d (t), the change in their inventories. Therefore, market clearing requires
"

A_ d (t) =
The measure ni (t) satis…es n_ i (t) =
t

ni (t) = e

A

I
X

Ad (t)

#

ni (t)ai (t) :

i=1

(17)

ni (t) for all i, and therefore,

i

ni (0) + (1

e

t

) i;

for i = 1; ::; I:

(18)

If we use (13) to substitute ai (t) from (17), it becomes apparent that this market-clearing
condition determines (t). The intermediation fees along the equilibrium path are given by (2).
Using (9), (11) and (12), (2) reduces to
i (a; t)

=

Ui [ai (t)]

Ui (a)
r+

(t) [ai (t)

a]

:

(19)

De…nition 1 An equilibrium is a collection of bounded asset holdings [fai (t)gIi=1 ; Ad (t)], together with piecewise continuously di¤ erentiable trajectories for prices and intermediation fees,
[ (t); p (t) ;

i (a; t)],

that satisfy , (4)–(6), (12)–(14), (17) and (19).

We do not list the distribution of asset holdings across investors in the preceding de…nition
because it does not a¤ect the dealer’s problem, the investor’s problem, nor any of the variables
which are relevant to our analysis. To characterize the equilibrium, we begin by establishing
two important properties of any equilibrium price path.
Lemma 4 In an equilibrium,
lim e

t!1

p(t) =

rt

Z

p(t) = 0,
1

e

r(s t)

t

13

and
"

(s)

(20)
_ (s)
r+

#

ds:

(21)

The no-bubble condition (20) follows from adding up the transversality conditions (6) and
(14) across all agents, which after observing that agents’holdings must add up to A > 0 imply
limt!1 E p( t )e

r

t

A = 0. This, in turn, can be shown to imply (20). With (20), (21) follows

from (15).
If we combine (13), (16) and (17) and assume an interior solution for dealers’inventories,
the model can be reduced to a system of two …rst-order di¤erential equations
(
)
I
X
0
1
A_ d (t) =
A Ad (t)
ni (t)Ui [ (t)] ;
_ (t) = (r + )

i=1
0

(t)

[Ad (t)] ;

(22)
(23)

with ni (t) given by (18). This system is nonlinear and nonautonomous. The steady-state
equilibrium is such that Ui0 (ai ) =

0 (a )
d
0 1

=

( )+

= rp, where
I
X

0 1
i Ui (

is the unique solution to

) = A:

(24)

i=1

Consider the limit as the trading frictions vanish, i.e., as
(t) = rp(t)

approaches 1. From (15),

p(t),
_
so the investor’s cost of investing in the asset is the ‡ow cost rp(t) minus the

capital gain p(t),
_
the same as the dealer’s. From (11), Ui (a) tends to ui (a), so (11) implies that
the investor’s optimal choice of assets satis…es u0i (ai ) = rp(t)

p(t).
_
This is the asset demand

of an investor in a frictionless Walrasian market.
A very tractable special case of (22) and (23) obtains when ni =

i

for all i, i.e., when

the distribution of preference types across investors is time-invariant, since the system is then
homogenous. (Note that this does not imply that the joint distribution of assets and preference
types across investors is constant, so the economy need not be in a steady state.) Linearizing
(22) and (23) in the neighborhood of the unique steady-state, (Ad ; ), the steady state can
be veri…ed to be a saddle-point. For some initial condition Ad (0) in the neighborhood of the
steady state there is a unique trajectory, the saddle-path, that brings the economy to its steady
state. This trajectory also satis…es (6), so it is an equilibrium. Lemma 5 establishes that for a
given initial condition, such a path is the unique equilibrium. Figure 2 depicts the dynamics of
the system with a phase diagram.
Lemma 5 Suppose that ni (0) =

i

for all i, and that the initial condition ad (0) = Ad (0) is

close to the steady-state value Ad . Then, there is a unique dynamic equilibrium, and it converges
to the steady state.
14

Ad = 0

0

A

Ad

Ad

Figure 2: Dealers and inventories: Phase diagram

As dealers’ marginal utility for the asset decreases, the
0 (a )
d

isocline shifts downward. As

tends to 0, a case we will focus on in the following sections, the

isocline approaches

the horizontal axis for all Ad > 0 and the vertical axis for Ad = 0. The steady state is then at
the intersection of the Ad isocline and the vertical axis, and there is a saddle-path that brings
the economy to the steady state.

5

E¢ ciency

In this section we characterize the e¢ cient allocation. We carry out an elementary variational
experiment to identify the social gains associated with liquidity provision by dealers, and provide
a more formal treatment of the social planner’s problem in Appendix A.
Use m( ; t) to denote the marginal utility that an investor enjoys at time t, from the asset
position he acquired at time
M( ; t)

t. Let
(r + )Et

Z

T

e

r(s t)

m( ; s)ds ;

t

i.e., M( ; t) is the ‡ow expected present value of an investor’s marginal utility for the assets

15

he acquired at time , from time t

until his next contact time with dealers, T .12 Let

represent the length of a small time interval, then M( ; t) solves the recursion
M( ; t) = (r + )m( ; t)

+ (1

r

)Et [M( ; t +

)] :

(25)

At each point in time t > 0, a quantity Ad (t) of assets is held by dealers, and the remaining
A

Ad (t) is held by investors. Because there is a continuum of investors establishing contact

with dealers at Poisson intensity , the law of large numbers implies that, during any small time
interval [t; t +

], there is a quantity Ad (t) +

[A

Ad (t)] of assets that can be reallocated

between those investors who are in contact with dealers, and between investors and dealers.
Holding Ad (t) …xed, an e¢ cient allocation of the remaining

[A

Ad (t)] assets must

equalize the marginal value M(t; t) of all investors who are currently contacting dealers and
holding assets. Otherwise, one could improve welfare by reallocating assets from investors with
low marginal valuations to investors with high marginal valuations. This means that,
M(t; t) = (t);
for some (t)

(26)

0, which represents the shadow price that the planner assigns to assets in the

hands of dealers at time t (assuming investors hold some assets).
We now provide a necessary condition for dealers’inventory holdings, Ad (t), to be part of
an e¢ cient allocation. Start from an allocation such that (26) holds at each time, and perturb
it as follows: (i ) keep the same allocation during [0; t), (ii ) take a marginal asset from some
positive measure of “early”investors at time t and give them to dealers until time t + . (iii ) If
an early investor recontacts the market at time t + , give the asset back to him. If he does not
recontact the market at time t +
the market at time t +

, give the asset to some other “late”investor who contacted

. (iv ) Continue with the initial asset allocation after t +

dealers’asset holdings at t +

. (Since

are the same as in the initial allocation, the quantity of assets

available in the market stays the same, and it is feasible to continue with the initial allocation
after t +

.)

We can break up the net utility of this perturbation as follows. First, during [t; t + ] assets
are held by dealers, with a marginal utility

0 (t),

instead of the early investors, with a marginal

12
We introduce a di¤erent notation here so that the present calculations also apply to the environment
of Section 7, which features aggregate uncertainty. In the environment of the previous section, for instance,
0
m( ; s) = u0k(s) ak( ) , and with = 0, M( ; s) = Uk(s)
ak( ) , where ak( ) is the asset position chosen by the
investor at time , and k(s) is the investor’s preference type at time s. Also, in this section we use Et to denote
the expectation operator conditional on the information available at time t.

16

utility of m(t; t).13 This represents a net ‡ow utility of (r + ) [ 0 (t)
is a fraction

m(t; t)] . Second, there

of early investors who re-establish contact with dealers at t +

their asset back, with a net utility of zero from t +

and receive

onwards. For the fraction 1

of early

investors who do not re-establish contact with dealers, there is an expected discounted cost of
Et e

r

M(t; t +

) ' (1

r )Et [M(t; t +

)] :

(27)

This represents the discounted marginal value that is lost because early investors hold one unit
less of assets until their next respective contact times with dealers. Lastly, since the asset is
transferred to some late investors at time t +
(1

, there is an expected gain of

r )Et [M(t +

;t +

)] :

(28)

As before, equation (28) is the discounted marginal value that is gained because late investors
hold one more unit of assets until their next respective contact time with dealers. This discussion
shows that the net utility of the perturbation is
(r + )

0

(t)

m(t; t)

+ (1

)(1

r )Et [M(t +

;t +

)

M(t; t +

)] :

The second term represents the gain from liquidity provision. The discounting factor, (1
appears because the gain occurs later in time. The probability factor, (1

(29)
r ),

), appears

because the gain occurs only if the early investors do not manage to re-establish contact with
dealers. The last factor, Et [M(t +
of the early investor, M(t; t +
investor, M(t +

;t +

;t +

)

M(t; t +

)], is positive when the marginal utility

), is, on average, smaller than the marginal utility of the late

). This means that liquidity provision can raise welfare by improving

intertemporal matching, i.e., by creating a mutually bene…cial match between two investors
who contact dealers at di¤erent points in time.
To a …rst-order approximation, equation (29) can be rearranged as follows14
0

(r + )
Divide (30) through by

(t)

(t) + (1

and take

r

) fEt [ (t +

)]

(t)g :

(30)

to zero to …nd that increasing the amount of inventories

held by dealers does not improve welfare if
0

(t) +

1
r+

lim

Et [ (t +

!0

)

(t)]

(t):

(31)

13
Note that, since agents have quasi-linear preferences, one must give equal weights to all agents’ marginal
utilities for the assets.
14
Use (25) to rewrite (29) as (r + )v 0 (t)
M(t; t) + (1 r
) Et [M(t + ; t + )]. The expression
(30) then follows from (26).

17

Considering the opposite perturbation of decreasing dealers’inventories, we …nd that (31) holds
with equality whenever Ad (t) > 0. In the environment of the previous section, with no aggregate
uncertainty and where
Maximum Principle.

0 (0)

= 1, we can derive these …rst-order conditions formally using the

i
h
Lemma 6 An e¢ cient allocation fai (t)gIi=1 ; ad (t) satis…es
PI

(r + ) u0i [ai (t)] +

j=1

r+
0

0
j uj

[ai (t)]

+

[ad (t)] +

_ (t)

r+

=

(t) ,

= (t);

(32)
(33)

the resource constraint (17), and the transversality condition
lim e

rt

(t) = 0;

(34)

(t)ad (t) = 0;

(35)

t!1

for some (t)

0. In addition, if ad (t) satis…es
lim e

rt

t!1

h
i
then fai (t)gIi=1 ; ad (t) is an optimal path.
If we identify the equilibrium “price,” (t), with the planner’s shadow price of assets,

(t),

and compare (4) and (11) with (32) and (33), it becomes apparent that they would be identical
if

= , i.e., if

were equal to zero. The following proposition formalizes this observation.

Proposition 1 Equilibrium is e¢ cient if and only if
Whenever

= 0.

> 0, an ine¢ ciency arises from a holdup problem due to ex-post bargaining.

Whenever they trade, investors anticipate the fact that they will have to pay fees for rebalancing
their asset holdings in the future. These intermediation fees increase with the surplus that the
trade generates. As a consequence, investors will tend to avoid positions that could lead to
large rebalancing in the future.

6

Crash and deterministic recovery

In this section, we describe the dynamic adjustment of the asset price and the allocation of
assets between dealers and investors following a market crash. We think of a market crash as
18

a sudden rise in selling pressure, and model it as a one-time unexpected shock that modi…es
the distribution of investors across preference types, fni (t)gIi=1 , in a way that causes the total
demand for the asset to fall unexpectedly.15 We suppose that the economy is in the steady state
at the time this shock hits, which we take to be t = 0. The total quantity of assets demanded
by investors is lowest at t = 0, and then gradually recovers over time as the initial distribution
of preference types, fni (0)gIi=1 , reverts back to the invariant distribution, f i gIi=1 .

In order to highlight the intermediation role of dealers, we assume that they start o¤ with

no inventory, ad (0) = 0, and that they get no utility from holding the asset, i.e.,

(a) = 0.

In this formulation, dealers will only buy assets for their own account in an attempt to make
capital gains over some holding period. Hence, Ad = 0 in the steady state, since dealers cannot
make capital gains if the asset price is constant. For investors, we adopt ui (a) = "i a1 =(1
),
P
(r+
)"
+
"
which implies Ui (a) = "i a1 =(1
), with "i = r+ +i
and " = Ik=1 k "k . The following

lemma summarizes the key properties of the investor’s and the dealer’s optimization problems.
Lemma 7 (a) An investor with preference type i who gains access to the market at time t,
demands
ai (t) =

"i
(t)

1=

:

(36)

(b) A dealer’s asset holdings satisfy
[rp (t)

p_ (t)] ad (t) = 0:

(37)

The second part of Lemma 7 formalizes the notion that if dealers do not enjoy any direct
bene…ts from holding the asset, then they will only hold it to try to obtain capital gains.
Dealers hold no inventories over periods when the price is growing at a rate lower than the
rate of time preference. Conversely, they are willing to take long positions in the asset only if
p_ (t) =p (t) = r. (Naturally, p_ (t) =p (t) > r would be inconsistent with equilibrium.) We can use
(15) to express the dealer’s optimality condition as
"
#
_ (t)
(t)
Ad (t) = 0;
r+
with _ (t) = (t)

r + , where Ad (t)

(38)

0 denotes dealers’aggregate inventories. (Notice that

individual dealers need not hold the same inventories here.)
15

This is the same notion of market crash used by Weill (2006). We study a di¤erent notion of market crash
in the following section.

19

With (18) and (36), the market-clearing condition (22) can be written as
A_ d (t) =
where E =

PI

i=1

1=
i "i

n
A

and E0 =

Ad (t)

(t)

PI

1=
i=1 ni (0)"i

1=

h

E

e

t

E

. Intuitively, (t)

E0

io

1=

E

;

(39)
e

t

E

E0

is

the total quantity of assets demanded by investors at time t. This way of writing the investors’
aggregate demand reveals two sources of time variation. First, investors’aggregate demand will
change in response to changes in the e¤ective cost of purchasing the asset, (t). The second
component, E

e

t

E

E0 , captures changes in aggregate demand due to composition

e¤ects coming from variations in the distribution of investors over the various preference types.
The constant E is a measure of investors’willingness to hold the asset in the steady state, i.e.,
when ni (t) =

i,

while E0 re‡ects the investors’willingness to hold the asset at time 0, when

the aggregate shock hits. Thus, E0 =E is a measure of the magnitude of the composition shock
to aggregate demand for the asset. In line with our market crash interpretation, we maintain
E0 =E < 1 throughout the analysis, i.e., lower preference types receive larger population weights
at time 0 relative to the steady state.
The dealers’…rst-order condition, (38), and the market-clearing condition, (39), are a pair
of di¤erential equations that can be solved for
interval [t1 ; t2 ], then (38) implies (t) =

(t) and Ad (t). If Ad (t) > 0 for all t in some

e(r+ )(t t2 )

(t2 ), and given this path for

(t), (39) is

a …rst-order di¤erential equation that can be readily solved for the path Ad (t). Similarly, if
Ad (t) = 0 over some interval, then (39) immediately implies a path for (t). In order to fully
characterize the equilibrium path one needs to determine the time intervals over which dealers
accumulate inventories as well as the continuity of the trajectory. The following proposition
provides the salient features of the equilibrium path following a market crash.
Proposition 2 The unique equilibrium path, f (t) ; Ad (t)g, has the following features:
1. It converges to the steady state,

; Ad = f E=A

; 0g.

2. There exists a time T 2 [0; 1) such that Ad (t) > 0 for all t 2 (0; T ) and Ad (t) = 0 for
all t

T.

3. Let p0 (t) denote the equilibrium asset price that would obtain if dealers were constrained
to hold no inventories. Dealers intervene, i.e., T > 0, if and only if, at the time of the

20

crisis, t = 0,

p_ 0 (0)
p0 (0)

> r, which is equivalent to
PI

i=1 ni (0) [(r

PI

i=1

i [(r

+ ) "i + "]1=

+ ) "i + "]1=

<

r+

+

:

(40)

According to Proposition 2, the equilibrium path following a market crash is characterized
by a switching time T 2 [0; 1) such that dealers hold the asset for all t 2 (0; T ) and do not hold
it for t

T . It is possible that T = 0, in which case dealers do not hold inventories at all. The

last part of the proposition establishes that dealers will intervene if and only if p_0 (0)=p0 (0) > r,
i.e., if and only if the rate of growth of the asset price that would result at the time of the crisis
if they did not intervene, exceeds the rate of time preference.
If dealers intervene, the time period during which they hold the asset is an interval, which
starts at the outset of the crisis, i.e., at t = 0. (See Figure 4 for an illustration.) Thus, dealers
never …nd it bene…cial to delay the acquisition of the asset: If they will buy at all, they start
buying from the very beginning, when the investors’selling pressure is strongest. The economic
reasoning behind this result is that since dealers get no direct utility from holding the asset,
they are only willing to take long positions if the capital gains associated with those positions
are large enough, i.e., if the growth rate of the asset price is greater than the discount rate. It is
possible to show that, in the absence of dealers’intervention, the price of the asset, p0 (t), grows
at a decreasing rate. Hence, if dealers don’t have incentives to hold inventories at t = 0, they
never will. In contrast, Weill (2006) …nds that dealers do not necessarily start accumulating
inventories right after the crash, and that for some parameter values, delaying the intervention
of dealers is socially optimal.16
Notice that the left side of (40) equals E0 =E. Thus, the last part of Proposition 2 states
that the condition for dealers to participate, i.e., p_0 (0)=p0 (0) > r, can be expressed in terms of
16

The key assumption in Weill (2006) that lies behind this result is that investors’ utility function is of the
Leontief form, u(a) = minfa; 1g, so they are e¤ectively restricted to hold zero or one unit of the asset. In
contrast, here we allow investors to hold any nonnegative position. To reconcile our results with Weill’s, we can
nest Weill’s speci…cation with ours by assuming an investor’s utility function is

u(a) =

h

+ (1

)a
1

1

i

1

;

for some ( ; ) 2 R+ (0; 1). Our isoelastic utility function is obtained as ! 1 , and Weill’s Leontief utility
function is obtained as ! 0+ . Numerical calculations (available upon request) suggest that, for close to zero,
we would recover Weill’s result that dealers do not necessarily start accumulating inventories at the time of the
crash.

21

the exogenous severity of the crash, as measured by 1

E0 =E, i.e., the magnitude of the initial

drop in the investors’ willingness to hold the asset. If this drop is larger than the threshold
1

r+ +

, then dealers will step in to take up the slack resulting from the reduction in investors’

demand. Conversely, dealers will not intervene if (40) is not satis…ed. Condition (40) depends
on all the fundamentals of the economy, e.g., preferences ( ), the extent of trading frictions
and the market-power of dealers ( ), the change in the distribution of valuations that triggers
the crisis (fni (0)gIi=1 ) and the frequency of the preference shocks ( ). As shown in the next
corollary, there exist parametrizations for which condition (40) does not hold.
Corollary 1 The set of parameter values under which dealers do not accumulate inventories
(i.e., T = 0) is nonempty.
Corollary 1 contrasts with Theorem 1 in Weill (2006), which establishes that there is always a
period of time during which dealers lean against the wind before the investors’selling pressure
subsides.17 A su¢ cient condition for condition (40) to fail is that (r + ) = be su¢ ciently large.
Suppose that preference shocks are very persistent ( very small). In this case the recovery is
slow, the growth rate of the asset price is small, and dealers …nd that the prospective capital
gains are smaller than the opportunity cost of holding the asset. It is also instructive to consider
the limiting case as

goes to in…nity and the economy approaches the frictionless Walrasian

benchmark. In this case, dealers no longer have the advantage of trading continuously vis-à-vis
investors, and their ability to realize capital gains vanishes (recall our discussion of (16)). Put
di¤erently, as frictions vanish, the market provides dealers no incentive to buy assets early in
the crisis, and they do not intervene regardless of the severity of the crisis.
Below, we will show that there are also parametrizations for which condition (40) is satis…ed
and dealers buy assets at the beginning of the crisis, hold them for a while and sell them o¤ as
the investors’ selling pressures subside. In these cases, dealers choose positive asset positions
(foregoing interest on their stock of the numéraire good) even though they get no utility from
holding these assets. The reason why dealers may be willing to carry assets is that they have
continuous access to the market while investors do not: This trading advantage allows dealers to
“time the market” continuously in order to capture capital gains that investors cannot realize.
Without dealers, or if dealers were unable to hold inventories, these capital gains would remain
17

This di¤erence in results is also due to the fact that investors’ asset holdings are unrestricted here but
subject to a unit upper bound in Weill (2006) (see footnote 16).

22

unexploited. In equilibrium, competition among dealers ends up equalizing these capital gains
to the opportunity cost of holding assets, i.e., p=p
_
= r. This logic is consistent with the
frictionless limit we discussed above.
Next, we use numerical examples to illustrate and explain how the key parameters in‡uence
the dealers’ incentives to hold inventories. In what we will consider to be the benchmark
example, we set

= 1=2 and assume that the preference shock can either be "1 = 0 or "2 = 1,

with equal probability. This means that the invariant distribution has an equal measure of
investors with low and high valuations. We also set r = 0:05 and

=

= 1, so that on average,

investors get one preference shock and one chance to trade per “period.” We also set

= 0 so

that the equilibrium allocation of the benchmark parametrization corresponds to the solution
to the planner’s problem. We consider an economy which is at its steady state, and at time 0
is subject to a shock that causes the fraction of investors with the low preference shock to rise
from

= 1=2 to n1 (0) = 0:95.

The shaded (green) regions in Figure 3 illustrate the combinations of parameter values for
which condition (40) is satis…ed so that dealers hold inventories after the crash. In each panel,
we let the two parameters in the axes vary and keep the rest …xed at their benchmark values.
All panels have

— our index of the degree of the trading frictions— on the horizontal axis.

Markets with large

are very liquid markets where trades get executed very fast.

Figure 3 allows us to address the following normative question: Could it be socially e¢ cient
for dealers to accumulate inventories, even though they are pure speculators who don’t derive
any direct utility from holding assets? The answer is: yes. Recall (Proposition 1) that the
equilibrium allocations of an economy with

= 0 correspond to the Pareto-optimal allocations.

The third panel of Figure 3 shows that there are parameterizations involving

= 0 where

dealers indeed choose to intervene. As explained in Section 5, the planner allocates assets to
dealers in order to exploit an intertemporal trade-o¤ between the marginal utility of investors
in the market at the current date and in the future. The average marginal valuation of the asset
across investors is low at the outset of the crisis and higher later on. The planner uses dealers’
inventories to smooth these marginal valuations over time. Speci…cally, the planner may choose
to put assets in the hands of dealers in the early stages of the crisis (when the opportunity cost
of not allocating them to investors is relatively low) to be able to transfer these assets without
delays to investors in the later stages of the crisis, when the marginal valuation of the average
investor is high. Therefore, depending on fundamentals, it can be optimal to have dealers act

23

Figure 3: Parametrizations for which dealers “lean against the wind”

as a “bu¤er stock.” The opportunity cost of having dealers carry an asset they don’t value for
a while is the price the planner pays to provide immediacy to the future higher-than-averagevaluation “cohorts” of investors that will gain access to the asset market at later dates. Let
us now turn to the e¤ects of fundamentals on dealers’likelihood to intervene during the crisis.
In turn, we will consider the e¤ects of the characteristics of the crisis, market structure and
investors’preferences.
Characteristics of the crisis.

The …rst panel in Figure 3 shows that for any given , dealers

intervene if n1 (0) is large enough, i.e., if the crash is su¢ ciently severe. To explain this result
we resort to the connection to the planner’s problem (but there is an equivalent explanation
in terms of the dealers’ incentives in the equilibrium). In the early stages of the crisis, the
“cohorts”of investors that contact the marketplace involve a very large fraction of low-valuation
investors who have relatively low individual demands for the asset. If the planner chooses not
to use the dealers’ inventories, then in these early stages he will be reallocating more assets
24

to the few high-marginal-valuation investors. Such an allocation will imply a very low shadow
price of assets (denoted

(t) in Section 5) in the early stages of the crisis. Conversely, the

shadow price of the asset will be relatively large at later dates, as the fraction of high-valuation
investors increases toward its steady-state level, since at that point there will be many more
high-valuation investors who are willing to hold relatively large quantities of the asset. To
larger values of n1 (0) correspond larger discrepancies between the marginal utilities of earlier
and later cohorts of investors, among which the planner can reallocate assets (this discrepancy
is measured by the term (t +

)

(t) of (30)). Dealers o¤er the planner a way to smooth

these di¤erences in intertemporal marginal utilities across cohorts of investors, and are used as
a bu¤er stock for large values of n1 (0), i.e., whenever the crash is severe.
The second panel in Figure 3 shows that, given
the recovery is fast enough (i.e., if

, dealers …nd it optimal to intervene if

is large enough), so that they would not have to hold the

asset for very long. However, the …gure also shows that dealers won’t intervene if
This is because

is too large.

not only measures the speed of the recovery but also the arrival intensity of

idiosyncratic preference shocks. With a very large , the average type of an investor over his
holding period, e.g., "i , becomes very close to the mean, ". In this case, the economy becomes
very similar to an economy without idiosyncratic preference shocks, so there is little need to
reallocate assets across investors (see our discussion of Corollary 1).
Market structure.

We identify the structure of the market with two parameters:

, the

extent of the trading frictions, and , dealers’bargaining strength. The …rst panel in Figure 3
shows that, for a given size of the aggregate shock, dealers provide liquidity if trading frictions
are neither too severe nor too small. For large , investors face short delays to rebalance their
asset holdings, 1= on average. This increases their willingness to take more extreme positions.
In particular, investors with higher-than-average utility become more willing to hold largerthan-average positions and absorb more of the selling pressure. In some cases, when

is large

enough, they end up supplying so much liquidity to other investors that dealers don’t …nd it
pro…table to step in. Conversely, if

is very small, then "i becomes close to ", and all investors

choose very similar asset holdings regardless of their preference type. In this case, the economy
becomes similar to an economy without idiosyncratic preference shocks, and dealers are not
needed to reallocate assets across investors.
The third panel in Figure 3 reveals that for any given

25

, dealers are more likely to hold

inventories if their bargaining power is neither too large nor too small. Since
enter the equilibrium conditions as a product, an economy with large

and (1

)

is, from an investor’s

standpoint, payo¤ equivalent to an economy where investors access the market very infrequently,
i.e., an economy with small

. Recall that if

= 0, the economy is constrained-e¢ cient.

Therefore, the third panel shows that there are parametrizations for which dealers intervene in
equilibrium although the planner would not have them intervene, as well as parametrizations
for which the opposite is true.
Preferences.

The fourth panel of Figure 3 illustrates the role that , the curvature of the

investor’s utility function, plays in the dealer’s decision to hold the asset. First,

< 1 is a

necessary condition for dealers to intervene. In the case of the most severe crisis possible, i.e.,
n1 (0) = 1 (no investor values the asset at t = 0), one can show that dealers intervene if and
only if

< 1 regardless of the value of . If

= 1, the trajectory of the price is
I

"
e t X
p(t) =
+
ni (0)("i
rA (r + ) A

");

i=1

which is independent of . In fact, in this case p(t) coincides with the price that would prevail
in a frictionless Walrasian market.18 But as we argued earlier, in a Walrasian market dealers
would hold no assets since arbitrage by investors would prevent the asset price from growing
faster than the discount rate. Therefore, dealers never hold inventories for

= 1. For lower

values of n1 (0), the dealers’incentives to hold the asset are nonmonotonic in . In particular,
for a range of values of

they only hold it if

too big or too small. Suppose that

is in some intermediate range, but not if it is

is very big, so that marginal utility is very steep. One

could think that there is more room for dealers to smooth di¤erences in intertemporal marginal
utilities across cohorts. However, if

is very large, then the individual asset demand of an

investor with high valuation tends to be very close to the asset demand of an investor with low
valuation, and this reduces the bene…t from transferring assets between them. In the extreme
case

! 1, ai (t) = A for all i and all t. But of course this means that shocking the invariant

distribution from f i gIi=1 to fni (0)gIi=1 has no e¤ect on asset holdings. So e¤ectively, there

is no shock and thus no gain from liquidity provision, even if f i gIi=1 …rst-order stochastically
18
With log preferences an investor’s demand is linear in "i , so the aggregate demand for the asset only depends
on ", i.e., it is independent of , see Lagos and Rocheteau (2007). For a related result
under a CARA utility
P
function, see Gârleanu (2006). Also, note that for = 1, condition (40) reduces to Ii=1 ni (0)"i < 0, indicating
that dealers never intervene.

26

dominates fni (0)gIi=1 . Alternatively, one can interpret 1= as the elasticity of asset demand,
ai , with respect to the preference shock, "i . As

! 1, asset demand becomes inelastic to the

preference shock. In this case, the planner’s shadow price ( (t) in the notation of Proposition
6) is constant over time, so there is no need nor scope for him to reallocate assets over time.

It is also instructive to look at the opposite extreme of very low . For example, consider
what happens as
::: < "I

.19

! 0 so that investors’preferences become linear. Suppose that "1 < "2 <

From (11) it follows that ai ! 0 for i 2 f1; :::; I

1g, i.e., only investors with the

highest marginal utility, "I , hold the asset. Furthermore, (t) ! "I for all t and, from (21),
p(t) ! p = "I =r for all t. Thus, the price of the asset is constant and equal to its steady-state

level. There is clearly no incentive for dealers to buy the asset, regardless of the initial shock to
the population weight of investors with high valuation. In this extreme case, investors’desired
holdings change dramatically in response to preference shocks, but marginal utility is constant
at all times among those who demand the asset, so a planner would have no need to use dealers
to “store”the assets in order to smooth the marginal utilities of cohorts of investors at various
points in time.
We can summarize the discussion above as follows. Dealers provide liquidity by accumulating asset inventories if: (i ) the market crash is abrupt and the recovery is fast; (ii ) trading
frictions are neither too severe nor too small; (iii ) dealers’market power is not too large; (iv )
idiosyncratic preference shocks are not too persistent and investors’ asset demand is not too
inelastic with respect to preference shocks.

Figure 4: Dealers’asset holdings

19

This utility speci…cation is the same one used in Du¢ e et al. (2005) and Weill (2006), except that they
assume a unit upper bound on investors’holdings.

27

While Figure 3 illustrates the conditions under which dealers accumulate inventories, it is not
informative about the extent of dealers’intervention, e.g., what quantity of the asset do dealers
accumulate, and how long is the holding period? To answer these questions, Figure 4 plots the
trajectory for dealers’inventories for the parameter values of our benchmark example.20 In both
panels one can clearly identify T , namely the switching time at which Ad (t) becomes zero after
a period over which dealers have held assets. The …rst panel illustrates the relationship between
market structure ( ) and dealers’inventory policy. Trading frictions have a nonmonotonic e¤ect
on T : the length of the holding period is increasing in

for low values of

(because investors

take more extreme positions, which increases the discrepancy between their marginal utility
at di¤erent dates), and decreasing for large values of

(because investors need less liquidity

from dealers when trading frictions are mild). The second panel of Figure 4 describes dealers’
inventory behavior as a function of the severity of the crash. As n1 (0) decreases, the holding
period shrinks and the quantity of assets held by dealers at any point in time becomes smaller.
So in a more severe crash, dealers provide more liquidity and for a longer period of time.
The following proposition compares the trajectory for (t), the equilibrium e¤ective cost of
holding the asset, to the trajectory of

0 (t),

the e¤ective cost of holding the asset that would

result if dealers were constrained to hold no inventories.
Proposition 3 If condition (40) holds, then there exists t such that (t) >
and (t) <

0 (t)

for all t 2 (t; T ).

0 (t)

for all t 2 [0; t)

According to Proposition 3, the presence of dealers mitigates the e¤ect of the market crash on
the e¤ective cost of holding the asset. By accumulating inventories right after the crash, dealers
prevent

from falling too much: (0) is higher than it would have been had dealers not stepped

in to buy assets. This is illustrated in Figure 5.

7

Crash and stochastic recovery

In the previous section, our operational de…nition of a “market crash” was a shock to the
distribution of investors across valuations which caused the investors’ total demand for the
asset to fall. The recovery path corresponded to the transitional dynamics leading to the
20

Together with Proposition 2, Lemma 13, which is stated and proved in Appendix A, provides a full characterization of the equilibrium path following a market crash, including closed-form expressions for the paths of
(t) and Ad (t).

28

^

0

T
Ad (t ) = 0

Ad (t ) > 0

Figure 5: Paths for

0 (t)

and (t)

steady state, so it was deterministic and it started immediately after the shock. It may be
argued that during actual market crashes, the investors’ behavior and the dealers’ decisions
about whether to intervene and when to intervene, may be a¤ected by uncertainty about the
duration of the crisis. For this reason, in this section we study the dealers’incentives to provide
liquidity in the aftermath of a crisis with an uncertain recovery.
We consider the following scenario. At time zero all investors receive an unanticipated
multiplicative shock that temporarily scales down their marginal utility from holding the asset.
This constitutes the crash. Subsequently, the economy awaits a “recovery shock”that follows a
Poisson process with arrival rate

which causes all investors to simultaneously revert back to

their pre-crisis willingness to hold the asset. Formally, we let T be an exponentially distributed
random variable with mean 1= , where T denotes the time at which the economy reverts to
normal. An investor with preference type i gets utility ui (a) from holding a for all t < 0
and all t

T . For t 2 [0; T ), the investor gets utility Rui (a), with R < 1. Thus, a small

R indicates that the crash is severe, and a small

that it is expected to be long-lived.21

We assume that the stochastic process that describes the recovery is independent of the one
21

One virtue of this formulation is that it disentangles the speed of the recovery, , and the frequency of the
idiosyncratic preference shocks, . In the previous section, both were captured by .

29

that governs an investor’s transitions between preference types. Furthermore, in this section
we assume fni (0)gIi=1 = f i gIi=1 , i.e., that the initial distribution of preference types is the
invariant distribution.

We discuss the equilibrium dynamics using Figure 6. (Appendix B provides an analytical
solution of the model.) We let A`d (t) be the dealers’inventories at time t, conditional on t < T ,
i.e., given that the recovery has not occurred until time t. We denote

`

(t) the e¤ective cost

of holding the asset before the recovery takes place. Similarly, we use the superscript “h” to
denote variables after the recovery has occurred. The isocline A_ ` = 0 is located to the right of
d

the isocline A_ d = 0 implied by (22). This is because, for any given , dealers need to hold more
`
of the asset in order to clear the market. The isocline _ = 0 is downward-sloping and located
underneath the saddle-path leading to the long-run steady state,

; 0 . The equilibrium unfolds

as follows. The economy starts at A`d (0) = 0, and at the time of the crash,
saddle-path leading to (

`

; A`d ).

jumps down to the

(This saddle-path is represented by a dotted line in the …gure.)

The economy then evolves along this saddle-path until the random recovery shock occurs. In
the meantime, along this path, dealers’inventories increase and

`

(t) decreases. At the random

time when the recovery occurs, say t , the system jumps to the saddle-path leading to
This saddle-path, denoted

;0 .

= (Ad ), is represented by a dashed line in the …gure. At the time

the recovery shock occurs, the cost of holding the asset jumps from

`

to

h

, and dealers begin

selling their inventories gradually until they are completely depleted.
The following proposition provides a condition under which A`d (t) > 0 for all t > 0 before the
recovery occurs, i.e., a condition for dealers to lean against the wind during a crisis of random
duration. It is convenient to de…ne V~i` (a) as the expected sum of discounted utility ‡ows from
holding asset position a for an investor of preference type i until the next time he contacts a
dealer, and U ` (a) = (r + )V~ ` (a).22
i

i

Proposition 4 Let p`0 be the asset price during the crisis, and ph0 be the price after the stochastic
recovery, that would obtain if dealers were constrained to hold no inventories. Dealers hold
inventories during the crisis if and only if
I
X
i=1

22

`0 1
i Ui

`
(ph
0 p0 )
p`0

r+

> r, which is equivalent to

+

< A:

We report the expression for Ui` (a) in the proof of Lemma 15 in Appendix B.

30

(41)

Ad = 0
Adl = 0

ξ

l

ψ Ad

>>>>

ξl = 0

Ad

Ad (tρ) Adl

Figure 6: Stochastic recovery: Phase diagram

Proposition 4 provides a condition on fundamentals such that dealers …nd it bene…cial to buy
assets during the crisis. Analogously to what we found for the case of a deterministic recovery,
dealers intervene if and only if (ph0

p`0 )=p`0 > r, i.e., if and only if the expected capital gain

that they would obtain by buying the asset during the crash and re-selling it once the economy
recovers, in an economy where dealers do not intervene, exceeds the rate of time preference.
Condition (41) need not always hold, as the following two limiting cases show. Consider
…rst the frictionless limit

! 1. Then, Ui` (a) ! Rui (a), and the left side of (41) approaches

1. If investors can access the market as frequently as dealers, there is no role for dealers to
provide liquidity by buying assets. Next, consider the case where

! 0, i.e., the crisis becomes

permanent. Again, the left side of (41) can be shown to approach 1. If the shock is permanent,

dealers cannot expect to make capital gains, and therefore they do not invest in the asset. We
summarize these …ndings as follows.

Corollary 2 The set of parameter values under which dealers do not accumulate inventories
is nonempty.
Corollary 2 is the analogue of Corollary 1 for a crisis of random duration. Next, we show that
there exist parameterizations for which condition (41) is satis…ed. To this end, let u (a) =

31

a1

=(1

) and ui (a) = "i u (a). Then, during the crisis, an investor’s ‡ow expected utility

Ui` (a) = ^"i u(a), where ^"i is given in the following corollary.
Corollary 3 Let ui (a) =

"i a1
1

. Dealers hold inventories during a crash if and only if
PI

i=1
PI
i=1

where
^"i =

r+
r+ +

1=
"i
i^
1=
i "i

PI
(r+ + )"i +
j=1
r+ + +

1

<

r+

j "j

R+

+

;

(42)

PI
(r+ + )"i +
j=1
r+ +
r+ + +

j "j

:

Condition (42) is a condition on fundamentals, including the degree of trading frictions, preferences and the properties of the crash. The shaded (green) regions in Figure 7 illustrate the
combinations of parameter values for which condition (42) is satis…ed so that dealers hold inventories in times of crisis. The benchmark parametrization is:
=

= 1,

= 1, R = 0:02 and

= 0:5, r = 0:05,

1

=

2

= 0:5,

= 0. In each panel, we let the two parameters in the axes

vary and keep the rest …xed at their benchmark values. All panels have

— our index of the

degree of the trading frictions— on the horizontal axis.
Characteristics of the crisis.

The …rst panel con…rms one of our …ndings from Section 6:

dealers are more likely to accumulate asset inventories when the market crash is severe (R low).
If the crash is severe, dealers expect a larger capital gain when the economy recovers and hence
they have an incentive to buy assets during the crash. According to the second panel of Figure
7, for dealers to buy the asset, the crash must be anticipated to be short-lived ( must be
su¢ ciently large). From the planner’s standpoint, if

is small, the opportunity cost of having

dealers hold assets (i.e., the utility foregone by investors) is high. Thus, for

low enough, the

planner would not use dealers’inventories to reallocate the asset across investors over time.
Market structure.

As before, we identify the market structure with the parameters

and

. The third panel of Figure 7 shows that dealers accumulate the asset if their bargaining
power is neither too large nor too small. If

is close to 1, investors only enjoy a small gain

from rebalancing their asset holdings. As a consequence, when in contact with a dealer they
put more weight on their average preferences in order to reduce their need to readjust their
asset holdings in the future. As discussed above, if idiosyncratic preference shocks become less

32

relevant, there is less scope for dealers to help reallocate the asset over time. To understand
why dealers have lower incentives to provide liquidity when

is small, recall that a reduction in

is similar from the point of view of investors’payo¤s to an increase in : If trading frictions
are reduced, there is less need for the bu¤er stock of assets provided by dealers.
Preferences.

The fourth panel shows that the curvature of investors’utility function must be

su¢ ciently small for dealers to accumulate asset inventories. As before, if

is high, investors’

demand for the asset is relatively inelastic with respect to the idiosyncratic preference shock,
which reduces the usefulness of dealers.
To conclude, we study how the characteristics of the crash and the structure of the market
a¤ect the amount of liquidity provided by dealers. For our baseline parameter values, in Figure
8 we plot the maximum quantity of assets that dealers are willing to accumulate during the
crash, namely, A`d = limt!1 A`d (t).23 The …rst panel con…rms the nonmonotonic relationship
between dealers’ provision of liquidity and the degree of frictions that prevail in the market.
The second panel shows that dealers’willingness to provide liquidity increases with the severity
of the crisis. According to the third panel, the relationship between the maximum amount of
liquidity that dealers are willing to provide and the expected duration of the crisis (1= ) is
nonmonotonic. If the crash is very persistent ( small) dealers are not willing to accumulate
large positions since the expected discounted capital gain of these inventories is small. If the
crash is anticipated to be short-lived ( large), dealers will not accumulate too much inventories
because the crash reduces investors’asset demand only by a small amount. The fourth panel
shows that dealers’ inventories decrease as investors’ intertemporal elasticity of substitution
(1= ) gets smaller. In particular, as investors’utility function becomes linear ( ! 0) dealers
are willing to accumulate the entire stock of assets in the economy (A`d ! A).

We can summarize the results in this section as follows. Dealers are more likely to provide

liquidity during a crash with stochastic recovery if: (i ) the market crash is abrupt and expected
to be short-lived; (ii ) dealers’ market power is above some minimum value but not too close
to one; (iii ) trading delays are neither too long nor too short; (iv ) investors’asset demand is
su¢ ciently elastic with respect to idiosyncratic preference shocks. The amount of liquidity provided by dealers, as proxied by the maximum quantity of assets they are willing to accumulate,
increases with the severity of the crash but is nonmonotonic with respect to the duration of the
23

In Appendix B we report a closed-form expression for A`d .

33

Figure 7: Parametrizations for which dealers “lean against the wind”

crisis and the extent of the trading frictions.

8

Conclusion

We have studied the equilibrium dynamics of an asset market in the presence of the types of
trading frictions that are characteristic of many …nancial markets during times of crisis and
of many other markets, e.g., over-the-counter markets, even in normal times. In particular,
we have analyzed the recovery path of the market in the aftermath of an aggregate shock to
investors’ preferences, which we interpret as a crash or could also be thought of as a “‡ightto-liquidity shock.” In principle, dealers can mitigate the e¤ects of such aggregate shocks on
the asset price by providing liquidity during these times of market distress. However, there is
evidence that sometimes they do, and sometimes they don’t.
We have established conditions on fundamentals, such as the extent of the trading frictions,
the degree of market power of dealers, and the severity and expected duration of the crash, under
34

Figure 8: Dealers’provision of liquidity

which dealers will …nd it pro…table to step in to accumulate asset inventories during times when
investors’demand collapses, thereby preventing the asset price from falling as much as it would
have had they not intervened. We have found that dealers are more likely to accumulate asset
inventories during a market crash if execution delays are neither too long nor too short. This
suggests that a regulation that increases the capacity of dealers to execute a large volume
of orders, thereby reducing trading delays, may in fact reduce dealers’ incentives to provide
liquidity during a market crash.24 Similarly, dealers are less likely to accumulate inventories
in times of crisis if they have high bargaining power. This suggests that a market reform
that reduces dealers’rents can improve liquidity during times when selling pressures intensify.
Finally, since dealers’incentives to accumulate inventories are based on their expected capital
gains, our theory predicts that dealers will provide liquidity when the crash is abrupt and
short-lived.
From a normative standpoint, we have established necessary and su¢ cient conditions for
liquidity provision by dealers to be e¢ cient. We have found that there exist parametrizations
for which dealers accumulate asset inventories when it is socially ine¢ cient for them to do so,
as well as parametrizations for which the opposite is true.
24

The regulatory developments in the securities markets since the October 1987 crisis are reviewed in Lindsey
and Pecora (1998). According to Lindsey and Pecora (1998, p.290) “most exchanges now have excess capacity
of approximately three times that needed for an average trading session.”

35

References
[1] Benveniste, L. M., and J. A. Scheinkman (1982). “Duality Theory for Dynamic Optimization Models of Economics: The Continuous Time Case,” Journal of Economic Theory
27(1) (June): 1–19.
[2] Bernardo, Antonio and Ivo Welch (2004). “Liquidity and …nancial market runs,”Quarterly
Journal of Economics 135–158.
[3] Borio, Claudio (2004). “Market distress and vanishing liquidity: anatomy and policy options,” Bank of International Settlements Working Paper 158.
[4] Costantinides, George (1986). “Capital Market Equilibrium with Transaction Costs,”Journal of Political Economy 94, 842-862.
[5] Du¢ e, Darrell, Nicolae Gârleanu, and Lasse Heje Pedersen (2005). “Over-the-Counter
Markets,” Econometrica 73(6) (November): 1815–47.
[6] Du¢ e, Darrell, Nicolae Gârleanu, and Lasse Heje Pedersen (2006). “Valuation on Overthe-Counter Markets,” Review of Financial Studies (Forthcoming).
[7] Gârleanu, Nicolae (2006). “Portfolio Choice and Pricing in Illiquid Markets.” Working
Paper, University of Pennsylvania Wharton School.
[8] General Accounting O¢ ce (2003). “Potential terrorist attacks: Additional actions needed
to better prepare critical …nancial participants,” 03-251.
[9] Grossman, Sanford and Merton Miller (1988). “Liquidity and market structure,” Journal
of Finance 43, 617-633.
[10] Halkin, Hubert (1974). “Necessary conditions for optimal control problems with in…nite
horizons,” Econometrica 42, 267-272.
[11] Hamilton, James (1996). “The daily market for federal funds,” Journal of Political Economy 104, 26-56.
[12] Harris, Larry. Trading & Exchanges: Market Microstructure for Practitioners. Oxford University Press, 2003.
36

[13] Hendershott, Terrence and Mark Seasholes (2006). “Market maker inventories and stock
prices,” unpublished manuscript (U.C. Berkeley).
[14] Ho, Thomas and Hans Stoll (1983). “The dynamics of dealer markets under competition,”
Journal of Finance 38, 1053-74.
[15] Lagos, Ricardo and Guillaume Rocheteau (2006). “Search in asset markets,” Federal Reserve Bank of Cleveland Working Paper 06-07 and Federal Reserve Bank of Minneapolis
Sta¤ Report 375.
[16] Lagos, Ricardo and Guillaume Rocheteau (2007). “Search in asset markets: Market structure, liquidity and welfare,” American Economic Review 97 (Papers and proceedings),
198-202.
[17] Lo, Andrew W., Harry Mamaysky, and Jiang Wang (2004). “Asset prices and trading
volume under …xed transactions costs,” Journal of Political Economy 112, 1054–1090.
[18] Lindsey, Richard and Anthony Pecora (1998). “Ten years after: Regulatory developments
in the securities markets since the 1987 market break,” Journal of Financial Serivices
Research 13, 283–314.
[19] Longsta¤, Francis (2005). “Financial claustrophobia: Asset pricing in illiquid markets,”
unpublished manuscript.
[20] Michaely, Roni and Vila, Jean-Luc (1996). “Trading volume with private valuation: Evidence from the ex-dividend day,” Review of Financial Studies 9, 471-509.
[21] O’Hara, Maureen (1997). Market Microstructure Theory, Blackwell: Malden, MA.
[22] Presidential Task Force (1988). “Report of the presidential task force on market mechanisms,” Washington DC, January.
[23] Securities and Exchange Commission (1998). “Trading analysis of October 27 and 28,
1997,” Division of Market Regulation of US Securities and Exchange Commission (September).
[24] Seierstad, Atle, and Knut Sydsæter (1987). Optimal Control Theory with Economic Applications. Amsterdam: North Holland.
37

[25] Stoll, Hans (1978). “The supply of dealer services in securities markets,”Journal of Finance
33, 1133-1151.
[26] Vayanos, Dimitri and Pierre-Olivier Weill (2007). “A Search-Based Theory of the On-theRun Phenomenon,” Journal of Finance, forthcoming.
[27] Weill, Pierre-Olivier (2007). “Leaning against the wind,” Review of Economic Studies,
forthcoming.

38

A

Proofs

Proof of Lemma 1. Consider any feasible inventory path a(t). Let W0t (a) denote the dealer’s
expected discounted utility from following a plan a from time 0 to t. Let t1 < t2 : : : be the
successive jumps of the price path, and let K be the last jump before some time t, we can write,
with the convention that t0 = 0,
Z t
f [a(s)] p(s)a(s)g
_
e
W0t (a) =
0

=

Z

t

[a(s)] e

rs

ds

=

K Z
X

ds

tk

p(s)a(s)e
_

t

[a(s)] e

rs

ds

0

Z

1
k=1
Z
K
X tk

k=1

Z

t

e

a(s) [rp(s)

tk

rs

p(s)]
_
e

+

p(s)a(s)e
_

rs

ds

a(s) [rp(s)

p(s)]
_
e

rs

ds

ds

K
X

e

rtk

p(tk )a(tk )

e

rtk

1

p(t+
k 1 )a(tk

1)

k=1

rt

p(t)a(t)

f [a(s)]
K
X

t

1

e

rtK

p(t+
K )a(tK )

t

0

ds +

Z

tK

tK

=

rs

tk

0

Z

rs

a(tk )e

a(s) [rp(s)
rtk

p(t+
k)

p(s)]g
_
e
p(tk )

e

rs

rt

ds
p(t)a(t);

k=1

where the second equality follows from integration by part over each interval [tk

1 ; tk ],

and the

last equality by collecting time-tk terms.
We …rst establish the “only if” part of the lemma. Consider any bounded solution a(t) to
the dealer’s problem and suppose that the price has a positive jump up at some tk . Then,
for " small enough, consider the perturbation a(t) +
(t) = 1 + (t

tk )=" for t 2 [tk

"; tk ],

(t) = 1

(t

(t) where

(t) = 0 for t < tk

tk )=" for t 2 [tk ; tk + "], and

thereafter. Then, using the above, the net utility of this perturbation,
Z tk +"
[a(s) + (s))]
[a(s)]e rs
(s) [rp(s) p(s)]
_
ds + e
tk "

Because a(s) and

W01 (a)
rtk

p(t+
k)

",

(t) = 0

W01 (a +

) is

p(tk ) :

(s) are bounded, the …rst term goes to zero as " goes to zero, showing

that the net utility of the perturbation converges to e

rtk

p(t+
k)

p(tk ) > 0, a contradiction

that proves that the price can only have a negative jump. If the price has a negative jump
p(t+
k)

p(tk ) < 0 then, as long as a(tk ) > 0 the reverse perturbation could improve the
39

dealer’s utility. Therefore, if there is a negative jump, then a(tk ) = 0. Now suppose that,
0 [a(s)]

at some di¤erentiability point s,

p(s).
_
Then, using the expression for W0t ,

rp(s)

one easily shows that a dealer could improve his utility by accumulating more inventories
around s. Therefore,

0 [a(s)]

rp(s)

p(s).
_
If the inequality is strict and a(s) > 0, then

accumulating less inventory around s would improve the dealer’s utility. Therefore, if a(s) > 0,
then rp(s)

p(s)
_
= 0. In order to establish the necessity of the transversality condition (6), we

calculate the net-utility of scaling down an optimal path a(t) by 1
We …nd
W0t (a)

W0t [(1

")a] =

Z

0

", for some small " > 0.

t

f [a(s)]

[a(s)(1

")]

Take limits as t ! 1 on both sides, to …nd
Z 1
1
1
W0 (a) W0 (a(1 ")) =
f [a(s)]

"a(s) [rp(s)

[a(s)(1

")]

p(s)]g
_
e

"a(s) [rp(s)

rs

ds "a(t)p(t)e

p(s)]g
_
e

rs

rt

ds

0

" lim a(t)p(t)e
t!1

Now divide by " and let " go to zero, to get
Z 1
1
1
W0 (a) W0 (a(1 ")) =
"a(s) 0 [a(s)]

rt

:

(43)

[rp(s)

p(s)]
_
e

rs

ds

0

=

lim e

t!1

rt

lim e

t!1

p(t)a(t);

rt

p(t)a(t)
(44)

where we have used the …rst-order condition (4). (Precise arguments for taking these limits are
provided in the last paragraph of the proof.) Because, a(t) is an optimal path, the net utility
calculated above must be positive, meaning that the limit of e
Since a(t) is positive, e

rt p(t)a(t)

rt p(t)a(t)

must be non-positive.

must converge to zero, and we are done. The “if”part of the

Lemma follows from Theorem 13, Chapter 3, in in Seierstad and Sydaester (1987).
Lastly, we show that we can take limits in (43) and (44). The left-hand side of (43) converges
by de…nition of the inter-temporal utility. Because of concavity and because of the …rst-order
condition (4), the …rst term on the right-hand side is positive and increasing, and thus converges
to some limit. Now note that p(t)e

rt

is positive and decreasing: indeed it can only jump down

and, by the …rst-order condition (4), its derivative is negative. Hence, p(t)e
Because a(t) is bounded, it follows that e

rt p(t)a(t)

rt

is bounded.

is also bounded. Taken together, this

implies that the …rst-term on the right-hand side of (43) has some …nite limit, and so does the
second term. For (44), note that
[a(s)]

[a(s)(1
"

")]

a(s) [rp(s)
40

p(s)]
_
& 0;

:

which allows us to apply the dominated convergence theorem.
Proof of Lemma 2. When evaluating an investor’s intertemporal utility we can ignore price
jumps: this is because the probability that an investor contact the market at a jump time is
equal to zero. We let the random ‡ow utility of an investor at time t be u(a; t), where we use
the time argument “t” as a short-hand for the investor’s current preference shock.
Notation. Considering an individual investor, we let T1 < T2 < : : : be the sequence of his
contact times with dealers, with the convention that T0 = 0. Also, we let Nt be the number of
contact times during [0; t]. Then, for any asset plan, a, we calculate the intertemporal utility
Z t
Nt
X
t
p(Tn )e rTn [a(Tn ) a(Tn 1 )] ;
V0 (a)
u[a(s); s]e rs ds
0

n=1

between 0 and t, along a realization of the contact time and type processes. This utility can be
decomposed as
V0t = U0t
where
U0t (a)

=

B0t (a) =

B0t + p(T1 )e
Z

rT1

t

rs

u [a(s); s] e

0
N
t 1
X

a(0)

r

p( t )a( t )e

t

;

ds;

a(Tn ) p(Tn )e

rTn

p(Tn+1 )e

rTn+1

:

n=1

We consider portfolio plans a that are bounded, and such that the intertemporal utility E [V01 (a)]
is well de…ned. We …rst establish:
Result 1. E U0t (a) , E B0t (a) , and E p( t )e

r

t

a( t ) converge to …nite limits.

Let’s start with E U0t (a) . When the investor’s utility is bounded below, then the result
follows from the assumption that the portfolio plan, a, is bounded. When the investor’s utility
is unbounded below and bounded above, we can assume without loss of generality that it is
negative. Then E[U0t ] is decreasing and thus converges either to some …nite or some in…nite
limit. The limit, in turn, must be …nite because
E[U0t ] = E[V0t ] + E[B0t ]

E[p(T1 )e

rT1

a(0)]

E[V0t ] + E[B0t ]
E[V0t ]

41

E[p(T1 )e

E[p(T1 )e

rT1

a(0)];

rT1

a(0)]

where the inequality follows because p(t)e

rt

is decreasing and B0t is therefore positive. Because

E[V01 ] is well de…ned, the right-hand side of the inequality is bounded below, implying that
E[U0t ] has a …nite limit. It then immediately follows that
h
i
E B0t + p( t )e r t a( t ) = E V0t
E U0t

E[p(T1 )e

rT1

a(0)];

also converges to some …nite limit. Note that B0t is increasing because a(t)
decreasing, implying
implies that E[B0t ]

that E[B0t ] has
E[V0t ] E[U0t ]

0 and p(t)e

rt

is

a limit. This limit must be …nite because the above equality
E[p(T1 )e

rT1 a(0)].

It then follows that E[p( t )e

r

t

a( t )]

also has a …nite limit, which completes this part of the proof.
Result 2. An investor’s intertemporal utility is
"1
X
E [V01 ] = (r + ) 1 E
e rTn fU [a(Tn ); Tn ]

(Tn )a(Tn )g

n=1

where
U [a(Tn ); Tn ] = (r + )E

Z

#

Tn+1

h
lim E p( t )e

t

t!1

r(s Tn )

u [a(s); s] e

r

i
a( t ) ; (45)

ds Tn :

Tn

To show that result, write
" "

E [B01 ] = E E

1
X

a(Tn ) p(Tn )e

n=1

= (r + )

1

E

"

1
X

rTn

p(Tn+1 )e
rTn

a(Tn ) (Tn )e

n=1

#

rTn+1

Tn

##

;

by de…nition of (Tn ). In addition note that, when u is bounded below, we can without loss of
generality assume that it is positive, and we have
u[a(s); s]e
and u[a(s); s]Is

t

rs

Ifs

u[a(s); s]e

tg

rs

Ifs

tg

u[a(s); s];

% u[a(s); s] as t goes to in…nity. The same reasoning go through with

opposite inequalities when u is negative. Therefore, an application of the dominated convergence
theorem implies that
E [U01 ]

= E

Z

t

u(a(s); s)e

0

= (r + )E

"

1
X

e

rs

rTn

ds = E

"

1 Z
X

n=1 Tn

#

U (a(Tn ); Tn ) ;

n=1

42

Tn+1

u(a(s); s)e

rs

ds

#

where the last equality follows by taking expectations of each term in the sum with respect to Tn .
Result 3. The ‡ow inter-contact time utility is U [a(Tn ); Tn ] = (r + )

1U
i(Tn ) [a(Tn )],

where

Ui (a) is de…ned in equation (11) of the lemma. To see why, denote,
"Z ~
#
T
rs
0
e uk(t+s) (a ) ds k(t) = i :
V~i (a; t) = Ei
0

By the Markovian nature of the process k(t), V~i (a; t) only depends on t through the condition
k(t) = i which is already captured by the subscript i. Therefore, hereafter we will slightly
abuse notation and write V~i (a) for V~i (a; t). Denote T^ the length of the period of time before
the investor receives a preference shock. By de…nition, T^ is exponentially distributed with mean
1= . The value of an investor can then be written recursively as follows,
#
"
"
Z T^
Z T~
rs
~
e ui (a)ds +E I(T^<T~)
e rs ui (a)ds + I(T^<T~) e
Vi (a) = E I(T~<T^)
0
0

r T^

#

V~k(T^) (a) ; (46)

where k(T^) indicates the new realization of the preference shock at time T^. Using the fact that
T~ and T^ are independent random variables, one can rewrite the …rst term on the right-hand
side of (46) as
"

E I(T~<T^)

Z

0

T~

e

rs

ui (a)ds

#

=
=

ZZ
Z

I(t~<t^) e
Z

1

t~

e
Z

t~

t^

e

t~

e

rs

ui (a)dsdt^dt~

0

e

t^

dt^

t~

Z

t~

e

rs

ui (a)dsdt~

0

=

ui (a)
r

=

ui (a)
:
( + ) ( + + r)

e

Z

[ + ]t~

1

e

r t~

dt~
(47)

Similarly, the second term on the right-hand side of (46) can be reexpressed as
"
#
Z T^
ZZ
Z t^
rs
t~
t^
E I(T^<T~)
e ui (a)ds =
I(t^<t~) e
e
e rs ui (a)dsdt^dt~
0

0

=

ui (a)
( + ) ( + + r)

(48)

Since the realizations of the preference shocks are independent and identically distributed, the

43

distribution of k(T^) is given by f i gIi=1 . Therefore,
h
E I(T^<T~) e

r T^

ZZ
i
V~k(T^) (a) =
I(t^<t~) e
=

t~

e

rt^

dt^dt~

I
X

~

k Vk (a)

k=1

I
X

+r+

t^

e
~

k Vk (a):

(49)

k=1

Adding (47), (48) and (49), one …nds
ui (a)
+
+ +r

V~i (a) =

I
X

+r+

~

k Vk (a):

(50)

k=1

After carrying out some calculations, (50) yields
Ui (a)
;
V~i (a) =
r+

(51)

where Ui (a) is as in (11).
Result 4. The expected discounted price at the time the investor regains direct access to the
asset market is:
r T~

E[e

p(t + T~)] =

Z

1

e

(r+ )s

p(t + s)ds:

(52)

0

Result 5. The “only if”part of the lemma. First, it is clear from (45) that an optimal portfolio
strategy should maximize each term U [a(Tn ); Tn ]

(Tn )a(Tn ), implying the investor’s …rst-

order condition. As for the necessity of the transversality condition, consider an optimal asset
holding plan and scale it down by (1

"), for some small enough ". Using (45), the net change

in intertemporal utility can be written

"

= (r + )

1

"

1
X

e

rTn

n=1

h
" lim E a( t )e
t!1

r

t

fU [a(Tn ); Tn ]

U [a(Tn )(1

"); Tn ]

i
p( t ) :

" (Tn )a(Tn )g

#

(53)
(54)

Divide by " and note that
1
U (a(Tn ); Tn )
"

U (a(Tn )(1

"); Tn )

(Tn )a(Tn ) &

44

Ua (a(Tn ); Tn )

(Tn ) a(Tn ) = 0;

because of the …rst-order condition in the lemma. Convergence is monotonic because of concavity. This last property allows us to apply the dominated convergence theorem, and we …nd
that
E

1
X
1

n=1

and thus

"

U (a(Tn ); Tn )

"

lim

"); Tn )

h
lim E a( t )e

t!1
"
0, it follows that limt!1 E a( t )e
"!0

Since a(t)

=

U (a(Tn )(1

r

t

r

t

(Tn )a(Tn ) ! 0;

i
p( t )

0:

(55)

p( t ) = 0, and we are done.

Result 6. For the “if” part, we consider a plan a that satis…es the …rst-order conditions and
compare it to some other plan a0 . We …nd
E[V01 (a) V01 (a0 )]
"1
X
= E
e rTn U (a(Tn ); Tn )

U (a0 (Tn ); Tn )

a0 (Tn )

(Tn ) a(Tn )

n=1

i
h
+ lim E p( t )e r t a0 ( t )
t!1
"1
X
e rTn Ua (a(Tn ); Tn )
E

(Tn )

a(Tn )

0

a (Tn )

n=1

#

#

0;

where the …rst inequality follows because of concavity, and the second inequality follows because
of the …rst-order condition in the lemma and because a0 ( t )

0.

Proof of Lemma 3. (a) To obtain (15), rewrite (12) as
Z 1
(r+ )t
(t) = (r + ) p(t)
e
(r + ) e

(r+ )s

p(s)ds

(56)

t

and di¤erentiate with respect to t.

Proof of Lemma 4. First note that the dealer’s …rst-order conditions imply that the price can
only have negative jumps and that d=dt(e

rt )

= p(t)
_

rp(t)

0. Hence, p(t)e

and positive, and thus has a limit. Now we know that
h
i
E p( t )e r t a( t ) ! 0;

where a(t) denotes the asset holding of some investor and
investor before t. Note that the cdf of
Pr(

t

t

t

Ns = 0) = e
45

is decreasing

the last contact time of that

is

s) = Pr(Nt

rt

(t s)

:

So

t

(t s) .

has an atom at zero, and its cdf is e

rt

p(t)e

Another thing we know is that

a(t) ! 0;

where a(t) denotes a dealer’s asset holdings. In particular, if one integrates p(t)e
the cdf of

t,

one …nds that

as t goes to in…nity, because

h
E p( t )e

t

r

t

rt a(t)

against

i
a( t ) ! 0;

goes to in…nity almost surely. Now consider some time s. The

sum of asset holdings across investors and dealers must be equal to A, i.e.,
Z
aj (s) dj = A;
where j indexes all agents in the economy. Now, we can also write
Z
i
i
h
h
aj ( t ) dj p( t )e
AE p( t )e r t = E Ap( t )e r t = E
= E

j

Z

p( t )e

r

t

j

a ( t ) dj =

Z

j

j

r

E p( t )e

r

t

t

aj ( t ) dj:

As shown above, the last expression goes to zero as t goes to in…nity. Therefore, because A > 0,
h
E p( t )e

r

t

i

as t goes to in…nity. Because we know that p(t)e
p(t)e

rt

! 0;
rt

(57)

converges to some limit, it follows that

converges to zero. Indeed, suppose that the limit is strictly positive. Then there is

some " > 0 and t" such that p(t)e
h
E p( t )e

r

t

i

h
E p( t )e

rt

r

> " for all t
t

Ift

t" g

i

t" and
"Pr(

t

t" ) = " 1

e

(t t" )

!"

as t goes to in…nity, which is a contradiction. To arrive at (21), integrate (15) forward using
the transversality condition (6).
Proof of Lemma 5. The proof consists of showing that from any initial condition close
to the steady state, only the trajectory that follows the saddle path to the steady state is
consistent with individual maximization. Consider Figure 1 and focus on trajectories below the
saddle path. These trajectories eventually lead to

(t)

0 or to Ad (t) = 0. The former are

inconsistent with the investor’s optimization (note that (11) would be violated since Ui0 > 0).
46

The latter are inconsistent with the dealer’s maximization. To see this, integrate (4) forward
to obtain
p (t) = ert lim e
s!1

If we multiply through by e

rs

p (s) +

Z

1

e

rs 0

[Ad (s + t)] ds:

(58)

0

rt ,

take limits as t ! 1, and use the transversality condition
R1
(6), this expression implies limt!1 0 e r(s+t) 0 [Ad (s + t)] ds = 0, which is violated along
trajectories where Ad (t) equals zero in the limit, or in …nite time. Trajectories above the
saddle path are also inconsistent with the dealer’s optimization. First, note that (t) diverges
to +1 along any such trajectory. From (11), this implies that ai (t) converges to zero for
each i. In turn, using (17), this implies that Ad (t) converges to A. Again, (6) and (58) imply
R1
p (t) = 0 e rs 0 [Ad (s + t)] ds, hence limt!1 p (t) = 0 (A) =r, a constant. But then (12)
implies limt!1 (t) =

0 (A)

< 1, i.e., a contradiction that indicates that these paths violate

the …rst-order necessary conditions of the dealer’s problem. Thus, trajectories that lie above
the saddle path are not solutions to the dealer’s asset accumulation problem. Conversely, the
trajectory that follows the saddle path satis…es the equilibrium conditions (6), (11), (16) and
(17), as well as (6).

Proof of Lemma 6. We study the problem of a social planner who maximizes the sum of all
agents’utilities, subject to the trading technology. As before, Ht (i; a) denotes the distribution
of investors across preference types and asset holdings at time t. Since at any point in time
all investors access the market according to independent stochastic processes with identical
distributions, the quantity of assets that the measure
of randomly-drawn investors make
R
available to the planner is
adHt (a; i) = [A Ad (t)]. So the quantity of assets available to

be reallocated among agents who are in the market depends on the distribution Ht (i; a) only
through its mean, A

Ad (t). Consequently, Ht (i; a) is not a state variable for the planner’s

problem. Notwithstanding, in order to allocate assets across investors, the planner needs to
R
know ni (t) = Ifj=ig dHt (j; a), i.e., the measure of investors of preference type i at date t.
Let V~i (a) denote the expected discounted utility of an investor of type i who holds a stock
of assets a until the next time his portfolio can be changed, i.e.,
Z t+T
~
uk(s) (a)e r(s t) ds :
Vi (a) = Ei

(59)

t

The value function V~i (a) satis…es

V~i (a) =

(r + ) ui (a) +
(r +

PI

j=1

j uj (a)

+ ) (r + )
47

:

(60)

(The calculations leading to (60) parallel the derivation of V~i (a) in the proof of Lemma 2.) Since
general goods enter linearly in the utility function of all agents, the utilities from production
and consumption of those goods net out to 0 and can therefore be ignored by the planner. Thus,
the planner only maximizes the direct utilities that dealers and investors enjoy from holding
assets. At each date the planner chooses q (t), the change in the quantity of assets held by
dealers and ai (t), the quantity of assets allocated to an investor of type i when he readjusts his
portfolio, in order to maximize
Z

V~i (a)dH0 (a; i) +
s.t.

Z

1

0

rt

e

"

q (t) =

(

[ad (t)] +

I
X
i=1

A

ad (t)

I
X

)

ni (t)V~i [ai (t)] dt
#

(61)

ni (t)ai (t) ;

i=1

(62)

and subject to the law of motion a_ d (t) = q (t), (18), and the initial conditions ni (0) and ai (0)
for i = 1; :::; I. The …rst term in (61) captures the utility of all investors before the …rst time
their portfolios can be reallocated. It is a constant and can therefore be ignored in choosing
the optimal allocation. Hence, the planner’s current-value Hamiltonian reduces to
I
X

[ad (t)] +

i=1

where

ni (t)V~i [ai (t)] + (t) q (t) ;

(63)

(t) is the co-state variable associated with the law of motion for ad (t). (The nonneg-

ativity constraints on ai (t) and ad (t) are slack at all times since u0i (0) =

0 (0)

= 1.) From

the Maximum Principle (e.g., Theorem 12 in Seierstad and Sydsæter, 1987), the necessary
conditions for an optimum are
n
ni (t) V~i0 [ai (t)]

which using (60) can be rewritten as

(r + ) u0i [ai (t)] +
r+

PI

j=1

0
j uj

o
(t) = 0;
[ai (t)]

+

= (r + ) (t);

(64)

(65)

and
0

[ad (t)] + _ (t) = (r + ) (t):

(66)

Next, we show that the optimal path must also satisfy the transversality condition
lim e

rt

t!1

48

(t) = 0:

(67)

We begin by noticing that for every path of the controls, the functional
(
)
Z 1
I
h
i
X
e rt
[ad (t)] +
U q ( ) ; fai ( )gIi=1 =
ni (t)V~i [ai (t)] dt +
0

Z

i=1

1

e

rt

0

with ad (t) = A

PI

i=1 ni (t)ai (t),

q (t) =

f (t) [q (t)

a_ d (t)]g dt

(68)

yields the same value as the planner’s objective

function (61) (ignoring the constant term in (61)). Integration by parts implies that
Z 1
Z 1
t=1
rt
rt
e
(t) a_ d (t) dt = e
(t) ad (t) t=0
e rt [ _ (t) r (t)] ad (t) dt;
0

0

and substituting this expression into (68) yields
(
Z 1
h
i
I
rt
U q ( ) ; fai ( )gi=1 =
e
[ad (t)] + [ _ (t)

r (t)] ad (t) +

0

Z

1

e

rt

(t) q (t) dt

e

I
X
i=1

rt

(t) ad (t)

0

t=1
:
t=0

)

ni (t)V~i [ai (t)] dt +

Suppose that q (t) and fai (t)gIi=1 are optimal paths for the controls, then along this optimal
PI
trajectory, the implied path for the state variable ad (t) is A q (t) =
i=1 ni (t)ai (t). Consider
the admissible paths q^ (t; ") and f^
ai (t; ")gIi=1 , where q^ (t; ") = q (t) + "
ai (t) + "

q

(t) and a
^i (t; ") =

i (t),

for some arbitrary " 2 R. The implied path for the state is a
^d (t; ") = ad (t)
PI
" d (t), where d (t) = q (t) = + i=1 ni (t) i (t). (An “admissible path” is a path which

is piece-wise continuously di¤erentiable and satis…es (62), together with the initial conditions
h
i
a
^i (0; ") = ai (0) and a
^d (0; ") = ad (0).) Let J (") = U q^ ( ; ") ; f^
ai ( ; ")gIi=1 . Since the paths

q (t) and fai (t)gIi=1 are optimal, we must have
0 =

Z

1

e

rt

0

Z

1

e

0

If we substitute

rt

(

0

[ad (t)] + _ (t)

r (t)

= 0, or equivalently,

d (t)

+

I
X
i=1

f (t)

q

@J(")
@" "=0

(t) =

q

(t)g dt + e
d (t)

rt

(t)

PI

t=1
d (t) t=0 :

i=1 ni (t)

i (t)

ni (t)V~i0 [ai (t)]

and notice that

a
^d (t; ") is admissible), we …nd that this last expression is equivalent to
Z 1
0 =
e rt 0 [ad (t)] + _ (t) (r + ) (t)
d (t) dt +
0
" I
#
Z 1
h
io
Xn
rt
0
e
ni (t) V~i [ai (t)]
(t)
i (t) dt + lim e
0

t!1

i=1

49

i (t)

d (0)

rt

)

(t)

dt +

= 0 (because

d (t) :

But then (64) and (66) imply that
d (t)

@J(")
@" "=0

= 0 only if limt!1 e

rt

(t)

d (t)

= 0, and since

is arbitrary, (67) is a necessary condition for optimality. If we rescale the co-state by

de…ning

(t)

(r + ) (t), it becomes clear that (65), (66) and (67) correspond to (32),

(33) and (34), respectively. Finally, the Mangasarian condition (35) is su¢ cient because the
Hamiltonian is jointly concave (see Theorem 13 in Seierstad and Sydsæter, 1987).
Proof of Proposition 1. We wish to show that the planner’s optimality conditions and
the equilibrium conditions are identical when

= 0. First, note that the planner’s law of

motion (62) is always the same as the market-clearing condition (17). Then let

(t) =

(t)

and note that the planner’s optimality conditions (32) and (33) are identical to the equilibrium
conditions (11) and (4) if and only if
to (6), but given
rt p (t)

limt!1 e
lim e

rt

t!1

(t) =

= 0. To conclude, we must show that (34) is equivalent

(t), it su¢ ces to show that limt!1 e

rt

(t) = 0 if and only if

= 0. From (12),

(t) =

lim e

rt

t!1

= (r + )
= r lim e
t!1

Z

(r + )

Z

1

0

1

0
rt

e

(r+ )s

e

(r+ )s

n
r lim e
t!1

p (t) :

frp (t)
rt

[p (t + s)

p (t)

lim e

rt

t!1

p (t)]g ds
[p (t + s)

o
p (t)] ds

Proof of Lemma 7. For part (a), note that the investor’s asset demand (36) is immediate
from (11) given the functional form assumptions. The Hamiltonian corresponding to the dealer’s
problem is

p (t) q (t)+ (t) q (t)+& (t) ad (t), where

is the multiplier on the constraint ad (t)
Seierstad and Sydsæter, 1987) delivers

(t)

0 is the costate variable and & (t)

0. The Maximum Principle (e.g., Theorem 12 in
(t) = p (t) and & (t) = rp (t)

complementary slackness condition & (t) ad (t) = 0. This implies [rp (t)
together with the fact that rp (t)

p_ (t)

0

p_ (t), together with the
p_ (t)] ad (t) = 0, which

0 implies part (b).

Before proving Proposition 2, we establish several intermediate results (Lemmas 8–13) which
will aid us in the proofs.
We begin with a characterization of the equilibrium trajectories of Ad (t) and (t) over arbitrary
time-intervals:

50

Lemma 8 (i) Consider a time-interval [t1 ; t2 ] such that Ad (t) > 0 for all t 2 (t1 ; t2 ). Then,

+
and

(t) =

+

t

e

A1

Ad (t) =

1 e

E

[e

(r+ )t2

E E0
1=
[e (r+ )t2 (t2 )]

1 e

)t

e

r+

1=

(t2 )]

r+ +

(

r+

(

)t

r+ +

r+ +

e

r+

t

t

(69)

(t), where
+

(t) = e(r+

)(t t2 ) +

(t2 )

(70)

for all t 2 (t1 ; t2 ).

(ii) Consider a time-interval during which Ad (t) = 0. Then, (t) =

0 (t)

for all t in such

interval, where

with t^ = (1= ) ln

h

r+ +
r+

0 (t)

= 1

E0
E

i

1

r+
r+ +

^
e (t t)

;

(71)

.

Proof. (i) Consider an interval (t1 ; t2 ) such that Ad (t) > 0 for all t in that interval. From
(38), _ (t) = (t) = r + which gives (70). Substituting this expression into (39), implies that
Ad (t) satis…es
r+
Ee ( )t

A_ d (t) + Ad (t) = A

r+
E0 e (

E
(r+ )t2

e

(t2 )

+

)t
;

1=

and (69) is the solution to this …rst-order di¤erential equation. In the case of resonance where
r+

= , the solution becomes
Ad (t) =

A1

e

t

E

[e

(r+ )t1

1=

(t1 )]

t

te

E E0
1=
[e (r+ )t1 (t1 )]

There is a second nongeneric case of resonance where

r+ +

=

h

e

( + )t

e

t

i

:

. In this case, the solution

becomes
Ad (t) =

A1

e

t

E

[e

(r+ )t1

1=

(t1 )]

e

r+

t

e

t

+

[e

E E0
1=
(t1 )]

(r+ )t1

te

To avoid repetitive derivations, we restrict our analysis to the generic case, where
and

r+ +

6= 0.

t

:
r+

6= 0

(ii) Consider a time interval (t1 ; t2 ) such that Ad (t) = 0. From (39), Ad (t) = A_ d (t) = 0
implies (t) =

0 (t)

with

0 (t)

given by (71).

The following lemma establishes a key continuity property of equilibrium prices and allocations.
51

Lemma 9 In any equilibrium, Ad (t) and (t) are continuous for all t.
Proof. To establish the continuity of Ad (t) we proceed in three steps. (i) From Lemma
8 it is immediate that Ad (t) and

(t) are both continuous on every open interval (t1 ; t2 ) over

which Ad (t) > 0 for all t 2 (t1 ; t2 ) or Ad (t) = 0 for all t 2 (t1 ; t2 ). (ii) We establish that if

Ad (t) > 0 for all t 2 (t1 ; t2 ), and Ad (t) = 0 for all t 2 (t2 ; t3 ), then Ad (t) must be continuous
at t2 . Assume this is not the case, i.e., suppose that limt"t2 Ad (t) > 0, but Ad (t2 ) = 0. If

dealers are reducing their asset holdings discretely at t2 , by market clearing, it must be that
the investors who are in the market at t2 are increasing their holdings discretely. But since
their demands are continuous decreasing functions of

(t), this can only happen if

(t) has a

downward jump at t2 . (Since there is only a measure 0 of investors in the market at any point
in time, investors’ demand would have to be in…nite at t2 and

(t2 ) = 0.) Rearranging (56)

from the proof of Lemma 3, we get
p(t)

(t)
= e(r+
r+

)t

Z

1

e

(r+ )s

p(s)ds:

t

Thus, since the right-hand side is continuous in t, any pointwise downward jump in (t) corresponds a pointwise downward jump in p (t). Since limt"t2 Ad (t) > 0, we have limt"t2 ad (t) > 0
for at least some dealer(s). Focus on any such dealer’s problem as t2 approaches. In the proposed equilibrium, p t2

p (t2 ) > 0, and ad t2

ad (t2 ) = ad t2

> 0, so in the interval

(t2 ; t2 ], the dealer’s utility from trading inventories is p (t2 ) ad t2 , the proceeds of his asset sale
at t2 (recall that, p_ (t) =p (t) = r while ad (t) > 0, so he is getting zero utility from trading inventories on (t1 ; t2 )). But this dealer could have attained a payo¤ p t2 ad t2 > p (t2 ) ad t2
by selling o¤ his inventory an instant before the price jumped downward. Thus, we conclude
that the equilibrium path Ad (t) cannot exhibit this type of discontinuity. In this part we have
considered the case where the discontinuity is from the left, i.e., limt"t2 Ad (t) > Ad (t2 ) = 0.
The case where limt"t2 Ad (t) = Ad (t2 ) > limt#t2 Ad (t) = 0 is handled similarly. (iii) By an
argument analogous to the one in step (ii), one can show that if Ad (t) = 0 for all t 2 (t1 ; t2 ),
and Ad (t) > 0 for all t 2 (t2 ; t3 ), then Ad (t) must be continuous at t2 . (The measure of assets

held by investors in the market is dtA where dt ! 0 which prevents dealers’inventories from

jumping upward.) Together, steps (i)–(iii) imply that any equilibrium path Ad (t) must be

continuous for all t. To conclude, we establish that (t) must be continuous for all t. First, we
show that the continuity of Ad (t) implies that

(t) cannot have a downward jump at t2 . The

continuity of Ad (t) means that Ad (t2 ) = 0, which together with the nonnegativity constraint
52

Ad (t)

0 implies A_ d (t2 )
h

E

e

(t2 ) <

+
A_ d (t+
2 ). Since Ad (t2 ) = Ad (t2 ) = 0, (39) yields

E

E0

i

1
(t+
2)

A

(t+
2 ). The fact that

and therefore, (t2 )
(t+
2)

t+
2

0

h

E

e

t2

E

E0

i

1
;
(t2 )

(t) cannot have an upward jump, i.e., that

cannot be part of an equilibrium, follows from a no-arbitrage argument like the

one in step (iii). Hence, (t2 ) = (t+
2 ).
The following lemma shows that there is no equilibrium in which dealers hold positive inventories
at all dates.
Lemma 10 There is no equilibrium with Ad (t) > 0 for all t < 1.
Proof. Otherwise, it follows from the dealer’s …rst-order condition that rp(t) = p(t)
_
and
therefore that p(t)e

rt

= p(0). Since p(0) > 0, this violates the no-bubble condition (20) of

Lemma 4.
Lemma 11 shows that the t^ de…ned in part (c) of the statement of Proposition 13 has the
property that dealers will hold inventories for all t < t^.
Lemma 11 In any equilibrium, t : t

t^

ft : Ad (t) > 0g, where t^ = ln

h

r+ +
r+

1

E0
E

i1=

Proof. Suppose the contrary, i.e., that Ad (t) = 0 for all t 2 (t0 ; t00 ), with t00 < t^. Then
h
i
^
(t) = 1 r+r++ e (t t)
for all t 2 (t0 ; t00 ) (by part (ii) of Lemma 8). Thus,
_ (t)
(t)

=
(r +

+

(r + )
^
) e (t t)

for all t 2 (t0 ; t00 ). But note that _ (t) = (t) > r +

(r + )

for all t < t^, so the proposed path for Ad (t)

violates the dealer’s …rst-order condition (38) on (t0 ; t00 ).
Lemma 12 establishes that the equilibrium asset holdings of dealers after a crash follow a very
precise pattern: if dealers hold positive inventories, they will do so from the outset of the crash,
over a connected interval of time of …nite length t, and will hold no inventories thereafter.
Lemma 12 In any equilibrium, ft : Ad (t) > 0g = [0; T ) where 0
53

T < 1.

.

Proof. We …rst show that if Ad (t0 ) = 0, then Ad (t) = 0 for all t
mediately implies that ft : Ad (t) > 0g = [0; t), with t

t0 . (Note that this im-

0 but possibly in…nite.) We proceed by

contradiction. Suppose that Ad (t) is part of an equilibrium, with Ad (t) = 0 for all t 2 (t0
and Ad (t) > 0 for all t 2 (t0 ; t0 +

of Lemma 8),

(t) =

0 (t)

+ ),

for all t 2

for some

(t0

0
e(r+ )(t t ) + (t0 ).

on (t0 ; t0 +

+

+

,

> 0. Then, from (71) (part (ii)
h
i
^
where 0 (t) = 1 r+r++ e (t t)
,

; t0 ),

and from (70) (part (i) of Lemma 8), (t) =

; t0 ]

(t) for all t 2 (t0 ; t0 +

+ ),
+

From Lemma 9 we know that (t) must be continuous, so

+ ).

From Lemma 11 we know that for Ad (t) = 0 on t 2 (t0
an equilibrium, it must be that t0 > t0
t^, so _ 0 (t) = 0 (t) =

+

where

(t) =

)e

for all t t0
(with strict inequality for t > t0
). But then the
+
+
and _ 0 (t) = 0 (t) < r + = _ (t) = (t) for all t > t0 implies that + (t) >
Since

0 (t

; t0 ) to be part of

(r+ )
(t^ t) (r+ )
fact that 0 (t0 ) =

(r+ +

(t) =

0
e(r+ )(t t )

0 (t)

r+
+

(t0 )

for all t > t0 .

(t) must be continuous, this would imply an equilibrium with Ad (t) > 0 for all t > t0 .

But this is a contradiction, since we know by Lemma 10 that such a path for Ad (t) is inconsistent with the dealer’s transversality condition. Thus, if dealers hold inventories at all in
equilibrium, they must do so from t = 0 and for an uninterrupted period of time, up to some
time T

0. Finally, the fact that T < 1 follows by appealing to Lemma 10 once again. Figure

5 illustrates the main idea of this proof.
Lemma 13 Following a market crash:

(a). If dealers do not intervene, the equilibrium is Ad (t) = 0 and

0 (t)

(t) =

for all t,

with
0 (t)

and t^ = (1= ) ln

h

r+ +
r+

1

i

E0
E

r+
r+ +

= 1

^
e (t t)

.

(b). If dealers intervene, the equilibrium is
+ (t)

(t) =
where

+ (t)

A+
d (t) =
and T

= e(r+
1 e

0 (t)

)(t T )
t

+

for t < T
for t T

0 (T ),
e

r+ (t T )

r+
r+ +

1

e

(T

t^)

t^ is the unique positive root of
Z T
r+
e s 1 e
0

A+
d (t) for t < T
0
for t T;

Ad (t) =

r+
r+ +

(T s) 1
1

54

1 e

r+ +

(

)t

r+ +

r+
r+ +
r+
r+ +

e

(s

t^)

e

(T

t^)

^
e (t t)

ds = 0:

1 e

(

r+
r+

)t

A;

0)

Proof of Lemma 13 and Proposition 2. From Lemma 12, we know that an equilibrium must
have Ad (t) > 0 for all t 2 [0; T ) and Ad (t) = 0 for t

T , with 0

T < 1, so we construct such

an equilibrium to establish parts (a) and (b) of Lemma 13. For part (a), note that Ad (t) = 0
and

(t) =

0 (t)

for t

T by part (ii) of Lemma 8. Thus in particular, this is true if T = 0

(i.e., if dealers do not intervene). For part (b), note that again, Ad (t) = 0 and
for t

T . For t < T , we have Ad (t) and

in the proof of Lemma 8. Since
+

(t) = e(r+

for Ad (t) for
t2 = T and

)(t T )

0 (T ),

+

(t) =

(t) =

0 (t)

(t), given by (69) and (70), respectively,
+

(t) must be continuous (Lemma 9),

which in the statement of Lemma 13 is denoted

t < T , i.e., (69), reduces to A+
d (t) in the
i
h
^
(T ) = 0 (T ) = 1 r+r++ e (T t)

(T ) =

+ (t).

0 (T ),

so

The expression

statement of Lemma 13 after setting
e t^, and

r+
r+ +

, using E0 =E = 1

rearranging terms. So far we have described the full equilibrium for a given switching date T .
To determine T , we use the fact that Ad (t) must be continuous, which implies Ad (T ) = 0, a
condition to be solved for T . To derive this condition, we start with (39), which leads to
Z t
Z t
io
h
n
h
i
s _
ds
(s) 1= E e s E E0
Ad (s) + Ad (s) ds =
e s A
e
0

0

and in turn to

Ad (t) =

Z

t

(t s)

e

E
(s)1=

A

0

For t

T,

(s) =

(r+
+ (s) = e

)(s T )

1

(r+
0 (T ) = e

stituting this into (72) yields
Ad (t) = A

Z

t

e

0

Thus, Ad (T ) = 0 if and only if
(T )

Z

0

T

e

2

(t s) 4

1

e

r+

1

e

1
s)
1

(T ) = 0, where
2
s4

(T

r+
r+ +
h
)(s T ) 1

r+

(T

1
s)
1

r+
r+ +
r+
r+ +

r+
r+ +
r+
r+ +

^
e (s t)

r+
r+ +

ds:

^
e (T t)

i

(72)
, and sub-

3
^
e (s t)
5 ds:
^
e (T t)

(73)

3
^
e (s t)
5 ds:
T t^)
(
e

This is the same map we used to de…ne T in the statement of Lemma 13, so the proof of part
(b) of the lemma is complete. Finding T reduces to …nding the zeroes of the map
that

(0) = 0 and

(T ) !

1 as T ! 1, so limT #0

existence of some T 2 (0; 1) such that
show that

0 (T )

0 (T )

. Note

> 0 is su¢ cient to guarantee the

(T ) = 0 (i.e., dealers intervene). If in addition, we can

< 0 for T > 0, then this will guarantee that the root is unique. Conversely, if
55

limT #0

0 (T )

0 (T )

0, then

< 0 for T > 0 implies there exists no T > 0 such that

(T ) = 0

(i.e., dealers do not intervene). Di¤erentiating, we …nd
0

(T ) =

r+

r+
r+ +

^
e (T t)

e

t^, so for T > 0,

From Lemma 11 we know that T

h

T

0 (T )

h

1

1

i
^
e (T t) :

has the same sign as

i
T t^)
(
e
;

1

which is negative. As T ! 0, this expression is positive if and only if t^ > 0, which amounts to
condition (40) in the statement of Proposition 2. Hence, a T > 0 such that Ad (T ) = 0 exists

(i.e., dealers intervene) if and only if (40) holds, and when such a T exists, it is unique. To link
this condition to p_0 (t)=p0 (t), recall that p_ (t) =p (t) > r if and only if _ (t) = (t) > r+ (e.g., from
(15)). Then, from (39), if dealers do not intervene, _ (t) = (t) =

(r+ +

)e

(r+ )
(t^ t) (r+ ) ,

which is

(1 E0 =E)]. Thus, limt#0 _ (t) = (t) =
decreasing in t and equal to r + at t^ = (1=
(r+ )
> r + , t^ > 0, and this last condition is equivalent to (40). Finally,
(r+ + )e t^ (r+ )
) ln[ r+r++

notice that the uniqueness of the equilibrium follows from Lemma 12 and the uniqueness of the
switching time T such that

(T ) = 0. The convergence to the steady state is immediate from

the equilibrium prices and allocations described in parts (a) and (b) of Lemma 13.
Proof of Proposition 3. First, note that from parts (c) and (d ) of Proposition 13,
0 (s)

+ (s)

0 if and only if
1

e

r+

(T s)

^
e (s t)
^
e (T t)

r+
r+ +
r+
r+ +

1
1

0:

< (0+ ). We proceed by contradiction. Suppose 0 (0+ )
(0+ ).
From the proof of Lemma 12 we know that _ 0 (t)= 0 (t) is decreasing, with _ 0 (t) = 0 (t) ! 0 as
t ! 1. In addition, under condition (40), _ (t) = (t) > r + at t = 0+ . Therefore, there is
We …rst establish that

+
0 (0 )

0

a unique T > 0 such that

0 (T )

=

e(r+ )T

0

(0+ ).

therefore
1

e

r+

(T s)

1
1

For all s 2 (0; T ),

0 (s)

> (s) =

Finally, the fact that ln

0

(0+ )

< ln

(0+ ),

t^ 2 (0; T ] de…ned as in Proposition 13 such that
56

d
dt

and

^
e (s t)
< 0;
^
e (T t)

r+
r+ +
r+
r+ +

which together with (73) implies Ad (t) < 0 for all t 2 (0; T ), a contradiction. Thus,
(0+ ).

+ (s)

ln

ln

0 (T )

0 (t)

+
0 (0 )

<

= ln (T ) and that there is a

r+

=

d
dt

ln (t) if and only if

t 2 [0; t^], implies there is a unique t < T with

for all t 2 (0; t) and (t) <

0 (t)

0 (t)

= (t), and the property that (t) >

for all t 2 (t; T ). See Figure 5 for an illustration.

57

0 (t)

B

Stochastic recovery

Suppose the recovery occurs at some time t , i.e., t is the realization of the random variable T .
We begin by describing the equilibrium of the economy after the recovery, taking as given dealers’inventories at the time the recovery occurs, Ad (t ). Once we have solved for the equilibrium
from the time of the recovery onward, we solve for the equilibrium price and allocations before
the recovery and then piece both sets of paths together to characterize the full equilibrium from
the outset of the crash at t = 0.
Consider …rst the economy after the recovery. Let Vih (a; t; t ) denote the value function
corresponding to an investor who has preference type i and is holding portfolio a at time t,
conditional on the recovery having occurred at time t
(Z ~
T

Vih (a; t; t ) = Ei
e

r(s t)

uk(s) (a) e

t. The investor’s value function is

ds +

t

r(T~ t)

h
fph (T~; t )a + max
[Vk(
(a0 ; T~; t )
T~)
0
a

ph (T~; t )a0 ]g ;

(74)

where ph (t; t ) denotes the asset price. Notice that (74) is identical to (9) except for the fact
that ph (T~; t ) replaces p(T~). Therefore, the investor’s problem is the same as in Lemma 2 where
ph (t; t ) replaces p(t). The dealer solves
h

W (ad ; t; t ) = max
q(s)

subject to a_ d (s) = q (s), ad (s)

Z

1

r(s t) h

e

p (s; t )q (s) ds

(75)

t

0 for all s

t, and the initial condition ad (t ) = ad . The

problem (75) is analogous to (3).
For all t

t , the equilibrium is characterized by the pair of di¤erential equations (22)

and (38), together with the initial condition Ad (t ). The following lemma characterizes the
equilibrium path that the economy follows after the recovery has taken place.
Lemma 14 Suppose the economy recovers at some time t
equilibrium path

(t) ; Ahd (t)

for t

0. Then, there exists a unique

t such that:

(a) For all t 2 (t ; T ],
(t) =
Ahd (t) = e

e

(r+ )(T t)
(t t )

Ad (t ) +

Z

t

e

t

58

(t s)

"

A

I
X
i=1

0 1
[
i Ui

#

(s)] ds;

(76)
(77)

where T < 1 is the unique solution to Ahd (T ) = 0.
(b) For all t

(t); Ahd (t) = ( ; 0), where

T,

Proof. Note that if Ad (T ) = 0 for some T
( ; 0) for all t

T . Thus, let T = inf ft

by establishing that Ad (t) > 0 for all t

solves

PI

i=1

0 1
i Ui (

) = A.

t , then (22) and (38) imply f (t); Ad (t)g =

t : Ad (t) = 0g. Next we show that T < 1

t is inconsistent with equilibrium. Note that if

Ad (t) > 0 for all t

t , (22) and (38) imply, after a change of variable,
"
Z t t
I
X
0 1
(t t )
u
Ad (t) = e
Ad (t ) +
e
A
[ (t
i Ui
0

with (s) = e(r+

)(s t )

which implies limt!1 e

#

u)] du

i=1

(t ). Thus, limt!1 Ad (t) = A > 0. From (37), p(t) = er(t
rt p (t)

lated, so Ad (t) > 0 for all t

rt

=e

t ) p(t

)

p(t ) > 0. The dealer’s transversality condition is vio-

t cannot be part of an equilibrium. We conclude that T < 1

and this establishes part (b) of the lemma. For part (a), …rst note that the same arguments
we used in Lemma 9 can be applied here to establish that

(t) and Ad (t) are continuous for
1

all t 2 (t ; 1). (The only di¤erence is that Lemma 9 is proven with Ui (a) = "i a1

, but this

is immaterial for the results.) In particular, this means that (t) and Ad (t) are continuous at
t = T > t . For any t 2 (t0 ; t00 )

(t ; T ], (22) and (38) imply that f (t); Ad (t)g are given by

(77) and (76), where (76) uses (T ) = , which follows from the continuity of ( ). We use the
continuity of Ad ( ), to determine T : using (77) and (76), Ad (T ) = 0 can be written as
#
"
Z T
I
i
h
X
0 1
(s t )
(r+ )(s T )
ds = 0:
e
A
e
Ad (t ) +
i Ui
t

i=1

The left-hand side of (78) is equal to Ad (t )

0 at T = t and goes to

Di¤erentiate the left-hand side of (78) with respect to T to get:
(r + )

Z

t

where ai (s) = Ui0

1

e

(78)

(r+ )(T s)

T

e

(s t )

I
X
i=1

i

1 as T ! 1.

e(r+ )(s T )
ds < 0;
Ui00 [ai (s)]

. So there is a unique T that satis…es Ad (T ) = 0. To

conclude, the uniqueness of the equilibrium follows from the fact that the saddle path leading
to the steady state depicted in Figure 9 is the only path that satis…es all the equilibrium
conditions. Any other path is inconsistent with the dealer’s optimization: paths above the
saddle path violate the transversality condition while those below would imply an upward jump
in (t) at t = T (see Figure 9).
59

According to Lemma 14 the equilibrium path of the economy starting from t is such that
Ahd (t) > 0 for all t in the interval (t ; T ) and Ahd (t) = 0 for all t

T . Furthermore, T > t

unless Ad (t ) = 0. According to (76), the investor’s e¤ective cost of holding the asset, (t),
increases at rate r +

while dealers hold inventories, meanwhile according to (77), the stock of

assets held by dealers decreases monotonically until it is fully depleted at time T . (To see this,
PI
0 1
notice from (76) that (t) < for all t < T . As a consequence, A
[ (t)] < 0 for
i=1 i Ui
h
all t < T and from (22) A_ d (t) < 0.) The condition A (T ) = 0 can be rewritten as
d

Z

Ad (t ) +

T t

e

s

0

(

I
X

A

0 1
i Ui

i=1

h

(r+ )[(T t ) s]

e

i

)

ds = 0:

From (79) the time that it takes for dealers’inventories to be depleted, T

(79)

t , is an implicit

function of the stock of inventories in dealers’hands at the recovery time, Ad (t ). Equivalently,
(24) provides a relationship between the e¤ective cost of holding the asset at the recovery time,
(t ) = e

(r+ )(T t ) ,

by the function

and dealers’ initial inventories, Ad (t ). We represent this relationship

such that (t ) =

0

[Ad (t )].25 Notice that

< 0, so (t ) is decreasing in

Ad (t ), and (0) = . Intuitively, the larger the stock of inventories that dealers are holding at
the time of the recovery, the lower the e¤ective cost of holding the asset at the recovery time,
and the longer it will take to deplete dealers’inventories once the recovery has occurred.
Figure 9 shows the phase diagram of the dynamic system [Ad (t); (t)] following the recovery.
From (22) we see that the Ad isocline is upward-sloping and intersects the vertical axis at the
steady-state point. The equilibrium trajectory of the economy is indicated in the …gure by
arrows along the saddle-path, namely, (t) =

[Ad (t)] . The initial condition Ad (t ) determines

the starting point on the saddle path. The trajectories marked with dotted lines that do not
follow the saddle path are solutions to the di¤erential equations (22) and (38) but they either
fail to satisfy the transversality condition or the requirement that the equilibrium path (t) be
continuous.
Next, we analyze the economy before the arrival of the recovery shock. Let Vi` (a; t) denote
the value function corresponding to an investor who has preference type i and is holding portfolio
25

From (79), the reciprocal of
1

( )=

is de…ned as
Z

1
ln( = )
(r+ )

e
0

s

n

A

60

X

i

0 1
i Ui

h

e(r+

)s

io

ds

Ad = 0

<
ψ ( Ad )

Ad

A

Ad (tλ )

Figure 9: Dynamics after the recovery

a at time t < T . Then, the investor’s value function satis…es
Vi` (a; t) = V~i` (a) + Ei IfT
+IfT~<T g e

r(T~ t)

T~g e

r(T~ t)

h
h
max
Vk(
(a; T~; T )
T~)
0
a

h

`
max
Vk(
(a0 ; T~)
T~)
0
a

ph (T~; T ) a0

p` (T~) a0

a

i

;

a

i
(80)

where the indicator function IfT T~g equals one if T
T~ and zero otherwise, and
(Z ~
)
T
V~i` (a) Ei
R + Ifs>T g (1 R) uk(s) (a) e r(s t) ds :
t

This Bellman equation is a natural generalization of (9), for example, they coincide if we set
R = 1 and let ! 0. The function V~ ` (a) is the expected discounted sum of utility ‡ows
i

that an investor enjoys from holding a quantity a of the asset until he gains e¤ective access
to the market at Poisson rate . The term R + Ifs>T g (1

R) indicates that the investor’s

instantaneous utility is scaled down by R until the economy recovers. It will be convenient to
de…ne Ui` (a) = (r + )V~i` (a). If = 0 then Ui` (a) reduces to RUi (a). Alternatively, as ! 1

(the economy recovers almost surely in the next instant), Ui` (a) ! Ui (a).
61

The following Lemma gives a formulation of the investor’s problem which is analogous to
the one in Lemma 2.
Lemma 15 An investor of preference type i who holds portfolio a and gains direct e¤ ective
access to the market at time t before the recovery has taken place, solves
h
max Ui` (a`i )

`

a`i

(t)a`i

i

(81)

where
`

Z

(t) = (r + ) p` (t)
Z

0

1

e

(r+ + )

p` (t +

)d

0

1Z 1

e

ph (t +

(r+ )

e

;t +

)d

d

#

:

(82)

Proof. The …rst term on the right-hand side of (80), V~i` (a), satis…es the following ‡ow
Bellman equation,
I
X

(r + )V~i` (a) = Rui (a) +

j

j=1

h

i
h
V~i` (a) + V~i (a)

V~j` (a)

i
V~i` (a) ;

(83)

where V~i (a) = Ui (a)=(r + ). The investor’s portfolio problem before the recovery is
n
max V~i` (a)
a

p` (t)a

h
E e

r(T~ t)

Use Ui` (a) = (r + )V~i` (a) to rewrite (84) as

h

I(T~<T ) p` (T~) + I(T~

h
max Ui` (a)

`

a

where
`

and
Ui` (a) =

n
(t) = [r + ] p` (t)

r+
r+ +

2
4

h
E IfT~<T g e

(r+ + )Rui (a)+

XI

j=1

r+ + +

62

h

ii o
(T~; T ) a :

(84)

i
(t)a ;

r(T~ t) `

j Ruj (a)

T )p

p (T~) + IfT

3

5+

T~g p

h

io
(T~; T )

(r+ + )Ui (a)+
r+ +

XI

r+ + +

j=1

j Uj (a)

:

Using the fact that T~

t and T

t are two independent exponentially distributed random

variables, the expected value of the resale price is
h
h
ii
~
E e r(T t) I(T~<T ) p` (T~) + I(T~ T ) p(T ; T~) =
Z 1Z 1
h
i
e r
I( < ) p` (t + ) + I(
p(t
+
;
t
+
)
e
)
0
0
Z
Z 1
`
r
e
p(t + ; t + ) e
e
p (t + ) +
e
=

e

d d
d d

:

0

0

Change the order of integration of the second term to arrive at (82).
According to Lemma 15, an investor maximizes his e¤ective utility function, Ui` (a), minus
the e¤ective cost of investing in the asset,

`

(t) a. Just as Ui` (a) takes into account both

idiosyncratic and aggregate preference shocks,

`

(t) takes into account the expected capital

gain that will be realized the next time the investor gains access to the market, which may be
before or after the economy recovers. As before the last two terms on the right-hand side of
(82) represent the expected resale price of the asset. From Lemma 15 it follows that during the
crisis, an optimal portfolio choice a`i (t) satis…es
Ui` 0 [a`i (t)] =

`

(t).

(85)

We now turn to analyze a dealers’s problem. At any time t before the recovery has occurred,
the dealer solves
max E
q(s)

Z

T

e

r(s t) `

p (s)q(s)ds + e

r(T

t)

W h [ad (T ) ; T ; T ] ;

(86)

t

subject to a_ d (s) = q (s), ad (s)

0 for all s

t and the initial condition ad (t). Lemma 16

simpli…es the dealer’s problem.
Lemma 16 At any every time t before the recovery has occurred, the dealer solves
Z 1
n
h
io
max
e (r+ )s
rp` (t + s) + p_` (t + s) + ph (t + s; t + s) p` (t + s) ad (t + s)ds
ad (t+s) 0 0

given an initial condition ad (t).
Proof. Integration by parts and the fact that limt!1 e

rt ph (s; t

)ad (t) = 0 (by Lemma

14) implies that (75) can be written as
W h (ad ; t; t ) = W h (0; t; t ) + ph (t; t )ad ;
63

(87)

where W h (0; t; t ) = maxad (s)

R 1 r(s t)
0 t e

p_h (s; t )

rph (s; t ) ad (s) ds. Integration by parts

and (87) allow us to rewrite the dealer’s problem (86) as
Z

max E

ad (s) 0

T

e

t

r(s t)

h

i
rp` (s) ad (s)ds + e

p_` (s)

After a change of variables, de…ning
distributed random variable
Z 1
max f
ad (t+s) 0 0
Z 1
e (r+ )
0

for s

= T

r(T

t)

h

ph (T ; T )

t and noticing that

i
p` (T ) ad (T ) :
is an exponentially

with mean 1= , this last expression becomes
Z
h
i
e rs p_` (t + s) rp` (t + s) ad (t + s)dsd
e
h

0

ph (t +

;t +

)

p` (t +

i
) ad (t +

+

)d g

(88)

t, with ad (t) given. Since (88) is the same as
Z 1Z 1
h
i
Ifs< g e rs p_` (t + s) rp` (t + s) ad (t + s)dsd
e
max f
ad (t+s) 0 0
0
Z 1
h
i
ph (t + ; t + ) p` (t + ) ad (t + ) d g;
e (r+ )

+

0

we can change the order of integration in the …rst term and integrate with respect to

to

arrive at the dealer’s problem as formulated in the statement of the lemma.
From Lemma 16 we see that the ‡ow of pro…t of dealers during the crisis has three components:
the opportunity cost of holding the asset, rp` (t + s), the capital gain while the economy remains
in the crisis state, p_` (t), and the expected capital gain ph (t + s; t + s)
recovers (which occurs with Poisson intensity ). Clearly, p_` (t) +

p` (t + s) if the economy

ph (t; t)

p` (t) > rp` (t) is

inconsistent with equilibrium (the dealer’s problem would have no solution). Let a`d (t) denote
the solution to the dealer’s problem. The dealer’s necessary conditions are immediate from
Lemma 16: as long as the economy is in the crisis state,
n
h
io
rp` (t) + p_` (t) + ph (t; t) p` (t) a`d (t) = 0
for all t, with a`d (t)

rp` (t) + p_` (t) +

0 and

ph (t; t)

p` (t)

(89)

0. The following lemma,

which is analogous to Lemma 3 allows us express the dealer’s …rst-order conditions (89) in terms
of investors’ e¤ective cost of buying the asset before the recovery and after the recovery has
occurred. We use (76) to de…ne
h

(t; t ) =

[Ad (t )] e
64

(r+ )(t

t)

:

(90)

Notice that given

h

[t; t ; Ad (t )] we can use (21) to …nd the path for the asset price after the

recovery.26
Lemma 17 Condition (82) implies
`

h

`

rp (t) + p_ (t) +

i
p (t) =

h

`

p (t; t)

`

(t) +

_ ` (t) +

h

(t; t)
r+

`

(t)

:

Proof. Let
Z

`

P (t) =

1

e

(r+ + )(s t) `

p (s) ds

t

P h (t) = e(r+

+ )t

Z

t

1Z

1

z

e

(r+ )s h

e

p (s; z) dsdz;

z

which correspond to the second and third terms in (82), respectively, after a change of variables.
Then (82) can be written more compactly as
h
(t) = (r + ) p` (t)

P ` (t)

i
P h (t) ;

(91)

h
_ ` (t) = (r + ) p_` (t)

P_ ` (t)

i
P_ h (t) :

(92)

p` (t)

(93)

`

and therefore,

Note that

P_ ` (t) = (r +
and
P_ h (t) = (r +

+ ) P h (t)

+ ) P ` (t)
Z

1

e

(r+ )(s t) h

p (s; t) ds:

(94)

t

From the investor’s problem ((12) and Lemma 3), we know that
Z 1
h
(t; t ) = (r + ) ph (t; t )
e (r+ )(s t) ph (s; t )ds ;
t

which evaluated at t = t implies
Z

1

e

(r+ )(s t) h

p (s; t)ds = ph (t; t)

t

26

@

h

Speci…cally, ph (t; t ) =

R1
t

e

r(s t)

h

h

(s; t )

_ h (s;t )
r+

(s; t ) =@s and p_h (t; t ) to denote @ph (t; t ) =@t.

65

i

h

(t; t)
:
r+

(95)

h
ds, where hereafter, _ (s; t ) is used to denote

Substitute (95) back into (94) to get
_h

"

h

P (t) = (r +

+ ) P (t)

#
(t; t)
:
r+
h

h

p (t; t)

(96)

Next, substitute (93) and (96) into (92) to arrive at
_ ` (t)
r+

= p_` (t)

h

i
+ ) P ` (t) + P h (t) + p` (t) +

(r +

"

#
(t; t)
;
r+
h

ph (t; t)

which after using (91) to substitute P ` (t) + P h (t) and rearranging reduces to
rp` (t) + p_` (t) +

h

ph (t; t)

i
p` (t) =

`

(t) +

_ ` (t) +

h

(t; t)
r+

`

(t)

;

the expression in the statement of the lemma.
Lemma 17 allows us to write (89) as
n `
_ (t) + h (t; t)

(r +

`

+ )

o
(t) a`d (t) = 0:

To summarize, we have shown that once the economy has recovered from the crisis, say
h

at some time t , it will evolve along a deterministic path Ahd (t) ;
(90). Before it has recovered from the crisis, it follows a path
satis…es

n

_ ` (t) +

[A`d (t)]

(r +

+ )

and the market clearing condition
A_ `d (t)

=

(

A

A`d (t)

`

o
(t) A`d (t) = 0
)

I
X

`0 1 `
[ (t)]
i Ui

i=1

(t; t ) given by (77) and

A`d (t) ; ` (t)

:

which, using (90),
(97)

(98)

We can now de…ne an equilibrium to be a stochastic process f (t); Ad (t)g, such that for t <
T , f (t); Ad (t)g =
h

`

(t); A`d (t)

satisfying (97) and (98), and for t

(t; T ) ; Ahd (t) satisfying (77) and (90).

T , f (t); Ad (t)g =

`

Let ( ; A`d ) denote the steady-state associated with (97) and (98); it is characterized by
`

r+
A = A`d +

+
I
X

(A`d )

“ = ” if A`d > 0

`0 1 `
( )
i Ui

i=1

66

(99)
(100)

`

As the random time of recovery, T , becomes very large,

(t); A`d (t) approach their steady

`

state values ( ; A`d ) as given by (99) and (100). Assuming A`d > 0, it can be checked from (97)
and (98) that the steady state is a saddle point and that there is a unique trajectory that brings
the system to its steady state.
Proof of Proposition 4 Dealers accumulate inventories if and only if A`d > 0. From (99) and
(100), A`d is determined by the condition (A`d ) = 0, where
(Ad ) = Ad +

I
X

`0 1
i Ui

r+

i=1

(Ad )

+

A:

> 0 and limAd !1 (Ad ) = 1, there is a unique A`d > 0 such that (A`d ) = 0 i¤
P
A, so
(0) < 0. Using the fact that (0) = we know that (0) = Ii=1 i Ui`0 1 r+ +

Since

0 (A )
d

(0) < 0 is equivalent to (41).

Derivation of A`d . From (79), normalizing t to 0 and assuming that Ad (t ) = A`d , we get
"
#
Z T
I
X
0 1
e s A
A`d +
[ (s)] ds = 0:
i Ui
0

i=1

With the functional form ui (a) = "i a1
e

(r+ )(T s) .

PI

i=1

i

+

Z

T

s

e

0

"i =

1=

"

r+

[ (s)] = ["i = (s)]1= and (s) =

A

I
X

"i

1=

( r+ )(T s)

e

i

i=1

#

ds = 0:

= A. After some calculations, we arrive at
A`d

A
A

where

1

Hence,
A`d

Notice that

) we have Ui0

=(1

+

e

T

e

T

= 0;

(101)

. The steady-state condition (100) yields
A = A`d +

I
X

^"i
i

i=1

Combined with (99),

`

=

r+ +

A=

e
A`d

`

!1=

:

(r+ )T ,

+e

T

I
X

r+
i

i=1

67

+ ^"i

1=

:

(102)

1

Using the fact that

=

PI

i=1

1=
i ("i )

e
where

r+ +

1=

PI

i=1

"i )1=
i (^
T =

=
1

=A, (102) becomes
T

=

PI

i=1

ln

A`d

A
A

1=
i ("i )

+

;

(103)

. Substitute (103) into (101) to obtain
:

(104)

Finally, substitute the expression for T given by (104) into (103) to obtain
(
)
A`d = A 1

+

68

:

