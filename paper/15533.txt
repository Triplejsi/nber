NBER WORKING PAPER SERIES

JUMP-ROBUST VOLATILITY ESTIMATION USING NEAREST NEIGHBOR TRUNCATION
Torben G. Andersen
Dobrislav Dobrev
Ernst Schaumburg
Working Paper 15533
http://www.nber.org/papers/w15533

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
November 2009

We are grateful to Federico Bandi, Luca Benzoni, Jean Jacod, Per Mykland, Roel Oomen, Roberto
Renò, Neil Shephard, Viktor Todorov, Lan Zhang, and, in particular Mark Podolskij and Kevin Sheppard
for their insights. We also thank participants at the Singapore Management University Conference
in Honor of P.C.B. Phillips, July 2008, the CREATES Volatility Symposium, Aarhus, August 2008,
the Chicago/London Conference on Financial Markets, December 2008, the Humboldt-Copenhagen
Conference on Recent Developments in Financial Econometrics, Berlin, March 2009, the North American
Summer Meeting of the Econometric Society, Boston, June 2009, the First European Conference of
the Society for Financial Econometrics, Geneva, June 2009, as well as seminar participants at the Federal
Reserve Board and the U.S. Commodity Futures Trading Commission for their comments.¸˛Andersen
gratefully acknowledges financial support from the NSF through a grant to the NBER and by CREATES
funded by the Danish National Research Foundation. The views in this paper are solely those of the
authors and should not be interpreted as reflecting the views of the Board of Governors of the Federal
Reserve System, the Federal Reserve Bank of New York, any other person associated with the Federal
Reserve System, or the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2009 by Torben G. Andersen, Dobrislav Dobrev, and Ernst Schaumburg. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

Jump-Robust Volatility Estimation using Nearest Neighbor Truncation
Torben G. Andersen, Dobrislav Dobrev, and Ernst Schaumburg
NBER Working Paper No. 15533
November 2009
JEL No. C14,C15,C22,C80,G10
ABSTRACT
We propose two new jump-robust estimators of integrated variance based on high-frequency return
observations. These MinRV and MedRV estimators provide an attractive alternative to the prevailing
bipower and multipower variation measures. Specifically, the MedRV estimator has better theoretical
efficiency properties than the tripower variation measure and displays better finite-sample robustness
to both jumps and the occurrence of "zero'' returns in the sample. Unlike the bipower variation measure,
the new estimators allow for the development of an asymptotic limit theory in the presence of jumps.
Finally, they retain the local nature associated with the low order multipower variation measures. This
proves essential for alleviating finite sample biases arising from the pronounced intraday volatility
pattern which afflict alternative jump-robust estimators based on longer blocks of returns. An empirical
investigation of the Dow Jones 30 stocks and an extensive simulation study corroborate the robustness
and efficiency properties of the new estimators.

Torben G. Andersen
Kellogg School of Management
Northwestern University
2001 Sheridan Road
Evanston, IL 60208
and NBER
t-andersen@kellogg.northwestern.edu
Dobrislav Dobrev
Federal Reserve Board of Governors
20th Street and Constitution Avenue NW
Washington, DC 20551
Dobrislav.P.Dobrev@frb.gov

Ernst Schaumburg
Federal Reserve Bank of New York
33 Liberty Street
New York, NY 10045
ernst.schaumburg@ny.frb.org

1

Introduction

In the ubiquitous continuous-time no-arbitrage semimartingale framework for modeling asset prices, it is often useful to obtain separate estimates of the continuous part of the
volatility process versus the return variation induced by discontinuities or jumps. This is,
for instance, the case in the context of risk management, option pricing and volatility forecasting. Thus far, the dominant approach for delivering jump-robust volatility estimates
from intradaily return observations has been the so-called realized bipower variation measure, introduced by Barndorff-Nielsen and Shephard (2004), in which volatility is estimated
by the cumulative sum of products of adjacent absolute returns.1 While the bipower variation, by construction, ensures that (finite activity) jumps will not impact the consistency
of the volatility estimate, it does not allow for a feasible asymptotic theory under the jump
alternative and is subject to a fairly significant finite sample jump distortion (upward bias)
that may be of concern in applications. To obtain improved finite sample jump robustness
and a feasible asymptotic theory under the jump alternative, the bipower variation has
been generalized in subsequent work to tripower and multipower variation measures, which
employ products of (lower order) powers of three or more adjacent returns.2 The tripower
variation is theoretically the most efficient among those. However, it is also more susceptible to market microstructure contamination of the high-frequency return series than the
bipower variation. In particular, multipower variation measures are sensitive to the presence of very small (zero) returns arising from stale quotes and rounding to a discrete price
grid. In applications, the prevalence of zero returns is often substantial, thus introducing a
separate source of potential bias.3
We propose two simple alternatives to the prevailing bipower and tripower variation
measures that provide additional robustness to jumps and/or market microstructure noise
by using nearest neighbor truncation. The first estimator obtains jump robustness by appropriately scaling the square of the minimum of two consecutive intraday absolute returns.
If one of these returns is large, e.g., due to the presence of a jump during the interval, this
return is automatically discarded and all weight in the computation falls on the adjacent
diffusive returns. Asymptotically, under finite jump activity, we never encounter two adjacent jumps so, like bipower, the measure retains consistency for the underlying integrated
diffusive variance. However, this “minimum” or “MinRV” estimator suffers from a similar
exposure to small (zero) returns as the traditional multipower variation estimators. In addition, large (absolute) returns are inherently more informative of the underlying volatility
1

Alternative jump-robust estimators include: Mancini (2006), Andersen, Dobrev, and Schaumburg (2008)
and Lee and Mykland (2007).
2
See Barndorff-Nielsen, Graversen, Jacod, Podolskij, and Shephard (2006) and Barndorff-Nielsen, Shephard, and Winkel (2006).
3
Studies of the finite sample behavior of the bipower statistic include Barndorff-Nielsen and Shephard
(2004), Huang and Tauchen (2005), Andersen, Bollerslev, and Dobrev (2007), and Dobrev (2007).

1

than small returns, so our minimum estimator is not particularly efficient. Consequently,
we introduce another variant which considers three consecutive intraday returns and simply
squares the median absolute return among the three. This estimator also, asymptotically,
avoids including the impact of a jump in the measure while reducing the sensitivity to the
smallest absolute returns within the trading day and enhancing the asymptotic efficiency.
The unifying theme behind our new estimators is that the absolute returns are truncated
at a level controlled by the neighboring returns. “MinRV” uses one-sided truncation as each
intraday return is compared only to the subsequent absolute return. The second estimator,
denoted “MedRV”, employs two-sided truncation as it uses the median of three adjacent
absolute returns. Hence, these estimators exploit an adaptive truncation scheme which
serves as an endogenous control for the local level of volatility and avoids the potentially
delicate choice of an ex-ante threshold required for, e.g., the truncated RV approaches of
Mancini (2006) and Aït-Sahalia and Jacod (2007) or the truncated bipower variation of
Corsi, Pirino, and Renò (2008).
The endogenous “nearest neighbor” truncation enhances the robustness of our estimators
and allows for the development of an asymptotic distribution theory covering both the
“no-jump” null hypothesis and the “jump” alternative, which facilitates inference about
the presence of jumps. Specifically, the MedRV estimator has better theoretical efficiency
properties than the tripower variation measure and displays better finite-sample robustness
to jumps and the occurrence of “zero” returns in the sample.
We define the MinRV estimator as arising from the sequential use of the min operator on
blocks of two returns and the MedRV estimator from applying the med operator on blocks
of three returns. Increasing the block size over this minimum length leads to a gradual
efficiency loss, analogous to that observed for higher order multipower variation measures.4
Instead, as a theoretically attractive avenue for more efficient jump-robust volatility estimation exploiting larger block sizes, we consider the recent quantile realized volatility (QRV)
estimator of Christensen, Oomen, and Podolskij (2008) based on optimally combining relative extreme quantile observations within blocks of twenty or more data points.5 However,
the reliance on larger blocks has a non-trivial practical cost in finite samples. A critical
assumption is that the returns within each block are i.i.d. Gaussian and thus, in particular,
that volatility is constant across the block. Although asymptotically valid, this assumption
becomes progressively harder to maintain in applied work as the block size increases to
encompass a wider calendar interval. This is due to the substantial systematic variation in
4

Results for such less efficient versions of MinRV and MedRV are available from the authors upon request.
In fact, our “minimum” and “median” estimators share features of both the multipower and quantile
estimators. MinRV and MedRV rely on functions of (small) overlapping blocks of adjacent returns like the
former, while they exploit the squared quantiles of the (absolute) returns over a (short) block, thus mimicking
qualitative aspects of the latter. Another recent estimator of this type is the Realized Outlyingness Weighted
Quadratic Covariation (ROWQCov) estimator of Boudt, Croux, and Laurent (2008).
5

2

volatility across the trading day, which renders the underlying returns within a longer block
non-homogeneous. In addition, although trade and quote arrivals are correlated with increments in volatility they are not well enough aligned to ensure homogeneity (i.e., constant
volatility) of the observed log-price increments in either calendar or tick time. Consequently,
the gap between the finite sample and asymptotic properties of such estimators tends to be
more pronounced than for our “local” MinRV and MedRV estimators. We provide extensive
evidence on the finite sample properties of the alternative estimators in simulations and for
individual stocks in the Dow-Jones 30 index between January 2005 and May 2008.
The remainder of the paper progresses as follows: Section 2 lays out the basic setup
and introduces several popular jump-robust measures of integrated volatility along with
our MinRV and MedRV estimators. The asymptotic properties of the new estimators are
laid out in a series of propositions. Section 3 provides an empirical application to the set of
stocks in the Dow Jones 30 index. Section 4 presents extensive simulation evidence exploring
the impact of a variety of features on the performance of the alternative estimators. Section
5 provides concluding observations, while all formal proofs are relegated to the appendix.

2

Jump-Robust IV Estimation

We consider the univariate logarithmic price process Y = {Yt }0≤t≤1 of an asset defined on
a filtered probability space (Ω, F, (Ft )t≥0 , P ) so that Y is adapted to the filtration and
evolves in continuous time as described by the following jump-diffusive representation,

dYt = µt dt + σt dBt + dJt

(1)

where µ is a locally bounded and predictable process and σ is cadlag and bounded away
from zero almost surely. The price process is observed at the N + 1 discrete points in time
0 ≤ t0 < t1 < · · · < tN ≤ 1 over a given period which we refer to as a trading day. The
corresponding returns and time intervals are denoted ∆Yi = Yti − Yti−1 and ∆ti = ti − ti−1 ,
i = 1, ..., N . Finally, J denotes a finite activity jump process and dJt is either zero (no
jump) or a real number indicating the occurrence and size of a jump at time t. Our finite
activity jump assumption implies that there are only a finite number of jumps over the
trading day. The subsequent analysis is performed via standard continuous record in-fill
asymptotics where the time increments between successive return observations, defining the
sampling scheme, uniformly shrink towards zero as N increases.
The object of interest is to estimate the continuous part of the quadratic variation, or
the integrated variance (IV), defined as

3

Z 1

IV =
0

σu2 du

As is well known, this rules out the use of the popular realized volatility estimator
which estimates the total quadratic variation of the observed semimartingale, including the
contribution from the cumulative squared jumps.6

2.1

Multipower Variation Measures

The initial, and by far most widely used, estimator of IV in the presence of jumps is the
bipower variation (BV) measure of Barndorff-Nielsen and Shephard (2004). It can be shown
to be consistent for IV in the absence of market microstructure noise but under otherwise
very general conditions. It is given as,

BVN

π
=
2



N
N −1

 NX
−1

|∆Yi ||∆Yi+1 | .

(2)

i=1

The intuition for the consistency and jump robustness of the BV estimator
is straightfor

2

ward: If ∆Yi , ∆Yi+1 ∼ i.i.d.N (0, σN ) then E[|∆Yi ||∆Yi+1 |] =

2 σ2
π N,

and

N
N −1

is a required

finite sample correction factor. As such, each term of the bipower variation measure delivers
an unbiased estimate of the underlying local (spot) variance. Moreover, asymptotically, as
the returns span near infinitesimal intervals, there will at most be a single jump within two
adjacent intervals. This isolated jump will be dampened by the multiplication by a small
adjacent (diffusive) return of order ( √1N ). As N grows this is sufficient to render the jump
contribution asymptotically negligible. Nonetheless, in practical applications there will be
an upward (finite sample) bias due to large jumps as the adjacent return is not vanishing,
reflecting the choice of underlying sampling frequency. The latter is typically governed
by market conventions as well as the liquidity and microstructure features of the market.
√
Another drawback of the BV estimator is that the jumps only vanish at the rate of N
which is not sufficient to deliver a continuous-record central limit theory in the presence of
jumps in the price path. The desire to obtain an operational asymptotic theory under jump
alternatives was a major reason for the introduction of the multipower variation statistics.
These are analyzed thoroughly in, e.g., Barndorff-Nielsen, Shephard, and Winkel (2006).
In order to introduce the requisite extension of the bipower variation statistic it is
useful, for simplicity, to assume equally spaced sampling, i.e., ∆t = ti − ti−1 = 1/N, for all
i = 1, ..., N . The class of multipower variation statistics is then defined via the cumulative
6

See, e.g., Andersen, Bollerslev, and Diebold (2009), Bandi and Russell (2007), Barndorff-Nielsen and
Shephard (2007), McAleer and Medeiros (2008) for surveys of the realized volatility literature.

4

sum of m products of adjacent absolute returns raised to the (r/m)’th order, where m is
a positive integer and r a positive real number, usually an integer. Hence, the cumulative
power of the adjacent products equals r. These statistics provide consistent estimators for
the corresponding integrated power of the volatility,

M P VN (m; r) = dm,r



N
N −m+1



(N )

r/2−1

N −m+1
X

r
m

|∆Yi | ...|∆Yi+m−1 |

r
m

P

→

Z 1
0

i=1

where dm,r is a known constant dependent only on m and r, while
sample correction

factor.7



N
N −m+1



σur du (3)

is a finite

If the adjacent returns are i.i.d. Gaussian, each summand in (3)

delivers an unbiased estimate of the power of spot volatility. The sum therefore provides a
(converging) Riemann approximation to the integrated power of the volatility process.
This multipower variation measure generalizes the entire first generation of estimators
in the realized volatility literature, as one obtains the standard realized volatility measure as RVN = M P VN (1; 2), while BVN = M P VN (2; 2), and additional oft-applied
measures include the tripower variation T P VN = M P VN (3; 2) the quadpower variation
QP VN = M P VN (4; 2), and the fourth order power variation P VN (4) = M P VN (1; 4).
In the presence of a finite activity jump process, the RV estimator is not consistent for
the integrated variance, the BV statistic is consistent but does not allow for an asymptotic
theory under the jump alternative, while the realized tripower and quadpower measures
both provide consistency and allow an associated asymptotic mixed normal limit theory.
This property is maintained for M P VN (m; 2) for m > 3. Likewise, the fourth order power
variation is consistent for the integrated fourth power of the volatility process, the so-called
integrated quarticity, but allows for an asymptotic theory only in the absence of jumps.
Robust alternatives, which provide both consistency and asymptotic theory under finite
activity jumps, are given by M P VN (m; 4) for m > 5.8
The existence of numerous estimators begs the question of which one is preferable. Not
surprisingly, this cannot be answered in general. However, using the ideal setting of no
microstructure noise, near infinitely frequent sampling and no jumps, the M P VN (m; r)
measure of lowest order in m delivering the desired feature, whether consistency or a mixed
normal limit theory, is the more efficient estimator. Specifically, for estimating the integrated variance in the absence of jumps, the realized volatility estimator is most efficient.
Analogously, bipower variation is the preferred consistent jump-robust estimator for IV
7

In the case of Gaussian i.i.d.

price changes dm,r = µ−m
, where µp = E|U |p = 2p/2
r/m

Γ(

1
(p+1))
2
,
1
Γ( )
2

U ∼ N (0, 1), see, e.g., Barndorff-Nielsen and Shephard (2004) and Barndorff-Nielsen, Graversen, Jacod,
Podolskij, and Shephard (2006).
8
See Barndorff-Nielsen, Shephard, and Winkel (2006) for the behavior of the multipower variation estimators under both the no-jump null hypothesis and under the jump alternative in more general scenarios.

5

while tripower variation is the estimator with minimal asymptotic variance among this
class which allows for the development of an asymptotic theory under the jump alternative.
Of course, the frictionless setting is not representative of actual market conditions.
In particular, various market features limit the sampling frequency so that the impact of
jumps cannot be fully neutralized. In this case, it may be desirable to apply higher order
multipower variation measures as they provide better (finite sample) dampening of the
jump component. In fact, an extensive simulation exercise by Veraart (2008) finds that
the finite sample jump distortion is sufficiently influential to render the M P VN (10; 2) and
M P VN (10; 4) preferable to the lower order multipower statistics. One caveat is that this
simulation evidence assumes a very smooth evolution of the diffusive volatility process and
that equally spaced ultra high-frequency returns are available at near arbitrary sampling
intervals. These features render volatility near constant across sequences of ten adjacent
high-frequency returns thus ensuring that the returns within each block adhere closely to
the ideal of being i.i.d. Gaussian distributed. In reality, however, many asset prices display
a pronounced U-shape in volatility across the trading day, resulting in sharp movements
in volatility across fairly short time intervals. Moreover, fresh quote or trade observations
are often not available at the very highest sampling frequencies as both trade and quote
intensities undergo significant intraday fluctuations as well. The result is that a block of
adjacent (non-stale) price or quote observations often spans a non-trivial time interval, and
thus validity of the assumption of homogenous returns and, in particular, constant volatility
is questionable. Moreover, the extent of this problem is proportional to the number of
adjacent returns exploited by a given estimator. As such, it may be important to explore
the impact of the “localness” of the estimator in practical applications. We present evidence
both from actual equity data and from an extensive simulation design that this feature,
indeed, is a major determinant of the performance of such estimators.
In summary, the class of multipower variation measures embodies a tradeoff between
efficiency and localness on the one hand and jump robustness on the other. This motivates
our introduction of alternative estimators based on nearest neighbor truncation that retain
the local nature of the bipower and tripower estimators and provide better finite sample
robustness and asymptotic efficiency, while allowing for feasible asymptotic theory in the
presence of (finite activity) jumps.

6

2.2

The MinRV and MedRV Estimators

We propose the following MinRV and MedRV estimators of integrated variance,
MinRVN

π
=
π−2



N
N −1

 NX
−1

min ( |∆Yi |, |∆Yi+1 | )2

i=1

(4)
π
√

MedRVN =

6−4 3+π



N
N −2

 NX
−1

med ( |∆Yi−1 |, |∆Yi |, |∆Yi+1 | )2

i=2

The scaling factors ensure that every summand on the right hand side of equation (4)
provides an unbiased estimate of the underlying spot variance if the corresponding block
of returns are i.i.d. Gaussian.9 The robustness of the MinRV and MedRV estimators
compared, e.g., to the BV estimator in equation (2) stems from the fact that returns contaminated by a large jump are fully eliminated by the min/med operators. That is, if a
(large) jump occurs within one of the two terms for the MinRV estimator, the min operator
simply squares the adjacent (small) diffusive return. There will be an induced bias as we
now effectively compute the square of a single return rather than of the minimum of two
independent returns, but the bias is an order of magnitude smaller than for bipower. For
illustration, assume there is a (large) price jump of size ∆ji in the interval [ti−1 ; ti ] but no
jump in the adjacent intervals so that |∆Yi−1 |  |∆ji | and |∆Yi+1 |  |∆ji |. The distortion to the overall BV from the interval containing the jump return clearly dominates the
corresponding maximal distortion to the MinRV measure, i.e.,
i
π
π h
|∆ji |(|∆Yi−1 | + |∆Yi+1 |) 
|∆Yi−1 |2 + |∆Yi+1 |2
(5)
2
π−2
√
as the left hand side is of order (1/ N ) versus order (1/N ) on the right hand side. More

generally, the upward bias due to jumps for any multipower variation M P VN (m; 2) , m ≥ 2
1

is of order (1/N 1− m ), thus approaching (1/N ) from above for large m. The expression (5)
also reflects the important fact that only the number of jumps, but not their actual size, have
an impact on the bias of the MinRV and MedRV estimators. By construction, one should
therefore expect a larger degree of finite sample jump robustness from these estimators than
the multipower variations.10
As indicated above, the MinRV and MedRV estimators are consistent for the integrated
variance, as implied by the following proposition.
9

The derivation of these scaling factors is a simple exercise in integration and is available from the authors
upon request.
10
Likewise, the MinRV and MedRV estimators have the advantage of simplicity relative to the truncated
RV estimator of Mancini (2006) which truncates jumps above a pre-specified threshold. This threshold
choice can be delicate when (latent) volatility is time varying, although some practical progress is reported
by Corsi, Pirino, and Renò (2008) using a combination of multipower and threshold techniques.

7

Proposition 1 Let the log-price process Yt be given by the jump-diffusion (1) with finite
jump activity. Assume further that µt is adapted and locally bounded, σt is adapted, cadlag
and inf t≥0 σt > 0 almost surely. Then we have, as N → ∞,
P

MinRVN −→

Z 1
0

σu2 du

and

P

MedRVN −→

Z 1
0

σu2 du

Under slightly stronger assumptions about the volatility process we obtain a corresponding asymptotic distribution theory.
Proposition 2 Let the log-price process Yt be given by the jump-diffusion (1) with finite
jump activity. Assume further that µt is adapted and locally bounded, σt is bounded away
from zero almost surely and follows an Ito process of the form (A1) given in the appendix,
then
√

stable D



stable D



N (MinRVN − IV ) −→ M N 0, 3.81

Z 1
0

√

N (MedRVN − IV ) −→ M N 0, 2.96

Z 1
0



σu4 du



σu4 du

Moreover, these results remain valid for finite as well as infinite activity jumps in the
volatility process subject only to the weak regularity conditions of Barndorff-Nielsen, Graversen, Jacod, Podolskij, and Shephard (2006), stipulating only that the resulting general
Ito semimartingale, generalizing Assumption (A1), has jump characteristics that are locally
bounded.
The distributional convergence is stable and the notation M N denotes a mixed Gaussian limiting distribution, i.e., a normal distribution conditional on the realization of the
integrated quarticity, IQ =

R1 4
0 σu du, where, importantly, the limiting normal variate is

independent of the (random) IQ process.
The results in Proposition 2 mirror existing limit theories for multipower variation statistics in scenarios without jumps. In this case, the MinRV and MedRV estimators are less
efficient than the optimal multipower variation statistics (bipower). Of course, the advantage is the near elimination of finite sample jump distortion.
To illustrate the relationship between the estimators, we derive the joint asymptotic
distribution between the MinRV, MedRV and the standard RV and BV estimators under
the no-jump null:
Proposition 3 Under the assumptions of Proposition 2, except that we rule out jumps in
the price process, we have the following joint asymptotic stable distributional result,

8



√

RVN − IV


 BV − IV
N

N
 MinRVN − IV


MedRVN − IV









 stable D
 −→ M N






0,










2

2

2

2










2.61 2.98 2.53 


 IQ


3.81 3.09 


2.96

The proposition shows that there is a non-trivial increase in the asymptotic variance
as we move from BV to MinRV, while the MedRV measure is much closer to matching
the efficiency of BV. Moreover, both MinRV and MedRV are highly correlated with BV as
well as with each other.11 Of course, a more natural comparison is between the MinRV and
MedRV estimators and higher order multipower variation measures as these allow for a valid
asymptotic theory in the presence of jumps. Table 1 tabulates the relevant efficiency factors.
It is evident that MinRV is less efficient, being on par with the sixth order multipower
variation estimator. In contrast, MedRV is more efficient (has lower asymptotic variance)
than the best (tripower) estimator within this subset of the MPV group.
Proposition 2 implies that feasible inference regarding the realized latent integrated
variance is possible based on the MinRV and MedRV estimators, even in the presence of
finitely many price jumps. However, as for the MPV measures, this requires a consistent
estimator for the integrated quarticity. Such jump-robust estimators are readily constructed
from higher order multipower variation statistics. An alternative is to construct an estimator
for the quarticity in a direct extension of the principles behind the MinRV and MedRV
estimators:

MinRQN
MedRQN

 NX
−1

=

πN
3π − 8

=

3πN
√
9π + 72 − 52 3



N
N −1

min (|∆Yi |, |∆Yi+1 |)4

i=1



N
N −2

 NX
−1

med (|∆Yi−1 |, |∆Yi |, |∆Yi+1 |)4

i=2

In fact, the asymptotic theory is entirely analogous and results similar to Propositions
1-3 hold for these quarticity estimators. Likewise, tests for jumps involving statistics based
on appropriately normalized differences between the RV and MedRV or MinRV measures
may readily be constructed using Proposition 3. We defer the exploration of such procedures
to future research.
11
We note as a corollary the following correlations between estimators: Corr(RV, MinRV) =
72.4%, Corr(BV, MinRV) = 94.5% , Corr(RV, MedRV) = 82.2%, Corr(BV, MedRV) = 91.0%
Corr(MinRV, MedRV) = 92.0%. This suggests that there may be some scope for applying a jump-robust
GMM procedure by combining BV, MinRV and MedRV estimators. The derivations are available from the
authors upon request.

9

3

Finite Sample Evidence - Dow Jones 30 Stocks

In this section we gauge the empirical performance of the MinRV and MedRV estimators on
the set of Dow Jones 30 stocks using NYSE TAQ data from January 1, 2005 through May 31,
2007. Ignoring short trading days around major holidays we obtain a sample of 601 trading
days. We apply the estimators to the series of mid-quotes after filtering out spread outliers
(less than 0.1% of the data) and compare the finite sample efficiency of the sub-sampled
MinRV and MedRV to sub-sampled multipower variation estimators. Sub-sampling is a
simple way of increasing the efficiency of an estimator and was originally advocated for RV
by Zhang, Mykland, and Aït-Sahalia (2005). It involves taking the average of an estimator
across all possible sub-samples (at a given sampling frequency) obtained by starting from
different offsets (and scaling up to match the full day length). For comparison, we also
consider a sub-sampled version of the recently developed Quantile RV (QRV) estimator
of Christensen, Oomen, and Podolskij (2008). There is little existing evidence regarding
the best practical construction of the QRV measure, so we adopt an approach guided by
their specific empirical implementation aiming to improve on the efficiency of the bipower
variation benchmark.12
To keep the exposition manageable we only present results for the various daily measures
averaged over the full sample period and across all the stocks. This should help convey
the systematic differences across the estimators while reducing the impact of idiosyncratic
features of individual stocks and specific time periods.

3.1

“Tick” Time and Calendar Time Sampling

An important aspect of the implementation of any IV estimator is whether to sample in
“tick” time or “calendar” time. These sampling schemes represent alternative extreme views
of the dependence between observation times and price moves. The tick time approach can
be justified (with the standard limiting theory) when volatility is constant in tick time, i.e.,
observation times and the quadratic variation of the price process are perfectly correlated.
12
In particular, we use only a single return block for each trading day, consisting of all the relevant recorded
quotes, and we optimally weight the quantiles {0.05, 0.10, 0.15, 0.85, 0.90, 0.95} based on the finite sample
values of the associated scaling factors, exploiting sample sizes all the way up to 23,400 (one per second):

QRV =

1
ν

X

ωλ g 2 (λ) + g 2 (1 − λ)





λ∈{0.85,0.9,0.95}

where g(λ) is the order statistic of the λth return percentile and ωλ provides the optimal weighting as
suggested by Christensen, Oomen, and Podolskij (2008). The constant ν is a normalizing constant whose
(finite sample) value must be determined by numerical integration or simulation. Importantly, it is not
possible to reliably interpolate the QRV scaling factors across nearby sample sizes due to their pronounced
oscillatory nature. This is also the case for a symmetrized version of QRV explored in a conference discussion
of Christensen, Oomen, and Podolskij (2008) by Kevin Sheppard.

10

The calendar time approach, on the other hand, can be justified when observation times
are exogenous to the price process, i.e., inference can be carried out conditional on the
observation times. In particular, there can be no correlation between quote/trade arrivals
and changes in volatility. Neither correlation assumption is likely to be fully accurate, so
we study our estimators under both calendar and tick time sampling.13
From Figure 1, Panels 1A and 2A we note that the calendar and tick time based approaches lead to qualitatively similar IV estimates for each estimator across the sampling
frequencies. A couple of other features are striking. First, it is evident that the RV estimator
is more robust than any of the others, as the implied volatility level is quite stable across the
entire range of sampling frequencies, spanning 4 seconds to 5 minutes. In contrast, all the
jump-robust IV estimators vary significantly across the frequencies, with the pronounced
dip at the highest frequencies being particularly noteworthy.14 In most cases, the maximum
value is obtained around the two-minute frequency. The subsequent explorations document
fairly significant downward biases at the highest and lowest frequencies, suggesting that IV
estimates based on sampling around the two-minute level are the least biased. In particular,
we study the effects of stale quotes, unevenly spaced data, i.i.d. microstructure noise and
strong intraday volatility patterns below. Second, the IV estimators differ substantially
from each other: MinRV , MedRV and BV lead to roughly similar average estimates while
the tripower (TV) and the quantile (QRV) estimators often yield much lower and RV much
higher estimates. These differences are highly significant given the standard deviation of
daily IV estimates depicted in Figure 2, Panels 1A-2A, taking into account the large number of underlying days and stocks. For RV, the higher estimates are consistent with the
presence of price jumps as, by construction, it is not jump-robust. As such, the discrepancy
between RV and the other measures provides an indication of the overall jump contribution
to the return variation across the Dow Jones stocks. The analysis in the following sections
sheds further light on the reasons for the disparate behavior of the alternative IV measures.

3.2

Stale Quotes

Table 2 summarizes basic descriptive statistics for the Dow Jones components, including
all companies that were part of the index during January 1, 2005 and May 31, 2007. These
stocks are generally very actively traded, with an average of one new quote arrival every
2 seconds throughout the normal trading hours from 9:30am to 4:00pm EST. However, a
13
In practice, this issue seems greatly alleviated if one avoids sampling at ultra-high frequencies. For
example, the effect appears empirically negligible for actively traded securities if volatility is computed from
one-minute returns. Nonetheless, much current research aims to reduce the impact of noise sufficiently
that even the highest sampling frequencies may be exploited productively. As such, the dependence between
observation times (quotes or trades) and the underlying price process is an intriguing area for future research.
See Mykland, Renault, and Zhang (2008) for a recent discussion of volatility estimation in such circumstances.
14
Chaboud, Chiquoine, Hjalmarsson, and Loretan (2007) have also documented a similar dip of the bipower
variation estimates of IV on FX and T-Bond data.

11

significant number of these quotes simply repeat previous quotes, as reported in the first two
columns of the table: the average number of non-duplicate quotes is only about one quarter
of the recorded quotes. Remarkably, the two most actively traded stocks (INTC and MSFT)
have the smallest number of non-duplicate quotes. As a consequence, estimators may well
behave differently if based on duplicate-filtered versus unfiltered data. Furthermore, the
last column of the table indicates that the duplicate quotes are clustered as most stocks
experience long spells of duplicate quotes. The median number of zero returns lasting longer
than 30 seconds on each day is 161, those lasting longer than 1 minute are about 48 on
each day, and those lasting longer than 2 minutes are about 11 per day. Importantly, this
pattern is observed without much variation across stocks (reported) or trading days (not
reported). The effect of filtering out duplicates is shown in Figure 1, Panel 3A. For all
estimators, except QRV, the dip at higher frequencies is substantially alleviated without
any major impact at lower frequencies, consistent with the elimination of a bias induced
by zero returns. Specifically, we note that the behavior of the TV measure now starts to
resemble that of the remaining IV estimators, leaving QRV as a relative outlier.

3.3

Microstructure Noise

The prevalent way of dealing with microstructure noise is to sample at a lower frequency
than the available data (e.g., 2 minutes) to gain noise robustness and then compensate
for the efficiency loss by subsampling the estimator.

An alternative approach termed

“pre-averaging,” recently introduced by Podolskij and Vetter (2006), exploits the data at
the highest frequency available, but uses local “pre-averaging” via a kernel function to
produce a set of non-overlapping (asymptotically) noise free (in practice, noise reduced)
observations to which standard IV estimators may be applied. In practice, this necessitates a choice of bandwidth (and kernel function) and leads to a familiar bias-variance
trade-off which we study for our set of estimators. To render the results comparable, we
consider pre-averaging window lengths matching our sub-sampling frequencies. In particular, we note that if the pre-averaged log-prices for window of length K are defined as
Ȳi =

1
K

PK−1
j=0

Yi+j , i = 0, 1, ..., N − K + 1 then the pre-averaged version of each estimator

has equivalent representation in terms of sub-sampling Ȳi at frequency K observations, implying that the corresponding returns Ȳi+K − Ȳi cover a window of length 2K observations
of the original log-price series Yi . Therefore, for each pre-averaged IV estimator based on
Ȳi we set the underlying pre-averaging window length K, so that 2K equals the sample
frequency of each corresponding sub-sampled IV estimator based on Yi .15
15

Unlike the sub-sampled IV estimators, their pre-averaged counterparts require an additional scaling
factor implied by the kernel function and asymptotically equal to 3, see, e.g., Podolskij and Vetter (2006)
and Christensen, Oomen, and Podolskij (2008). We computed the exact finite sample value of this scaling
factor (available upon request) as a function of pre-averaging window length in order to eliminate the bias
otherwise incurred when using its asymptotic value.

12

The pre-averaged estimators are displayed in Figure 1, Panels 1B-3B. Overall, they
mirror the qualitative behavior of the sub-sampled estimators although the estimated level
of volatility is marginally lower. In particular, the tripower variation measure continues to
be strongly downward biased. Moreover, the QRV measure again delivers values that fall at
the bottom of the range across the estimators. This goes along with a substantially lower
daily standard deviation of the measure as depicted in Figure 2. The simulation section
below exemplifies some of the features that may rationalize this distinctive behavior of QRV.

3.4

Robustness across Volatility Regimes

Based on newly available NYSE/TAQ data, we consider a second shorter sample covering
June 1, 2007 to May 31, 2008. Ignoring short trading days around major holidays we obtain
a sample of 248 days during the second sample period. This allows us to consider the
robustness and relative performance of the estimators across different regimes as volatility
is significantly higher during the more recent period.
The results are displayed in Figures 3-4. Along with the much higher estimates of IV
there is also a much wider gap between RV and the jump-robust measures suggesting more
significant jump activity in this period. The relative behavior of the individual estimators,
however, follows roughly the same pattern as in the first sample, with notably lower estimates of QRV and TV compared to MinRV , MedRV and BV. Interestingly, Panels 3A and
3B also suggest that, in this period of higher volatility, it may be particularly beneficial to
filter out duplicates for the sake of producing volatility estimates that are consistent across
a wider range of sampling frequencies and pre-averaging windows.
Overall, the behavior of the various IV estimators appears robust to the volatility regime
as the qualitative differences observed over the prior sample remain intact. It is worth
noting, though, that the dispersion of the estimates is no longer wildly inflated at the highest
frequencies as was the case in the initial sample period (Figure 4 vs. Figure 2). This may
reflect a reduction in the noise-to-signal ratio over time due to the growing quantity and
quality of the high-frequency quotations.16

4

Finite Sample Simulation Evidence

We conduct Monte Carlo experiments focusing on features of the data generating process
that may affect the finite sample behavior of the various IV estimators. In particular, we
compare the performance of sub-sampled/pre-averaged MinRV and MedRV estimators to
sub-sampled/pre-averaged BV, TV, and QRV benchmarks for a set of models embodying
distinct features. The emphasis is on the qualitative impact. In reality, all these features are
16

In addition, a period of elevated volatility, without a commensurate increase in the microstructure noise,
translates into an improved signal-to-noise ratio, i.e. better relative quality of the data.

13

likely present simultaneously and interact with each other, creating rather complex patterns
in tick-by-tick data. Hence, the simulations are not designed to replicate the quantitative
magnitude of statistics observed from actual data in all dimensions, but rather to help
identify features which may be relevant to explain the systematic patterns in the empirical
results.
We consider the following set of volatility models, which mostly deviate from the simple
i.i.d. Gaussian benchmark in a single dimension to facilitate direct interpretation of the
qualitative impact:
- Model 1 : “BM”. This is our baseline Brownian motion model with sampling on an equispaced time grid. It provides the ideal setting under which the finite sample performance of
the IV estimators should be closely in line with the underlying asymptotic theory.
- Model 2 : “SV-U”. This is a stochastic volatility model (two-factor affine) with intraday
U-shape volatility pattern and sampling on an equispaced time grid. It allows us to isolate
potential finite sample biases of the estimators due to time variation in volatility.
- Model 3 : “BM + Sparcity”. This is a Brownian motion model with sampling on a sparse
(exogenously random) time grid. While not necessarily realistic, this model is helpful for
studying the potential distortion of the estimators when applied on non-homogeneously
sampled returns, effectively inducing spurious variations in their volatility.
- Model 4 : “BM + 1 Jump”. This is a Brownian motion model with one jump on each day
and sampling on an equispaced time grid. It serves to illustrate the degree of finite sample
jump robustness of the alternative IV estimators.
- Model 5 : “BM + 4 Jumps”. This is a Brownian motion model with four jumps on each
day and sampling on an equispaced time grid. We use this jump specification to study the
impact of multiple (potentially adjacent) jumps.
- Model 6 : “BM + Noise”. Brownian motion model with sampling on an equispaced time
grid and subject to i.i.d. microstructure noise. It allows us to shed light on potential
distortions due to microstructure noise.

4.1

Simulation Design

In each model, the price process {Yt } follows a driftless Brownian motion with instantaneous
volatility σ(t):
dY (t) = σ(t) dW1 (t)
Across all model specifications, the unconditional IV of each day is calibrated to 0.000159
corresponding to an annualized volatility of 20% (assuming 252 trading days per year).
This roughly matches the average level of volatility observed in our DJ 30 sample between
January 2005 and May 2007. We also match the average sample frequency of 2 seconds

14

resulting in 11,700 intraday observations. We adopt an equispaced time grid across all
models except for Model 3, where we use (exogenously) random sampling.
In Model 2, the stochastic volatility model with intraday U-shape volatility pattern is
described by
dY (t)

=

σu (t) σsv (t) dW1 (t)

2 (t)
σsv
dσ12 (t)
dσ22 (t)

=

σ12 (t) + σ22 (t)

=

κ1 θ1 − σ12 (t) dt + η1 σ1 (t) dW21 (t)

=

κ2 θ2 − σ22 (t) dt + η2 σ2 (t) dW22 (t)








with W21 , W22 independent and the leverage effect captured by the instantaneous correlations ρ1 = corr(dW1 (t), dW21 (t)) and ρ2 = corr(dW1 (t), dW22 (t)). The two factor model
parameters are calibrated in line with Andersen, Bollerslev, and Meddahi (2005) in percentage form as κ1 = 0.6, κ2 = 0.1, θ1 = 1.0582, θ2 = 0.5291, η1 = 0.2, η2 = 0.1, ρ1 =
0.9, ρ2 = −0.4. Following Hasbrouck (1999) we model the diurnal volatility U-shape as the
sum of two exponentials:
σu (t) = C + A e−at + B e−b(1−t) , t ∈ [0; 1]
where the constants A = 0.75, B = 0.25, C = 0.88929198, a = 10, b = 10 are calibrated
to produce a strong asymmetric U-shape with variance at the open (t = 0) more than 3
times the midday variance (t = 1/2) and variance at the close about 1.5 times the midday
variance.
In Model 3, non-homogeneous sampling is obtained by taking a random sample of 11,701
points (without repetition) out of the full daily time grid (23,401 seconds from 9:30 am
to 4:00 pm). The resulting sample size is identical to the one obtained with 2-second
equidistant sampling, but the price observations are subject to exogenously imposed random
sparcity.
In Models 4-5, price jumps are introduced by extending the log-price process as
dY (t) = σ(t) dW1 (t) + dJt
where the Poisson jump process (Jt ) is assumed independent of (W1 , W2 ). In order to stress
test the IV estimators, we calibrate the process to match moderate “jump days” on which
one (Model 4) or four (Model 5) Gaussian jumps account for an average increase of 25% in
realized volatility (i.e. the jump contribution JV is 25% of IV or, equivalently, 20% of QV
= IV + JV, thereby generating many jumps that are not too obvious return outliers).
Finally in Model 6, we simulate Gaussian i.i.d. noise with a moderate noise-to-signal
ratio λ = 0.25, defined as the ratio of annualized error variance to annualized IV.

15

4.2

Simulation Results

For each model specification, we simulate 2,500 trading days (roughly ten years of data ignoring non-trading periods) and tabulate the relative bias and efficiency of the sub-sampled
IV estimators at sampling frequencies 12, 60, and 300 seconds (Table 3) as well as their
pre-averaged counterparts for pre-averaging windows 12, 60, and 300 seconds (Table 4).17
The results for Model 1, Tables 3-4, confirm that, in a frictionless setting with homogeneous returns, all IV estimators are unbiased and their relative efficiency is closely in
line with the asymptotic theory. However, under the more realistic scenario of stochastic
volatility and pronounced diurnal volatility patterns all IV estimators exhibit a pronounced
downward bias if sub-sampled or pre-averaged sparsely (bottom panels, Tables 3-4, Model
2). Moreover, QRV remains biased even for relatively high sub-sampling frequencies or
small pre-averaging windows (top panels, Tables 3-4, Model 2), whereas the remaining IV
estimators become unbiased as the sampling frequency grows as they are better equipped to
handle intraday volatility fluctuations due to the “locality” achieved by using short rolling
blocks of returns. Thus, the MinRV/MedRV and the multipower variation measures seem
to have a clear finite sample advantage over QRV in this regard.
At the same time, all estimators are downward biased at the highest frequencies if the
sampled returns are non-homogeneous due to (exogenous) random sparcity of the available
observations (top panels, Tables 3-4, Model 3). In this case, pre-averaging over wider
windows or sampling at sparser frequencies (bottom panels, Tables 3-4, Model 3) eliminates
the bias for all estimators. On the other hand, the results for the jump scenarios (Models 45, Tables 3-4) provide evidence that MinRV, MedRV, and QRV are considerably less biased
in the presence of jumps, especially multiple ones, compared to the multipower variation
measures. Finally, the sensitivity of the estimators to microstructure noise is quite similar
and both sub-sampling (middle and bottom panels, Table 3, Model 6) and pre-averaging
(middle and bottom panels, Table 4, Model 6) seem to offer a sensible solution for all
estimators. It is worth noting, though, that matching the pre-averaging window size to the
sub-sampling frequency results in consistently lower MSE of the pre-averaged estimators
compared to their sub-sampled counterparts (Table 3 vs Table 4), which is in line with the
underlying asymptotic theory.
These controlled Monte Carlo experiments suggest that the MinRV/MedRV estimators
combine the main advantages of the existing IV estimators in finite samples: superior
robustness to jumps akin to QRV as well as reasonable robustness to time-varying volatility
17

c /IV , while the relative efficiency factor at the
The relative bias is computed as the sample mean of IV
c − IV )2 /IQ, where IV and IQ are the
60-sec sample frequency is calculated as the sample mean of 390(IV
c is the IV estimate for
true simulated integrated variance and integrated quarticity on each day, while IV
the given day. For example, the MSE factor for 60-sec sub-sampled RV is about 1.33, and thus in line with
the theoretical value derived in Zhang, Mykland, and Aït-Sahalia (2005).

16

like the multipower variation measures. Sub-sampling or pre-averaging either too sparsely
(i.e. much lower than one-minute frequency) or too frequently (much higher than oneminute frequency) result in downward biases for all the IV estimators, but especially in
the case of QRV, if there are pronounced intraday variations in volatility or instances of
spurious sparcity of the price observations. In this regard, the evidence in Tables 3-4 is
qualitatively consistent with the signature plots produced for the Dow Jones 30 stocks
in Section 3 (Figures 1 and 3). As such, the return variation estimates obtained around
the 2-minute frequency appear most reliable as they seem to avoid both the (downward)
biases induced at the highest frequencies by sparcity, noise and rounding and those at lower
frequencies due to stochastic volatility and diurnal patterns.

5

Conclusion

We introduce two new jump-robust estimators of integrated variance based on high-frequency
return observations. These MinRV and MedRV estimators rely on nearest neighbor truncation as an attractive novel way to achieve jump robustness, while sharing a number of
important features with existing estimators. First, the estimators mirror the traditional RV
measure in simply cumulating a sum of squared intraday returns. Second, they resemble
the bipower and tripower variation estimators in exploiting two or three adjacent return
observations to obtain each summand within the sum defining the variation measure. An
important distinction, however, is that the MinRV and MedRV estimators dampen the effect of jumps at a faster asymptotic rate than any multipower variation estimator. Third,
they provide an even sharper truncation of outliers than the threshold RV estimators. The
main difference is that MinRV and MedRV exploit a threshold given by the adjacent return
observations which ensures a local and adaptive truncation level. In contrast, threshold
RV estimators determine the appropriate threshold by some auxiliary procedure and require effort to ensure sensible adaptation to the time-varying return volatility level. Fourth,
since the minimum and the median correspond to particular quantiles, the MinRV and
MedRV estimators are conceptually related to quantile RV estimators although there are
several important differences. The quantile RV estimators exploit non-overlapping blocks
and emphasize the efficiency gains from using extreme quantiles based on long blocks of
observations, thereby sacrificing the localness of the estimator. The MinRV and MedRV
achieve good efficiency properties exploiting very short overlapping blocks. Moreover, the
finite sample scaling factors and normalizing constants of the MinRV and MedRV are
known in closed form and do not require costly numerical evaluation.
The MinRV and MedRV estimators are designed to obtain a number of specific properties. One, the finite sample jump-robustness is, by construction, excellent as influential
(large) jumps are systematically discarded. Two, the use of overlapping windows helps

17

extract additional information from the observed data. Three, the local nature of the estimators renders them robust to strong intraday variation in volatility. Four, the adaptive
nature of the (implicit) threshold avoids any delicate calibration of the appropriate cutoff level. Five, there is no need for auxiliary procedures to determine a window length
or bandwidth. Six, the MedRV estimator is robust also to the presence of spurious zero
returns (quote or trade price duplicates). Finally, both MinRV and MedRV are very simple
and entail only minor modifications of the popular realized volatility, bipower and tripower
variation measures. In particular, the proofs of the asymptotic theory for the estimators,
although rather technical, can be derived in a manner quite similar to those in the extant
literature. In fact, our appendix illustrates how one may recast the features of a specific
estimator into the format required for application of the existing powerful methodology for
deriving the asymptotic distribution theory.
The evidence gleaned from our analysis of the Dow Jones 30 stocks as well as the
simulation study confirms that the MinRV and MedRV estimators possess excellent jump
robustness (only minor upward bias), while with an adequate choice of a sampling frequency
they also may be designed to avoid significant downward biases from sparse data and/or
zero returns. Moreover, the MedRV measure is theoretically more efficient than all existing
jump-robust multipower variation estimators which allow for development of an asymptotic
limit theory in the presence of jumps, i.e., the tripower and higher order power variation
measures. In practice, MinRV and MedRV appear to perform on par with the subsampled
bipower variation statistic, while clearly improving on the jump-robustness of the latter.
Finally, the new estimators appear to dominate the less local quantile RV estimators as
the latter tend to suffer significantly from the presence of a strong and systematic intraday
variation in the volatility process and other factors inducing violations of return homogeneity
across larger blocks of data.
In conclusion, the MinRV and MedRV measures are promising candidates for practical applications involving the estimation of integrated variance due to their combination
of reasonable efficiency and good robustness properties. Such estimators may be particularly attractive for estimation and inference in settings where the presence of jumps cannot
be ignored. Moreover, it is simple to generalize these estimators to obtain corresponding measures of the integrated quarticity and the associated asymptotic limit theory is
straightforward to derive using the proof strategy developed in this paper. As an example,
the estimators should be useful ingredients in procedures designed to test for the presence
of price jumps.

18

References
Aït-Sahalia, Y. and J. Jacod (2007). Volatility estimators for discretely sampled lévy processes.
Annals of Statistics 35 (1), 355–392.
Andersen, T. G., T. Bollerslev, and F. X. Diebold (2009). Parametric and nonparametric volatility
measurement. North Holland. In Handbook of Financial Econometrics, Yacine Aït-Sahalia,
Lars P. Hansen, and Jose A. Scheinkman (Eds.).
Andersen, T. G., T. Bollerslev, and D. Dobrev (2007). No-arbitrage semi-martingale restrictions
for continuous-time volatility models subject to leverage effects, jumps and i.i.d. noise: Theory
and testable distributional implications. Journal of Econometrics 138 (1), 125–80.
Andersen, T. G., T. Bollerslev, and N. Meddahi (2005). Correcting the errors: Volatility forecast
evaluation using high-frequency data and realized volatilities. Econometrica 73 (1), 279–96.
Andersen, T. G., D. P. Dobrev, and E. Schaumburg (2008). Duration based volatility estimation.
Manuscript, Northwestern University.
Bandi, F. M. and J. R. Russell (2007). Volatility. Elsevier Science, New York. in Handbook of
Financial Engineering, V. Linetski and J. Birge (Eds.).
Barndorff-Nielsen, O. E., S. E. Graversen, J. Jacod, M. Podolskij, and N. Shephard (2006). A
central limit theorem for realized power and bipower variations of continuous semimartingales.
in From stochastic calculus to mathematical finance : the Shiryaev Festschrift, Springer Verlag.
Barndorff-Nielsen, O. E., S. E. Graversen, J. Jacod, and N. Shephard (2006). Limit theorems for
bipower variation in financial econometrics. Econometric Theory 22 (4), 677–719.
Barndorff-Nielsen, O. E. and N. Shephard (2004). Power and bipower variation with stochastic
volatility and jumps. Journal of Financial Econometrics 2 (1), 1–37.
Barndorff-Nielsen, O. E. and N. Shephard (2007). Variation, Jumps, Market Frictions and High
Frequency Data in Fnancial Econometrics. Cambridge University Press. In Advances in Economics and Econometrics. Theory and Applications, Ninth World Congress, R. Blundell, T.
Persson, and W. Newey (Eds.).
Barndorff-Nielsen, O. E., N. Shephard, and M. Winkel (2006). Limit theorems for multipower
variation in the presence of jumps. Stochastic Processes and Their Applications 116, 796–806.
Boudt, K., C. Croux, and S. Laurent (2008). Outlyingness weighted quadratic covariation. Working paper.
Chaboud, A., B. Chiquoine, E. Hjalmarsson, and M. Loretan (2007). Frequency of observation
and the estimation of integrated volatility in deep and liquid markets. Board of Governors of
the Federal Reserve System, International Finance Discussion Papers.
Christensen, K., R. Oomen, and M. Podolskij (2008). Realized quantile-based estimation of integrated variance. Working paper.
Corsi, F., D. Pirino, and R. Renò (2008). Volatility forecasting: The jumps do matter. SSRN
Working Paper.
Dobrev, D. (2007). Capturing volatility from large price moves: generalized range theory and
applications. Working paper, Northwestern University.

19

Hasbrouck, J. (1999). The dynamics of discrete bid and ask quotes. Journal of Finance 54 (6),
2109–42.
Huang, X. and G. Tauchen (2005). The relative contribution of jumps to total price variance.
Journal of Financial Econometrics 3 (4), 456–99.
Jacod, J. and A. N. Shiryaev (2003). Limit theorems for stochastic processes (2nd ed.).
Grundlehren der mathematischen Wissenschaften. Berlin; New York: Springer.
Lee, S. S. and P. A. Mykland (2007, December). Jumps in financial markets: A new nonparametric test and jump dynamics. Review of Financial Studies 20.
Mancini, C. (2006). Estimating the integrated volatility in stochastic volatility models with levy
type jumps. Working paper, University of Firenze.
McAleer, M. and M. C. Medeiros (2008). Realized volatility: A review. Econometric Reviews 27 (13), 10–45.
Mykland, P. A., E. Renault, and L. Zhang (2008). Volatility estimation when trade times and
returns are dependent. Working paper University of Chicago and UIC.
Mykland, P. A. and L. Zhang (2009). Inference for continuous semimartingales observed at high
frequency. Econometrica 77 (5), 1403–1445.
Podolskij, M. and M. Vetter (2006). Estimation of volatility functionals in the simultaneous presence of microstructure noise and jumps. Working paper, CREATES, University of Aarhus
and Ruhr University of Bochum.
Revuz, D. and M. Yor (1999). Continuous martingales and Brownian motion (3rd ed.).
Grundlehren der mathematischen Wissenschaften. Berlin [u.a.]: Springer.
Veraart, A. E. D. (2008). Inference for the jump part of quadratic variation of itô semimartingales.
working paper University of Aarhus.
Zhang, L., P. A. Mykland, and Y. Aït-Sahalia (2005). A tale of two time scales: Determining
integrated volatility with noisy high-frequency data. Journal of the American Statistical Association 100 (472), 1394–1411.

20

A

Consistency and CLT

Let Yt be the log price process and assume that it follows a Brownian semimartingale

Z
Yt

Z

t

σu− dBu

au du +

Y0 +

=

t

(6)

0

0

where a is a locally bounded and predictable process and σ is adapted and cadlag and bounded away from
zero. Without loss of generality, we further assume that the functions a, σ are uniformly bounded and that
inf t>0 σt > 0 a.s.18 The extension allowing for finite activity jumps in Yt is dealt with in Section A.3 below.
For the central limit theorem we require in addition that the volatility process follows a generalized Itô
process:

Z
Assumption (A1) : σt = σ0 +

t

t

Z

Z

0

0

t

ṽu− dWu ,

σ̃u− dBu +

ãu du +

0

where ã is locally bounded and predictable and σ̃, ṽ are cadlag and the Brownian motions B, W are uncorrelated. As before, we impose without loss of generality that the functions ã, σ̃, and ṽ are uniformly bounded
and that inf t>0 σ̃t > 0 and inf t>0 ν̃t > 0 a.s. In addition, as explained at the end of Section A.2, a general
set of jump processes may be included in the volatility process specification without altering the results.
We assume that Y is observed at N + 1 evenly spaced time points spanning the interval [0; 1]. Below,
we denote these observations by Yi/N , i = 0, . . . , N , and the associated log-returns by ∆N
i Y = Yi/N −
Y(i−1)/N , i = 1, . . . , N . The proofs involve sequences of standardized return observations and corresponding
approximating sequences for which volatility is fixed across one or more returns. Hence, we introduce nonoverlapping blocks of M ≥ 1 returns for which the volatility process is constant. We assume we have
K = N/M such blocks in the sample. Consequently, we define the quantities,

βiN,M

√
χN
N ∆N
and
i =
i Y
√
√
N
N
= N σ b(i−1)/M cM ∆i B = N σ b(i−1)/M c ∆i B ,
N

(7)
(8)

K

where b·c indicates the integer part of an expression. Hence, for each of the K return blocks, corresponding
to βiN,M , the volatility remains fixed at the value it attains at the beginning of the block. We shall exploit
N,M
. The strategy of the proof is then, as in Barndorff-Nielsen, Graversen,
that, for large N , χN
i ≈ βi
Jacod, Podolskij, and Shephard (2006), henceforth BNGJPS, to first show convergence in probability and
distribution for the approximate process and then argue that the difference is small.
Let g : R2 7→ R+ be given by,
g(x) =

π
min(|x1 |2 , |x2 |2 ).
π−2

then, for any two bivariate vectors, a = (a1 , a2 ) and b = (b1 , b2 ), we have the bound
|g(a) − g(b)| ≤ |a21 − b21 | + |a22 − b22 |



(9)

18

As argued in Barndorff-Nielsen, Graversen, Jacod, Podolskij, and Shephard (2006), this follows from
(k)
(k)
working with the stopped versions of the processes: Tt = Yt∧Tk and σt = σt∧Tk where Tk = inf{t||at | +
|σt− | ≥ k} and Tk % ∞ a.s.

21

and furthermore we note that g(x, y) is differentiable, except on the null set {(x, y) ∈ R2 |x = y} and


1
lim
min(x21 , x22 + εz) − min(x21 , x22 ) =
ε→0 ε

(

z
0

if x22 < x21
if x22 > x21

(10)

Our MinRV estimator of IV takes the form,
N −1
N −1


1 X
1 X
π
2
N
2
N
min (χN
)
,
(χ
)
=
g χN
i
i+1
i , χi+1 .
π−2 N −1
N −1

minRVN =

i=1

i=1

The proof revolves around the sequences,

N −1
N −1


1 X
1 X
N
M
N,M
g χN
,
χ
and
U
=
g βiN,M , βi+1
.
i
i+1
N
N
N

VN =

i=1

i=1

M
Since MinRVN = NN−1 VN the VN sequence is asymptotically equivalent to our MinRV estimator, while UN
is the approximating sequence.
We introduce some additional simplifying notation: for any adapted, integrable, d-dimensional cadlag
process, Z, and for N ≥ j > i − 1 ≥ 0 we define the expectation conditional on information at time i−1
:
N

h

Ei−1 Z j

i

h

= E Z j |F i−1

N

N

i

(11)

N

One useful implication of our ability to focus on the case with uniformly bounded drift and volatility functions
is that, using the Burkholder-Davis-Grundy inequalities, we have,
p
Ei−1 |χN
≤ C and Ei−1 |βiN,M |p ≤ C ,
i |









(12)

where p > 0 and C denotes a generic positive constant which (with a slight abuse of notation) will take on
disparate values in different places in what follows. We exploit this property of uniformly bounded moments
repeatedly in the sequel.
We may now decompose our basic estimators for IV into a sum of conditional expectations and the
M
M
M
where,
+ U2N
= U1N
associated martingale difference sequence: VN = V1N + V2N and UN
V1N =

N −1


1 X
N
Ei−1 g χN
,
i , χi+1
N

V2N =

i=1

M
U1N
=

N −1


1 X
N,M
Eb i−1 cM g βiN,M , βi+1
,
M
N

N −1
 N N 
1 X
N
g(χN
i , χi+1 ) − Ei−1 g(χi , χi+1 )
N
i=1

M
U2N
=

i=1

N −1 n

o
1 X
N,M
N,M
g(βiN,M , βi+1
) − Eb i−1 cM g(βiN,M , βi+1
) .
M
N
i=1

1
When M = 1 we will use the shorthand βiN ≡ βiN,1 , UN ≡ UN
and similarly for the individual pieces
U1N and U2N . These definitions allow us to decompose the main estimator:

VN

=

U1N + U2N + (V1N − U1N ) + (V2N − U2N )

(13)

Consistency of VN can then be obtained by showing consistency of the estimator applied to the approximating
Brownian path with piecewise constant volatility (UN = U1N + U2N ) and then showing that the difference
VN − UN (the last two terms) is asymptotically negligible. This is what we do in Section A.1 below. To

22

prove a CLT, we exploit a different decomposition (similar to Mykland and Zhang (2009)), in which we show
the CLT for our estimator applied to an approximating Brownian motion in which volatility is held constant
over a block of length M and then proceed to show that the difference between the original estimator and
the estimator applied to the approximating process is negligible. This analysis is carried out in Section A.2
based on the decomposition:
√
N (VN − IV )

√
√
√
N (V1N − U1N ) + N (V2N − U2N ) + N (U1N − IV )
√
√
M
M
N (U2N − U2N
) + N U2N

=
+

A.1

(14)

Proposition 1: Consistency

We proceed by analyzing equation (13) term by term through a series of lemmas. For brevity, we focus
on the features that are specific to our estimator, while referring to proofs in the extant literature when
feasible. This also serves to highlight the underlying structural similarities between our IV measure and
some previously proposed IV estimators.
Lemma 4 Under the maintained assumptions we have,

P

U1N → IV

(15)

Moreover, if Assumption (A1) holds we obtain,

√
P
N (U1N − IV ) → 0

(16)

Proof. First, note that
N
g βiN , βi+1



=

h



N
− g βiN ,
g βiN , βi+1



√

N σ i−1 ∆N
i+1 B

i

N



+ g βiN ,

√

N σ i−1 ∆N
i+1 B



N

so we may write

U1N

=

N −1
N −1
h

i
√

1 X
1 X 2
N
Ei−1 g βiN , βi+1
− g βiN , N σ i−1 ∆N
+
σ i−1
i+1 B
N
N
N
N
i=1

(17)

i=1

The first sum in (17) tends to zero in probability. To see this, note that the bound (9) implies the
following limit in L2 -norm:

E

N −1
h

i
√

1 X
N
Ei−1 g βiN , βi+1
− g βiN , N σ i−1 ∆N
i+1 B
N
N
i=1

2

N −1

≤

C X 2
E
|σ i − σ 2i−1 |2 → 0
N
N
N

(18)

i=1

where the convergence in (18) (which implies convergence in probability) follows from the fact that σt
has finite quadratic variation. In addition, since {σt2 }t≥0 is uniformly bounded and cadlag, the pointwise
dominated convergence of σu − σ buN c → 0 for u ∈ [0; 1] follows, and Lebesgue’s theorem yields
N

23

"
X Z

N −1

i
N



(i−1)
N

i=1

σu2

2

− σ (i−1)

#



a.s.

→ 0

du

(19)

N

P

Together (18) and (19) imply IV − U1N → 0, which establishes (15). To show (16) we need the stronger
√
assumption (A1). Define the sequence of independent standard normals Zi = N ∆N
i B, then Assumption
(A1) yields

h

i

2
Ei−1 (σ 2i − σ 2i−1 ) Zi+1
1Z 2
N

<Zi2
i+1

N

h

i

= Ei−1 (σ 2i − σ 2i−1 ) ϕ(Zi2 ) = OP (1/N )
N

(20)

N

2
since ϕ(Zi2 ) = Ei [Zi+1
1Z 2 <Z 2 ] is an even function of the Brownian path {Bt }(i−1)/N <t<i/N . Now the
i+1
i
property (10) yields

h



N
Ei−1 g βiN , βi+1
− g βiN ,



i
√
N σ i−1 ∆N
= OP (1/N )
i+1 B

(21)

N

This ensures that the first term in (17) is asymptotically negligible, even when scaled up by
the remaining task is to show,

!

N −1
1 X 2
σ i−1 − IV
N
N

√
N

√
N . Hence,

P

→ 0.

i=1

However, this is a common task in the proof of CLT for IV estimators and the method of proof is, by now,
well established; see, e.g., BNGJPS where the result is shown for a general setting of which the current
framework is a special case. A more intuitive and detailed exposition is provided by Barndorff-Nielsen,
Graversen, Jacod, and Shephard (2006), henceforth BNGJS.
Lemma 5 Under the maintained assumptions, we have
P

U2N → 0

(22)

Proof. To simplify notation, define the martingale difference sequence

N
N
ηiN = g(βiN , βi+1
) − Ei−1 g(βiN , βi+1
)



n

1
N

ηiN , F

o
i
N

:

i≥0



Note that E[(ηiN )2 |F i−1 ] ≤ C, so applying the Cauchy-Schwartz inequality,
N

"
V

N
1 X N
ηi
N

#

i=1

"

#

"

#

N
N

1
1 X
C
1 X
C
N
= E
(ηiN )2 + 2ηiN ηi+1
≤ E
E[(ηiN )2 |F i−1 ] ≤
→ 0.
N
N
N
N
N
N
i=1

The L2 convergence implies

1
N

PN
i=1

i=1

P

ηiN → 0.

Lemma 6 Under the maintained assumptions, we have,
P

(V1N − U1N ) → 0 .

(23)

24

Under Assumption (A1), we obtain,
√
P
N (V1N − U1N ) → 0 .

(24)

Proof. To establish (24), and thus also (23), we must show,
N −1
√


1 X
N
N
N
N (V1N − U1N ) = √
Ei−1 g(χN
→ 0 as N → ∞ .
i , χi+1 ) − g(βi , βi+1 )
N i=1

(25)

Using the bound (9), it follows that,

"

N −1
X
1
N
N
N
√ E
|g(χN
i , χi+1 ) − g(βi , βi+1 )|
N
i=1

√
N (V1N − U1N ) ≤

#

"

N
X
C
2
N 2
(χN
≤ √ E
i ) − (βi )
N
i=1

#

N 

√
C X
2
√
Ei−1 h( N ∆N
i Y ) − σ i−1
N
N i=1

=

where we have defined the function h(x) = x2 . This formulation maps directly into the setting of BNGJPS
where the results of this lemma are proven in a more general setting and for a generic h(x) function subject
to regularity conditions. In particular, our h function trivially satisfies the continuous differentiability and
polynomial growth conditions necessary for the applicability of their analysis. An accessible, albeit lengthy,
account of the steps of the argument may be found in BNGJS (2006, pp. 713-719). So while this proof is
quite involved, the above reformulation of the relevant inequalities, as they arise within our specific setting,
allows us to simply refer to previously published work for the result.
Lemma 7 Under the maintained assumptions, we have,
P

(V2N − U2N ) → 0 .

(26)

Moreover, we may strengthen this result further to obtain,
√
P
N (V2N − U2N ) → 0 .

(27)

Proof. In order to demonstrate the second result of the lemma, which obviously implies the first, we define,
√



N
N
N
,
ξiN = (1/ N ) g χN
i , χi+1 − g βi , βi+1
and we must then prove that,
N −1

X

P

ξiN − Ei−1 [ξiN ] → 0



i=1

This expression constitutes a martingale difference sequence with respect to the filtration F i , so it suffices
N
to show,
N −1

X 
E

i=1

(ξiN )2



= E

"N −1
X

Ei−1

(ξiN )2



#


→ 0 as N → ∞

i=1

25

Mimicking the type of steps undertaken in the proof of the previous lemma, including application of the
N
uniform bound on moments of χN
i and βi , we obtain,

#

"

N −1

X 
E

(ξiN )2



i=1

N −1
X
1
N
N
N
=
E
Ei−1 g(χN
i , χi+1 ) − g(βi , βi+1 )
N

2

i=1

"

#

N
h
X
2 i
C
N
≤
E
Ei−1 h(χN
.
i ) − h(βi )
N
i=1

As for the previous lemma, our reformulation of the task maps the problem into the corresponding task in
BNGJPS (2006) who prove the current lemma in a more general setting. A detailed account of the requisite
steps to complete the proof may again be gleaned from BNGJS (2006, pp. 704-706).
Taken together, Lemma 4 - 5 and the first parts of Lemma 6 - 7 imply the consistency of our estimator
under the minimal maintained assumptions. The second part of Lemma 6 - 7 is critical for the proof of the
central limit theorem below.

A.2

Proposition 2: The CLT

Lemma 8 Under assumption (A1), we have
√
M
N U2N

stable D



−→ N

Z

1

0, ν

σ 4 du


(28)

0

where the constant ν = Var [g(U0 , U1 ] + 2 Cov [g(U0 , U1 ), g(U1 , U2 )] for U0 , U1 , U2 ∼ i.i.d.N (0, 1).
Proof. Consider splitting the N scaled return observations into K blocks, the kth of which is the vector
√
N
χM
k = { N ∆i Y }i∈{(k−1)M +1,...,kM } . The corresponding vector of observations from the approximating
Brownian motion where volatility is held constant over the block is βkN,M = {βiN,M }i∈{(k−1)M +1,...,kM } .
Next, define by gM (·) : RM 7→ R the block estimator of volatility:
gM (βkN,M ) =

1
M

kM −1

X

N,M
g(βiN,M , βi+1
)

(29)

i=(k−1)M +1

√
M
. Defining the martingale
We wish to apply Theorem IX.7.28
in Jacod and Shiryaev
(2003) to N U2N


√
N,M
N,M
M −1 2
difference sequence ψk
= M gM (βk ) − M σ (k−1) we can write
K

K
K−1 
√
 N,M N,M 
1 X N,M
1 X
M
N,M
N,M
N U2N
= √
ψk
+√
g(βkM
, βkM
+1 ) − E k−1 g(βkM , βkM +1 )
K
K k=1
N k=1
K
1 X N,M
= √
ψk
+ oP (1)
K k=1

(30)

The last equality follows from the fact that each term in the second sum is centered and has bounded variance
√
(given the uniform bound on σt ). Thus the sum divided by N will tend to zero provided K = oP (N ).
We must now verify conditions (7.27)-(7.31) of Theorem IX.7.28. First note that E[ψkN,M |F k−1 ] = 0 so
K
that condition (7.27) is trivially satisfied. Condition (7.28) follows from the fact that

n

K
o2
√ 
M −1 2
1 X
E
M gM (βkM ) −
σ (k−1)
F k−1
K
K
M
K
k=1

26

=

Z 1
K
ν X 4
P
σ k−1 → ν
σu4 du
K
K
0
k=1

(31)

where the convergence in probability (and in fact a.s.) is a consequence of the volatility
process
 being

M
cadlag and uniformly bounded. Next, we turn to condition (7.29). Let ∆k B = B k − B (k−1) , then
K

h

E ψkN,M ∆M
k B F k−1

i

K

K

= 0, which follows from the fact that the variables ψkN,M are centered and that gM

h

i

P

is an even function. Condition (7.30), stating that E (ψkN,M )2 1|ψN,M |>ε → 0, follows straightforwardly
k
from the fact that σ is uniformly bounded.
Finally, let {Nt }t∈[0;1] be a bounded martingale orthogonal
to B(i.e. the covariation hB, N it = 0 a.s.).

We want to show that, for each block k, E[ψkN,M N k − N (k−1)
the martingale difference sequence Mt = E
M k−1 +
K

R

k
K
k−1
K



ψkN,M

K

|F k−1 ] = 0. For t >
K

K

k−1
K

consider

Ft . By the martingale representation theorem, Mt =

ϕu dBu for some predictable process ϕu . Therefore the processes {Mt }t> k−1 and {Nt −
K

N k−1 }t> k−1 are orthogonal and the product, {Mt (Nt − N k−1 )} is again a martingale which must then have
K
K
K
mean zero. This verifies condition (7.31). Theorem IX.7.28 in Jacod and Shiryaev (2003) then implies that
as N (and hence K and M ) tend to infinity:
√
M stable
−→ N
N U2N



Z

0, ν

1

σ 4 du


(32)

0

Lemma 9 Under the maintained assumptions, we have
√
 P
M
N U2N − U2N
→0

(33)

N,M
N,M
Proof. Defining ηiN,M = g(βiN,M , βi+1
)−Eb(i−1)/M cM g(βiN,M , βi+1
) , we note that





n

√1
N

(ηiN − ηiN,M )

o

 i≥1
√
M
is a martingale difference sequence with respect to the filtration {Fi/N }. To show that N U2N − U2N
=
√
PN −1 N
N,M
)/ N → 0 in probability, it therefore suffices (by Doobs inequality, e.g. Revuz and Yor
(ηi − ηi
i=1
(1999), p.54-55) to show that
"

N −1
X
1
N
N,M
E
g(βiN , βi+1
) − g(βiN,M , βi+1
)
N

#
2

→0

(34)

i=1

By the bound of g(·) we have

"

N −1
X
1
N
N,M
)
E
g(βiN , βi+1
) − g(βiN,M , βi+1
N
i=1

≤

C
E
N

"

N
X

σ 2i−1 − σ 2b(i−1)/M cM
N

i=1

2

#
2

"

N
X
C
≤ E
Ei−1 (βiN )2 − (βiN,M )2
N

#
2

i=1

#

Z
= CE

N

0

1



σ 2buN c − σ 2buKc
N

2

du = oP (1)

(35)

K

where the last inequality follows from the uniform boundedness of σt and Lebesgues theorem.
Importantly, the specification of the volatility process in Assumption (A1) can be extended to include
finite as well as infinite activity jump processes subject only to very weak regularity conditions, stipulating
that the volatility process evolves according to an Ito semimartingale where the jump components have
locally bounded jump characteristics, as laid out in BNGJPS. This follows from the fact that the only terms
√
√
in (14) affected by the inclusion of jumps are N (V1N − U1N ) and N (V2N − U2N ) which map into the
corresponding terms in BNGJPS as outlined in the proofs above. As such, the distributional results of the
paper cover a very wide range of underlying return generating processes.

27

Finally, we note that the proof for the MedRV estimator follows analogously by simply changing the
g function accordingly. The proof of Proposition 3 is omitted, but it may be derived using the identical
strategy, in which volatility is held constant over blocks of increasing size. In particular, the conditional
covariance between the estimators can easily be calculated on each block and a stable convergence argument
similar to Lemma 8 goes through.

A.3

The Asymptotic Distribution under Jump Alternatives

Suppose now the log price process is given as X = Y + J, where Y is a Brownian semi-martingale of the
form (6) while J is a finite activity jump process. While the specification of the jump process is restrictive,
it covers many cases of interest and it can be generalized to infinite activity jump processes along the lines
of Barndorff-Nielsen, Shephard, and Winkel (2006). Restating their Proposition 1 in our notation, we have
√
N |Y i −Y i−1 | = OP (| log(N )|1/2 ), which, as they show, follows from Levy’s modulus of continuity theorem
N
N
for Brownian motion. This immediately yields:
Proposition 10 When J is a finite activity jump process, the asymptotic distribution of the MinRV and
MedRV estimators applied to the processes {Xt } and {Yt } are identical.
Proof.
As before, we deal only with the MinRV case as the MedRV case is analogous. On a given realization
of the path there is a finite number of jumps, so (asymptotically) at most one of the terms |X i − X i−1 | or
N
N
|X i+1 − X i | will include a jump. Therefore, each term in the estimator (up to a normalizing constant) is
N

N



min |X

i
N

− X i−1 |2 , |X i+1 − X i |2
N

N

N



= OP



log N
N



regardless of whether a (single) jump occurred or not. Since only finitely many terms differ,

N h
X



min |X

i
N

− X i−1 |2 , |X i+1 − X i |2
N

N

N





− min |Y

i
N

− Y i−1 |2 , |Y i+1 − Y i |2
N

N

i

N

j=1

= OP



log N
N



1
= oP ( √ )
N

so neither the consistency nor the convergence in distribution is affected by the occurrence of finite activity
jumps.

28

B

Figures and Tables
BV

MedRV

MinRV

×10‐4

8 12 20 24 40 60 120180300360600

4

8 12 20 24 40 60 120180300360600

1.B Calendar Time Pre‐Averaged

×10‐4

×10‐4

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4
8 12 20 24 40 60 120180300360600

4

2.A Tick Time Sub‐Sampled

8 12 20 24 40 60 120180300360600

2.B Tick Time Pre‐Averaged

×10‐4

×10‐4

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4

4

TV

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4

1.A Calendar Time Sub‐Sampled

4

RV

×10‐4

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4

4

QRV

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4
8 12 20 24 40 60 120180300360600

4

3.A Tick Time Sub‐Sampled, No Duplicates

8 12 20 24 40 60 120180300360600

3.B Tick Time Pre‐Averaged, No Duplicates

Figure 1: Average IV estimates across 33 DJ30 stocks between January 1 2005 and May 31,
2007. The first column (Panels (1A)-(3A)) shows the average IV estimates produced by each sub-sampled estimator
as a function of sampling frequency (measured in seconds on the x-axis). Panel (1A) contains the calendar time
estimates, Panel (2A) the tick time estimates, and Panel (3A) the tick time estimates after filtering out duplicate
quotes. The second column (Panels (1B)-(3B)) plots the corresponding estimates for the pre-averaged version of
each estimator as a function of pre-averaging window (measured in seconds on the x-axis), where the pre-averaging
is carried out at the highest frequency as described in section 3.3.

29

BV

MedRV

MinRV

×10‐4

8 12 20 24 40 60 120180300360600

×10‐4

4

8 12 20 24 40 60 120180300360600

1.B Calendar Time Pre‐Averaged
×10‐4

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4
8 12 20 24 40 60 120180300360600

4

2.A Tick Time Sub‐Sampled
×10‐4

8 12 20 24 40 60 120180300360600

2.B Tick Time Pre‐Averaged
×10‐4

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4

4

TV

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4

1.A Calendar Time Sub‐Sampled

4

RV

×10‐4

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4

4

QRV

1.4
1.3
1.2
1.1
1.0
0.9
0.8
0.7
0.6
0.5
0.4
8 12 20 24 40 60 120180300360600

4

3.A Tick Time Sub‐Sampled, No Duplicates

8 12 20 24 40 60 120180300360600

3.B Tick Time Pre‐Averaged, No Duplicates

Figure 2: Average standard deviation of IV estimates across 33 DJ30 stocks between January
1 2005 and May 31, 2007. The first column (Panels (1A)-(3A)) shows the average standard deviation of the IV
estimates produced by each sub-sampled estimator as a function of sampling frequency (measured in seconds on the
x-axis). Panel (1A) contains the calendar time estimates, Panel (2A) the tick time estimates, and Panel (3A) the tick
time estimates after filtering out duplicate quotes. The second column (Panels (1B)-(3B)) plots the corresponding
standard deviation for the pre-averaged version of each estimator as a function of pre-averaging window (measured
in seconds on the x-axis), where the pre-averaging is carried out at the highest frequency as described in section 3.3.

30

BV

MedRV

MinRV

×10‐4

8 12 20 24 40 60 120180300360600

×10‐4

4

8 12 20 24 40 60 120180300360600

1.B Calendar Time Pre‐Averaged
×10‐4

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2
8 12 20 24 40 60 120180300360600

4

2.A Tick Time Sub‐Sampled
×10‐4

8 12 20 24 40 60 120180300360600

2.B Tick Time Pre‐Averaged
×10‐4

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2

4

TV

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2

1.A Calendar Time Sub‐Sampled

4

RV

×10‐4

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2

4

QRV

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2
8 12 20 24 40 60 120180300360600

4

3.A Tick Time Sub‐Sampled, No Duplicates

8 12 20 24 40 60 120180300360600

3.B Tick Time Pre‐Averaged, No Duplicates

Figure 3: Average IV estimates across 33 DJ30 stocks between June 1 2007 and May 31, 2008.
The first column (Panels (1A)-(3A)) shows the average IV estimates produced by each sub-sampled estimator as a
function of sampling frequency (measured in seconds on the x-axis). Panel (1A) contains the calendar time estimates,
Panel (2A) the tick time estimates, and Panel (3A) the tick time estimates after filtering out duplicate quotes. The
second column (Panels (1B)-(3B)) plots the corresponding estimates for the pre-averaged version of each estimator
as a function of pre-averaging window (measured in seconds on the x-axis), where the pre-averaging is carried out at
the highest frequency as described in section 3.3.

31

BV

MedRV

MinRV

×10‐4

8 12 20 24 40 60 120180300360600

×10‐4

4

8 12 20 24 40 60 120180300360600

1.B Calendar Time Pre‐Averaged
×10‐4

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2
2.1
2.0

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2
2.1
2.0
8 12 20 24 40 60 120180300360600

4

2.A Tick Time Sub‐Sampled
×10‐4

8 12 20 24 40 60 120180300360600

2.B Tick Time Pre‐Averaged
×10‐4

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2
2.1
2.0

4

TV

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2
2.1
2.0

1.A Calendar Time Sub‐Sampled

4

RV

×10‐4

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2
2.1
2.0

4

QRV

3.2
3.1
3.0
2.9
2.8
2.7
2.6
2.5
2.4
2.3
2.2
2.1
2.0
8 12 20 24 40 60 120180300360600

4

3.A Tick Time Sub‐Sampled, No Duplicates

8 12 20 24 40 60 120180300360600

3.B Tick Time Pre‐Averaged, No Duplicates

Figure 4: Average standard deviation of IV estimates across 33 DJ30 stocks between June 1
2007 and May 31, 2008. The first column (Panels (1A)-(3A)) shows the average standard deviation of the IV
estimates produced by each sub-sampled estimator as a function of sampling frequency (measured in seconds on the
x-axis). Panel (1A) contains the calendar time estimates, Panel (2A) the tick time estimates, and Panel (3A) the tick
time estimates after filtering out duplicate quotes. The second column (Panels (1B)-(3B)) plots the corresponding
standard deviation for the pre-averaged version of each estimator as a function of pre-averaging window (measured
in seconds on the x-axis), where the pre-averaging is carried out at the highest frequency as described in section 3.3.

32

Table 1: Variance factors for multipower and RMinRV and MedRV estimators.
1 4

All estimators have an asymptotic variance of the form ν
factor ν for each estimator.

Variance Factor

0

σu du. The table displays the variance

RV

BV

MedRV

MPV(3)

MPV(4)

MPV(5)

MPV(6)

MinRV

MPV(7)

2.00

2.61

2.96

3.06

3.38

3.61

3.78

3.81

3.91

Table 2: Descriptive statistics for the 33 stocks that were part of the Dow Jones 30 index
between January 1, 2005 and May 31, 2007.

Average #
Quotes
Symbol
AA
AIG
AXP
BA
BAC
C
CAT
CVX
DD
DIS
EK
GE
GM
HD
HPQ
IBM
INTC
IP
JNJ
JPM
KO
MCD
MMM
MO
MRK
MSFT
PFE
PG
T
UTX
VZ
WMT
XOM

11,062
11,420
10,280
10,481
12,364
13,201
9,660
13,353
10,460
11,421
7,645
14,010
10,225
11,606
12,284
11,626
17,285
8,064
11,722
12,263
11,269
11,171
9,421
10,544
11,424
16,575
13,654
11,663
11,970
10,201
12,339
12,475
14,831

Average #
Non-Duplicate
Quotes
3,610
4,484
3,444
4,919
3,496
4,073
4,361
6,169
3,597
2,774
1,769
2,565
3,211
3,814
3,324
5,531
1,638
2,277
4,091
3,453
3,158
3,238
4,026
4,195
3,315
1,272
2,501
4,101
2,472
4,432
3,056
4,345
6,133

Mean ALL:
Median ALL
Max ALL:
Min ALL:

11,757
11,778
17,285
7,645

3,601
3,601
6,169
1,272

Average
Price
($)
30
64
55
74
48
49
71
63
45
29
26
35
30
39
32
86
22
34
64
42
44
36
78
74
37
27
26
58
27
68
35
48
64

Average
2-min RV
(x10-4)
2.22
1.00
0.81
1.26
0.68
0.77
1.62
1.64
1.19
1.08
2.19
0.63
3.70
1.35
1.61
0.84
1.67
1.36
0.52
0.88
0.59
1.22
0.91
1.09
1.58
0.94
1.12
0.72
1.08
1.07
0.98
0.91
1.39

Average
2-min BV
(x10-4)
2.10
0.95
0.76
1.19
0.64
0.73
1.54
1.58
1.12
1.01
1.93
0.59
3.49
1.28
1.50
0.80
1.51
1.25
0.49
0.83
0.55
1.13
0.87
0.93
1.38
0.84
1.06
0.69
1.00
1.01
0.91
0.88
1.34

Average
Log Spread
(x10-4)
4.80
2.73
2.84
2.97
2.87
2.70
3.01
2.88
3.48
4.46
5.48
3.35
5.09
3.69
4.32
2.43
4.63
4.28
2.47
3.27
3.15
3.90
2.74
2.38
3.84
3.80
4.63
2.69
4.94
3.16
3.81
3.01
2.27

Average Ratio
Log Spread/Sigma
0.03
0.03
0.03
0.03
0.04
0.03
0.02
0.02
0.03
0.04
0.04
0.04
0.03
0.03
0.04
0.03
0.04
0.04
0.04
0.04
0.04
0.04
0.03
0.02
0.03
0.04
0.05
0.03
0.05
0.03
0.04
0.03
0.02

Average # zero returns
per day lasting above
30s / 60s / 120s
161 / 48 / 11
127 / 30 / 5
161 / 48 / 11
113 / 21 / 3
161 / 49 / 11
144 / 42 / 9
131 / 27 / 4
82 / 15 / 2
154 / 45 / 10
177 / 67 / 19
189 / 81 / 28
182 / 70 / 20
162 / 51 / 13
149 / 39 / 8
163 / 55 / 14
89 / 14 / 2
206 / 99 / 35
191 / 71 / 20
130 / 32 / 6
163 / 52 / 12
166 / 57 / 15
164 / 55 / 14
141 / 31 / 5
142 / 33 / 5
165 / 54 / 13
199 / 106/ 43
184 / 71 / 21
144 / 38 / 7
177 / 77 / 27
127 / 27 / 4
165 / 61 / 18
130 / 32 / 6
90 / 17 / 2

47
48
86
22

1.23090
1.08398
3.69647
0.52107

1.14720
1.00552
3.48752
0.49326

0.00035
0.00033
0.00055
0.00023

0.03
0.03
0.05
0.02

152 / 49 / 13
161 / 48 / 11
206 / 106/ 43
82 / 14 / 2

33

34
1.000
0.996
1.000
1.242
1.250
1.017
1.001
0.991
1.002
1.242
1.250
1.003

Model 1: BM
Model 2: SV‐U
Model 3: BM + Sparcity
Model 4: BM + 1 Jump
Model 5: BM + 4 Jumps
Model 6: BM + Noise

Model 1: BM
Model 2: SV‐U
Model 3: BM + Sparcity
Model 4: BM + 1 Jump
Model 5: BM + 4 Jumps
Model 6: BM + Noise

RV
1.000
0.999
0.999
1.244
1.250
1.083

Sub­Sampled Estimators

Model 1: BM
Model 2: SV‐U
Model 3: BM + Sparcity
Model 4: BM + 1 Jump
Model 5: BM + 4 Jumps
Model 6: BM + Noise

12­sec frequency

1.002
0.980
1.002
1.089
1.149
1.005

1.000
0.993
0.996
1.044
1.085
1.017

1.000
0.998
0.983
1.021
1.042
1.084

BV

1.002
0.970
1.003
1.066
1.126
1.005

0.999
0.991
0.995
1.027
1.062
1.017

1.000
0.998
0.977
1.011
1.025
1.084

TV

1.002
0.967
1.000
1.039
1.110
1.004

1.000
0.970
0.993
1.008
1.033
1.017

0.999
0.971
0.978
1.002
1.007
1.082

1.002
0.980
1.002
1.031
1.093
1.007

0.999
0.994
0.993
1.008
1.029
1.018

1.000
0.998
0.971
1.002
1.007
1.084

1.003
0.969
1.005
1.034
1.102
1.005

0.999
0.991
0.994
1.008
1.033
1.017

1.000
0.998
0.975
1.002
1.008
1.084

QRV MinRV MedRV

Relative Bias

6.736
6.606
6.913
81.665
47.083
6.852

1.350
1.309
1.436
75.595
38.855
1.454

0.268
0.273
0.345
75.196
37.245
2.949

RV

7.808
7.166
7.891
15.012
21.087
7.753

1.511
1.485
1.586
3.135
5.124
1.681

0.310
0.310
0.476
0.636
1.146
3.041

BV

8.342
7.521
8.436
12.275
18.078
8.289

1.613
1.568
1.698
2.199
3.520
1.769

0.337
0.336
0.580
0.402
0.615
3.061

TV

7.394
6.686
7.447
8.462
14.415
7.406

1.455
1.540
1.528
1.562
1.969
1.546

0.300
0.550
0.525
0.295
0.319
2.964

9.676
8.709
9.783
10.704
16.119
9.599

1.857
1.845
1.952
2.006
2.339
2.065

0.389
0.386
0.772
0.384
0.412
3.148

8.432
7.637
8.588
9.672
15.620
8.246

1.633
1.582
1.710
1.753
2.227
1.798

0.328
0.338
0.618
0.337
0.372
3.059

QRV MinRV MedRV

Relative MSE

and each model based on sampling frequency 12 seconds (top panel), 60 seconds (middle panel), and 300 seconds (bottom panel). The MSE
c − IV )2 /IQ, where IV and IQ are the true simulated integrated variance and integrated
factor is computed as the sample mean of 390(IV
quarticity on each day. The MSE factor for 60-sec sub-sampled RV is thus ≈ 1.33 which is the theoretical value shown by Zhang, Mykland, and
Aït Sahalia (2005). Each column corresponds to a given estimator: Realized volatility (RV), bipower variation (BV), tripower variation (TV),
Realized Quantile RV (QRV), the MinRV and the MedRV. Each row corresponds to one of the models described in detail in Section 4.

Table 3: Relative bias and relative mean squared error (MSE) factors for sub-sampled IV estimators at the 12second, 60-second, and 300-second sampling frequencies. We report the bias and MSE factors for each sub-sampled estimator

60­sec frequency

300­sec frequency

35
1.001
0.995
1.001
1.242
1.250
1.003
1.001
0.990
1.002
1.241
1.251
1.002

Model 1: BM
Model 2: SV‐U
Model 3: BM + Sparcity
Model 4: BM + 1 Jump
Model 5: BM + 4 Jumps
Model 6: BM + Noise

Model 1: BM
Model 2: SV‐U
Model 3: BM + Sparcity
Model 4: BM + 1 Jump
Model 5: BM + 4 Jumps
Model 6: BM + Noise

RV
1.000
0.999
0.999
1.244
1.250
1.078

Pre­Averaged Estimators

Model 1: BM
Model 2: SV‐U
Model 3: BM + Sparcity
Model 4: BM + 1 Jump
Model 5: BM + 4 Jumps
Model 6: BM + Noise

12­sec window

1.001
0.979
1.001
1.075
1.131
1.004

1.000
0.993
0.993
1.038
1.073
1.004

1.000
0.999
0.974
1.018
1.035
1.079

BV

1.002
0.968
1.003
1.053
1.107
1.004

1.000
0.990
0.991
1.023
1.051
1.003

1.000
0.998
0.965
1.009
1.020
1.079

TV

1.001
0.967
0.998
1.031
1.086
1.001

1.000
0.969
0.988
1.006
1.026
1.003

0.999
0.971
0.969
1.001
1.006
1.078

1.002
0.979
1.000
1.024
1.073
1.005

1.000
0.993
0.988
1.007
1.023
1.004

1.000
0.999
0.955
1.002
1.006
1.079

1.002
0.969
1.002
1.027
1.082
1.002

1.000
0.991
0.990
1.007
1.026
1.004

1.000
0.998
0.962
1.002
1.006
1.079

QRV MinRV MedRV

Relative Bias

5.374
5.358
5.569
80.465
45.584
5.655

1.093
1.057
1.197
75.497
38.454
1.090

0.208
0.206
0.311
75.350
37.093
2.616

RV

6.654
6.106
6.793
11.892
17.171
6.711

1.288
1.269
1.380
2.536
3.984
1.333

0.251
0.240
0.601
0.479
0.851
2.683

BV

7.280
6.562
7.498
9.993
14.700
7.285

1.415
1.388
1.516
1.861
2.763
1.456

0.276
0.264
0.818
0.317
0.458
2.718

TV

6.002
5.651
6.241
6.967
10.464
6.185

1.202
1.355
1.313
1.247
1.501
1.204

0.232
0.496
0.680
0.222
0.243
2.601

9.004
7.987
9.220
9.608
13.342
8.794

1.679
1.692
1.825
1.826
2.024
1.761

0.334
0.316
1.195
0.329
0.340
2.784

7.321
6.668
7.546
8.055
12.172
7.255

1.386
1.379
1.512
1.515
1.791
1.430

0.271
0.261
0.907
0.270
0.291
2.715

QRV MinRV MedRV

Relative MSE

and each model based on pre-averaging window of 12 seconds (top panel), 60 seconds (middle panel), and 300 seconds (bottom panel). The
c − IV )2 /IQ, where IV and IQ are the true simulated integrated variance and integrated
MSE factor is computed as the sample mean of 390(IV
quarticity on each day. Each column corresponds to a given estimator: Realized volatility (RV), bipower variation (BV), tripower variation (TV),
Realized Quantile RV (QRV), the MinRV and the MedRV. Each row corresponds to one of the models described in detail in Section 4.

Table 4: Relative bias and relative mean squared error (MSE) factors for pre-averaged IV estimators using 12second, 60-second, and 300-second pre-averaging windows. We report the bias and MSE factors for each pre-averaged estimator

60­sec window

300­sec window

