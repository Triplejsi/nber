NBER WORKING PAPER SERIES

WHAT GOODS DO COUNTRIES TRADE? A QUANTITATIVE EXPLORATION
OF RICARDO'S IDEAS
Arnaud Costinot
Dave Donaldson
Ivana Komunjer
Working Paper 16262
http://www.nber.org/papers/w16262

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
August 2010

We thank Gene Grossman, Gordon Hanson, Giovanni Maggi, Jim Rauch, Stephen Redding, Frédéric
Robert-Nicoud, Bob Staiger, Kjetil Storesletten, Jonathan Vogel, Kei-Mu Yi, three anonymous referees,
and seminar participants at many institutions for very helpful comments. We also thank Don Davis
and Sam Kortum for stimulating discussions and precious advice at the Princeton IES Summer Workshop.
Nadege Plesier provided excellent research assistance. This paper is a heavily revised version of the
2007 NBER working paper "What Goods Do Countries Trade? New Ricardian Predictions". The views
expressed herein are those of the authors and do not necessarily reflect the views of the National Bureau
of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2010 by Arnaud Costinot, Dave Donaldson, and Ivana Komunjer. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.

What Goods Do Countries Trade? A Quantitative Exploration of Ricardo's Ideas
Arnaud Costinot, Dave Donaldson, and Ivana Komunjer
NBER Working Paper No. 16262
August 2010
JEL No. F10,F11
ABSTRACT
The Ricardian model predicts that countries should produce and export relatively more in industries
in which they are relatively more productive. Though one of the most celebrated insights in the theory
of international trade, this prediction has received virtually no attention in the empirical literature since
the mid-sixties. The main reason behind this lack of popularity is the absence of clear theoretical foundations
to guide the empirical analysis. Building on the seminal work of Eaton and Kortum (2002), the present
paper offers such foundations and uses them to quantify the importance of Ricardian comparative
advantage. Using trade and productivity data from 1997, we estimate that, ceteris paribus, the elasticity
of bilateral exports with respect to observed productivity is 6.53. From a welfare standpoint, however,
the removal of Ricardian comparative advantage at the industry level would only lead, on average,
to a 5.5% decrease in the total gains from trade.

Arnaud Costinot
Department of Economics
MIT, E52-243B
50 Memorial Drive
Cambridge MA 02142-1347
and NBER
costinot@mit.edu
Dave Donaldson
MIT Department of Economics
50 Memorial Drive, E52-243G
Cambridge, MA 02142-1347
and NBER
ddonald@mit.edu

Ivana Komunjer
Department of Economics
University of California, San Diego
9500 Gilman Drive
La Jolla, CA 92093-0508
komunjer@ucsd.edu

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

1

1. Introduction
The Ricardian model predicts that countries should produce and export relatively more in
industries in which they are relatively more productive. Though one of the most celebrated
insights in the theory of international trade, this prediction has received virtually no attention
in the empirical literature since the mid-sixties; see e.g. MacDougall (1951), Stern (1962),
and Balassa (1963).1 The main reason behind this lack of popularity is not the existence
of strong beliefs regarding the (un)importance of technological considerations. It derives
instead from the absence of any clear theoretical foundations to guide the empirical analysis;
see e.g. Bhagwati (1964), Deardor¤ (1984), and Leamer and Levinsohn (1995). Building on
the seminal work of Eaton and Kortum (2002), this paper develops such foundations and
uses them to quantify the importance of Ricardian comparative advantage at the industry
level.2
The tight connection between theory and empirics o¤ered by our paper has two crucial
advantages over the previous literature. First, when estimating the importance of Ricardian
comparative advantage in the cross-section, we do not have to rely on ad-hoc measures of
export performance such as total exports towards the rest of the world (MacDougall, 1951;
Stern, 1962); total exports to third markets (Balassa, 1963); or bilateral net exports (Golub
and Hsieh, 2000). Our theory tells us exactly what the dependent variable in our crosssectional regressions ought to be: log of exports, disaggregated by exporting and importing
countries, di¤erenced across industries and exporters, and adjusted for di¤erences in levels
of ‘openness’to account for trade-driven selection. Using trade and productivity data, we
can therefore o¤er the …rst theoretically consistent Ricardian test. Our preferred estimate
implies that, ceteris paribus, the elasticity of (adjusted) bilateral exports with respect to
observed productivity is positive, as our Ricardian model predicts, and equal to 6:53.
Second, our clear theoretical foundations allow us to do general equilibrium counterfactual
analysis. In order to quantify further the importance of Ricardian comparative advantage,
we then ask: What if, for any pair of exporters, there were no relative productivity di¤erences
1
2

A notable exception, which we discuss more below, is Golub and Hsieh (2000).
This quanti…cation depends on the level of aggregation at which an ‘industry’ is de…ned. Throughout

this paper, industries will be de…ned as the lowest level of disaggregation for which we have productivity
data that are comparable across countries and industries, namely the two-digit ISIC level.

2

COSTINOT, DONALDSON, AND KOMUNJER

across industries? What would be the consequences for aggregate trade ‡ows and welfare?
According to our estimates, the removal of Ricardian comparative advantage at the industry
level would only lead, on average, to a 5:5% decrease in the total gains from trade.
Section 2 describes our theoretical framework. We consider an economy with multiple
countries, multiple industries, and one factor of production, labor. Up to this point, this
is a standard Ricardian model. We generalize this model by allowing for intra-industry
heterogeneity à la Eaton and Kortum (2002). Formally, we assume that each good is available
in many varieties and that labor productivity di¤ers across varieties. The key feature of this
model is that labor productivity may be separated into: (i) a deterministic component,
which is country and industry speci…c; and (ii), a stochastic component, randomly drawn
across countries, industries, and varieties. The former, which we refer to as ‘fundamental
productivity,’ captures factors such as climate, infrastructure, and institutions that a¤ect
the productivity of all producers in a given country and industry.3 The latter, by contrast,
re‡ects idiosyncratic di¤erences in technological know-how across varieties.
Section 3 derives our theoretical predictions, relates them to the previous Ricardian literature, and investigates their robustness. The …rst set of predictions are cross-sectional in
nature, and describe how productivity di¤erences a¤ect trade patterns across countries and
industries in any trading equilibrium. A key result that emerges is a parsimonious method for
correcting for the trade-driven selection that creates an endogenous wedge between fundamental and observed productivity. The second set of predictions concerns general equilibrium
responses to novel and natural counterfactual scenarios that explore by how much aggregate
trade ‡ows and welfare would change if, for any pair of exporters, there were no fundamental
relative productivity di¤erences across industries.
Section 4 tests our cross-sectional predictions using the best available data on internationallycomparable productivity and trade ‡ows across countries and industries. In line with our
Ricardian model, our measures of relative productivity are computed using relative producer
prices from the GGDC Productivity Level Database. Our analysis illustrates how tests of
the Ricardian model, which have long been perceived as hopelessly ad-hoc, can be performed
3 Matsuyama

(2005), Acemoglu, Antras, and Helpman (2007), Levchenko (2007), Vogel (2007), Costinot

(2009), and Cuñat and Melitz (2010) explicitly model the impact of various institutional features— e.g. labor
market ‡exibility, the quality of contract enforcement, or credit market imperfections— on labor productivity
across countries and industries.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

3

in a theoretically consistent manner. This procedure allows us to estimate the extent ‘ ’of
intra-industry heterogeneity which is the key structural parameter governing the relationship
between productivity and exports in this Ricardian world. After adjusting for di¤erences in
openness across exporting countries and industries, which turns out to be empirically important, our preferred estimate of

is equal to 6:53. This is in line with previous estimates of

obtained by researchers using di¤erent methodologies; see e.g. Eaton and Kortum (2002),
Bernard, Eaton, Jensen, and Kortum (2003), Donaldson (2008), and Simonovska and Waugh
(2009).
Section 5 presents our counterfactual results. Using productivity measures revealed by our
Ricardian model to minimize measurement error, we investigate the consequences for aggregate trade ‡ows and welfare of removing relative productivity di¤erences across countries
and industries. According to our estimates, the removal of Ricardian comparative advantage at the industry level would only lead, on average across countries, to a 5:5% decrease
in the total gains from trade. We conclude Section 5 by exploring how the magnitude of
this estimate is related to two important features of the data: heterogeneous preferences and
heterogeneous trade costs. Both of these aspects of heterogeneity tend to o¤set the purely
productivity-driven heterogeneity that is at the heart of the Ricardian model.
Our paper is related both to the early empirical tests of the Ricardian model— MacDougall
(1951), Stern (1962), and Balassa (1963)— and to a much more recent but rapidly growing
literature based on multi-sector extensions of the Eaton and Kortum (2002) model— Shikher
(2004, 2008), Costinot (2005), Chor (2008), Donaldson (2008), Caliendo and Parro (2009),
Kerr (2009), and Burstein and Vogel (2010). Relative to this literature, our …rst contribution
is to show how micro-foundations à la Eaton and Kortum (2002) can be used to contrast
the cross-sectional predictions of the Ricardian model with the data. Using our model,
we estimate the impact of observed productivity di¤erences on the pattern of trade across
countries and industries without having to rely on ad-hoc measures of export performance,
bilateral comparisons inspired by a two-country model, or unclear orthogonality conditions.4
Our second contribution is to show how estimates obtained from these regressions can be used
4 It

is worth emphasizing that, our theoretical foundations notwithstanding, our cross-sectional results

are much closer, in spirit, to those of MacDougall (1951), Stern (1962), Balassa (1963), and Golub and
Hsieh (2000) than to those of Eaton and Kortum (2002). Fundamentally, the focus of our analysis is the
commodity pattern of trade, not the total volume of trade. Compared to Eaton and Kortum (2002), our

4

COSTINOT, DONALDSON, AND KOMUNJER

to measure, in a well-de…ned way, the welfare impact of Ricardian comparative advantage
at the industry level.5 Put together, these cross-sectional and counterfactual results provide
a complete exploration of the quantitative implications of Ricardo’s ideas.
Our analysis is also related, though less closely, to a large empirical literature investigating the role of various sources of comparative advantage; see e.g. Harrigan (1997b),
Beck (2003), Romalis (2004), Yeaple and Golub (2007), Nunn (2007), Manova (2008), and
Morrow (2009). Like the previous papers, we analyze how di¤erences in costs of production may a¤ect the pattern of trade across countries and industries. However, our main
focus is not to assess which particular channel— e.g. institutions, infrastructure, or factor
endowments— contributes more to the cross-sectional variation in costs of production, and
in turn, bilateral trade ‡ows. Like in previous Ricardian tests, we start by interpreting
the cross-sectional variation in costs of production as the result of fundamental productivity di¤erences. Conditional on this interpretation, we then investigate how much of the
cross-sectional variation in trade ‡ows and the overall gains from trade can be explained by
these di¤erences. In other words, the goal of the present paper is not to investigate what
causes observed productivity di¤erences or whether such di¤erences may be accounted for
by di¤erences in factor endowments.6 Our goal simply is to ask: Seen through the lens of the
Ricardian model, how important are productivity di¤erences across countries and industries?

2. Theoretical Framework
We consider a world economy comprising i = 1; : : : ; I countries and one factor of production, labor. There are k = 1; : : : ; K industries or goods and constant returns to scale
in the production of each good. Labor is perfectly mobile across industries and immobile
across countries. We denote by Li and wi the number of workers and the wage in country i,
empirical exercise therefore requires independent measures of productivity as well as trade data disaggregated
by industry.
5 In this regard, the present analysis is most closely related to Chor (2008) who compares the impact of
various sources of comparative advantage on welfare, albeit not in a fully structural way.
6 While an assessment of the relative importance of productivity and factor endowment di¤erences for the
determinants of comparative advantages is not our main focus, we do present, in Section 4.3 below, evidence
that our estimates are robust to controlling for factor price and factor intensity di¤erences.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

5

respectively. Up to this point, this is a standard Ricardian model. We generalize this model
by allowing for intra-industry heterogeneity in labor productivity.

Technology. Each good k may come in an in…nite number of varieties indexed by ! 2

f1; : : : ; +1g.7 We denote by zik (!) the number of units of the !th variety of good k that
can be produced with one unit of labor in country i. Following Eaton and Kortum (2002),
we assume that:
A1. For all countries i, goods k, and their varieties !, zik (!) is a random variable drawn
independently for each triplet (i; k; !) from a Fréchet distribution Fik ( ) such that:
Fik (z) = exp[

(1)
where zik > 0 and

z=zik

], for all z

0,

> 1.

According to Assumption A1, technological di¤erences across countries and industries
only depend on two parameters, zik and .8 We refer to zik as the fundamental productivity
of country i in industry k. It aims to capture factors such as climate, infrastructure, and
institutions that a¤ect the productivity of all producers in a given country and industry. For
each industry k, the cross-country variation in zik s pins down the cross-country variation in
relative labor productivity at the core of the standard Ricardian model. Formally, Equation
(1) implies zik =zik0 = E zik (!) =E zik0 (!) , for any i, i0 , and k.
By contrast, the second parameter, , measures intra-industry heterogeneity. It aims
to re‡ect the scope for idiosyncratic di¤erences in technological know-how across varieties,
which we assume to be the same in all countries and industries.9 In this model parametrizes
7 Alternatively,

we could have assumed the existence of a continuum of varieties. By assuming that the

number of varieties is in…nite, but countable, we avoid the technical di¢ culties of invoking the law of large
numbers with a continuum of i.i.d. variables; see e.g. Al-Najjar (2004). Nothing substantial hinges on this
particular modeling choice. More economically substantial is the implicit assumption that the number of
varieties per industry— unlike in a monopolistically competitive model with free entry— is exogenously given.
8 Section
9 Using

3.4 analyzes how our results extend to environments in which A1 is not satis…ed.
a unique dataset that documents physical output (rather than just revenue) at the plant level in the

United States, Foster, Haltiwanger, and Syverson (2008) document signi…cant intra-industry heterogeneity
in plant-level physical productivity.

6

COSTINOT, DONALDSON, AND KOMUNJER

the impact of changes in fundamental productivity levels, zik , on aggregate trade ‡ows.
Estimating

will be one key focus of our quantitative exploration of the Ricardian model.

Trade costs. Trade frictions take the form of ‘iceberg’trade costs. Formally, we assume
that:
A2. For each unit of good k shipped from country i to country j, only 1=dkij
with dkij such that: (i) dkii = 1; and (ii) dkil

1 units arrive,

dkij dkjl for any third country l.

The second part of Assumption A2 simply rules out cross-country arbitrage opportunities.
Market structure. Markets are assumed to be perfectly competitive. Together with
constant returns to scale in production, perfect competition implies:
A3. In any country j, the price pkj (!) paid by buyers of variety ! of good k is
pkj (!) = min ckij (!) ,

(2)

1 i I

where ckij (!) =

dkij wi

zik (!) is the cost of producing and delivering one unit of this

variety from country i to country j.
For each variety ! of good k, buyers in country j are ‘shopping around the world’for the
best price available. In what follows, we let ckij = dkij wi

zik > 0.

Preferences. In each country there is a representative consumer with a two-level utility
function. The upper tier utility function is Cobb-Douglas, while the lower tier is CES.10
Accordingly, expenditures are such that:
A4. In any country j, total expenditure on variety ! of good k is
1

(3)
k
j

where 0

1,

k
j

k

k
j
xkj (!) = pkj (!) pkj
j wj Lj ,
hP
i1=(1
k
0 1 kj
< 1 + , and pkj
p
(!
)
0
j
!2

k)
j

.

The above expenditure function is a standard feature of models of intra-industry trade
in the ‘new trade’literature; see e.g. Helpman and Krugman (1985). The …rst preference
parameter,
10 While

k
j,

measures the share of expenditure on varieties from industry k in country j,

the Cobb-Douglas assumption in A4 could be dispensed with in favor of any upper tier utility

function for our cross-sectional results, it will play a non-trivial role in our counterfactual analysis.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS
k
j,

whereas the second,
k
j

< 1+

7

is the elasticity of substitution between varieties. The restriction

is a technical assumption that guarantees the existence of a well de…ned CES

price index, pkj , in country j and industry k. It is worth emphasizing that demand conditions
may vary across countries and industries: kj and kj are functions of j and k. For future
k
QK
k j
the consumer price index in country j.
reference, we denote by pj
k=1 pj
Trade Balance. We denote by xkij

P

!2

i to country j in industry k, where

k
ij

k
ij

xkj (!) the value of total exports from country
!2

ckij (!) = min1

i0 I

cki0 j (!)

is the set

of varieties exported by country i to country j in industry k. Similarly, we denote by
PI
k
k
xkij
ij
i0 =1 xi0 j the share of exports from country i in country j an industry k. Our

…nal assumption is that:

A5. For any country i, trade is balanced
(4)
where

PI

j=1

i

wi Li /

PI

i0 =1

PK

k=1

k
ij

k
j j

=

i,

wi0 Li0 is the share of country i in world income.

Conditional on aggregate trade ‡ows, Assumption A5 pins down relative wages, wi =wi0 ,
around the world.11 This completes our description of a trade equilibrium in this economy.
3. Theoretical Predictions
Using the previous theoretical framework, Assumptions A1-A5, we derive two types of
predictions. First, we show how di¤erences in labor productivity across countries and industries a¤ect the pattern of trade in a given equilibrium. These cross-sectional predictions will
form the basis of our …rst empirical exercises (in Section 4), the goal of which is to estimate
the key model parameter

which governs the relationship between productivity and exports

in this Ricardian world. Second, we demonstrate how changes in labor productivity would
a¤ect trade and welfare across equilibria. These counterfactual predictions will form the
basis of our …nal empirical exercise (in Section 5), in which we explore the importance of
inter-industry Ricardian forces for generating gains from trade around the world.
11 For

expositional purposes, we have chosen to impose trade balance, but it should be clear that all our

results would hold if we had assumed …xed trade imbalances instead. It should also be clear that, like the
Cobb-Douglas preferences in A4, A5 could be dispensed with for our cross-sectional results.

8

COSTINOT, DONALDSON, AND KOMUNJER

3.1. Productivity and Trade: A First Look. Before deriving our new cross-sectional
predictions, we …rst describe the impact of fundamental productivity and trade costs on
bilateral exports at the industry level. By themselves, such theoretical results are of limited
use for empirical work because fundamental productivity levels cannot be observed: doing
so would require data on products that have been driven out of domestic production by the
forces of trade. This intermediate step, however, will allow us to compare our approach to
the previous theoretical literature on the Ricardian model— a literature without clear predictions in a world with many countries and industries— in a transparent manner. In the next
subsection, we will then highlight how trade-driven selection drives a wedge between fundamental productivity and observed productivity, and how empirical work can nevertheless
proceed in the face of this wedge.
Lemma 1. Suppose that Assumptions A1-A4 hold. Then for any importer, j, any pair of
exporters, i and i0 , and any pair of goods, k and k 0 ,
!
0
0
xkij xki0 j
zik zik0
(5)
ln
= ln
0
0
xkij xki0 j
zik zik0

0

ln

dkij dki0 j
0
dkij dki0 j

!

.

The proof of Lemma 1 is simple.12 Under Assumptions A1-A4, bilateral exports from
country i to country j in sector k can be expressed as:
xkij

(6)

= PI

wi dkij zik

i0 =1

wi0 dki0 j

zik0

k
j wj Lj :

To go from this expression to Equation (5), we then use a simple ‘di¤erence-in-di¤erence’
0

strategy. The …rst (log-) di¤erence, xkij =xkij , allows us to control for di¤erences in wages,
wi , across exporters, as well as di¤erences in income, wj Lj , across importers. The second
(log-) di¤erence,
expenditure,

k
j,

0

xkij =xkij

0

xki0 j =xki0 j , allows us to control for di¤erences in the share of

across sectors. Equation (5) follows.

At this point, our theoretical framework imposes very little structure on the variation of
trade costs. To better relate Lemma 1 to previous results in the literature, it is useful to
consider brie‡y the special case in which:
(7)
12 Proofs

dkij = dij dkj for all k and i 6= j:
of all our formal results can be found in Appendix A.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

9

This restriction is trivially satis…ed, for example, in Dornbusch, Fischer, and Samuelson
(1977) who assume that trade costs are symmetric across countries and identical across
goods, dkij = dkji

d. In Equation (7), the …rst parameter dij measures the trade barriers

which are speci…c to countries i and j such as physical distance, existence of colonial ties,
use of a common language, or participation in a monetary union. The second parameter
dkj measures the policy barriers imposed by country j on good k, such as import tari¤s
and standards, which, in line with ‘the most-favored-nation’ clause of the World Trade
Organization, may not vary by country of origin.13
0

0

In this special case, since dkij dki0 j dkij dki0 j = 1 for all i,i0 6= j, Lemma 1 directly implies:
Corollary 2. Suppose that Assumptions A1-A4 and Equation (7) hold. Then for any importer, j, and any pair of exporters, i,i0 6= j, the ranking of relative fundamental productivity

determines the ranking of relative exports:
zi1
zi10

:::

x1ij
ziK
, 1
xi0 j
ziK0

:::

xK
ij
:
K
xi0 j

Note that, without loss of generality, we can always …x a pair of countries, i1 and i2 , and
index the K goods so that:
(8)

zi11
zi12

:::

ziK1
.
ziK2

Ranking (8) is at the heart of the standard two-country Ricardian model; see e.g. Dornbusch,
Fischer, and Samuelson (1977). When there is no intra-industry heterogeneity, Ranking (8)
merely states that country i1 has a comparative advantage in (all varieties of) the high k
goods. If there only are two countries, the pattern of trade follows: i1 produces and exports
the high k goods, while i2 produces and exports the low k goods. If there are more than
two countries, however, the pattern of pairwise comparative advantage no longer determines
the pattern of trade. In this case, the standard Ricardian model loses most of its intuitive
content; see e.g. Jones (1961) and Wilson (1980).
13 In

practice, Equation (7) may be violated because of preferential trade agreements or, more simply,

because bilateral distance has a di¤erential impact on goods of di¤erent weights; see e.g. Harrigan (2005).
For this reason, we do not impose Equation (7) throughout the remainder of this paper. The role of Equation
(7) here is purely to relate our results to previous theoretical work on the Ricardian model.

10

COSTINOT, DONALDSON, AND KOMUNJER

When there are stochastic productivity di¤erences within each industry, it is easy to check
that Assumption A1 and Ranking (8) further imply:
zi11 (!)
zi12 (!)

(9)
where

:::

ziK1 (!)
,
ziK2 (!)

denotes the …rst-order stochastic dominance order among distributions. In other

words, Ranking (9) is just a stochastic— hence weaker— version of the ordering of labor productivity zik , which is at the heart of the Ricardian theory. Like its deterministic counterpart
in (8), Ranking (9) captures the idea that country i1 is relatively better at producing the
high k goods. But whatever k is, country i2 may still have lower labor requirements on some
of its varieties.14
According to Corollary 2, Ranking (9) does not imply that country i1 should only produce
and export the high k goods, but instead that it should produce and export relatively more
of these goods. This is true irrespective of the number of countries in the economy. Unlike
the standard Ricardian model, our model generates a clear and intuitive correspondence
between labor productivity and exports. Here, the pattern of comparative advantage for
any pair of exporters fully determines their relative export performance across industries.
The previous discussion may seem paradoxical. As we have just mentioned, Ranking (9)
is a weaker version of the ordering at the heart of the standard theory. If so, how does
the present theory lead to …ner predictions? The answer is simple: it does not. While the
standard Ricardian model is concerned with trade ‡ows in each variety of each good, we
only are concerned with the total trade ‡ows in each good. Unlike the standard model,
we recognize that random shocks— whose origins remain outside the scope of our model—
may a¤ect the costs of production of any variety.15 Yet, by assuming that these shocks are
identically distributed across a large number of varieties, we manage to generate predictions
at the industry level in a multi-country world. The lack of such predictions has been the
fundamental hindrance to theoretically consistent empirical work on the Ricardian model to
date.
14 It

should be clear, however, that Ranking (9) per se does not imply the equivalence in Corollary 2. To

derive this equivalence, we use Equation (5) which relies on the particular functional forms in A1.
15 In this regard, our model bears a resemblance to Davis (1995) where Ricardian di¤erences also explain
intra-industry trade. However, unlike in our model, factor proportions determine inter-industry trade in
Davis (1995).

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

11

Having clari…ed how the predictions that emerge from our Ricardian model di¤er from
those of the previous theoretical Ricardian literature, we now proceed to tighten the relationship between our model and the real world. That is, we recognize that fundamental
productivity levels, which feature in Lemma 1, are not observable.

3.2. Cross-sectional Predictions. As in the previous empirical Ricardian literature, our
goal is to study the relationship between observed trade ‡ows and observed productivity
levels. To do so we assume that statistical agencies perfectly observe zik (!) for all varieties
of good k produced in country i. What statistical agencies cannot observe, however, is labor
productivity for varieties of good k which are not produced in country i because such varieties
are being imported from another country.16 In other words, even in an ideal world without
measurement error, statistical agencies cannot report unconditional average productivity,
E zik (!) . Instead statistical agencies can only report conditional averages, E zik (!)
based on the set of varieties actually produced in country i,
on, we refer to

zeik

E

zik (!)

k
i

k
i

[j=1;:::;I

k
ij .

k
i

,

From now

as observed productivity in country i and industry k and

contrast this variable repeatedly with fundamental productivity, zik .
Using Lemma 1 and the previous de…nition we now describe the impact of observed productivity di¤erences on the cross-sectional variation of aggregate trade ‡ows.
Theorem 3. Suppose that Assumptions A1-A4 hold. Then for any importer, j, any pair of
exporters, i and i0 , and any pair of goods, k and k 0 ,
0

(10)

ln

where x
ekij
16 This

xkij

k
ii .

x
ekij x
eki0 j
0 k
x
ekij x
ei0 j

!

0

0

= ln

zeik zeik0
0
zeik zeik0

ln

dkij dki0 j
0
dkij dki0 j

!

,

problem, which our approach will solve, was observed by Deardor¤ (1984) while reviewing empirical

work on the Ricardian model (p. 476): “Problems arise, however, most having to do with the observability
of [productivity by industry and country]. The...problem is implicit in the Ricardian model itself...[because]
the model implies complete specialization in equilibrium... This in turn means that the di¤erences in labor
requirements cannot be observed, since imported goods will almost never be produced in the importing
country.”

12

COSTINOT, DONALDSON, AND KOMUNJER

The proof of Theorem 3 proceeds as follows. First, we use Assumption A1 in order to
establish the link between observed and fundamental productivity levels:
zik
=
zik0

(11)

zeik
zeik0

k
ii
k
i0 i0

1=

.

The logic behind Equation (11) is fairly intuitive. In a given industry k, if country i is more
open than in country i0 ,

k
ii

k
i0 i0 ,

then country i will tend to produce a smaller, but more

productive subset of varieties. Hence, observed relative productivity, zeik zeik0 , will be higher

than fundamental relative productivity, zik zik0 . The second term on the right-hand side of

Equation (11) exactly corrects for this trade-driven selection. Equation (10) directly derives
from Equations (5) and (11).

In our empirical analysis below we will use Theorem 3 in order to estimate directly the
impact (governed by ) of observed productivity di¤erences on the pattern of trade across
countries and industries. Since this empirical exercise is most closely related to previous
Ricardian regressions, it is important to highlight how our theory-based approach di¤ers
from previous empirical work. It does so in three respects. First, the most novel aspect
of our analysis lies in the left-hand side of Equation (10). Unlike in MacDougall (1951),
Stern (1962), Balassa (1963), and Golub and Hsieh (2000), the dependent variable in our
cross-industry regressions will be the log of exports, disaggregated by exporting and importing countries, di¤erenced across exporters and industries, and corrected for di¤erences in
levels of ‘openness’across exporting countries. According to Theorem 3, this new measure
of export performance is the theoretically correct way to control for trade-driven selection.
Second, our theory clari…es how empirical work can and should control for all of the general
equilibrium interactions across countries and industries that have a bearing on the partial
equilibrium relationship between productivity and exports. Theorem 3 shows that these
endogenous relationships do not introduce bias as long as one works with exports and productivity levels that are both in a (log-) ‘di¤erence-in-di¤erence’form. Finally, compared to
previous Ricardian tests, our microtheoretical foundations also make it possible to discuss
the economic origins of the error term. In our model, these are equal to a particular form
of relative trade costs. As a result, our theory makes transparent the plausibility of any
orthogonality condition on which the estimation of

in Equation (10) would be based. We

will come back to this important issue in detail in Section 4.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

13

3.3. Counterfactual Predictions. Theorem 3 o¤ers cross-sectional predictions which will
help us test and quantify the importance of Ricardian comparative advantage in the data.
An alternative way of quantifying Ricardian forces is to do counterfactual analysis, i.e. to
evaluate the e¤ects of moving to a world in which Ricardian forces do not operate across
industries. In this section we pursue such an evaluation and ask: What if, for any pair
of exporters, there were no fundamental relative productivity di¤erences across industries?
What would be the consequences for aggregate trade ‡ows and welfare?
Formally, we proceed as follows. We start by …xing a reference country i0 . We assume
that fundamental productivity in country i0 is the same in all sectors in the initial and the
counterfactual equilibrium: zik0

0

zik0 for all k. By contrast, for any country i 6= i0 and any

sector k, we assume that fundamental productivity in sector k goes from zik to zik
that

0
zik

0

such

Zi zik0 , where Zi is chosen such that the value of the relative wage (wi =wi0 )0

in the counterfactual equilibrium is the same as in the initial equilibrium (wi =wi0 ). We will
come back to the exact values of Zi for all i 6= i0 in a moment. In the rest of this paper, we
use the convention Zi0

1 for the reference country.

It is important to note that there are no fundamental di¤erences in relative productivity
across countries in the counterfactual equilibrium. By construction, for any pair countries,
i1 and i2 , and any pair of sectors, k1 and k2 , we have
(12)

zik11

0

zik21

0

=

zik12
zik22

0
0.

In other words, there is no source of Ricardian comparative advantage at the industry level.
Furthermore, the adjustment in absolute productivity, Zi , which is designed to hold relative wages constant around the world, guarantees that changes in fundamental productivity
levels from zik to zik

0

have no indirect terms-of-trade e¤ects on the reference country, i0 .

Accordingly, the impact of such changes on aggregate trade ‡ows and welfare in country i0
can be interpreted as the impact of Ricardian comparative advantage at the industry level.17
For lack of a better terminology, we will now refer to this particular comparative statics
exercise as ‘Removing country i0 ’s Ricardian comparative advantage.’
17 Another

way to see this is to note that starting from an initial equilibrium where Equation (12) holds,

changes in fundamental productivity levels from zik to zik

0

would have no impact on trade ‡ows and welfare.

14

COSTINOT, DONALDSON, AND KOMUNJER

The …rst step of our counterfactual analysis is to use the trade balance condition, Assumption A5, in order to compute the adjustment in absolute productivity, Zi , for all i 6= i0 .
Lemma 4. Suppose that Assumptions A1-A5 hold. For all countries i 6= i0 , adjustments in
absolute productivity, Zi , can be computed as the implicit solution of
(13)

PI

j=1

k
k
k
ij zi =Zi
j j
k=1 PI
k
k
i0 =1 i0 j zi0 =Zi0

PK

=

i

An attractive feature of Lemma 4 is that the computation of absolute productivity adjustments, Zi , requires only a small amount of information. In particular, we do not need
data on wages, factor endowments, or trade costs, which may be hard to obtain in practice.
In our computation of absolute productivity adjustments (in Section 5.1), we will simply use
revealed measures of fundamental productivity zik together with trade data which enable us
to compute export shares, kij , expenditure shares, kj , and world income shares, j .
b
Let X
X 0 / X denote an arbitrary proportional change in any variable X between the

initial and the counterfactual equilibrium. Our last theoretical result can be stated as follows.

Theorem 5. Suppose that Assumptions A1-A5 hold. If we remove country i0 ’s Ricardian
comparative advantage, then:
(1) Counterfactual changes in bilateral trade ‡ows, xkij , satisfy
(14)

x
bkij = PI

i0 =1

zik =Zi
k
i0 j

zik0 =Zi0

, for all i, j, k.

(2) Counterfactual changes in country i0 ’s welfare, Wi0
wi0 / pi0 , satisfy
# ki /
"
0
k
Q
P
z
K
I
i
k
c
(15)
Wi0 = k=1
.
i=1 ii0
zik0 Zi

The proof of Theorem 5 is a straightforward generalization of the approach followed by

Dekle, Eaton, and Kortum (2008) in the one-industry case. Again, only a very small amount
of data is needed to compute counterfactual changes in bilateral trade ‡ows and welfare, x
bkij
ci0 . We still do not need any data on wages, factor endowments, or trade costs. All
and W
the economically relevant information about these variables is already included in the

k
ij s.

Equations (14) and (15) are both intuitive. Since our adjustment of absolute productivity

levels, Zi , controls for any indirect terms-of-trade e¤ect, changes in bilateral trade ‡ows,

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

15

x
bkij , should mechanically re‡ect changes in the productivity of exporter i relative to other

exporters i0 , zik =Zi

zik0 Zi0 , weighted by the importance of these exporters in each im-

porting country and industry, ki0 j . Similarly, Equation (15) states that changes in welfare,
ci0 , should mechanically re‡ect the changes in relative prices due to the changes in proW
ductivity of di¤erent exporters with the

k
ij s

providing the economically relevant weights,

namely the share of expenditures on goods from country i in country j and industry k.

3.4. Robustness. The previous theoretical predictions have been derived under strong functional form restrictions. In particular, we have assumed, as in Eaton and Kortum (2002),
that labor productivity was drawn from an extreme value distribution, Assumption A1.
Before turning to our empirical analysis, we now brie‡y discuss the robustness of our results.
The crucial assumption behind Lemma 1 is that the elasticity of bilateral trade ‡ows, xkij ,
with respect to trade and production costs, ckij , is constant. In Lemma 1, this elasticity is
given by our measure of intra-industry heterogeneity, , which creates a tight relationship
between the variations in relative productivity and relative exports. While Assumption A1
is su¢ cient for the elasticity of trade ‡ows to be constant, it is not necessary. In Appendix
B, we show that the elasticity of trade ‡ows would remain constant for any distribution of
productivity shocks, provided that: (i) di¤erences in the distribution of productivity across
countries and industries, Fik , can still be parameterized by a single location parameter, zik ;
(ii) di¤erences in trade and production costs are small, ck1j ' : : : ' ckIj ; and (iii), elasticities

of substitution are constant across countries and industries,

k
j

= . The intuition is simple.

On the one hand, conditions (i) and (ii) guarantee that marginal changes in trade and
production costs ckij have the same impact on the extensive margin across countries and
industries, i.e., on how many varieties are being exported. On the other hand, condition
(iii) guarantees that they have the same impact on the intensive margin, i.e. on how much
of each variety is being exported. Thus, the elasticity of trade ‡ows must be constant.
Lemma 1 and Corollary 2 directly follow.18
18 Since

Lemma 1 relies on the elasticity of trade ‡ows being constant, it may be surprising that no

restriction was imposed on the variations of the elasticity of substitution,

k
j,

in Assumption A4. Condition

(iii) was not necessary in Lemma 1 because of one key property of the Fréchet distribution: like in Eaton and
Kortum (2002), the distribution of the price pkj (!) of a given variety ! of good k in country j is independent
of the country of origin i; see Eaton and Kortum (2002) p1748 for a detailed discussion. Formally, if Fik ( )
satis…es Equation (1), then Pr pkj (!)

p = Pr pkj (!)

p ckij (!) = min1

i0 I

cki0 j (!) ; for any p > 0 and

16

COSTINOT, DONALDSON, AND KOMUNJER

In Appendix B, we also discuss the importance of adjusting bilateral exports for di¤erences in levels of openness,

k
ii ,

in order to correct for the endogenous di¤erence between

fundamental and observed productivity levels. Without Assumption A1, one cannot obtain
closed-form solutions for the extent of trade-driven selection, and so, one cannot derive Theorem 3. However, we show that even without Assumption A1, the

k
ii s

still contain useful

information about the di¤erence between fundamental and observed productivity levels. In
particular, they should still be controlled for when estimating the impact of productivity
di¤erences on bilateral trade ‡ows under conditions (i)-(iii). Put simply, the particular way
in which we control for di¤erences in levels of openness,

k
ii ,

is functional form dependent,

but the general idea that the relationship between fundamental and observed productivity
depends on these levels is not.
Finally, we show that Theorem 5 would also hold under conditions (i)-(iii) if fundamental
productivity di¤erences across countries are initially small, zik ' : : : ' zIk ; see Appendix B

for details.19 To summarize, in a world economy featuring small technological di¤erences

across countries, our main cross-sectional and counterfactual predictions would hold under
weaker restrictions on the distribution of intra-industry productivity shocks. The main role
of Assumption A1 is to help us go from local to global predictions, which hold for arbitrarily
large di¤erences across countries and industries.

4. Cross-sectional Results
In this section, we investigate how much observed productivity di¤erences a¤ect the crosssectional variation of bilateral trade ‡ows. That is, we test Theorem 3 using the best available
data on internationally comparable productivity and trade ‡ows across countries and industries. This procedure will highlight how empirical tests of the Ricardian model should be
performed in a theory-consistent manner. It will also allow us to estimate the parameter ,
which is the only structural parameter needed to ask questions about counterfactuals within
this Ricardian model (the goal of Section 5).
any 1

i

I. Unfortunately, this property does not generalize to any other standard distribution, as we

have shown formally in an earlier version of this paper, Costinot and Komunjer (2007).
19 For the second of our counterfactual results, Equation (15), condition (ii) can actually be dispensed
with altogether.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

17

Table 1: Data Set Description
Sources:

OECD STAN Bilateral Trade Database (Edition 2008); International Comparisons of
Output and Productivity Industrial Database (Timmer, Ypma and van Ark, 2007).

Year:

1997

Countries:

Australia, Belgium-Luxembourg (aggregated into one country unit to enable a merge with
the productivity data), Czech Republic, Denmark, Spain, Finland, France, Germany,
Greece, Hungary, Ireland, Italy, Japan, Korea, Netherlands, Poland, Portugal, Slovakia,
Sweden, United Kingdom, and United States

Industry:

STAN Description:

Food
Textiles
Wood
Paper
Fuel
Chemicals
Plastic
Minerals
Metals
Machinery
Electrical
Transport
Misc. Manuf.

Food products, beverages and tobacco
Textiles, textile products, leather and footwear
Wood and products of wood and cork
Pulp, paper, paper products, printing and publishing
Coke, refined petroleum products, and nuclear fuel
Chemicals, and chemical products
Rubber and plastics products
Other non-metallic mineral products
Basic metals, and fabricated metal products, except machinery and equipment
Machinery and equipment not elsewhere classified
Electrical and optical equipment
Transport equipment
Manufacturing not elsewhere classified

ISIC Rev. 3.1 Code
15-16
17-19
20
21-22
23
24
25
26
27-28
29
30-33
34-35
36-37

4.1. Data. Our baseline tests require data of just two types: trade ‡ows and productivity.
In this section we outline the sources of these data.

4.1.1. Trade Flows. We use trade ‡ow data taken from the OECD Structural Analysis
(STAN) Bilateral Trade Database (edition 2008) relating to the year of 1997. Our selection of countries and industries (and the year, 1997) is driven entirely by the availability
of both bilateral trade ‡ow data and high quality productivity data. The resulting sample
comprises 21 countries (18 European countries plus Japan, Korea and the United States) and
13 industries which correspond to roughly two-digit ISIC codes and span the manufacturing
sector, as described in Table 1.

18

COSTINOT, DONALDSON, AND KOMUNJER

We use the value of bilateral exports from each of these 21 countries (i) to each of these
21 countries (j) in each industry (k) as our measure of xkij .20 The …nal source of trade
data that we require concerns how much each exporting country i imports in each industry
k relative to its total expenditure in that industry, in order to correct for the endogenous
selection of varieties that are actually produced domestically, i.e.

k
ii

in Theorem 3 above.

For this purpose we use data on the import penetration ratio, which is equal to 1

k
ii ,

of

each exporting country i and industry k, as reported in the OECD STAN database.
4.1.2. Productivity. Measuring productivity at the country-industry level is a non-trivial
exercise.21 As Bernard, Eaton, Jensen, and Kortum (2003) point out (p. 1274), “under
perfect competition, prices vary inversely with e¢ ciency exactly to eliminate any variation
in productivity, measured as the value of output per unit input.”Accordingly, real output per
worker— a typical proxy for labor productivity in the existing literature that is constructed
as nominal output per worker divided by a producer price index— is only an informative
measure of productivity to the extent that it uses the correct price de‡ator. In a Ricardian
world, variations in relative productivity levels should be fully re‡ected in relative producer
prices.22
With this in mind, and in line with the Ricardian assumptions made in Section 2, we
measure the variation in productivity across countries and industries using di¤erences in
producer price indices. Our producer price data are taken from the GGDC Productivity
Level Database; see Timmer, Ypma, and van Ark (2007) for details. In this database, raw
20 Our

sample of exporting countries and industries is fundamentally constrained by the intersection of

available trade ‡ow and productivity data. However, for many of the exporter-industry pairs in our sample
data on exports are available for many import destinations, not just for imports to another of the 21 countries
in our sample. The cross-sectional estimates of

presented below change only trivially if trade ‡ow data to

all available import destinations are included in the sample. Our procedure for computing counterfactuals
discussed below, however, requires the full (‘square’) matrix of imports and exports, so this procedure can
only be performed on the 21 countries in our main sample. It is for this reason that we prefer to use the full
‘square’sample throughout.
21 See, for example, Harrigan (1997a) for a review of the di¢ culties involved in comparing productivity
levels across countries and industries.
22 More speci…cally, in the context of our model, for any pair of goods, k and k 0 , and any pair of countries,
h 0
i
0
k
k
k0
E [ pk
z
eik z
eik0
i (!)j i ]E pi0 (!)
i0
0
i and i , Assumptions A2 and A3 imply zek zek0 = E pk (!) k E pk0 (!) k0 .
[ i0 j i0 ] [ i
j i ]
i0 i

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

19

price data observations are …rst collected at the plant level for several thousands of products
(often with hundreds of products per industry, which we interpret as varieties in the context
of our model). This is only made possible due to the use of the PRODCOM system of
homogeneous product descriptions within the EU and OECD. The GGDC database uses the
PRODCOM system to pay particular attention to matching products in di¤erent countries
in order to control for quality di¤erences. These prices are then aggregated up into a unique
producer price index at the industry level using output data. We take the inverse of this
producer price index as the empirical counterpart of zeik in our model.23 Our measures of
productivity across countries and industries are reported in Table 2.

A few comments about this procedure are in order. First, the productivity levels reported

in Table 2 are normalized to one in all industries for the United States and in all countries for
the Food industry. It should be clear that this is without any loss of generality and has no
impact on our analysis. At its core, the notion of Ricardian comparative advantage involves
the comparison of two goods and two countries, which is re‡ected in the fact that predicted
export behavior (in Theorem 3) depends only on the di¤erence-in-di¤erence in ln zeik .

Second, the main bene…t of our approach is that our independent variable is consistent

with the model developed in Section 2. In particular, we explicitly recognize that: (i) all
information about relative productivity levels in the data is fully re‡ected in relative producer
prices; and (ii), average productivity levels can only be measured using varieties that have
actually been produced. The main drawback of our approach, of course, is that the crosssectional variation in producer prices is likely to re‡ect more than productivity di¤erences
in practice. In particular, variation in producer prices may also capture di¤erences in factor

23 It

is worth pointing out that producer price indices from the GGDC database relate to gross output.

We believe that such measures are well suited for our empirical exercise for two reasons. First, as we discuss
in more detail below, our theory is fundamentally one of comparative costs. When perfectly competitive
producers (like those in our model) use intermediate inputs in production, it is the prices of their gross
output that are equal to their unit costs. Second, the GGDC database is primarily concerned with collecting
internationally comparable producer output rather than input prices, so we expect producer prices of gross
output to be the best measured proxy for productivity available. Nevertheless, for robustness, Section 4.3
below considers an extension that aims to control for the variation in input prices (and input intensity)
across countries and industries.

20

COSTINOT, DONALDSON, AND KOMUNJER

Table 2: Relative Productivity Levels, by Country and Industry
Food

Textiles

1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1

0.77
0.84
0.80
0.75
0.92
0.82
0.76
0.67
1.07
0.80
0.93
0.79
1.88
1.23
0.85
1.15
1.18
0.63
0.68
0.92
1

AUS
BEL
CZE
DEN
ESP
FIN
FRA
GER
GRE
HUN
IRE
ITA
JPN
KOR
NED
POL
PTL
SLK
SWE
UK
USA

Wood Paper
0.89
0.84
1.16
0.84
1.47
1.20
1.22
0.91
1.65
1.05
1.03
1.02
1.37
1.56
0.54
1.12
1.32
0.82
1.18
0.69
1

0.85
1.03
0.72
0.63
0.91
1.18
0.93
0.89
1.57
1.08
0.81
0.68
1.69
1.40
0.76
0.92
1.08
0.91
0.92
1.23
1

Fuel
1.21
1.70
0.66
0.64
0.70
0.86
1.11
0.94
1.13
0.52
1.15
0.65
1.06
1.32
0.65
1.07
0.62
0.49
0.78
1.27
1

ChemMinMach- Elec- Trans- Misc.
Plastic
Metals
icals
erals
inery trical port Manuf
0.84
1.26
1.44
1.02
1.34
1.69
1.24
1.03
1.87
0.98
1.49
1.26
1.84
2.74
1.25
1.24
1.26
1.04
1.22
1.20
1

0.81
1.71
1.65
1.01
1.38
1.37
1.64
1.23
1.21
1.32
1.55
1.48
1.69
1.97
1.26
2.21
2.32
1.07
1.18
1.74
1

1.00
1.49
1.88
0.98
1.58
1.30
1.28
1.20
2.19
1.33
1.19
1.63
1.71
2.22
1.11
1.59
1.66
1.45
0.92
1.24
1

0.84
1.07
1.05
0.85
1.08
1.18
1.08
0.91
1.51
0.91
1.11
1.17
1.85
1.50
1.00
0.91
1.42
0.71
1.14
1.02
1

0.86
0.93
0.97
0.85
0.99
1.13
1.13
0.92
1.54
1.52
0.92
1.02
2.05
1.64
0.71
0.80
1.01
0.63
0.98
1.29
1

0.82
0.86
0.93
0.63
1.08
0.90
0.93
0.80
1.26
0.83
0.74
0.98
1.96
1.60
0.75
0.60
1.01
0.72
0.89
0.97
1

0.74
0.71
0.78
0.51
1.01
0.65
0.84
0.72
0.83
0.49
0.62
1.14
1.96
1.72
0.61
0.68
0.59
0.65
0.67
0.79
1

0.84
1.11
0.85
1.35
1.15
1.47
0.92
0.90
1.36
1.14
1.11
0.94
1.33
1.94
0.74
0.64
0.91
0.89
1.09
1.80
1

Notes: Country and industry productivity, as measured by the inverse of producer prices (as collected by the GGDC Productivity Level
Database). Entries are normalized to reflect relative productivity levels in the manner suggested by equation (10). That is, within each
industry the USA has productivity equal to 1, and within each country the 'Food' industry (ISIC Rev 3.1 code: 15-16) has productivity equal
to 1. Countries are listed in the order presented in Table 1.

prices and factor intensity across countries and industries, as emphasized in the HeckscherOhlin model.24 While such considerations would not a¤ect our main speci…cation (which uses
producer price di¤erences to measure unit cost di¤erences accurately regardless of the source
of these di¤erences), they are obviously crucial for how one should interpret our results. We
will come back to this important issue in Section 4.3 below.
Finally, another concern with our approach is related to the way the GGDC Productivity
Level Database has been constructed in practice. Because of data limitations, producer prices
are sometimes combined with expenditure prices to generate producer price indices at the
24 The

exact same issue would arise if we were to use real output per worker as our measure of productivity.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

21

industry-level in the GGDC Productivity Level Database. This is, of course, problematic
for the purposes of our Ricardian approach since expenditure prices may be uncorrelated
with domestic productivity, which is what we are ultimately interested in.25 We explore the
consequences for our estimates of this data limitation in Section 4.4 below.
4.2. Baseline Results. Following Theorem 3, we estimate the following log-linear model
using the data described above
0

(16)

ln

where ln x
ekij

ln xkij ln

k
ii

eki0 j
x
ekij x
0 k
x
ekij x
ei0 j

!

0

0

= ln

zeik zeik0
0
zeik zeik

+ ln

"kij "ki0 j 0
0
"kij "ki0 j 0

!

,

is (log) ‘corrected exports’from country i to country j in industry

k, or (log) exports adjusted for openness in country i and industry k, ln

k
ii ;

and ln zeik is (log)

observed productivity. The error term "kij captures both the variation in (log) variable trade
costs,

ln dkij , as well as any measurement error in bilateral trade ‡ows.

As mentioned earlier, the (log) di¤erence-in-di¤erence in Equation (10) and its empirical
counterpart, Equation (16) above, highlight the essence of trade based on Ricardian comparative advantage. That is, relative productivity di¤erences across any pair of countries and
industries drive relative export levels to any market j. While it is possible to estimate Equation (16) in this form, it is simpler— and closer to existing empirical work— if we estimate
the following equivalent speci…cation:
(17)
In this expression

ij

ln x
ekij =

ij

+

k
j

+ ln zeik + "kij

represents an importer-exporter …xed e¤ect and

k
j

an importer-industry

…xed e¤ect.26 Under the assumption that variable trade costs (and other components of the
error term, "kij ) are orthogonal to observed productivity, an OLS estimate of Equation (17)
provides an unbiased estimate of , the extent of intra-industry heterogeneity in this model.
We come back to the plausibility of this orthogonality restriction in a moment.
25 Again,

the exact same issue would arise if we were to use alternative measures of productivity because all

such internationally comparable measures use indices of (supposedly) producer prices in their construction.
26 Since we have a full set of importer-exporter …xed e¤ects,
ij , note that this estimation strategy subsumes
exporter …xed e¤ects and importer …xed e¤ects.

22

COSTINOT, DONALDSON, AND KOMUNJER

Table 3: Cross-Sectional Results - Baseline
Dependent variable:

log (productivity based on producer prices)

log (corrected
exports)

log (exports)

log (corrected
exports)

log (exports)

(1)

(2)

(3)

(4)

1.123***

1.361***

6.534***

11.10***

(0.0994)

(0.103)

(0.708)

(0.981)

Estimation method

OLS

OLS

IV

IV

Exporter x Importer fixed effects

YES

YES

YES

YES

Industry x Importer fixed effects

YES

YES

YES

YES

Observations

5,652

5,652

5,576

5,576

R-squared

0.856

0.844

0.747

0.460

Notes : Regressions estimating equation (17) using data from 21 countries and 13 manufacturing sectors (listed in Table 1) in
1997. 'Exports' is the value of bilateral exports from the exporting country to the importing country in a given industry.
'Corrected exports' is 'exports' divided by the share of the exporting country's total expenditure in the given industry that is
sourced domestically (equal to one minus the country and industry's import penetration ratio). 'Productivity based on producer
prices' is the inverse of the average producer price in an exporter-industry. Columns 3 and 4 use the log of 1997 R&D
expenditure as an instrument for productivity. Data sources and construction are described in full in Section 4.1.
Heteroskedasticity-robust standard errors are reported in parentheses. *** indicates statistically significantly different from
zero at the 1% level.

The …rst column of Table 3 reports a preliminary estimate of , from estimating Equation
(17) by OLS. In line with the prediction in Theorem 3, this estimate is positive and statistically signi…cant.27 According to this estimate of the productivity-to-exports elasticity, a 1%
change in productivity is, all else held equal, associated with a 1:1% change in exports.
Column 2 of Table 3 reports the OLS estimate of if the dependent variable is not adjusted
for the di¤erence between fundamental and observed productivity highlighted by Theorem
3. Without this adjustment we see that one would tend to overestimate the importance
of productivity di¤erences. This is intuitive. Observed productivity di¤erences are smaller
27 The

standard errors reported in Tables 3 and 4 are adjusted for unrestricted forms of heteroskedasticity.

Standard errors that are clustered at the exporter-industry level are larger, as one would expect if the
error term "kij in Equation (17) is correlated across exporter destinations. But our preferred estimate of
is still statistically signi…cant at standard levels when based on standard errors that are clustered at the
exporter-industry level.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

23

than fundamental productivity di¤erences since countries with low fundamental productivity
levels only produce varieties for which they get very good productivity draws. Thus without
our correction, one would wrongly infer that smaller productivity di¤erences lead to the same
variation in trade ‡ows, thereby overestimating the elasticity

of trade ‡ows with respect

to productivity.
There are two main reasons to be concerned with the previous OLS estimates of Equation
(17) introduced above: (i) simultaneity bias, due to agglomeration e¤ects through which
higher export levels lead to higher productivity levels; and (ii) attenuation bias, due to measurement error in productivity. To attempt to circumvent these two potential sources of bias,
we estimate Equation (17) by the method of instrumental variables, with the endogenous
regressor— productivity levels (ln zeik )— instrumented with (the log of) research and develop-

ment (R&D) expenditures at the country-industry level.28 This approach follows Eaton and
Kortum (2002) and Gri¢ th, Redding, and Van Reenen (2004) in modeling technology as
a function of R&D activity. In doing so, our identifying assumption is that relative R&D
expenditures are correlated with relative bilateral trade ‡ows only through their impact on
relative productivity, i.e. relative producer prices.
Our IV estimate of

is reported in column 3 of Table 3.29 This is our preferred speci-

…cation. Compared to the OLS estimates, the magnitude of

is considerably larger— 6:53

rather than 1:12— and still statistically signi…cant. This increase is consistent with the likely
scenario in which our OLS estimates su¤er from attenuation bias because producer prices
are extremely di¢ cult to measure accurately in practice.30 Finally, in column 4 of Table 3
we see that if we were not adjusting for the distinction between fundamental and observed

28 Data

on R&D expenditure are from the Analytical Business Enterprise Research and Development

(ANBERD) database collected by the OECD— as used, for example, by Gri¢ th, Redding, and Van Reenen
(2004). Wherever possible this source aims to break down the R&D expenditures of large, multi-industry
…rms, as well as those of enterprise-serving research institutes, into expenditures by output product.
29 The instrument has strong predictive power. When run only across exporters and industries (that is,
utilizing only the meaningful variation in the …rst stage), the heteroskedasticity-robust t-statistic in the
…rst-stage is equal to 2.23.
30 Agglomeration e¤ects have a priori ambiguous e¤ects on our estimates of . To see this, suppose, using
the more compact notation of Equation (16), that observed productivity, zeik , and adjusted trade ‡ows, x
ekij ,

24

COSTINOT, DONALDSON, AND KOMUNJER

productivity, the value of our estimate of

would be signi…cantly biased upwards (from 6:53

to over 11) in both statistical and economic senses.31
Taken together, our …ndings in Table 3 highlight the importance of the endogeneity of
relative productivity (and hence the importance of IV estimation relative to OLS estimation), and the importance of correcting for the trade-driven wedge between observed and
fundamental productivity levels, as emphasized in Theorem 3.
In Sections 4.3 and 4.4 below we document that our core …nding (in column 3 of Table 3)
is robust to a variety of speci…cation checks. Before moving on to these robustness checks,
however, it is important to note that our preferred estimate of
previous estimates of

= 6:53 is in line with

obtained by researchers using di¤erent methodologies. In particular,

Eaton and Kortum (2002) estimate

to be 3:60 using wage data, and either 8:28 or 12:86

using data on price gaps between countries (to proxy for trade costs); Simonovska and
Waugh (2009) amend Eaton and Kortum’s (2002) price gap methodology (using both Eaton
and Kortum’s (2002) price data and an improved round of the underlying ICP price data)
and estimate

to be 4:5 regardless of the sample. Finally, Donaldson (2008) estimates

commodity-by-commodity in colonial India using a trade costs approach and …nds an average
(over 85 commodities) of 5:2, with a standard deviation of 2:1.
4.3. Alternative Productivity Measures. In the previous subsection, we have taken the
Ricardian model developed in Section 2 very seriously, interpreting di¤erences in producer
prices as di¤erences in productivity. As previously mentioned, there are good reasons to
simultaneously satisfy:
ln
ln
where

0 k
x
ek
ei0 j 0
ij x
k k0
z
ei z
ei0
0 k
z
eik z
ei

= ln
=

ln

0

z
eik z
eik0
0 k
k
z
ei z
ei

0
x
ek
ek
ij x
i0 j 0
0 k
k
x
eij x
ei0 j 0

+ ln
+ ln

0

k
"k
ij "i0 j 0

0 k
"k
ij "i0 j 0
k k0
ij i0 j 0
k0 k
ij i0 j 0

,
,

> 0 captures the fact that higher levels of exports lead to higher productivity levels. If

orthogonal to "
31 By

0

x
ek
ek
ij x
i0 j 0

k0
i0 j 0

for all i, i0 , j, j 0 , k, and k 0 , then E ln

statistical sense, we formally mean the following.

0
z
eik z
eik0
0 k
k
z
ei z
ei

ln

k0
"k
ij "i0 j 0
0 k
k
"ij "i0 j 0

> 0 if and only if

k
ij

is

< 1.

If we estimate a full, three-equation system

(in which equation 1 is the …rst-stage relationship between observed productivity and R&D expenditure,
equation 2 is the second-stage relationship estimated in column 3 of Table 3, and equation 3 is the secondstage relationship estimated in column 4 of Table 3) that allows for correlation among the error terms across
equations, the chi-squared test for equality of the coe¢ cient estimate of
in equation 3 has a p-value that is smaller than 0.001.

in equation 2 and the estimate of

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

25

believe that the variation in producer prices may re‡ect more than productivity di¤erences
in practice. The objective of this subsection is to discuss how the introduction of additional factors of production would a¤ect our empirical analysis and the interpretation of our
empirical results.
The …rst thing to notice is that our main speci…cation, Equation (17), does not rely on
the assumption that there only is one factor of production (or that there are no intermediate
inputs to production). Our theory is fundamentally one of comparative costs. These costs relate one-for-one with producer prices in a perfectly-competitive setting, regardless of whether
the determinants of production costs are productivity or factor price di¤erences. With multiple factors of production (or intermediate inputs), the relationship between bilateral imports
and producer prices would still be given by Equation (17), with

now representing intra-

industry heterogeneity in terms of Total Factor Productivity (TFP).32 Thus, the only issue
related to the previous empirical results is one of interpretation, to which we now turn.
Econometrically, our IV estimates re‡ect the impact of predicted changes in producer
prices conditional on R&D expenditures. If R&D expenditures a¤ect producer prices only
through changes in TFP, our IV estimates should therefore capture, in line with our Ricardian
interpretation, the impact of TFP di¤erences on bilateral trade ‡ows. In order to assess the
validity of this interpretation formally, we estimate

using a measure of TFP rather than

producer price data. Since the GGDC Productivity Level Database also reports data on
the prices and shares of labor, capital, and material inputs, (log-) TFP measures can be
computed in the standard ‘dual’fashion: as the (log-) di¤erence between the producer price
and the sum of (log-) factor prices weighted by their factor shares, as in Jorgensen and
Griliches (1967).33
Having constructed this dual TFP measure of productivity in order to control for factor
price and intensity di¤erences, we then regress exports on productivity, as in Equation (17),
using this TFP measure of productivity rather than producer prices as before. The new IV
estimate of

in this regression is reported in column 2 of Table 4. While the estimate of

increases slightly to 6:70 (when compared with our previous estimate of 6:53, reported
32 The

proof is trivial and omitted; see e.g. Appendix E in Costinot and Komunjer (2007).
k
k
is, our ‘dual’ (log-) TFP measure is calculated as ln T F Pik = ln pki
i;L ln wi

33 That
k
i;M

and

ln mki , where the variables
wik ,

rik

and

mki

k
i;K

ln rik

refer to factor shares of labor, capital and material inputs, respectively,

refer to the wage rate, capital rental rate, and material inputs price, respectively.

26

COSTINOT, DONALDSON, AND KOMUNJER

Table 4: Cross-Sectional Results - Alternative Productivity Measures
Dependent variable in all regressions: corrected exports
(1)
log (productivity based on producer prices)

(2)

(3)

(4)

6.534***
(0.708)

log (productivity based on producer prices,

6.704***

dual TFP measure)

(0.874)

log (productivity based on real gross

2.735***

output per worker)

(0.239)

log (productivity based on real gross

4.341***

output, primal TFP measure)

(0.521)

Observations

5,576

5,576

5,353

4,357

R-squared

0.747

0.587

0.825

0.821

Notes : Regressions are based on estimating equation (17) using data from 21 countries and 13 manufacturing sectors
(listed in Table 1) in 1997. All regressions estimated use the log of 1997 R&D expenditure as an instrument for the
productivity measure, and w ith exporter-times-importer and industry-times-importer fixed effects included. 'Corrected
exports' is the value of bilateral exports divided by the share of the exporting country's total expenditure in the given
industry that is sourced domestically (equal to one minus the country and industry's import penetration ratio). 'Productivity
based on producer prices' is the inverse of the average producer price in an exporter-industry. 'Productivity based on
producer prices, dual TFP measure' is the inverse of the average producer price divided by an income share-w eighted
composite of producer input prices (w ages, capital rental rates and intermediate inputs), as defined in footnote 33.
'Productivity based on real gross output per w orker' is a nominal measure of gross output, deflated by average gross
output producer price indices. 'Productivtiy based on real gross output, primal TFP measure' is the nominal value of gross
output deflated by a producer gross output price index, divided by an income share-w eighted composite of input values
deflated by input price indices, as defined in footnote 35. Data sources and construction are described in full in Section
4.1. Heteroskedasticity-robust standard errors are reported in parentheses. *** indicates statistically significantly different
from zero at the 1% level.

again in column 1 of Table 4 for convenience) it is still positive and signi…cantly di¤erent
from zero, in line with Theorem 3. Further, this new estimate lies comfortably within the 95
percent con…dence interval of our previous estimate (and also within the bounds of estimates
of

previously obtained in the literature, as discussed above). Both of these …ndings lend

strong support to our Ricardian interpretation of the results presented in Table 3. Although
our use of relative producer prices to measure relative productivity is a priori consistent
with any theory of comparative costs— regardless of the number of non-tradable factors of

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

27

production— the estimates in columns 1 and 2 of Table 4 imply that Ricardian motives
for cross-industry trade (at least those contained in the component of productivity that is
correlated with R&D expenditure) appear to be orthogonal to Heckscher-Ohlin motives in
our data.34
The remaining two columns of Table 4 report estimates from regressions in which two
alternative proxies for productivity are used. These alternatives are all variations of ‘primal’
measures of labor and multi-factor productivity: real gross output per worker and TFP
calculated in the primal manner rather than the dual manner introduced above.35 Each
column contains the resulting estimate of

from a separate regression, each of which is an

IV regression of Equation (17) using one of the above alternative productivity proxies as a
measure of zeik .

Estimates of

based on these alternative productivity measures are both somewhat lower

than our preferred estimate (in column 1). This is consistent with the idea that these
alternative productivity proxies are mismeasured (and that this measurement error problem
is not entirely obviated by our instrumental variable procedure). As we have argued above,
in a Ricardian environment relative producer prices contain all of the relevant information
about relative productivity levels. Because our two alternative productivity measures are
constructed using data on producer prices plus additional variables (such as nominal output
and the number of workers in the case of real output per worker), these two measures are
e¤ectively our preferred productivity measure plus some variables carrying additional scope
for measurement error.36 That is, in the light of a Ricardian model, it is natural that column
34 This

…nding echoes the work of Morrow (2009).
alternative productivity proxies are reported in the GDDC database and are constructed in a

35 These

standard fashion. That is, real gross output per worker is constructed as the nominal value of gross output
per worker in an exporter-industry divided by the producer price index and ‘primal’ TFP is calculated as
ln T F Pik = ln Yik

k
iK

ln Kik

k
iL

ln Lki

k
iM

ln Mik , where Yik , Kik , Lki and Mik represent real values of

gross output, capital, labor and intermediate inputs respectively (where these real values are computed as
the ratio of nominal values over the relevant price index), and the terms represent income shares.
36 Consider the example of real gross output per worker, a productivity measure that has been used
extensively in the empirical Ricardian literature. This variable is computed as nominal gross output per
worker divided by a producer price index (i.e., by our preferred productivity measure). Since nominal gross
output per worker should be equal— in our Ricardian setting— to the nominal wage which is equal across
sectors, any divergence between relative real gross output per worker and relative (inverse) producer prices

28

COSTINOT, DONALDSON, AND KOMUNJER

1 contains a larger estimate of

than columns 3 and 4 because it is based on the measure

of productivity that is least likely to be mismeasured.
4.4. Alternative Samples. In this section we explore the extent to which our estimate of
= 6:53, obtained above, is robust to a number of alternative samples. The …rst sample
restriction we consider is to country- pairs in the EU only, which we use to test how our
results depend on our assumption of orthogonality between relative trade costs and relative
productivity. The second set of sample restrictions we consider is to observations for which
we have increased con…dence that producer prices were collected in a manner consistent
with our theory. In all of these sample restrictions our estimate of

is reassuringly robust

(varying from 4:62 to 8:06) and within the bounds of previous estimates in the literature.
4.4.1. Endogenous Trade Protection. In Section 4.2, we have described two potential sources
of bias of our OLS estimates and discussed how they could be addressed by an IV strategy.
This IV strategy, however, does not obviate issues related to endogenous trade protection,
which could bias our estimates downward.37 In order to address this issue, we now estimate
Equation (17) again by IV but on a sample that includes EU exporters and importers only.38
per worker must be due to measurement error in nominal output per worker (due to measurement error in
nominal output or the number of workers).
37 To see that our IV estimate of
would be biased towards zero under endogenous trade protection,
suppose, using again the more compact notation of Equation (16), that trade barriers, dkij , and exports, xkij ,
are simultaneously determined according to:
0

k
dk
ij di0 j 0

ln
ln
where

2

ln

= ln

0

x
ek
ek
ij x
i0 j

0 k
x
ek
ei0 j
ij x
0
z
eik z
eik0
0 k
k
z
ei z
ei

,
ln

0

k
dk
ij di0 j 0

0 k
dk
ij di0 j 0

,

> 0 captures the fact that higher levels of import penetration lead to higher levels of protection. The

previous system implies ln
(1 +

=

0 k
dk
ij di0 j 0
k k0
x
eij x
ei0 j
0 k
x
ek
ei0 j
ij x

)

1

(1 +

38 That is,

2

)

ln
1

0

z
eik z
eik0
0 k
k
z
ei z
ei

E[ ln

0

x
ek
ek
ij x
i0 j

0 k
x
ek
ei0 j
ij x

. If ln
0

z
eik z
eik0
0 k
z
eik z
ei0

= ln
0

z
eik z
eik0
0 k
k
z
ei z
ei0
2

=

0

z
eik z
eik0
0 k
z
eik z
ei

ln

+ ln
0

Rik Rik0
0
Rik Rik0

0

k
"k
ij "i0 j 0

0 k
"k
ij "i0 j 0

with

where ln

0

k
"k
ij "i0 j 0

0 k
"k
ij "i0 j 0

> 0, then E[ln

=
0

Rik Rik0
0
Rik Rik0

ln
ln

0

k
dk
ij di0 j 0

0 k
dk
ij di0 j 0
k0
"k
ij "i0 j 0
0 k
"k
ij "i0 j 0

=
]=

] < 0, leading to downward bias in the IV estimate of .

we restrict the sample to exporting and importing countries that were in the European Economic

Area in 1997: Belgium-Luxembourg, Denmark, Spain, Finland, France, Germany, Greece, Ireland, Italy,
Netherlands, Portugal, Sweden and the UK.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

29

Table 5: Cross-Sectional Results - Alternative Samples
Dependent variable in all regressions: corrected exports

Entire
sample

Producer
Producer
EU member
price data
price data
countries
below median above median
only
quality
quality

(1)

(2)

(3)

(4)

6.534***

4.621***

5.820***

8.057***

(0.708)

(0.585)

(1.106)

(1.267)

Observations

5,576

2,162

2,795

2,781

R-squared

0.747

0.808

0.820

0.688

log (productivity based on producer prices)

Notes : Regressions are based on estimating equation (17) using data from 21 countries and 13 manufacturing sectors
(listed in Table 1) in 1997. All regressions instrument for productivity using log R&D expenditures in 1997, and include
exporter-times-importer fixed effects and industry-times-importer fixed effects. 'Corrected exports' is the value of bilateral
exports divided by the share of the exporting country's absorption in the given industry that is sourced domestically (equal
to one minus the country and industry's import penetration ratio). 'Productivity based on producer prices' is the inverse of
the average producer price in an exporter-industry. 'Producer price data quality' is based on the percentage of underlying
price data observations w ithin the exporter-industry that w ere obtained (in the creation of the GGDC dataset) using
producer price data rather than expenditure price data. Data sources and construction are described in full in Section 4.1.
Heteroskedasticity-robust standard errors are reported in parentheses. *** indicates statistically significantly different from
zero at the 1% level.

Within this free trade area there are no trade barriers and, hence, no scope for endogenous
trade protection.
The results from restricting our sample to EU members are reported in column 2 of Table
5. Our preferred estimate of

is reasonably stable to this sample restriction: it falls to 4:62,

which still lies within the 95 % con…dence interval of our previous estimate of 6:53 (reported
again in column 1 of Table 5 for convenience) and remains statistically signi…cant despite the
reduction in sample size. It therefore appears that our estimates are unlikely to be biased
due to endogenous trade protection.

4.4.2. Producer vs. Expenditure Prices. In an open economy, goods price data are only informative about domestic productivity di¤erences to the extent that they re‡ect domestic

30

COSTINOT, DONALDSON, AND KOMUNJER

producer rather than expenditure prices. Unfortunately, though most of the GGDC’s internationally comparable price estimates are based on aggregations of micro-level observations
of producer prices, in order to achieve a complete sample the GGDC were forced to include
some observations of expenditure prices. Helpfully, however, the GGDC has published data
on the share of raw price observations, within each country and industry, that were obtained
from producer rather than expenditure accounts.39 We can therefore use this information
to explore how our estimates change as we restrict our sample to the observations that are
best suited to measuring producer productivity— namely, those that are drawn from underlying observations of producer rather than expenditure prices. In particular, we can rank
the exporter-industry observations by the percentage of price data based on producer prices,
and split our sample into groups of ‘price data quality’based on this ranking.
Our previous results (in Tables 3 and 4) were based on the entire sample of price data.40
By contrast, column 3 of Table 5 reports IV results based on two di¤erent samples that are
partitioned based on the quality of their producer price data— column 3 reports results for
the sample that contains only exporter-industry observations with below-median price data
quality and column 4 presents those with above-median price data quality. Our preferred
estimate of

is again reassuringly stable— given the standard errors on these estimates— to

this sample truncation, changing from 6:53 (whole sample in column 1) to 5:82 (below-median
quality sample in column 3) to 8:06 (above-median quality sample in column 4). Overall,
we believe that the cluster of estimates of
con…dence to our preferred estimate of

presented in Tables 4 and 5 adds considerable

= 6:53.

4.5. Summary. What have we learned from the cross-sectional results in Tables 3-5? Our
…ndings can be summarized as follows:
(1) Most importantly, the theoretical predictions of Theorem 3 are consistent with the
data. That is, relative export levels across countries and industries, corrected for
trade-driven selection, are positively correlated with relative productivity levels across
countries and industries. Further, the correction procedure suggested by Theorem 3
39 This

information is tabulated in Appendix Tables 2 and 3 of Timmer, Ypma, and van Ark (2007). We

have digitized the content of these tables so that it is included in the dataset used in the present paper.
40 The median observation in the unrestricted sample, used in column 1 of Table 5, is based on underlying
price observations that are comprised of 84 % producer prices and 16 % expenditure prices.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

31

is quantitatively important: failure to correct export ‡ows in this manner leads to
bias that is both substantial (from 6:53 to 11:1), and in the direction suggested by
our Ricardian model.
(2) Our preferred estimate of

= 6:53— which captures intra-industry heterogeneity à

la Eaton and Kortum (2002)— is comfortably in line with previous estimates of this
coe¢ cient obtained in the literature, even though these estimates have been obtained
using remarkably di¤erent methodologies.
(3) The di¤erence between our OLS and IV estimates of

suggests severe measurement

error in international productivity levels, which should not be surprising given the
well-known challenges of measuring internationally comparable productivity levels
across countries and industries.
(4) Our estimate of

is extremely similar,

= 6:70, when using a productivity measure

that strips out variation in factor intensity and factor prices across countries and
industries, thereby giving support to the Ricardian interpretation of our results.
(5) Finally, our estimates of are robust to a number of sample restrictions that alleviate,
among other things, concerns of bias due to endogenous trade protection.
Taken together these empirical results provide support for the ability of the Ricardian
model to explain the pattern of trade across countries and industries. Comforted by such
results, we go on to ask: In today’s world trading system, how important— in a well-de…ned,
welfare-based sense— are Ricardian forces?
5. Counterfactual Results
In order to investigate further the quantitative importance of productivity di¤erences,
we use Theorem 5 to ask the following counterfactual questions: What if, for any pair
of exporters, there were no fundamental relative productivity di¤erences across industries?
What would be the consequences for aggregate trade ‡ows and welfare? As mentioned earlier,
we refer to this counterfactual exercise as ‘Removing a country’s Ricardian comparative
advantage’, though it is important to stress that in our model there are also Ricardian
motives within each industry that our counterfactual exercise will leave intact.
5.1. Preliminary: Revealed Productivity. The formal procedure to compute our counterfactuals is as described in Section 3.3. However, to compute the initial productivity levels,

32

COSTINOT, DONALDSON, AND KOMUNJER

zik , that enter Equation (13) we do not to use producer price data from the GGDC Productivity Level Database, which, as argued in Section 4, su¤er from severe measurement error.41
Instead, we use our model to obtain ‘revealed’measures of productivity at the country and
industry level. Formally, we estimate
ln xkij =

(18)
where

ij ,

k
j,

and

k
i

ij

+

k
j

+

k
i

+ "kij ,

are exporter-importer, importer-industry, and exporter-industry …xed-

e¤ects, respectively. According to our model, bilateral trade ‡ows satisfy
ln xkij =
Hence estimates of

k
i

ij

+

k
j

+ ln zik + "kij .

can be used to construct revealed measures of productivity, e

k
i=

, in

country i and industry k. These measures, which will be used in all of our counterfactual
procedures below, are reported in Table 6.42 As in Table 2, note that productivity levels
have been normalized to one in all industries for the United States and in all countries for
the Food industry.43
Before turning to our counterfactual results, it is worth pointing out that this simple way
of computing revealed measures of productivity, while not the main focus of our paper, provides a theoretically-consistent alternative to Balassa’s (1965) well-known index of ‘revealed
comparative advantage.’ Like Balassa (1965), we o¤er a methodology that uses data on
relative exports to infer the underlying pattern of comparative advantage across countries
41 In

Section 4, measurement error does not a¤ect our IV estimates of . Our IV strategy was precisely

designed to overcome measurement error in productivity and obtain coe¢ cient estimates that are purged of
attenuation bias.
42 Using revealed productivity measures does not alter our main results dramatically. If we use observed
productivity (measured as inverse producer prices) projected on our instrumental variable (R&D expenditure) our most important result, the world average welfare loss from moving ‘removing a country’s Ricardian
comparative advantage,’is 2.3 percent rather than 5.5 percent of the total gains from trade. As in Section
5.3, there also is considerable heterogeneity in this number across countries.
43 Of

ln zik

course, our …xed-e¤ect regression only identi…es
ln zik

0

ln zik0

ln z

k0
i0

k
i

k0
i

k
i0

k0
i0

, and therefore,

. These di¤erences-in-di¤erences, however, capture all of the essence of

comparative advantage in our Ricardian model, and are all that is necessary for our counterfactual predictions; see Lemma 4 and Theorem 5.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

33

Table 6: Revealed Relative Productivity Levels, by Country and Industry
Food

AUS
BEL
CZE
DEN
ESP
FIN
FRA
GER
GRE
HUN
IRE
ITA
JPN
KOR
NED
POL
PTL
SLK
SWE
UK
USA

1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1

TexChemMinMach- Elec- Trans- Misc.
Wood Paper Fuel
Plastic
Metals
tiles
icals
erals
inery trical port Manuf
0.91
1.14
1.35
0.91
1.13
1.09
1.07
1.21
1.15
1.13
0.84
1.42
1.50
1.68
0.96
1.18
1.54
1.31
1.14
1.15
1

0.72
0.86
1.15
0.84
0.85
1.52
0.82
0.96
0.58
0.89
0.64
0.91
0.87
0.84
0.68
1.05
1.31
1.23
1.36
0.74
1

0.63
0.91
1.07
0.77
0.87
1.69
0.91
1.05
0.74
0.85
1.09
0.96
1.30
0.92
0.87
0.92
1.03
1.15
1.39
1.03
1

0.74
1.03
0.93
0.65
0.81
0.97
0.96
0.98
0.84
0.78
0.60
0.82
1.10
0.86
0.95
0.99
0.79
0.77
1.16
1.08
1

0.76
1.05
1.05
0.77
0.87
1.05
0.97
1.07
0.73
0.90
1.01
0.96
1.66
1.20
0.91
0.93
0.88
1.12
1.09
1.01
1

0.74
1.07
1.21
0.90
1.03
1.18
1.00
1.19
0.84
0.99
0.86
1.16
1.82
1.45
0.93
1.00
1.05
1.32
1.24
1.07
1

0.69
1.07
1.55
0.81
1.15
1.19
1.05
1.16
1.00
1.06
0.76
1.26
1.72
1.03
0.86
1.18
1.30
1.48
1.15
1.08
1

0.88
1.11
1.40
0.89
1.08
1.46
1.07
1.25
0.97
1.07
0.83
1.20
1.73
1.37
0.96
1.27
1.06
1.62
1.40
1.13
1

0.71
0.88
1.11
0.83
0.84
1.17
0.87
1.08
0.66
0.83
0.74
1.08
1.77
1.20
0.77
0.86
0.89
1.08
1.14
0.95
1

0.72
0.79
0.89
0.73
0.76
1.19
0.84
0.97
0.59
0.88
0.94
0.85
1.78
1.32
0.82
0.83
0.90
0.91
1.09
0.95
1

0.68
0.88
1.08
0.64
0.96
0.91
0.90
1.08
0.50
0.85
0.57
0.91
1.89
1.41
0.75
0.84
0.96
0.90
1.04
0.93
1

0.77
0.97
1.22
0.85
0.94
1.08
0.89
1.03
0.75
0.83
0.81
1.19
1.70
1.33
0.83
1.05
0.93
1.15
1.12
0.99
1

Notes: Country and industry productivity, as measured by estimates of exporter-industry fixed effects in the estimation of equation
(18). Entries are normalized to reflect relative productivity levels in the manner suggested by equation (10). That is, within each
industry the USA has productivity equal to 1, and within each country the 'Food' industry (ISIC Rev 3.1 code: 15-16) has productivity
equal to 1. Countries are listed in the order presented in Table 1.

and industries.44 There are, however, two important di¤erences between Balassa’s (1965)
approach and ours. First, our empirical strategy is theoretically grounded. The ranking of
the OLS estimates of
ln zik

k
US

k
i

, for instance, is the empirical counterpart to the ranking of

ln zUk S in our model. By contrast, in our model Balassa’s index would not, in gen-

eral, provide a ranking of relative productivity levels. Second, our approach fundamentally
44

In Balassa (1965), the revealed comparative advantage of country i in industry k is formally de…ned as
. P
PK
PI PK
I
k0
k
k0
k
k0 =1 xiW orld
i0 =1 xi0 W orld =
i0 =1
k0 =1 xi0 W orld where xiW orld are the total exports of

xkiW orld =

country i in industry k.

34

COSTINOT, DONALDSON, AND KOMUNJER

is about the pair-wise comparisons across exporters and industries that are at the core of
comparative advantage in a Ricardian world. Put simply, our …xed e¤ects aim to uncover
which of Portugal and England is the country relatively better at producing wine than cloth.
They do not try to assess whether Portugal is good at producing wine compared to an intuitive but ad-hoc benchmark. Unlike Balassa (1965), we do not aggregate exports across
countries and industries, which— according to our model— allows us to separate the impact
of productivity di¤erences from trade costs and demand di¤erences.
5.2. Trade Flows. We …rst consider the impact of ‘removing a country’s Ricardian comparative advantage’on trade ‡ows. For each country and industry, we compute changes in
total exports (to all destination countries combined) using Equation (14). The …rst column
of Table 7 describes the change in total exports for the reference country, i.e. the country
whose productivity remains unchanged. The overall picture is clear: on average, total trade
volumes change very little. This should not come as a surprise. By construction, wages,
and hence GDP levels, are unchanged in the counterfactual equilibrium. Thus, total trade
volumes, which are related to the dispersion of GDP levels across countries, do not change
very much either on average.
Intuitively, the main impact of our counterfactual exercise should be on the share of
inter-industry trade. If there were no trade costs and no di¤erences in preferences across
countries, then ‘removing a country’s Ricardian comparative advantage’would eliminate all
inter-industry trade, i.e. trade would be balanced industry-by-industry. To explore this idea
systematically, we use a linear transformation of the Grubel and Lloyd (1975) index. For
.P
P
k
k
k
k
each country i and industry k, we compute 100
x
x
ij
ji
j6=i xij + xji . If all
j6=i
trade were intra-industry trade, this index would be equal to zero. Conversely, if all trade

were inter-industry trade, it would be equal to 100. In our data the mean value of this index
is 26:9, which resonates with the well-known fact that the majority of trade among OECD
countries is intra-industry when industries are measured at the 2-digit level.
The second column of Table 7 reports the change in the previous index averaged across
all industries (weighted by total trade in each industry). As expected, the extent of interindustry trade goes down for most reference countries. Note, however, that: (i) ‘removing
a country’s Ricardian comparative advantage’never gets rid of all inter-industry trade; and
(ii); inter-industry trade may actually go up for some countries after Ricardian comparative

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

35

Table 7: Counterfactual Results - Baseline
Outcome variable of interest:

Reference country:

% change in
welfare relative
% change in
to the total
welfare
gains from
trade

% change in
total exports

change in
index of interindustry trade

(1)

(2)

(3)

(4)

Australia

18.53

-23.90

-2.91

-39.21

Belgium & Luxembourg

-1.72

4.47

0.68

2.53

Czech Republic

3.89

6.05

-0.10

-1.08

Denmark

0.59

-2.85

-0.43

-2.36

Spain

3.69

-3.85

-0.45

-7.01

Finland

-5.67

2.00

0.04

0.46

France

0.80

-0.43

-0.20

-3.10

Germany

-2.10

-7.97

0.14

2.20

Greece

26.46

-12.62

-4.47

-41.40

Hungary

1.73

-5.97

-0.27

-1.78

Ireland

-5.71

-5.57

0.12

0.44

Italy

-4.76

-9.54

0.14

2.69

Japan

-6.13

-25.99

0.34

23.43

Korea

2.68

-10.12

-0.45

-9.83

Netherlands

2.00

-0.87

-0.61

-2.65

Poland

12.33

-22.30

-1.69

-23.20

Portugal

8.47

-14.10

-0.97

-9.63

Slovakia

2.28

14.41

0.83

4.66

Sweden

-2.99

3.22

0.36

3.56

United Kingdom

3.47

-4.06

-0.27

-3.10

United States

3.82

-3.19

-0.43

-11.87

World Average

2.94

-5.87

-0.51

-5.53

0

Notes: Results from counterfactual calculations in w hich, one at a time for each country listed (the 'reference
country'), every other country in the w orld is given the reference country's relative productivity levels across
industries, w hile adjusting each country's absolute productivity levels in such a w ay as to hold nominal w ages
fixed around the w orld (so as to neutralize terms-of-trade effects). The methodology follow s Lemma 4 and
Theorem 5. Column (1) reports the resulting proportional change in the total volume of the reference country's
exports. Column (2) reports the resulting change in the reference country's index of inter-industry trade (given
in Section 5.2); this index takes the value of 100 in the case of pure inter-industry trade, and zero in the case of
pure intra-industry trade. Column (3) reports the resulting proportional change in w elfare (equal to real income
spent on manufacturing) for the reference country; a negative number indicates a w elfare loss. And Column (4)
reports this change in w elfare as a percentage of the total gains from trade; a negative number indicates a
w elfare loss (and a value of -100 means that this loss is equal to that of moving to autarky). The row labeled
'World Average' reports the unw eighted average of the country-specific results above.

36

COSTINOT, DONALDSON, AND KOMUNJER

advantage has been removed. Two simple explanations for these patterns are the existence of
heterogeneous trade costs and heterogeneous preferences across countries in practice. We will
come back to both of these explanations in detail below, while investigating the importance
of Ricardian comparative advantage for welfare.
5.3. Welfare. To assess the welfare importance of Ricardian comparative advantage at the
industry level, we now compute changes in welfare in the reference country using Equation
(15). The last two columns of Table 7 present the change in welfare associated with removing Ricardian comparative advantage at the industry level. Seen through the lens of our
Ricardian model, eliminating relative industry-level productivity di¤erences across countries
leads, on average, to a 0:5% decrease of real income (spent on manufacturing), or only a
5:5% decrease in the overall gains from trade.45
This small average e¤ect, however, masks a tremendous amount of heterogeneity across
countries. Countries such as Australia and Greece appear to be strong bene…ciaries of interindustry Ricardian motives for trade— they each see over a third of their total gains from
trade eroded by our counterfactual scenario. For a few countries in our sample, however, the
removal of Ricardian comparative advantage actually leads to a welfare gain! Two obvious
candidates for explaining these surprising results— heterogeneous trade costs and heterogeneous tastes— were introduced brie‡y in Section 5.2. In a Ricardian model without trade
costs and with identical, homothetic preferences across countries, removing di¤erences in
relative productivity should always lower trade and welfare.46 In general, however, removing
such di¤erences may very well increase both trade ‡ows and welfare if relative productivity
di¤erences are initially correlated with trade costs or di¤erences in preferences (such that
45 Normalizing

the welfare impact of Ricardian comparative advantage by the total gains from trade

allows us to ignore considerations related to the size of the non-tradable sector, which would a¤ect both in
a proportional manner. The formula for the total gains from trade is a simple multi-sector extension of the
formula used by Eaton and Kortum (2002). It can be found, for example, in Donaldson (2008).
46 In the absence of intra-industry trade, removing relative productivity di¤erences leads to autarky,
which trivially lowers welfare. In the presence of intra-industry trade, as in our model, removing relative
productivity di¤erences no longer leads to autarky. Nevetherless, it is easy to check that holding nominal
wages …xed around the world (as we do in our counterfactual procedure), eliminating relative productivity
di¤erences, and hence inter-industry trade, necessarily minimizes welfare in the country whose Ricardian
comparative advantage has been removed.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

37

Table 8: Counterfactual Results - Robustness
Outcome variable of interest:
% change in
welfare relative
% change in
to the total
welfare
gains from
trade

% change in
total exports

change in
index of interindustry trade

(1)

(2)

(3)

(4)

Baseline (as in Table 7)

2.94

-5.87

-0.51

-5.53

No preference differences

2.69

-5.39

-1.58

-11.76

No trade costs

3.46

-11.37

-0.75

-10.09

No preference diffs. or trade costs

3.57

-11.38

-2.82

-27.28

Counterfactual scenario:

Notes: Results from counterfactual calculations in w hich, one at a time for each country listed (the 'reference
country'), every other country in the w orld is given the reference country's relative productivity levels across
industries, w hile adjusting each country's absolute productivity levels in such a w ay as to hold nominal w ages fixed
around the w orld (so as to neutralize terms-of-trade effects). The methodology follow s Lemma 4 and Theorem 5.
Column (1) reports the resulting proportional change in the total volume of the reference country's exports. Column
(2) reports the resulting change in the reference country's index of inter-industry trade (given in Section 5.2); this
index takes the value of 100 in the case of pure inter-industry trade, and zero in the case of pure intra-industry
trade. Column (3) reports the resulting proportional change in w elfare (equal to real income spent on
manufacturing) for the reference country; a negative number indicates a w elfare loss. And Column (4) reports this
change in w elfare as a percentage of the total gains from trade; a negative number indicates a loss (and a value of 100 means that this loss is equal to that of moving to autarky). Unw eighted w orld average effects (averaging
across all reference countries) of such counterfactuals are reported. The methodology follow s Lemma 4 and
Theorem 5. The 'No preference differences' scenario calculates w orld expenditure shares across goods such that
these shares are identical across countries. The 'No trade costs' scenario calcuates trade flow s in such a w ay
that idiosyncratic trade cost differences are zero; see footnote 47 for details.

the initial scope for gains from trade due to productivity di¤erences is o¤set by that due to
trade costs or preference di¤erences).
A simple way to investigate the quantitative importance of each of these two explanations
is to redo our counterfactual exercises under the assumption that expenditure shares do not
di¤er across countries, and that trade costs satisfy dkij = dij dkj , which, as shown in Corollary
2, implies that trade costs no longer a¤ect the pattern of inter-industry trade.47 The results of
47 Formally,

in scenario (i), we assume that shares of expenditures

k
j

in country j and industry k are equal

to the world share of expenditure in industry k (so that all countries have the same expenditure shares).
And in scenario (ii), we assume that trade ‡ows are equal to ln xkij =

ij

+

k
j

+

k
i;

that is, we assume that

38

COSTINOT, DONALDSON, AND KOMUNJER

our new counterfactuals are reported in Table 8. On average, the welfare impact of Ricardian
comparative advantage as a fraction of the total gains from trade (reported in column 4 of
Table 8) goes up from 5:5% in our baseline scenario to: (i) 11:8% in the absence of preference
di¤erences; (ii) 10:1% in the absence of trade costs violating dkij = dij dkj ; and (iii), 27:3% in
the absence of both. The results of this extension for all countries are presented in Table A1
(in Appendix C). As expected, the welfare change only becomes negative for all countries
under scenario (iii) since only this scenario assumes a world in which the only source of
comparative advantage is relative productivity di¤erences.
The previous results point towards the importance of trade costs and demand di¤erences
for thinking about the consequences of technology di¤usion. In a textbook Ricardian model,
if China gets access to the United States’s technology, then trade ‡ows and welfare will fall
in the United States; see e.g. Samuelson (2004). By contrast, in a world with trade costs
and demand di¤erences across countries, the exact same pattern of technology di¤usion may
very well increase both trade and welfare in both countries. While exploring this possibility
further is not the focus of our paper, the results presented in Table 8 are consistent with
this idea.
6. Concluding Remarks
The Ricardian model has long been perceived as a useful pedagogical tool with, ultimately, little empirical content. Over the last twenty years, the Heckscher-Ohlin model,
which emphasizes the role of cross-country di¤erences in factor endowments, has generated
a considerable amount of empirical work; see e.g. Bowen, Leamer, and Sveikauskas (1987),
Tre‡er (1993), Tre‡er (1995), Davis and Weinstein (2001), and Schott (2004). In contrast,
the Ricardian model, which emphasizes productivity di¤erences, has generated almost none.
The main reason for this lack of attention is not the existence of strong beliefs regarding
the relative importance of factor endowments and technological considerations. Previous
empirical work on the Heckscher-Ohlin model unambiguously shows that technology matters. It derives instead from the obvious mismatch between the real world and the extreme
assumptions of the standard two-country Ricardian model. Although the de…ciencies of the
the error term, "kij , in Equation (18) exists only due to measurement error in trade ‡ows and should be
disregarded in a counterfactual analysis that assumes dkij = dij dkj .

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

39

Ricardian model have not lead to the disappearance of technological considerations from the
empirical literature, it has had a strong in‡uence on how the relationship between technology
and trade has been studied. In the empirical Heckscher-Ohlin-Vanek literature, the factor
content of trade— rather than the commodity pattern of trade— remains the main variable
of interest.
Building on the seminal work of Eaton and Kortum (2002), the present paper has developed a structural Ricardian model that puts productivity di¤erences at the forefront of
the analysis of a core question in international economics: What goods do countries trade?
Using this model, we have estimated the impact of productivity di¤erences on the pattern
of trade across countries and industries without having to rely on bilateral comparisons inspired by a two-country model, unclear orthogonality conditions, ad-hoc measures of export
performance, or measures of productivity that are systematically biased due to trade-driven
selection— all of which are limitations of the existing empirical Ricardian literature.
Using trade and productivity data from 1997, we have estimated the key structural parameter of the model, , which governs the elasticity with which increases in observed productivity levels, ceteris paribus, lead to increased exports. Our estimate of this elasticity,
= 6:53, is positive (in agreement with our Ricardian theory), robust to alternative estimation procedures, and lies comfortably within the range of existing estimates in the literature,
despite our novel method for obtaining it. Finally, we have used our model to quantify the
importance of inter-industry Ricardian forces in today’s world economy by measuring the
welfare consequences of removing Ricardian comparative advantage at the industry level.
According to our estimates, the disappearance of such forces would only lead, on average,
to a 5:5% decrease in the total gains from trade.

References
Acemoglu, D., P. Antras, and E. Helpman (2007): “Contracts and Technology Adoption,”The American Economic Review, 97(3), 916–943.
Al-Najjar, N. (2004): “Aggregation and the Law of Large Numbers in Large Economies,”
Games and Economic Behavior, pp. 1–35.
Balassa, B. (1963): “An Empirical Demonstration of Comparative Cost Theory,” The
Review of Economics and Statistics, pp. 231–238.

40

COSTINOT, DONALDSON, AND KOMUNJER

(1965):

“Trade Liberalization and Revealed Comparative Advantage,” The

Manchester School of Economic and Social Studies, 33, 99–123.
Beck, T. (2003): “Financial Dependence and International Trade,”Review of International
Economics, 11, 296–316.
Bernard, A. B., J. Eaton, J. B. Jensen, and S. Kortum (2003): “Plants and Productivity in International Trade,”The American Economic Review, pp. 1268–1290.
Bhagwati, J. (1964): “The Pure Theory of International Trade: A Survey,”The Economic
Journal, pp. 1–84.
Billingsley, P. (1995): Probability and Measure. John Wiley & Sons, Inc.
Bowen, H. P., E. E. Leamer, and L. Sveikauskas (1987): “Multicountry, Multifactor
Tests of the Factor Abundance Theory,”The American Economic Review, pp. 791–809.
Burstein, A., and J. Vogel (2010): “Globalization, Technology, and the Skill Premium,”
Unpublished Manuscript, Columbia University and UCLA.
Caliendo, L., and F. Parro (2009): “Estimates of the Trade and Welfare E¤ects of
NAFTA,”Unpublished Manuscript, University of Chicago.
Chor, D. (2008): “Unpacking Sources of Comparative Advantage: A Quantitative Approach,”Working Papers 13-2008, Singapore Management University.
Costinot, A. (2005): “Three Essays on Institutions and Trade,” Ph.D. Dissertation,
Princeton University.
(2009): “On the Origins of Comparative Advantage,” Journal of International
Economics, 77(2), 255–264.
Costinot, A., and I. Komunjer (2007): “What Goods Do Countries Trade? New Ricardian Predictions,”NBER Working Paper No. 13691.
Cuñat, A., and M. Melitz (2010): “Volatility, Labor Market Flexibility and Comparative
Advantage,”Journal of the European Economics Association, forthcoming.
Davidson, J. (1994): Stochastic Limit Theory. Oxford University Press, Oxford.
Davis, D. R. (1995): “Intra-Industry Trade: A Heckscher-Ohlin-Ricardo Approach,”Journal of International Economics, 39(3-4), 201–226.
Davis, D. R., and D. E. Weinstein (2001): “An Account of Global Factor Trade,” The
American Economic Review, pp. 1423–1453.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

41

Deardorff, A. V. (1984): “Testing Trade Theories and Predicting Trade Flows,” in
Handbook of International Economics, ed. by R. W. Jones, and P. B. Kenen, vol. 1, pp.
467–517. Amsteram: North Holland.
Dekle, R., J. Eaton, and S. Kortum (2008): “Global Rebalancing with Gravity: Measuring the Burden of Adjustment,”IMF Sta¤ Papers, 55(3), 511–540.
Donaldson, D. (2008): “Railroads of the Raj: Estimating the Impact of Transportation
Infrastructure,”Unpublished Manuscript, MIT.
Dornbusch, R., S. Fischer, and P. Samuelson (1977): “Comparative Advantage,
Trade, and Payments in a Ricardian Model with a Continuum of Goods,”The American
Economic Review, 67, 823–839.
Eaton, J., and S. Kortum (2002): “Technology, Geography, and Trade,” Econometrica,
70, 1741–1779.
Foster, L., J. Haltiwanger, and C. Syverson (2008): “Reallocation, Firm Turnover,
and E¢ ciency: Selection on Productivity or Pro…tability?,” American Economic Review,
98(1), 394–425.
Golub, S. S., and C.-T. Hsieh (2000): “Classical Ricardian Theory of Comparative
Advantage Revisited,”Review of International Economics, pp. 221–234.
Griffith, R., S. Redding, and J. Van Reenen (2004): “Mapping the two faces of
R&D: productivity growth in a panel of OECD industries,”The Review of Economics and
½ 895.
Statistics, 86(4), 883U–
Harrigan, J. (1997a): “Cross-Country Comparisons of Industry Total Factor Productivity:
Theory and Evidence,”Federal Reserve Bank of New York Research Paper no. 9734.
(1997b): “Technology, Factor Supplies, and International Specialization: Estimating the Neo-Classical Model,”The American Economic Review, pp. 475–494.
(2005): “Airplanes and Comparative Advantage,”NBER working paper 11688.
Helpman, E., and P. R. Krugman (1985): Market Structure and Foreign Trade. MIT
Press.
Jones, R. W. (1961): “Comparative Advantage and the Theory of Tari¤s: A Multi-Country,
Multi-Commodity Model,”The Review of Economic Studies, 28(3), 161–175.
Jorgensen, D., and Z. Griliches (1967): “The Explanation of Productivty Change,”
Review of Economic Studies, 34 (3), 249–283.

42

COSTINOT, DONALDSON, AND KOMUNJER

Kerr, W. R. (2009): “Heterogeneous Technology Di¤usion and Ricardian Trade Patterns,”
Unpublished Manuscript, Harvard Business School.
Leamer, E., and J. Levinsohn (1995): “International Trade Theory: The Evidence,”
in Handbook of International Economics, ed. by G. Grossman, and K. Rogo¤, vol. 3, pp.
1139–1194. Elsevier Science, New York.
Levchenko, A. (2007): “Institutional Quality and International Trade,” The Review of
Economic Studies, 74(3), 791–819.
MacDougall, G. (1951): “British and American Exports: A Study Suggested by the
Theory of Comparative Costs, Part I,”Economic Journal, 61(244), 697–724.
Manova, K. (2008): “Credit Constraints, Equity Market Liberalizations and International
Trade,”Journal of International Economics, 76, 33–47.
Matsuyama, K. (2005): “Credit Market Imperfections and Patterns of International Trade
and Capital Flows,”Journal of the European Economic Association, pp. 714–723.
Morrow, P. (2009): “East is East and West is West: A Ricardian-Heckscher-Ohlin Model
of Comparative Advantage,”Unpublished manuscript, University of Toronto.
Nunn, N. (2007): “Relationship-Speci…city, Incomplete Contracts, and the Pattern of
Trade,”Quarterly Journal of Economics, 122(2), 569–600.
Romalis, J. (2004): “Factor Proportions and the Structure of Commodity Trade,” The
American Economic Review, pp. 67–97.
Samuelson, P. A. (2004): “Where Ricardo and Mill Rebut and Con…rm Arguments of
Mainstream Economists Supporting Globalization,” Journal of Economic Perspectives,
18(3)(3), 135–146.
Schott, P. (2004): “Across-Product versus Within-Product Specialization in International
Trade,”Quarterly Journal of Economics, pp. 647–678.
Shikher, S. (2004): “Putting Industries into the Eaton-Kortum Model,”Unpublished Manuscript, Su¤olk University.
(2008): “Predicting the e¤ects of NAFTA: Now we can do it better!,”Unpublished
Manuscript, Su¤olk University.
Simonovska, I., and M. E. Waugh (2009): “The Elasticity of Trade: Estimates and
Evidence,”Unpublished Manuscript, UC Davis and NYU.

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

43

Stern, R. M. (1962): “British and American Productivity and Comparative Costs in
International Trade,”Oxford Economic Papers, pp. 275–303.
Timmer, M. P., G. Ypma, and B. van Ark (2007): “PPPs for industry output: A new
dataset for international comparisons,”GGDC Research Memorandum GD-82, Groningen
Growth and Development Centre.
Trefler, D. (1993): “International Factor Price Di¤erences: Leontief was Right!,”Journal
of Political Economy, pp. 961–987.
(1995): “The Case of the Missing Trade and Other Mysteries,” The American
Economic Review, pp. 1029–1046.
Vogel, J. (2007): “Institutions and Moral Hazard in Open Economies,” Journal of International Economics, 71(2), 495–514.
Wilson, C. A. (1980): “On the General Structure of Ricardian Models with a Continuum
of Goods: Applications to Growth, Tari¤ Theory, and Technical Change,”Econometrica,
pp. 1675–1702.
Yeaple, S., and S. S. Golub (2007): “International Productivity Di¤erences, Infrastructure, and Comparative Advantage,”Review of International Economics, 15(2), 223–242.

44

COSTINOT, DONALDSON, AND KOMUNJER

Appendix A: Proofs of Theorems 1-5
Proof of Lemma 1. By Assumption A4, we know that bilateral trade ‡ows satisfy

xkij

=

=

P

!2

P

k
ij

!2

i1
pkj (!)

pkj (!)1

!2

P

h

h

k
j

k
j wj Lj

k
j

n
pkj (!)1I ckij (!) = min1
P
1
k
!2 pj (!)

oi1
k (!)
c
I i0 j

i0
k
j

k
j

k
j wj Lj

where the function 1If g is the standard indicator function. By Assumption A1, zik (!) is independent
and identically distributed (i.i.d.) across varieties so the same holds for ckij (!). In addition, zik (!) is
n
o
i.i.d. across countries so 1I ckij (!) = min1 i0 I cki0 j (!) is i.i.d. across varieties as well. This implies
o
n
k
k
that pkj (!)1 j and pkj (!)1 j 1I ckij (!) = min1 i0 I cki0 j (!) are i.i.d. across varieties. Moreover,
i
h
k
since kj < 1 + we have E pkj (!)1 j < 1 so we can use the strong law of large numbers for i.i.d.
random variables (e.g. Theorem 22.1 in Billingsley (1995) and the continuous mapping theorem
(e.g. Theorem 18.10 (i) in Davidson (1994)) to show that

xkij =

h
E pkj (!)1

n
1I ckij (!) = min1
i
h
k
E pkj (!)1 j

k
j

h
Consider Hijk (ck1j ; : : : ; ckIj )
E pkj (!)1
and straightforward computations yield
(19)

Hijk (ck1j ; : : : ; ckIj )

=

i0

oi
k (!)
c
0
I ij

n
1I ckij (!) = min1

k
j

+1
Z

ckij
v

k
j

1

0

i0

k
j wj Lj .

oi
k (!)
c
. Assumptions A1, A3
0
I ij

hY
cki0 j i
f (v)
F k v dv
ci0 j
i0 6=i

where Fik (z) = F (z=zik ) and we let f (u)
F 0 (u). Under the Fréchet Assumption A1, we have
(
+1)
F (z) = exp( z ) and f (z) = z
exp( z ).
Using Equation (19) together with the expressions for the Fréchet distribution and density, we
then have
h
n
oi
k
E pkj (!)1 j 1I ckij (!) = min1 i0 I cki0 j (!)
=

Z

0

(20)

=

+1

ckij
v

+1

1

k
j

v
k
j

+1

PI

exp

i0 =1

h

(ckij )
(cki0 j )

v

I
X
cki0 j

i0 =1

( +1

ckij

k )=
j

;

i

dv

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

where ( ) denotes the Gamma function, (t) =
E

h

pkj (!)1

k
j

i

=

I
X
i=1

h
E pkj (!)1

R +1
0

vt

1 exp(

v)dv for any t > 0. Note that

n
1I ckij (!) = min1

k
j

45

oi

k
i0 I ci0 j (!)

;

so that by using Equation (20) we get
h
E pkj (!)1

k
j

i

=

k
j

+1

I
k
i0 =1 (ci0 j )

and hence
(21)

1

hP

xkij = PI

(ckij )

i0 =1

i(1

k )=
j

;

k
j wj Lj .

(cki0 j )

With iceberg trade costs, Assumption A2, we have ckij = dkij wi =zik . Combining the previous expression with Equation (21) gives the result of Lemma 1.
Proof of Theorem 3. We make use of the following Lemma:
Lemma 6. Suppose that the triangular inequality in Assumption A2 holds. Then, for all countries
i and goods k,
n
o
k
k
k
0 I c 0 (!)
(22)
=
!
c
(!)
=
min
1
i
i
ii
ii
Proof of Lemma 6. We proceed by contradiction. Fix an exporter j, and suppose there exists a
variety ! 0 of good k and a country l 6= j such that:
(
ckjl (! 0 ) = min1 i0 I cki0 l (! 0 )
ckjj (! 0 ) 6= min1

Then, there must be an exporter i 6= j such that
(
dkjl wj =zjk (! 0 )

k
i0 I ci0 j (! 0 )

dkil wi =zik (! 0 )

dkjj wj =zjk (! 0 ) > dkij wi =zik (! 0 )

Since dkjj = 1, taking the ratio of the two inequalities above gives
dkil > dkij dkjl
which contradicts Assumption A2. This completes the proof of Lemma 6.
Proof of Theorem 3 (continued). By de…nition, we know that ckii (!) = dkii wi =zik (!). Using Lemma
6 then yields
h
i G (ck ; : : : ; ck )
ii 1i
Ii
(23)
zeik E zik (!) j! 2 ki =
dkii wi ,
k
ii

46

COSTINOT, DONALDSON, AND KOMUNJER

where we have let

h
n
E (ckii (!)) 1 1I ckii (!) = min1 i0
n
o
Pr ckii (!) = min1 i0 I cki0 i (!) .

Gii (ck1i ; : : : ; ckIi )
k
ii

oi

k
I ci0 i (!)

;

The expressions for Gii (ck1i ; : : : ; ckIi ) and kii can easily be computed from the expression for Hiik (ck1i ; : : : ; ckIi )
in proof of Lemma 1 when the result in Equation (20) is evaluated at ki = 2 and ki = 1, respectively. By Equation (20), we formally have
1

Gii (ck1i ; : : : ; ckIi ) =

PI

(ckii )

i0 =1

k
ii

=

(1) PI

k
n=1 (ci0 i )

Hence,
zeik

=

1

PI

1

dkii wi

1=

k
i0 =1 (ci0 i )

(ckii )

=

(cki0 i )

(

1)=

;

.

1

zik

"

PI

(ckii )

k
i0 =1 (ci0 i )

#

1=

.

P
Now, recall that we have de…ned kii
xkii =[ Ii0 =1 xki0 i ]. Using the expression for xkij obtained in
(21) it then follows that under the Fréchet assumption A1 we have:
k
ii

(24)

= PI

(ckii )

k
n=1 (ci0 i )

=

k
ii :

Combining the two previous equations, we obtain
1

zeik = zik

(25)

k
ii

1=

:

Now, from Equation (21), we know that for every i and j,
xkij = PI

(dkij wi =zik )

k
j wj Lj

k
k
i0 =1 (di0 j wi0 =zi0 )

so combining with (25) and using x
ekij = xkij =
x
ekij =

1

k
ii

gives

PI

(dkij wi =e
zik )

k
k
i0 =1 (di0 j wi0 =zi0 )

k
j wj Lj :

Analogously to Lemma 1, the result of Theorem 3 then follows.
Proof of Lemma 4. Throughout this proof, we use wi0 as our numeraire in the initial and counterfactual trade equilibrium: wi0 = (wi0 )0 = 1. By de…nition, we know that Zi is chosen for any i 6= i0
such that the value of the relative wage (wi =wi0 )0 in the counterfactual equilibrium is the same as
in the initial equilibrium (wi =wi0 ). Thus Assumption A5 implies
(26)

I P
K
P

j=1 k=1

(

k 0 k
ij ) j wj Lj

= wi Li ,

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

47

where ( kij )0 are the exports from country i in country j and industry k in the counterfactual
equilibrium. Using the expression for (ckij )0 = (wi )0 dkij =(zik )0 , Equation (24) implies
h

i
(wi )0 dkij =(zik )0
( kij )0 =
i
PI h
k
k
0 )0 d 0 =(z 0 )0
(w
i
n=1
ij
i

.

Combining the above with the expression for kij and using the fact that the relative wages remain
unchanged in the counterfactual equilibrium, we get after rearrangements
(27)

(

k 0
ij )

= PI

(zik )0 =zik
(zik0 )0 =zik0

i0 =1

k
ij

k
i0 j

(zik0 ) Zi (zik )

= PI

i0 =1

(zik0 ) Zi0 (zik0 )

k
i0 j

k
ij ,

where the second equality uses the de…nition of Zi in Equation (??). Taken together, Equations
(26) and (27) imply
k k
I P
K
(zik =Zi )
P
ij j j
= i,
PI
k
k
j=1 k=1
i0 =1 (zi0 =Zi0 )
i0 j
P
where i wi Li / Ij=1 wj Lj is the share of country i in world income in the initial equilibrium.

Proof of Theorem 5. Similar to previously and throughout this proof, we use wi0 as our numeraire
in the initial and counterfactual trade equilibrium: wi0 = (wi0 )0 = 1.

1. Counterfactual changes in bilateral trade ‡ows, xkij .
By Equation (21), we know that
(xkij )0

=

(wi )0 dkij =(zik )0
PI

k
0
j (wj ) Lj .

(wi0 )0 dki0 j =(zik0 )0

i0 =1

Combining the above with the expression for x
^kij = (xkij )0 =xkij and using the fact that the relative
wages remain unchanged in the counterfactual equilibrium, we get after rearrangements
x
^kij = PI

(zik )0 =zik

i0 =1

(zik0 )0 =zik0

k
i0 j

= PI

(zik =Zi )

i0 =1

2. Counterfactual changes in country i0 ’s welfare, Wi0

k (z k =Z 0 )
i
i0 j i0

.

wi0 / pi0 .

Recall that by de…nition
n
pki0 = E

P

!0 2

pki0 j (! 01

k
j

)

o1=(1

k)
j

;

so from the proof of Theorem 1 we know that
pki0

=

+1

k
j

1=(1

k)
j

I
P

i=1

1=

wi dkii0 =zik

.

48

COSTINOT, DONALDSON, AND KOMUNJER

Given our adjustment in labor productivity, we also know that (wi )0 = wi for all i. Thus
pki0

0

+1

=

k
j

1=(1

k)
j

I
P

i=1

1=

wi dkii0 =(zik )0

.
0

Combining the two previous expressions with the de…nition of pbki0 = pki0 =pki0 , we obtain
"
# 1=
I
P
zik
k
k
pbi0 =
.
ii0
zik0 Zi
i=1

By de…nition of pi0

QK

k=1

pki0

k
i0

, we therefore have
"
K
Y
I
P
zik
k
pbi0 =
ii0
zik0 Zi
k=1 i=1

which immediately implies Equation (15).

#

k =
i0

,

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

49

Appendix B: Robustness
The objective of this Appendix is to investigate the robustness of our results to weaker supply-side
assumptions. Instead of Assumptions A1, we now assume that:
A1’. For all countries i, goods k , and their varieties !, zik (!) is a random variable drawn
independently for each triplet (i; k; !) from a distribution Fik ( ) such that:
Fik (z) = F

(28)

z
zik

;

where F ( ) is a distribution on [0; +1) with a continuous density f ( ).
Compared to Assumptions A1, A10 does not impose any functional-form restriction on the distribution of productivities, F ( ). Using this weaker assumption, we now derive local versions of
Lemma 1, Theorem 3, and Theorem 5.
Lemma 7. Suppose that Assumptions A1’-A4 hold and that cost di¤ erences across exporters are
small: ck1j ' : : : ' ckIj for all j and k. Then for any importer, j, any pair of exporters, i and i0 ,
and any pair of goods, k and k 0 , there exists > 0 such that
!
0 !
0 !
0
xkij xki0 j
dkij dki0 j
zik zik0
(29)
ln
' ln
,
ln
0
0
0
xkij xki0 j
zik zik0
dkij dki0 j
Proof of Lemma 7. We have already established in the proof of Lemma 1 that bilateral trade ‡ows
can be expressed as
h
n
oi
k
E pkj (!)1 j 1I ckij (!) = min1 i0 I cki0 j (!)
k
i
h
xkij =
j wj Lj
1 kj
k
E pj (!)
=

Hij (ck1j ; : : : ; ckIj )
h
i
k
E pkj (!)1 j

k
j wj Lj ,

h
n
where we have let Hij (ck1j ; : : : ; ckIj )
E pkj (!)1
1I ckij (!) = min1 i0
previously, Assumptions A1’, A3 and straightforward computations yield
(30)

Hij (ck1j ; : : : ; ckIj )

=

+1
Z

ckij
v

1

0

oi
k (!)
c
. Similar to
I i0 j

hY
cki0 j i
f (v)
F k v dv:
ci0 j
i0 6=i

~ ij (ck ; : : : ; ck ) ln Hij (ck ; : : : ; ck ) (1 ) ln ck obtained from Equation
We now approximate ln H
1j
1j
ij
Ij
Ij
(30) by its …rst order Taylor series around the symmetric case ln ck1j = : : : = ln ckIj = ln c. Without
loss of generality, we choose units of account in each industry k such that ln c = 0. We have
(31)

~ ij (ck1j ; : : : ; ckIj )
H

(0;:::;0)

+1
Z
=
v
0

1

f (v) [F (v)]I

1

dv;

50

COSTINOT, DONALDSON, AND KOMUNJER

~ ij (ck ; : : : ; ck )
@H
1j
Ij

(32)

@

and, for

i0

ln ckij

=

(I

(0;:::;0)

2

dv;

0

6= i,
~ ij (ck ; : : : ; ck )
@H
1j
Ij

(33)

+1
Z
1)
v f 2 (v) [F (v)]I

@ ln cki0 j

(0;:::;0)

+1
Z
=
v f 2 (v) [F (v)]I

2

dv:

0

Let
+1
Z
v

1

f (v) [F (v)]I

1

dv;

0

and

2 +1
Z
14
v f 2 (v) [F (v)]I

2

0

Combining Equations (31), (32), and (33), we then get
ln Hij (ck1j ; : : : ; ckIj ) = ln + (1

) ln ckij

3

dv 5 :

1) ln ckij +

(I

X

ln cki0 j + o

ln ckj

i0 6=i

(34)

= ln

1) ln ckij

( I+

+

I
X

ln cki0 j + o

ln ckj

;

i0 =1

h
i2
2
P
where ln ckj = Ii0 =1 ln cki0 j denotes the usual L2 -norm, and > 0 only depends on f ( ), F ( ),
and I.
Combining Equation (34) with the de…nition of ckij = dkij wi =zik then gives
!
k
d
ij
;
(35)
ln Hij (ck1j ; : : : ; ckIj ) ' i + bkj
ln
zik
where
i

bkj

ln
I
X

( I+

1) ln(wi )

ln cki0 j

i0 =1

I+

1

Note that i does not depend on the country i and good k indices, bkj does not depend on the
country index i, and
> 0 is a positive constant which only depends on f ( ), F ( ),
and I.
k
Combining Equation (35) with the expression for xij then yields
!
k
d
ij
(36)
ln xkij ' i + kj
ln
;
zik

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

where we have let kj
ln
the result of Lemma 7.

kw L
j j j

+ bkj

h
ln E pkj (!)1

i

51

. Taking successive di¤erences yields

Theorem 8. Suppose that Assumptions A1’-A4 hold and that cost di¤ erences across exporters are
small: ck1j ' : : : ' ckIj for all j, k. Then for any importer j, any pair of exporters, i and i0 , and
any pair of goods, k and k 0 , there exist > 0 and such that
!
!
0 !
0 !
0
k k0
dkij dki0 j
xkij xki0 j
zeik zeik0
ii i0 i0
' ln
ln
+ ln
.
ln
0
0
0
k0 k
xkij xki0 j
zeik zeik0
dkij dki0 j
ii i0 i0
Proof of Theorem 8. Recall from the proof of Theorem 3 that we have:

where as before

h
E zik (!) j! 2

zeik

(37)

k
i

i

=

Gii (ck1i ; : : : ; ckIi )

dkii wi ,

k
ii

h
n
Gii (ck1i ; : : : ; ckIi ) = E (ckii (!)) 1 1I ckii (!) = min1 i0
o
n
k
k
k
0
(!)
.
=
Pr
c
(!)
=
min
c
0
1 i I ii
ii
ii

oi

k
I ci0 i (!)

;

Now, consider a …rst order Taylor development of ln Gii (ck1i ; : : : ; ckIi ) around ln ck1i = : : : = ln ckIi = 0.
The latter is readily available from the proof of Theorem 7: we only need to set = 2 in the
expression for Hii (ck1i ; : : : ; ckIi ) obtained in Equation (34). By letting
+1
Z
vf (v) [F (v)]I

1

dv

0

and

2 +1
Z
14
v 2 f 2 (v) [F (v)]I
0

we get
ln Gii (ck1i ; : : : ; ckIi ) = ln
(38)

= ln

( I + 1) ln ckii +
I
P

ln ckii +

ln

i0 =1

2

3

dv 5

I
P

i0 =1

ln cki0 i + o

cki0 i
+o
ckii

ln cki

ln cki
;

where k k2 is the L2 -norm as previously. We can follow the same approach for ln
= 1 in Equation (34), we get
ln
(39)

k
ii

=
=

ln I
ln I +

I ln ckii +
I
P

i0 =1

ln

I
P

i0 =1

cki0 i
+o
ckii

ln cki0 i + o
ln cki

ln cki
;

k
ii .

By setting

52

COSTINOT, DONALDSON, AND KOMUNJER

where

2 +1
Z
4
I
vf 2 (v) [F (v)]I

2

0

3

dv 5 :

Combining Equation (37) with (38) and (39), we then obtain
ln zeik = ln( I)

ln ckii + ln(dkii wi ) + (

)

ln

cki0 i
+o
ckii

ln

cki0 i
:
ckii

i0 =1

which given that ckii = dkii wi =zik yields
ln zeik ' ln( I) + ln zik + (

(40)

I
P

)

I
P

i0 =1

ln cki

;

P
We now show that the last term can be written as a function of kii = xkii = Ii0 =1 xki0 i introduced
previously. For this, …x any constant ', and note that in the neighborhood of ln ck1i = : : : = ln ckIi = 0
we have:
I
I
P
cki0 i '
cki0 i '
1 P
=
ln
I
+
1 + o ln cki
;
ln
k
k
I
0
0
c
c
i =1
i =1
ii
ii

and, in addition, for any i0 ,

cki0 i
ckii

'

=1

cki0 i
+o
ckii

' ln

ln cki

:

Combining the two equations above then shows that for any ':
I
P

(41)

cki0 i
ckii

ln

i0 =1

=

I
ln I
'

I
P

ln

i0 =1

cki0 i
ckii

'

ln cki

+o

:

Now, from the proof of Theorem 7 and its Equation (36) we know that
h
i
xki0 i
cki0 i
k
1
+
o
;
=
ln
c
(42)
i
xkii
ckii

where is as de…ned in the proof of Theorem 7. Combining (42) with (41) evaluated at ' =
then get:
i
I
P
ck0
I h
ln iki =
ln I + ln kii + o ln cki
;
cii
i0 =1

we

which when combined with (40) gives:

ln zeik ' ln( I) + ln zik + (

(43)

)

I h

ln I + ln

k
ii

Finally, we combine the above expression with (36) to get:
ln xkij '

i

+

k
j

ln dkij +

ln zeik + I(

) ln

k
ii

I ln I(

i

:

)

ln( I);

where i and kj are as de…ned in the proof of Theorem 7. Taking the successive di¤erences then
yields the result of Theorem 8 with > 0 as in the proof of Theorem 7 and with
I(

)

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

i.e.

0 +1
R 2
f (v) [F (v)]I
B
B 0
= I B +1
@ R
f (v) [F (v)]I

2

1

+1
R

dv

v 2 f 2 (v) [F (v)]I 2 dv

0
+1
R

dv

0

vf (v) [F (v)]I

1

dv

0

53

1

C
C
C:
A

Theorem 9. Suppose that Assumptions A1’-A5 hold and that fundamental productivity di¤ erences
and cost di¤ erences across exporters are small: z1k ' : : : ' zIk and ck1j ' : : : ' ckIj for all j, k. If
we remove country i0 ’s Ricardian comparative advantage, then:
(1) Counterfactual changes in bilateral trade ‡ows, xkij , satisfy
x
bkij ' 1 +

h

i
I
1 P
zbik0 .
I i0 =1

zbik

(2) Counterfactual changes in country i0 ’s welfare, Wi0
K I
ci ' 1 + P P
W
0

k=1 i=1

wi0 / pi0 , satisfy

k k k
bi .
i0 ii0 z

Proof of Theorem 9. As before and throughout this proof, we use wi0 as our numeraire in the initial
and counterfactual trade equilibrium: wi0 = (wi0 )0 = 1.
1. Counterfactual changes in bilateral trade ‡ows, xkij .
Under the assumptions of Theorem 7, we know from Equation (36) that
ln xkij '

(44)

i

+

k
j

+

ln zik

ln dkij ,

where
ln

i
k
j

ln(

( I+
k
j wj Lj )

+

1) ln(wi );
I
X

h
ln E pkj (!)1

ln cki0 j

i0 =1

I+

1.

i

;

Di¤erentiating Equation (44) we obtain
d ln xkij ' d

i

+d

k
j

+ d ln zik

d ln dkij

Since trade costs are assumed to be constant and productivity levels are adjusted to maintain wages
constant in the counterfactual equilibrium, d ln wi = 0, the previous expression can be simpli…ed as
d ln xkij ' d
Under Assumption A4, we also know that d ln(
(45)

d ln xkij '

I
P

i0 =1

d ln zik0 j

k
j

+ d ln zik .

kw L )
j j j

= 0. Hence,

h
d ln E pkj (!)1

i

+ d ln zik .

54

COSTINOT, DONALDSON, AND KOMUNJER

Since consumption levels are chosen optimally in the initial equilibrium, the envelope theorem also
implies
h
i
I
P
k
k
k
1
d ln E pj (!)
= (1
)
ij d ln zi ,
i=1

which, around

ck1j

= ::: =

ckIj ,

gives the following …rst-order approximation

h
d ln E pkj (!)1

(46)

i

'

(1
I

I
)P

i=1

d ln zik .

Combining Equations (45) and (46) with the de…nition of , we obtain
d ln xkij '

I
1 P
d ln zik0 ,
I i0 =1

d ln zik

which can be rearranged as
x
bkij ' 1 +

(47)

h

i
I
1 P
zbik0 :
I i0 =1

zbik

How does the previous expression relate to counterfactual changes in bilateral trade ‡ows derived
under Assumptions A1–A4? Let us approximate the counterfactual change in x
bkij obtained from
Equation (14) by its …rst order Taylor series around zb1k = : : : = zbIk = 1 and ck1j = : : : = ckIj . Under
the assumptions of Theorem 1, we know that
x
bkij = PI

i0 =1

zbik

zbik0

k
i0 j

;

so taking the …rst-order approximation around zb1k = : : : = zbIk = 1 and ck1j = : : : = ckIj gives
x
bkij

(48)

'1+

h

zbik

i
I
1 P
k
zb 0 :
I i0 =1 i

Comparing Equations (47) and (48), we see that conditional on the estimate of the elasticity of
imports with respect to productivity changes, which can be estimated using cross-sectional data,
Equations (5) and (29), the counterfactual predictions for small changes in technology are the same
under Assumptions A1 and A1’.
2. Counterfactual changes in country i0 ’s welfare, Wi0

wi0 / pi0 .

Since consumption levels are chosen optimally in the initial equilibrium, the envelope theorem
implies
P k
k
d ln pki0 =
i0 (!) d ln pi0 (!) ,
!2

k
i0

where
(!) is the share of expenditure of variety ! in country i0 and industry k. Using Assumption A3, the previous expression can be rearranged as
d ln pki0 =

I
P

i=1

k
ii0

d ln zik + d ln wi ,

A QUANTITATIVE EXPLORATION OF RICARDO’S IDEAS

55

where kii0 is the share of expenditure on varieties from country i in country i0 and industry k.
Since wages are unchanged in the counterfactual equilibrium, d ln wi = 0, we obtain
I
P

d ln pki0 =

i=1

k
k
ii0 d ln zi

Combing the previous expression with the fact that the upper-tier utility function is Cobb-Douglas,
we get
K P
I
P
k
k
d ln Wi0 = d ln pi0 =
i0 ii0 d ln zi ,
k=1 i=1

which can be rearranged as
(49)

K I
ci ' 1 + P P
W
0

k=1 i=1

k k k
bi :
i0 ii0 z

How does the previous expression relate to counterfactual changes in bilateral trade ‡ows derived
c k obtained
under Assumptions A1–A4? Again, let us approximate the counterfactual change in W
i0
from Equation (14) by its …rst order Taylor series around zb1k = : : : = zbIk = 1. Under the assumptions
of Theorem 5, we know that
K
ci = Q
W
0

I
P

k=1 i=1

k
ii0

zbik

k =
i0

:

Taking the …rst-order approximation around zb1k = : : : = zbIk = 1 gives
(50)

K I
ci ' 1 + P P
W
0

k=1 i=1

k k k
bi :
i0 ii0 z

Comparing Equations (49) and (50), we see that the counterfactual changes in welfare associated
with small technological changes are the same under Assumptions A1 and A1’. Compared to
our counterfactual predictions on bilateral trade ‡ows, note that this result does not rely on the
assumptions that cost di¤erences across exporters are small: ck1j ' : : : ' ckIj for all j and k.

56

COSTINOT, DONALDSON, AND KOMUNJER

Appendix C: Additonal Counterfactual Results

Table A1: Robustness of Counterfactual Results
Outcome variable: % change in welfare relative
to the total gains from trade

Reference country:
Australia

No preference
differences

No trade
costs

No preference
differences or
trade costs

(1)

(2)

(3)

-41.1

-46.9

-57.8

Belgium & Luxembourg

0.4

0.3

-8.0

Czech Republic

-3.2

-10.3

-20.5

Denmark

-11.7

-2.2

-23.3

Spain

-11.6

-7.7

-22.9

Finland

-22.6

3.3

-41.8

France

-3.9

-3.6

-4.8

Germany

0.9

0.7

-1.4

-59.6

-55.9

-79.9

Greece
Hungary

-2.7

-10.5

-14.1

Ireland

-17.6

-9.1

-43.4

Italy

-4.7

9.7

-18.0

Japan

11.7

27.2

-41.7

Korea

-5.8

-25.3

-36.9

Netherlands

-7.7

-2.1

-12.0

Poland

-26.1

-27.6

-36.7

Portugal

-22.9

-16.3

-40.1
-29.8

Slovakia

-3.2

-8.5

Sweden

-0.9

-0.4

-8.8

United Kingdom

-4.4

-5.4

-6.7

United States

-10.4

-21.3

-24.3

World Average

-11.8

-10.1

-27.3

Notes: Results from counterfactual calculations in w hich, one at a time for each country listed (the
'reference country'), every other country in the w orld is given the reference country's relative
productivity levels across industries, w hile adjusting each country's absolute productivity levels in
such a w ay as to hold nominal w ages fixed around the w orld (so as to neutralize terms-of-trade
effects). The methodology follow s Lemma 4 and Theorem 5. All columns report the resulting
change in w elfare as a percentage of the total gains from trade; a negative number indicates a loss
(and a value of -100 means that this loss is equal to that of moving to autarky). The three columns
diiffer in the counterfactual scenario considered. Column (1) considers a scenario in w hich each
country has the same tastes. Column (2) considers a scenario in w hich there are no idiosyncratic
trade cost differences across countries (that is, trade costs satisfy the restriction in Equation (8)).
And Column (3) considers a scenario that combines the scenarios in Columns (1) and (2). See
footnote 47 for details.

