NBER WORKING PAPER SERIES

URBAN ACCOUNTING AND WELFARE
Klaus Desmet
Esteban Rossi-Hansberg
Working Paper 16615
http://www.nber.org/papers/w16615

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
December 2010

We thank Kristian Behrens, Gilles Duranton, Wolfgang Keller, and Stephen Redding for helpful comments,
and Joseph Gomes and Xuexin Wang for excellent assistance with the data. We acknowledge the financial
support of the International Growth Centre at LSE (Grant RA-2009-11-015), the Comunidad de Madrid
(PROCIUDAD-CM), the Spanish Ministry of Science (ECO2008-01300) and the Excellence Program
of the Bank of Spain. The views expressed herein are those of the authors and do not necessarily reflect
the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2010 by Klaus Desmet and Esteban Rossi-Hansberg. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

Urban Accounting and Welfare
Klaus Desmet and Esteban Rossi-Hansberg
NBER Working Paper No. 16615
December 2010
JEL No. E1,R0,R11,R12,R13
ABSTRACT
This paper proposes a simple theory of a system of cities that decomposes the determinants of the
city size distribution into three main components: efficiency, amenities, and frictions. Higher efficiency
and better amenities lead to larger cities, but also to greater frictions through congestion and other
negative effects of agglomeration. Using data on MSAs in the United States, we parametrize the model
and empirically estimate efficiency, amenities and frictions. Counterfactual exercises show that all
three characteristics are important in that eliminating any of them leads to large population reallocations,
though the welfare effects from these reallocations are small. Overall, we find that the gains from worker
mobility across cities are modest. When allowing for externalities, we find an important city selection
effect: eliminating differences in any of the city characteristics causes many cities to exit. We apply
the same methodology to Chinese cities and find welfare effects that are many times larger than in
the U.S.

Klaus Desmet
Department of Economics
Universidad Carlos III
28903 Getafe (Madrid)
SPAIN
klaus.desmet@uc3m.es
Esteban Rossi-Hansberg
Princeton University
Department of Economics
Fisher Hall
Princeton, NJ 08544-1021
and NBER
erossi@princeton.edu

Urban Accounting and Welfare
Klaus Desmet

Esteban Rossi-Hansberg

Universidad Carlos III

Princeton University

December 7, 2010

Abstract
This paper proposes a simple theory of a system of cities that decomposes the determinants
of the city size distribution into three main components: e¢ ciency, amenities, and frictions.
Higher e¢ ciency and better amenities lead to larger cities, but also to greater frictions through
congestion and other negative e¤ects of agglomeration. Using data on MSAs in the United
States, we parametrize the model and empirically estimate e¢ ciency, amenities and frictions.
Counterfactual exercises show that all three characteristics are important in that eliminating
any of them leads to large population reallocations, though the welfare e¤ects from these reallocations are small. Overall, we …nd that the gains from worker mobility across cities are
modest. When allowing for externalities, we …nd an important city selection e¤ect: eliminating
di¤erences in any of the city characteristics causes many cities to exit. We apply the same
methodology to Chinese cities and …nd welfare e¤ects that are many times larger than in the
U.S.

1. INTRODUCTION
Why do people live in particular cities? We can list many reasons, but two are undoubtedly
relevant. Agents can enjoy the city or be more productive there. How many agents are attracted to
a particular city due to its combination of life’s amenities and the productivity level of its workforce
determines the size of cities. The positive e¤ects of attractive amenities and high productivity
are capped by frictions arising from congestion. Depending on city governance and the ‡exibility
of markets, these frictions can be more or less important. These city characteristics are in turn
enhanced and ampli…ed by the presence of urban externalities. Understanding the di¤erent forces
We thank Kristian Behrens, Gilles Duranton, Wolfgang Keller, and Stephen Redding for helpful comments, and
Joseph Gomes and Xuexin Wang for excellent assistance with the data. We acknowledge the …nancial support of the
International Growth Centre at LSE (Grant RA-2009-11-015), the Comunidad de Madrid (PROCIUDAD-CM), the
Spanish Ministry of Science (ECO2008-01300) and the Excellence Program of the Bank of Spain.

1

that determine city sizes is crucial for answering a broad set of questions. What is the relative
importance of these forces in determining the size distribution of cities? How much would we gain
or lose if cities had similar amenities, technology levels or frictions? How much reallocation would
this cause? How do externalities interact with these forces to determine city selection?
In this paper we provide a simple way of decomposing the characteristics that lead to the size
distribution of cities into three main components: e¢ ciency, amenities, and excessive frictions. We
use a simple urban theory to calculate these components and to do a wide set of counterfactual
exercises that provide answers to the questions we asked above. The theory consists of a multi-city
model with monocentric cities that produce a single good. Workers decide how much to work and
where to live. E¢ ciency is modeled as TFP di¤erences, amenities as preference shocks, and excessive
frictions as the cost of providing urban infrastructure that is paid for with labor taxes. To measure
“excessive frictions”, we use the concept of a “labor wedge”and decompose it into the standard cost
e¤ect of city size and the “excessive cost” of providing city services (see Chari, et al., 2007). We
solve the general equilibrium model with and without externalities.
We use an empirical strategy to parametrize the model and to obtain the “excessive frictions”
shocks and the e¢ ciency shocks. We then use the model to determine the amenity shocks that make
cities be of their actual sizes. The model therefore matches by construction the size distribution of
cities in the U.S. The counterfactual exercises then allow us to analyze the e¤ects of the di¤erent
parameter values and of the di¤erent city characteristics. For many counterfactuals we …nd that
the changes in utility (and in consumption) are modest in spite of massive population reallocations.
For example, eliminating e¢ ciency di¤erences across cities lowers equilibrium utility levels by a
mere 2.5%, and eliminating amenity di¤erences reduces welfare by just 2.3%. When we account for
externalities, these numbers decline even further. The welfare implications of redistributing agents
across cities due to switching o¤ any of the fundamental characteristics that account for the actual
size distribution is never greater than a few percentage points.1 This is surprising given that the
di¤erences in amenities and e¢ ciency levels can be rather large and given that the implied population
reallocations can be as large as 50%. Adding externalities has an important e¤ect on the extensive
margin in the counterfactual exercises, with many cities exiting and the urban population settling
in the surviving cities. However, these externalities have only modest e¤ects on welfare.
A relevant question is whether the small welfare e¤ects we uncover are inherent to the model or
1 This

resembles the literature on business cycle accounting that found that eliminating business cycles would lead
to trivial e¤ects (as in Lucas, 1987, we do not have the necessary distributional cost to obtain larger losses as agents
are identical, as emphasized by Storesletten, et al., 2001).

2

speci…c to the U.S. To address this issue, we explore the same type of counterfactual exercises for
the size distribution of cities in China. We …nd welfare e¤ects that are an order of magnitude larger
than in the U.S. For example, when eliminating e¢ ciency di¤erences across Chinese cities, welfare
increases by 47%, compared to a corresponding 2.5% in the U.S.
The paper relates to much of the literature on the size distribution of cities, but instead of taking
a random growth approach in which city dynamics coming from productivity or preference shocks
determine the size distribution (as in Gabaix, 1999a, b, Duranton, 2007, Rossi-Hansberg and Wright
2007, and Cordoba, 2008), we use a model to decompose the individual city characteristics that lead
to the cross-sectional distribution of city sizes. Since our model has no dynamic frictions or speci…c
factors, agents move across cities as a response to any temporary shock. In that sense, city dynamics
play no role in our decomposition. Of course, the measured levels of e¢ ciency, amenities or frictions
may still be the result of these dynamic mechanisms. To the extent that this is the case, our approach
helps us assess the contribution of particular dynamic factors to the distribution of city sizes. Further
related to our work is Au and Henderson (2006) who use a model with agglomeration economies and
congestion e¤ects to analyze optimal city sizes in China. After structurally estimating their model,
they calculate the welfare e¤ects of migration constraints, and …nd that output per worker would
increase substantially in some cities if labor were free to move. However, di¤erent from us, they limit
their attention to e¢ ciency, and do not focus on the other components of city size determination.
Finally, a recent working paper by Behrens et al. (2010) also proposes a general equilibrium model
of a system of cities that can be contrasted with the data. In contrast to our work, their paper
emphasizes pro-competitive forces that work through …rm selection to determine the productivity of
cities. These forces lead to trade between cities, and so their counterfactual exercises focus on how
shocks in one city a¤ect the distribution of population and productivities in the rest of the country.
Other work has emphasized the importance of e¢ ciency, productivity and amenities in explaining
the distribution of city sizes. Glaeser et al. (2001), Glaeser et al. (2005), Albouy (2008 and 2009),
and Rappaport (2008 and 2009), for example, have underscored the importance of city amenities
and institutional frictions. Others have emphasized the importance of the relative e¢ ciency in
production of the di¤erent urban areas (Holmes and Stevens, 2002 and 2004, Holmes, 2005, Duranton
and Overman, 2008) or the geographic characteristics of the locations in which cities develop (Davis
and Weinstein, 2002, Bleakley and Lin, 2010). Our approach relates to this work in that we also
aim to identify important city characteristics that lead to urban agglomeration. We di¤er in that
we have a fully speci…ed general equilibrium model that we use to jointly account for e¢ ciency,

3

amenities and excessive frictions. The model is also ‡exible enough to incorporate externalities in
e¢ ciency levels and amenities. With the urban characteristics in hand we can perform a variety
of counterfactual exercises and calculate the welfare implications of eliminating variation in any
of these characteristics. Furthermore, the proposed methodology can be used to compare urban
systems across countries, although we leave that for future research.
The rest of the paper is organized as follows. Section 2 introduces a simple urban model and
explains the basic urban accounting exercise. Section 3 estimates a log-linear version of the structural
equations using U.S. data between 2005 and 2008 and obtains the reduced form e¤ects of the three
main characteristics of cities on rents and city sizes. Section 4 performs counterfactual exercises
using the empirical values of these city characteristics. Section 5 studies the e¤ect of e¢ ciency and
amenity shocks. Section 6 applies our methodology to China, and Section 7 concludes. Appendix A
shows how the population sizes of individual cities are a¤ected when certain characteristics change.
Appendix B describes in detail the urban data set constructed.
2. THE MODEL
We use a standard urban model with elastic labor supply so that labor taxes create distortions.
Agents work in cities with idiosyncratic productivities and amenities. They live in mono-centric
cities that require commuting infrastructures that city governments provide by levying labor taxes.
Large cities are more expensive to live in because of higher labor taxes and commuting costs, but
are large because of high levels of e¢ ciency or local amenities. City governments can be more or less
e¢ cient in the provision of the public infrastructure. We refer to this variation as a city’s “excessive
frictions”. In later sections we augment the model to include local externalities in production and
amenities.
2.1 Technology
Consider a model of a system of cities in an economy with Nt workers. Goods are produced in I
mono-centric circular cities. Cities have a local level of productivity. Production in a city i in period
t is given by
1
Yit = Ait Kit Hit

4

where Ait denotes city productivity, Kit denotes total capital and Hit total hours worked in the
city.2 We denote the population size of city i by Nit . The standard …rst order conditions of this
problem are
wit = (1

)

Yit
= (1
Hit

)

yit
hit

(1)

and
Yit
yit
=
Kit
kit

rt =

where small-cap letters denote per capita variables (e.g. yit = Yit =Nit ). Note that capital is freely
mobile across locations so there is a national interest rate rt . Mobility patterns will not be determined
solely by the wage, wit , so there may be equilibrium di¤erences in wages across cities at any point
in time.
We can then write down the “e¢ ciency wedge”which is identical to the level of productivity, Ait ;
as
Ait =

Yit
1
Kit Hit

=

yit
kit h1it

:

(2)

2.2 Preferences
Agents order consumption and hour sequences according to the following utility function
1
X

t

[log cit +

log (1

hit ) +

i]

t=0

where

i

is a city-speci…c amenity and

is a parameter that governs the relative preference for

leisure. Each agent lives on one unit of land and commutes from his home to work. Commuting is
costly in terms of goods.
The problem of an agent in city i0 with capital k0 is therefore
max

1

1
X

fcit t ;hit t ;kit t ;it gt=0 t=0

t

[log cit +

log (1

hit ) +

i]

subject to
cit + xit
kit+1

= rt kit + wit hit (1
=

(1

it )

Rit

Tit

) kit + xit ;

2 It

would be straightforward to generalize this model to include human capital. We experimented with this, and
doing so did not substantially change any of the theoretical or empirical results.

5

where xit is investment,

it

is a labor tax or friction associated with the cost of building the com-

muting infrastructure, Rit are land rents and Tit commuting costs (as we will see below, Rit + Tit is
constant in the city so the location of the agent’s home does not a¤ect his choices).3
Throughout the paper we assume that we are in steady state so kit+1 = kit and xit = kit .
Furthermore, we assume kit is such that rt =

(capital is at its Golden Rule level). The simpli…ed

budget constraint of the agent becomes
cit = wit hit (1

it )

Rit

Tit :

The …rst order conditions of this problem are given by 1=cit =
1
1

ht

= wit (1

it )

it ,

(3)
and

it ;

which imply
cit
= (1
1 hit
Combining equations (1) and (4) we obtain
(1

it )

=

(1

it ) wit :

)1

(4)

cit hit
:
hit yit

(5)

Agents can move freely across cities so utility in each period has to be determined by
u = log cit +

log (1

hit ) +

i;

(6)

for all cities with Nit > 0, where u is the economy-wide per period utility of living in a city.
2.3 Commuting Costs, Land Rents and City Equilibrium
Cities are mono-centric, all production happens at the center, and people live in surrounding
areas characterized by their distance to the center, d. Cities are surrounded by a vast amount of
agricultural land that can be freely converted into urban land. We normalize the price of agricultural
land to zero. Since land rents are continuous in equilibrium (otherwise there would be arbitrage
opportunities), this implies that at the boundary of a city, d, land rents should be zero as well,
namely, R d = 0. Since all agents in a city are identical, in equilibrium they must be indi¤erent
between where they live in the city, which implies that the total cost of rent plus commuting costs
should be identical in all areas of the city. So
Rit (d) + T (d) = T dit = dit
3 Since

agents can move across cities, the subscript i depends on t, as written under the maximization sign. To
save on notation, we drop this additional subscript.

6

since T (d) = d where

denotes commuting costs per mile.

Since everyone lives in one unit of land, Nit = d2 , and so
1
2

Nit

dit =

;

we know that
Rit (d) + T (d) =

1
2

Nit

all d:

This implies that
Rit (d) =

dit

d

and so total land rents in a city of size Nit are given by
Z dit
dit d d2 dd =
T Rit =
0

1
2

3

3

Nit2 :

Hence, average land rents are equal to
2
ARit =
3

Nit

1
2

:

Taking logs and rearranging terms, we obtain that
ln (Nit ) = o1 + 2 ln ARit ;

(7)

where o1 is a constant.
We can also compute the total miles traveled by commuters in the city, which is given by
Z dit
2 1 32
2N :
T Cit =
d2 2 dd =
it
3
0

(8)

2.4 Government Budget Constraint
The government levies a labor tax,

it ,

to pay for the transportation infrastructure. This tax can

also be interpreted as a distortion in the labor market because of the congestion created in a large
city. As in Chari et al. (2007), we will refer to

it

as the “labor wedge”. Let government expenditure

be a function of total commuting costs and wages such that
G (hit wit ; T Cit ) = git hit wit T Cit = git hit wit

2
3

1
2

3

Nit2 :

where git is a measure of government ine¢ ciency. That is, the government requires git workers per
mile commuted to build and maintain urban infrastructure. The government budget constraint is
then given by
it hit Nit wit

= git hit wit
7

2
3

1
2

3

Nit2

which implies that the “labor wedge” can be written as

it

2
3

= git

1
2

Nit

(9)

or
ln

it

= o2 + ln git +

1
ln Nit :
2

(10)

2.5 Equilibrium
The consumer budget constraint is given by
cit = wit hit (1

it )

Rit

Tit = (1

) (1

Nit

it ) yit

1
2

:

From (5) we know that
(1

it )

=

(1

)1

cit hit
:
hit yit

To determine output we know that the production function is given by yit = Ait kit h1it
decision of …rms to rent capital implies that rt kit = yit : Hence,
yit
rt

yit = Ait

h1it

or
1

1

yit = Ait1

hit :

rt

Hence,
rt

1

hit = cit

and so
hit =

0

1
1+

@1 +

which implies
1

hit =

1+

and

0

@1

(1

cit =

) (1

1

) (1

1

it ) Ait

rt

(1

1

(Rit + Tit )
1
) (1
it ) A 1
it

rt 1
(Rit + Tit )
1
(1
) (1
it ) A 1
it
1

(1

1

1

1

it ) Ait

1+

8

rt

1

A:

1
A

(Rit + Tit )
:

and the

The free mobility assumption in (6) implies that u = log cit +

log (1

hit ) +

it

for some ut

determined in general equilibrium so

ut + (1 + ) log (1 + )
log
0
1
1
1
A
it
= log @(1
) (1
(Rit + Tit )A
it )
rt

1

0

1
rt 1
(R
+
T
)
it
it
A+
+ log @1
1
(1
) (1
it ) A 1
it
0
1
1!
2 Nit 2
Ait1
@
git
) 1
= log (1
3
rt 1
0
B
+ log @1

Nit

(1

(11)

1
2

git 32

) 1

i

rt

Nit

1
2

1
2

Nit

1
1
1

Ait

1

C
A+

1
A

i

The last equation determines the size of the city Nit as an implicit function of city productivity,
Ait , city amenities,

i,

government ine¢ ciency git ; and economy-wide variables like rt and ut . We

can use this equation to derive the e¤ect of the three city speci…c characteristics (Ait ;

it ; git )

Nit . First note that the LHS of (11) is decreasing in Nit . The LHS is also increasing in Ait and

on
i

and decreasing in git . Hence, we can prove immediately that
dNit
dAit
dNit
d i
dNit
dgit

> 0;

(12)

> 0;
< 0:

So population increases in a more productive city or a city with more amenities, but it decreases in
a city with a less e¢ cient government.
The economy-wide utility level ut is determined by the labor market clearing condition
I
X

Nit = Nt :

(13)

i=1

This last equation clari…es that our urban system is closed; we do not consider urban-rural migration.

9

3. EVIDENCE OF EFFICIENCY, AMENITIES AND FRICTIONS
To lend validity to our theoretical model, we estimate the size of the three derivatives in (12) and
estimate the e¤ect of land rents on population as in (7). When doing so, the general equilibrium
nature of the model will be key.
3.1 Empirical Approach
We …rst estimate the “labor wedge”using equation (5) and the “e¢ ciency wedge”in equation (2).
Note that the empirical measure of the “e¢ ciency wedge” is related not just to productivity, but
also to the relative price of city output. Although we have no way of disentangling these two terms,
in a theory with multiple goods relative price e¤ects across cities would have isomorphic e¤ects
to changes in productivity. Hence, we just equate productivity to our measure of the “e¢ ciency
wedge”.
The general equilibrium nature of the model is important. For example, if we regress the log of
city size on the log of the labor wedge, we …nd a statistically signi…cant positive e¤ect (coe¢ cient
of 1.2360 and p-value of 0.000). But it would be wrong to conclude from there that higher frictions
lead to greater city size. Rather, according to the theory, this positive association would re‡ect
more productive cities being larger, and larger cities experiencing greater commuting costs. That
is, in as far as greater commuting costs are due to cities being more e¢ cient, they will be positively
associated with city size. Only frictions “in excess” of this basic tradeo¤ between e¢ ciency and
congestion will have a negative e¤ect on city size. In what follows we propose a methodology that
accounts for these general equilibrium links by decomposing these di¤erent e¤ects.
We start by estimating the following equation
ln Nit =
The value of
model,

1

1

1

+

1

ln Ait + "1it :

(14)

yields the e¤ect of the “e¢ ciency wedge” on city population. According to the

~it (Ait ) =
> 0 by (12). Furthermore, ln N

1

ln Ait is the population size explained by the

size of the “e¢ ciency wedge”. In contrast, "1it is the part of the observed population in the city
that is unrelated to productivity; according to the model it is related to both git and
thus de…ne the function ~"1 (git ;

it )

it .

We can

"1it .

Since the “e¢ ciency wedge”increases population size, total commuting increases, which a¤ects the
“labor wedge”according to equation (10). This is the standard urban trade-o¤ between productivity
10

and agglomeration. We can estimate the e¤ect of productivity on the “labor wedge” by using
~it (Ait ) and "1it provided by equation (14).
equation (10) and the decomposition of ln Nit into ln N
Hence, we estimate
ln
According to equation (10),

it

=

2

+

~it (Ait ) + "2it :
ln N

2

(15)

> 0. That is, a city that is more productive and so has more

2

population, will be more distorted. We denote the e¤ect of e¢ ciency on distortions by ln f
it =
2

~it (Ait ). Equation (10) also implies that the error term "2it is related to git and to ~"1 (git ;
ln N

it )

~it (Ait )).
(since the labor wedge depends on all factors a¤ecting population and not just on ln N
Hence, we de…ne ~"2 (git ; ~"1 (git ;

it ))

"2it .

We now use equation (7) to decompose the e¤ect from all three elements of (Ait ;

i ; git ).

To do

so, we estimate
ln (ARit ) =

3

+

3

ln f
it +

4 "1it

+

5 "2it

+ "3it

using median rents for ARit : The model has clear predictions for
implies

3

3,

4

(16)
and

5.

In particular, it

> 0, since by equations (7) and (12) e¢ ciency has a positive e¤ect on population, which

has a positive e¤ect on the level of distortions and on average rents. This is the standard city size
e¤ect. The e¤ects of

it

and "2it depend on both

and git are determined by the estimates of
it

and git . However, since "2it = ~"2 (git ; ~"1 (git ;

through "1it and we are including "1it directly in the regression,
changes in git on land rents. So,

5

it

5

and
it ))

it .

depends only on

it

Hence, the model implies that higher git , and therefore

Similarly, since we are controlling for the e¤ect of git by including "2it ,
"1it on land rents controlling for git , which is the e¤ect of
4

Note that "1it

will capture only the e¤ect of

and "2it , implies lower population and lower rents (see (12)). Thus

Hence, the model implies that

5.

captures the e¤ect of git on frictions and therefore average

rents. Higher distortions imply a higher
higher

4

it

4

5

should be negative.

will capture the e¤ect of

on land rents, since "1it = ~"1 (git ;

it ) :

should be positive by equations (7) and (12). Our model implies

that rents are a non-linear function of (Ait ;

i ; git ).

In contrast, equation (16) assumes that it is

a linear function. Adding higher degree polynomials and interaction terms to this relationship can
in principle be important. We do so in our empirical implementation below, though this does not
a¤ect results in any substantial way.
Note that we can then use equation (7) to relate average rents and population sizes. So we estimate
equation (7) as
ln (Nit ) =

4

+

6

11

ln ARit + "4it :

(17)

According to the model, in a circular city,

6

= 2 > 0.

3.2 E¤ects of E¢ ciency, Amenities and Frictions on City Size
To bring the model to the data, we construct a new data set on U.S. metropolitan statistical areas
(MSAs) for the period 2005-2008. Apart from output and rental prices, few ready-to-use data are
available at the MSA level. We rely on a combination of proxies previously used in the literature and
micro-data to come up with measures for the other relevant variables, such as consumption, hours
worked, and capital. Appendix B.1 provides details on the construction of the data set. Computing
the “labor wedge” and the “e¢ ciency wedge” requires making assumptions on the values of some
parameter values. Table 1 reports the parameter values we use and provides brief comments on the
chosen values. Essentially, they make the model match key moments in the aggregate.
To implement the empirical exercise of the previous section, we pool the data for 2005-2008, and
include time dummies in all regressions. One further di¤erence is that we also include an interaction
term "1it "2it in equation (16), since we found it to be statistically highly signi…cant. We denote the
coe¢ cient associated with this interaction term

7.

Standard errors for equations (16) and (15) are

obtained by bootstrapping, since some of the regressors are estimated.4 The results are presented
in Table 2.

Table 1
Parameter

r

Value

Comments

1:4841

McGrattan and Prescott (2009)

0:3358

McGrattan and Prescott (2009)

0:02

Standard number in the literature

0:02

Theory requires

=r

As is clear from Table 2, all coe¢ cients have the signs implied by the model and are highly
signi…cant. The estimation of equations (14), (15), (16), and (17) yield R2 values of, respectively,
0:14, 0:37, 0:25, 0:18. The model implies that in a circular city

6

= 2. The value we …nd is close to

two and we fail to reject the hypothesis that it is equal to two a the 5% level.
4 Correcting
3

the standard errors for clustering by MSA does not qualitatively change any of the results, except for
which is no longer statistically signi…cant.

12

Table 2
j

j

s.e.

p-value

Theoretical Prediction

1

2:0964

0:3727

0:000

+

2

0:4127

0:0234

0:000

+

3

0:1283

0:0461

0:005

+

4

0:0959

0:0070

0:000

+

5

0:2020

0:0420

0:000

6

2:1400

0:1652

0:000

7

0:1841

0:0437

0:000

2

Number of observations: 768

These results allow us to reach several conclusions. First, highly e¢ cient cities are more populated.
This is consistent with numerous empirical studies in the literature. Second, e¢ cient cities are more
distorted. Frictions are larger as a result of these cities being larger. The frictions that result from
more e¢ cient cities being larger are positively related to median rents as they are the result of the
higher e¢ ciency. Third, frictions that exceed the ones explained by e¢ ciency have a negative e¤ect
on land rents and city size. Finally, cities that are larger due to amenities also exhibit larger median
rents.
The model and the empirical exercise have allowed us to assess the impact of the three city
characteristics (e¢ ciency, excessive frictions, and amenities) on land rents and population size. It
has also made the point that the general equilibrium e¤ects are important. However, the empirical
log-linear model that we have used does not inherit the entire structure of the model. For example,
the derivatives in (12) need not be constant. It is therefore important to go beyond this simple
empirical exercise to capture the full richness of the theoretical model. In the next section we
propose a methodology to obtain the value of the three key city characteristics, and we use the
model to perform counterfactual exercises. We show how the model can be made to account for all
the variation in city sizes if we identify amenities as a residual from the theory.

13

4. COUNTERFACTUAL EXERCISES
4.1 Methodology and Shock Identi…cation
The model provides a straightforward way of performing counterfactual exercises. Equation (11)
implies that
C1 (ut ;
=
If git and

it )

log (C2 (Ait ; rt ))
2
git +
3
C2 (Ait ; rt )

(1 + ) log 1

Nit

are small using the approximation log (1

Nit =

2

where
C1 (u;

it )

0

1
2

!

(1+ )
C2 (Ait ;rt )

log 1

Nit

1
2

!

:

x;5 we obtain

x)

@ log (C2 (Ait ; rt ))

2
git
3

C1 (u;
+ 23 git

= ut + (1 + ) log (1 + )

12

it ) A

log

(18)

it ;

1

C2 (Ait ; rt )

=

This solves Nit as a function of (Ait ;
derivatives with respect to (Ait ;

(1

)

it ; git ).

it ; git ).

Ait1
rt

:
1

Note that the approximation results in exactly the same

Furthermore, @Nit =@ u < 0; namely, a higher equilibrium

utility (smaller total population) makes concentration of workers in a given city less likely since
concentration implies congestion costs.6
We can use the equation above to calculate Nit given the values of (Ait ;

it ; git )

and other para-

meter values. We can also use these expressions to run counterfactual exercises. In particular we
can calculate counterfactual distributions of city sizes assuming that all cities have similar values of
5 This

approximation works best if it and are small. In the exercise below the approximation error is likely very
small.
6 Throughout this section we calculate an agents’utility based on his labor and capital income but not the income
that agents obtain from land rents. Land is owned by absentee landlords and so rental income does not enter an
agent’s utility and does not a¤ect their decision to move. We have calculated all of the results below if we use the
alternative assumption that workers in a city own a diversi…ed portfolio of land in the city and so obtain as income
the average rents. The results under this assumption are essentially identical (utility di¤ers only by less than 0.001)
to the ones with absentee landlords, both in the case with and without externalities. The reason is that we are always
normalizing the level of utility that reproduces the size distribution to u = 10 and only relative utilities matter to
determine location decisions.

14

any of the exogenous city characteristics (Ait ;

it ; git ).

Note that ut has to be selected such that the

resulting city sizes satisfy the labor market clearing condition (13).
In order to perform any of these exercises we …rst need to develop a strategy to calculate
(Ait ;

it ; git )

for each city. Ait can be calculated directly from available data since
Ait =

yit
kit h1it

and we have data on yit , hit and kit : This is what we did in the empirical implementation above. An
alternative way of calculating the relevant productivity and skill term without using kit (which is
potentially poorly measured in the data) is to use the prediction of the model on capital allocation.
In particular the model implies that rt kit = yit and so
yit
:
rt

kit =
We can then let

1
yit

Ait =

:
h1it

rt

Equation (18) assumes that capital is determined in this way and so this method has the advantage
of being theoretically more consistent (although it does not use the actual data on capital stocks).
We have added capital in both ways, and found the results to be similar. The correlation of the
model-based capital stock measure and the empirical capital stock measure is 0.9. Therefore, we
omit here the exercise with the theoretical levels of capital and focus on the one where we use the
empirical measure of the capital stock. (Figure A9 in the appendix shows the results when we use
theory-based capital levels).
Obtaining values for the other two city characteristics is more complicated. First note that
equation (10) can be used to estimate git . Based on this equation we can run the simple log-linear
regression
ln

it

=

5

+

8

ln Nit + "5it :

(19)

Equation (10) then implies that "5it = ln git . Using data for 2005-2008 and adding time dummies,
we estimate

8

= 0:08 with a standard error of 0:009. The R2 of the regression is 0:10. Note that

equation (10) implies that

8

= 0:5, so the estimated coe¢ cient is signi…cantly lower than the one

predicted by the theory. The theoretical model can easily be modi…ed to account for this mismatch
if we allow for increasing returns in the provision of some forms of infrastructure. In particular
if g~it (Nit ) = git Nit , substituting g~it ( ) for git in equation (10) would yield the prediction that
15

8

= 0:5

. Independently of how the coe¢ cient

8

maps with the theory, the equation allows us

to recover the frictions not associated to population size, which constitute the natural logarithm of
the city’s “excessive frictions”.
We still have to obtain the value of

it .

There are a variety of ways to do this. The one that

is most consistent with the theory is to use equation (18) and solve for the set of

it

that make

the model match city sizes exactly, given some normalization of u (we set u = 10). We can then
…x

it

and perform counterfactual exercises. Of course, this exercise depends on the value of all

parameters in the model. As before, we use the parameters in Table 1, which match key moments
in the aggregate. One important parameter in determining
a value yet. To obtain a value for

it

is , for which we have not assigned

we also use equation (19) that regresses the labor wedge on city

population size. In discussing the results of estimating this equation, we already pointed out that
the theoretical value of the coe¢ cient on population size (
So we …x it at this value and estimate the constant
5

and so, given a value for
which yields a value of

5,

= ln

2
3

5.

+ ln

8)

should be 0.5 according to the theory.

Furthermore, equation (9) then implies that
1
ln
2

we can calculate . The estimation yields a constant equal to

7:3179,

= 0:00176. The time dummies we include are mostly not signi…cant, but

adding their values would yield a constant that is somewhat smaller which would imply a lower .
Therefore, we use a value of

= 0:001 and do many robustness checks for higher values of .

4.2 Counterfactuals
We are now ready to perform a number of counterfactual exercises. After analyzing the e¤ect of
commuting costs, the main focus will be on exploring the relative importance of di¤erent characteristics (e¢ ciency, amenities and excessive frictions) in determining the city size distribution. In
particular, we are interested in understanding how changes in city characteristics a¤ect city sizes,
welfare and the reallocation of people.

16

Effect of  given all Shocks
0

-1

ln(prob>population)

-2

-3

-4

 = 0.0006, Utility = 10.26
 = 0.0008, Utility = 10.10
Actual:  = 0.001, Utility = 10.00
 = 0.0012, Utility = 9.91
 = 0.002, Utility = 9.59
 = 0.003, Utility = 9.21

-5

-6

4

6

8

10
12
ln(population)

14

16

18

Figure 1: The City Size Distribution for Di¤erent Levels of Commuting Costs
Figure 1 shows the actual distribution of city sizes in the U.S. and counterfactual distributions of
city sizes if we increase or decrease commuting costs , given the distribution of characteristics. The
results are presented in the standard log population –log rank plots in which a Pareto distribution
would be depicted as a line with slope equal to minus the Pareto coe¢ cient. As is well known, the
actual distribution is close to a Pareto distribution with coe¢ cient one. By construction the model
matches the actual distribution exactly for

= 0:001. In that case we normalize utility u = 10:7

In all counterfactual exercises we solve for the value of u for which the labor market clears, i.e.,
the sum of population across cities equals the actual total urban population. Note that percentage
changes in utility are equivalent to percentage changes in consumption since we are using a logutility speci…cation. Figure 1 shows that larger commuting costs make the largest cities smaller
7 This

normalization a¤ects the size of the welfare changes due to the level taken by the amenity characteristics.

On average we …nd that the share of utility coming from amenities is around 28%. We have no evidence that this
number is reasonable. However, it is easy to adjust the numbers to be consistent with any share of amenities in utility.
For example, if the share of utility coming from amenities is set to zero, all our utility numbers from counterfactuals
would need to be multiplied by 1=(1 :28) = 1:39.

17

and the smaller cities larger, leading to a less dispersed distribution of city sizes. The 20% increase
in commuting costs decreases utility by about 0.9%. The decline in commuting costs increases
dispersion and raises utility by 1%. Note that the smallest cities now become much smaller. The
main advantage of some of these cities was their small size and their low commuting costs. As
commuting costs decrease, this advantage becomes less important and their size decreases further.
If we double or triple

to 0.002 and 0.003 we obtain changes in utility of around 4% and 8%. Large

cities now become much smaller, which implies that production is not done in the most productive
and highest amenity cities which leads to substantial welfare losses.
Counterfactuals Without One Shock,  = 0.001 , Year = 20052008
Counterfactual Utility = 10.2497
0

-1

-1
ln(prob > population)

ln(prob > population)

Model Utility = 10
0

-2
-3
-4
-5

12

13

-3
-4
-5

Actual
Modeled

-6
11

-2

14
15
ln(population)

16

-6

17

Actual
Avg. Efficiency
6

8

0

-1

-1

-2
-3
-4
-5
-6

8

10
12
ln(population)

14

16

-2
-3
-4
-5

Actual
Avg. Amenities
6

14

Counterfactual Utility = 10.0046

0

ln(prob > population)

ln(prob > population)

Counterfactual Utility = 10.2282

10
12
ln(population)

-6
10

16

Actual
Avg. Exc. Frictions
11

12

Figure 2: Counterfactuals Without one Shock

18

13
14
ln(population)

15

16

17

Figure 2 shows three counterfactual exercises where we shut down each of the three shocks (e¢ ciency, amenities, and excessive frictions) respectively. In all cases we eliminate a shock by setting
its value to the population weighted average of the shock. We then calculate the utility level that
clears the labor market, so total urban population is identical in all cases. Note that eliminating
any of the shocks always leads to an increase in utility. Shocks create dispersion in the city size
distribution and by equation (8) total commuting costs are convex. So utility in the model tends
to increase if population is uniformly distributed in the 192 cities in our sample. If we eliminate all
three shocks so that all sites are identical, welfare would increase by 3:26% and all cities would have
a population of 1 million 68 thousand people. Of course, this increase in welfare does not constitute
an upper bound on the importance of the shocks since the distribution of the shocks as well as their
correlation matters for the …nal results.
The counterfactual exercises in Figure 2 show that eliminating di¤erences in e¢ ciency and amenities has a small e¤ect on utility. In both cases utility would increase by less than 2.5%. The limited
e¤ect on utility is due to several reasons. The most obvious one is that population can reallocate
across cities. But there are others. For example, the e¤ect of a negative shock to productivity on
utility is also mitigated by people working less, by lowering the cost of providing city infrastructure,
and by the fact that utility does not only depend on production but also on amenities.
In spite of the small e¤ect on utility, the e¤ect on the size of individual cities is large. Many cities
would substantially decline in size, especially the largest ones. For example, Los Angeles-Long BeachSanta Ana would lose 85% of its population if it had average amenities, and 35% if it had average
e¢ ciency. Similarly, the corresponding …gures for New York-Northern New Jersey-Long Island are
79% and 53%. Maybe surprisingly, some of the small cities also decline. When this happens, it is
because they lose their only comparative advantage. One such example is Santa Fe: if it had average
amenities, it would lose 99% of its population. Intermediate-sized cities in general bene…t as they
tend to experience a boost in productivity or amenities, and already are attractive enough in terms
of other characteristics. These cities also grow because of the reallocation of population from larger
cities. In contrast to amenities and e¢ ciency, eliminating excessive frictions has only a small e¤ect
on the shape of the distribution, although again some individual cities would experience signi…cant
decreases in size, as they were large only because of their advantage in having low excessive frictions.
Phoenix-Mesa-Scottsdale, for example, would lose 48% of its population if it had average excessive
frictions.

19

Appendix A shows …gures and maps with the percentage changes in population for individual
cities when we set one of the shocks to its weighted average. In terms of the geographic distribution
of city characteristics, we …nd that most cities in the coastal regions would loose population if we
eliminated amenity di¤erences. This is consistent with Rappaport and Sachs (2003) who argue that
the concentration of population in coastal areas has to do increasingly with a quality of life e¤ect.
Central regions would tend to loose population if we eliminated e¢ ciency di¤erences as would most
of the north-eastern regions. Perhaps the sharpest geographical pattern emerges when we eliminate
excessive frictions. Most of the mid-west and north-east (the region that includes the “Rust Belt”)
would gain population if we equalize frictions across cities: an indication that governance problems,
as well as other labor market frictions, like unions, may be important in these regions.
The e¤ect of the di¤erent shocks on the distribution of city sizes hides some of the implied population reallocation in these counterfactuals. That is, cities are changing ranking in the distribution
even if the overall shape of the distribution does not exhibit large changes, as in the case of excessive
frictions. We can calculate reallocation following Davis and Haltiwanger (1992) by adding the number of new workers in expanding cities as a proportion of total population when we change from the
actual distribution to the counterfactual. This measure of reallocation is 51.79% when we eliminate
di¤erences in TFP, 42.54% when we eliminate amenities, and 9.9% when we eliminate excessive
frictions: large numbers given the modest welfare gains. As a benchmark, the same reallocation
number for the U.S. economy over a 5 year interval is around 2.1% (2.14% between 2003 and 2008
or 2001 and 2007).
Figure 3 shows the counterfactual distributions of city sizes when we shut down two of the three
shocks. The distributions therefore show the heterogeneity in city sizes generated by a single shock
or characteristic. Note that neither e¢ ciency on its own nor amenities on their own can explain
the relatively large sizes of the smallest cities in the actual distribution. This is because some of
these small cities are attractive in terms of the other characteristics, making them larger than their
e¢ ciency or their amenities would imply.

20

Counterfactuals with Only One Shock,  = 0.001 , Year = 20052008
Counterfactual Utility = 10.2589
0

-1

-1
ln(prob > population)

ln(prob > population)

Model Utility = 10
0

-2
-3
-4
-5

12

13

-3
-4
-5

Actual
Modeled

-6
11

-2

14
15
ln(population)

16

-6

17

Actual
Efficiency Only
6

8

0

-1

-1

-2
-3
-4
-5
-6

8

10
12
ln(population)

14

16

-2
-3
-4
-5

Actual
Amenities Only
6

14

Counterfactual Utility = 10.3448

0

ln(prob > population)

ln(prob > population)

Counterfactual Utility = 10.1917

10
12
ln(population)

-6
11

16

Actual
Exc. Frictions Only
12

13

14
15
ln(population)

16

17

Figure 3: Counterfactuals with Only one Shock
The level of commuting costs , which we have estimated to be equal to 0:001, is a key parameter
in determining the relative importance of each shock. The estimated value implies that agents spend
about 2% of their wage income on commuting infrastructure.8 The larger , the smaller the relative
importance of productivity shocks, since it becomes more costly to live in large productive cities and
the people that live in them tend to work less since

is larger. If we set

= 0:005, a …vefold increase,

the total reallocation if we equalize e¢ ciency across locations drops from around 52% to 10%, with
a 1.5% increase in utility, a smaller e¤ect than before. By decreasing the relative importance of
productivity shocks, higher transport costs increase the implied dispersion in amenities across cities.
8 This

number seems reasonable: estimates of government spending in transportation infrastructure as a share of
GDP come up with …gures around 1.5% (Congressional Budget O¢ ce, 2007).

21

As a result, with a …vefold increase in ; reallocations increase from 43% to 45% when cities have
average amenities, and utility now goes up by 14.3%, instead of by 2.3%. The reallocation if we
set excessive frictions to their average level remains relatively constant at 10%. The changes in city
sizes are highly correlated in the exercises with the two di¤erent values of . The correlation in the
population changes if we keep amenities constant is 0.53, if we keep e¢ ciency constant 0.95, and if
we keep excessive frictions constant 0.98.
0

-1

ln(prob > population)

-2

-3

-4

-5
Actual, Utility = 10.00
All Excessive Frictions at 10 Percentile, Utility = 10.13
All Excessive Frictions at 90 Percentile, Utility = 9.89
-6

6

8

10

12
ln(population)

14

16

18

Figure 4: Changing the Level of Excessive Frictions
Figure 4 shows a counterfactual exercise when we set excessive frictions in all cities equal to the
10th or 90th percentile of the distribution of excessive frictions. The …gure shows that reducing
frictions in all cities to the 10th percentile increases the dispersion of city sizes. Large cities bene…t
the most from the change, and small cities su¤er in terms of population. Utility increases by 1.3%.
The opposite e¤ect results from setting frictions to the 90th percentile, although the changes in the
distribution are much more modest. In this case utility declines by 1.1%, even though the distribution
is less dispersed. Note that by construction ln git and ln Nit are orthogonal so this relationship is
just the result of the fact that large cities use the commuting technology more intensively, as can be
22

seen in Section 2.4.
4.1 Adding Production Externalities
So far we have taken productivity in a particular city to be exogenously given. We have assumed
that the e¢ ciency of a particular site is not a¤ected by the level of economic activity at that site.
That is, so far, e¢ ciency has explained agglomeration, but we have assumed away the reverse link
by which agglomeration explains e¢ ciency. Of course, a standard view in urban economics suggests
that agglomeration is, at least in part, created by an increase in productivity coming from a rise in
the number of people living in a given city. Including these agglomeration e¤ects in our calculations
has the potential to change our results, as this will have an endogenous e¤ect on the size of a city.
To incorporate these e¤ects, we start with equation (18) but recognize that the term Ait , which
captures the e¢ ciency of city i, is a function of the size of the city Nit . In particular, we now let
Ait = A~it Nit! :

(20)

That is, the level of productivity is now a function of an exogenous shock A~it , and city size, Nit ,
where the elasticity of the e¢ ciency wedge with respect to population is given by !. Note that
externalities operate within cities, and not across cities. We can then use the previous calculation
of e¢ ciency wedges in the data, using equation (2), and divide by population raised to !. The
result is a set of new exogenous e¢ ciency levels A~it . We then substitute (20) in (18) and solve for
the

it ’s

that yield the city’s exact population levels. Excessive frictions are calculated as before.

With all the city shocks in hand, we can now perform the same set of counterfactual exercises as
before. Note that equation (18) now includes Nit in the productivity terms and so cannot be solved
analytically. However, we can solve the system of nonlinear equations numerically to obtain city
sizes in the counterfactual exercises.
We still need to determine a suitable value for !. Of course, the estimation of equation (14) is not
useful to determine !. In fact, this equation will …t exactly as in the data in our simulation of the
actual economy. Instead, we rely on the literature, that suggests a fairly robust estimate of ! = 0:02
(see, amongst others, Carlino, Chatterjee and Hunt, 2006, and Combes, et. al, 2009). We therefore
start with an initial value of 0:02 and perform some robustness checks. We also set
estimated in the previous section.

23

= 0:001 as

Counterfactuals Without One Shock,  = 0.001 ,  = 0.02
Counterfactual Utility = 10.1221
0

-1

-1
ln(prob > population)

ln(prob > population)

Model Utility = 10
0

-2
-3
-4
-5

12

13

-3
-4
-5

Actual
Modeled

-6
11

-2

14
15
ln(population)

16

-6

17

Actual
Avg. Efficiency
0

0

-1

-1

-2
-3
-4
-5
-6

5

10
ln(population)

15

15

20

-2
-3
-4
-5

Actual
Avg. Amenities
0

10
ln(population)

Counterfactual Utility = 9.9748

0

ln(prob > population)

ln(prob > population)

Counterfactual Utility = 10.1955

5

-6

20

Actual
Avg. Exc. Frictions
0

5

Figure 5: Counterfactuals Without one Shock and Externalities,

10
ln(population)

15

20

= 0:001, ! = 0:02

Figure 5 presents the exercise with externalities in the case where we eliminate each shock individually. First note that when we eliminate one of the shocks some cities no longer survive. In
particular, 5 cities exit when we equalize A~it across cities to its population weighted mean, 6 cities
exit when we set amenities to their average value, and 7 cities exit with average excessive frictions.
As in the case without externalities, these are cities that lose their only comparative advantage. With
externalities, this loss gets compounded, leading some small cities to exit. As for the large cities,
they tend to become a lot smaller when eliminating di¤erences in amenities, whereas their size does
not change much when equalizing exogenous e¢ ciency levels. This latter result can be explained
by the smaller dispersion in exogenous e¢ ciency. As for medium-sized cities, they generally bene…t
from the drop in size in many other cities. Compared to the case without externalities, utility drops.
24

With average e¢ ciency, utility declines from 10.25 to 10.12, and for average amenities utility declines
from 10.23 to 10.20. The utility levels with average excessive frictions declines from 10.005 to 9.97.
The gains are smaller with externalities because even though the convex commuting costs lead to
gains if cities become more alike, di¤erences in city characteristics make cities exploit the gains from
the external e¤ects. As we increase the elasticity of e¢ ciency to population size, the losses from the
second channel dominate when we eliminate di¤erences in one of the city characteristics.
Compared to the case without externalities, total reallocation required in the counterfactual tends
to go down when we eliminate e¢ ciency di¤erences (41.54%). This is natural as now a fraction of
the e¢ ciency di¤erences is explained by size. For the other two characteristics, reallocation increases
slightly to 44.03% in the case of average amenities, and more signi…cantly to 18.46% in the case of
average excessive frictions. This happens because the changes introduced by the elimination of these
shocks get compounded through the e¤ect of changes in population on e¢ ciency.
Figure 6 doubles the externality to ! = 0:04: This is closer to the estimate of 0.05 reported by
Behrens, Duranton and Robert-Nicoud (2010). In general, the e¤ects discussed before get exacerbated. Many more cities either exit or become very small. The results suggest that selection of
cities in the presence of externalities can be extremely important. Relative to the case without
externalities, the increase in externalities lowers the utility gain obtained if we equalize one of the
city characteristics. It also increases the decline in utility in the case of average excessive frictions
where many cities decline in size substantially. By equalizing exogenous characteristics, some of the
more attractive cities no longer bene…t from agglomeration economies, and utility drops.
Adding externalities in production implies that the equilibrium allocation we compute is no longer
e¢ cient. In contrast with the exogenous productivity case, city planners could improve on the
equilibrium allocation by subsidizing urban agglomeration. We can compute the optimal allocations
in the case with production externalities by letting a representative …rm internalize the external e¤ect
on productivity. Since the di¤erences in welfare between the cases with and without externalities
are so small, it is not surprising that the e¤ect of these optimal urban policies is necessarily small
as well. In fact, the gain in utility is only 0:06%: In the optimal allocation, some cities become very
small and all the rest increase their size slightly. Furthermore, the informational requirements for
these urban policies is extremely high so it is not clear that actual policy can achieve these small
gains. Figure A10 in Appendix A compares the optimal and actual allocations.

25

Counterfactuals Without One Shock,  = 0.001 ,  = 0.04
Counterfactual Utility = 10.0356
0

-1

-1
ln(prob > population)

ln(prob > population)

Model Utility = 10
0

-2
-3
-4
-5

12

13

-3
-4
-5

Actual
Modeled

-6
11

-2

14
15
ln(population)

16

-6

17

Actual
Avg. Efficiency
0

5

0

-1

-1

-2
-3
-4
-5
-6

5

10
ln(population)

15

20

-2
-3
-4
-5

Actual
Avg. Amenities
0

15

Counterfactual Utility = 9.9354

0

ln(prob > population)

ln(prob > population)

Counterfactual Utility = 10.1115

10
ln(population)

-6

20

Actual
Avg. Exc. Frictions
6

8

10

Figure 6: Counterfactuals Without one Shock and Externalities,

12
14
ln(population)

16

18

= 0:001, ! = 0:04

We should also mention here that the exercise with externalities leads to the possibility of multiple
equilibria in the size of cities. For many cities it will be the case that, given the equilibrium utility
level, there is only one equilibrium size. But for other cities it will be the case that there are several
possible equilibrium sizes. Our theory does not provide a way of selecting between these equilibria
so we always present the one that requires less reallocation. That is, we always initialize the search
for a solution of the size of a city at its actual size.

26

4.2 Adding Externalities to Amenities
We can also add externalities in the amenities a city provides. That is, we can let the utility from
living in a particular city depend on the size of the city directly. People live in New York because
living around a large number of people leads to a scale that provides them with a variety of goods
and services, and interactions with people, that they enjoy. We have modeled the preference to live
in a particular city through the amenity shocks
it

it .

So we can simply let

= ~ it Nit ;

where now ~ it is the exogenous amenity shock and

is the elasticity of amenities with respect to

population size.
We repeat the exercise in Figure 5 but now we let

= 0:02 as well. Figure 7 shows the results. The

results are qualitatively similar but now we observe that more cities become extremely small. That
is, the selection mechanism we emphasized above becomes stronger. Utility in all counterfactuals
decreases relative to Figure 5. Including the externality in amenities results now in small losses in the
case of identical exogenous productivity across cities, and 0.5% gains in the case where exogenous
amenities are constant. The decrease in utility is natural given that with externalities in both
production and amenities, equalizing city characteristics implies that externalities are not exploited
as much.
Perhaps surprisingly, the e¤ects on utility of eliminating the di¤erences in any of our three characteristics are extremely small in magnitude even though the implied reallocation of agents are, again,
fairly large. Eliminating e¢ ciency di¤erences reduces utility by less than 0.1% but implies that 42%
of agents reallocate. The same reallocation statistics when we eliminate amenity di¤erences is 40%
and 32% for excessive frictions. Most of the reallocation come from the extensive margin. Many
cities become extremely small: the city selection e¤ect. Once again, by equalizing a given characteristic, some small cities lose their only comparative advantage. This loss is compounded by the
existence of externalities, so that quite a few smaller cities become so small that they exit. However,
the reallocation has small e¤ects on agent’s utility since even though small cities do not experience
the bene…ts of large externalities they are not distorted through taxes since city infrastructure is
cheap. The slope of the envelope of the value of living in di¤erent cities is extremely ‡at, so agents
switching location lead to small utility gains.

27

Counterfactuals Without One Shock,  = 0.001 ,  = 0.02 ,  = 0.02
Counterfactual Utility = 9.9925
0

-1

-1
ln(prob > population)

ln(prob > population)

Model Utility = 10
0

-2
-3
-4
-5
-6
11

13

-3
-4
-5

Actual
Modeled
12

-2

14
15
ln(population)

16

-6

17

Actual
Avg. Efficiency
0

5

0

-1

-1

-2
-3
-4
-5
-6
-5

5
10
ln(population)

20

-2
-3
-4
-5

Actual
Avg. Amenities
0

15

Counterfactual Utility = 9.9148

0

ln(prob > population)

ln(prob > population)

Counterfactual Utility = 10.0505

10
ln(population)

15

-6

20

Actual
Avg. Exc. Frictions
6

8

Figure 7: Counterfactuals Without one Shock and Externalities,

10

12
14
ln(population)

= 0:001, ! = 0:02,

16

18

= 0:02

City selection can be most easily understood by studying what happens if we eliminate di¤erences
in all three city characteristics. In this case the urban structure has 61 cities with 3,360,745 agents
and the other 131 cities essentially disappear and preserve a population of only 613 agents in each
of them. Without any city characteristics, but with externalities, there are two city sizes that give
agents identical utility levels and the number of cities in each size is determined by the market
clearing condition so that all agents are housed in some city. So there is an equilibrium which
speci…es the number of cities of each type. The utility level in this case is 10.047. Thus, eliminating
all shocks yields bene…ts to agents as most of them can live in larger cities and the ones that do
not, live in small towns that have no congestion or infrastructure costs. Note again that since there
are no shocks we know that in this case there may be multiple equilibria. As before, in all cases we
28

compute the equilibrium with minimal reallocation of agents across cities, which also yields a level
of utility closest to the one in the actual distribution, which we normalize to 10.

0

-1

ln(prob > population)

-2

-3

-4

-5

-6

Actual, Utility = 10
No Shocks,  =  = 0.02, Utility = 10.047
No Shocks,  =  = 0.04, Utility = 9.951
No Shocks,  =  = 0.06, Utility = 9.856
6

8

10

12
ln(population)

14

Figure 8: Counterfactuals Without Shocks,

16

18

= 0:001

Figure 8 shows counterfactuals without shocks for di¤erent elasticities of city e¢ ciency and amenities to population size. Clearly, as we increase the elasticity, and therefore the externality, we still
have two sizes of cities, but the larger the externality, the larger and fewer the larger cities. So
larger externalities make the larger and smaller cities larger, and increase the number of small cities.
Furthermore, the larger the externality, the lower utility in the counterfactual without shocks. When
externalities are large, di¤erences across cities create agglomeration and result in bene…ts. Eliminating them yields lower utility.
5. THE EFFECT OF EFFICIENCY AND AMENITY SHOCKS
In this section we study the e¤ect on welfare and labor reallocation of shocks to e¢ ciency and
amenities. The model we have proposed to analyze the urban hierarchy has no dynamics, since all
29

factors reallocate in a frictionless manner across cities. There are some dynamics in the process of
accumulating capital but we neglect those and focus on the steady state (since these dynamics are
just aggregate and have been well studied in the macroeconomics literature).
The purpose here is to understand what are the magnitudes of welfare losses if the economy is
hit by, say, a 20% negative e¢ ciency shock. We consider a proportional decrease in productivity in
all cities and a random uniformly distributed proportional shock9 that amounts to di¤erent declines
in average productivity. Figure 9 shows the e¤ect on utility (top panel) and worker reallocation
(bottom panel). In this exercise we calculate utility including the gains from changes in land rents
in order to account exactly for an agent’s welfare (although this has a negligible impact).
As can be seen in Figure 9, if every city experiences a proportional reduction in e¢ ciency, the
urban hierarchy remains the same, so there is no reallocation of agents. In this case, the value of
commuting costs

does not a¤ect the slope of the welfare losses: the negative e¤ect on welfare of an

increase in the shock is independent of .10 The most important observation is that although shocks
reduce utility, they do so much less than proportionally. The reason is threefold. First, agents can
adjust their leisure as a result of the shock as well as the amount of capital. Second, agents obtain
utility out of the amenities in the city and so consumption of goods is only one of the elements
that determines an agent’s utility. The utility that agents obtain from city amenities amounts, on
average, to around 28% of an agent’s utility. Third, commuting costs and the distortions created to
build the related public infrastructure go down with productivity and wages.
If cities receive random, but on average negative, TFP shocks, the welfare costs are smaller, since
agents can relocate to the cities that received relatively good shocks. For example, for shocks that
reduce average TFP by 30%, welfare decreases by 4.6% rather than 5.3%. If we double commuting
costs to

= 0:002, the overall utility loss is slightly higher, as reallocation tends to go from smaller

to larger cities. The impact of higher commuting costs on reallocation is more substantial, since
higher congestion costs slow down the move towards larger cities. Overall, random shocks create
signi…cantly more reallocation, but the welfare implications are minor. The fact that all curves in
the top panel are close to each other suggests that changes in commuting costs, as well as including
externalities in production, have small e¤ects on the welfare consequences of these shocks. The …gure
also shows that in all these cases the urban structure, and in particular migration between cities,
9 We

use a proportional shock to productivity of the form sit = 0:5 + xit ; where xit U (0; 1) ; and sit is multiplied
by 1 minus the size of the average shock we analyze.
1 0 Of course, an increase in
leads to lower utility as more output is lost on commuting, but this does not show up
in the graphs, since in all cases the utility has been normalized to 10 when the shock is zero.

30

mitigates the impact of productivity shocks. It is also clear from the graph that the bene…ts from
the implied population reallocations are extremely small. In general, adding externalities leads to
more reallocation since many cities disappear. However, the welfare impact of these selection e¤ects
is, again, very small.
Welfare Effects of Productivity Shocks
10

9.9

Welfare

9.8

9.7

9.6
Proportional Shocks, all ,  = 0.00
Shocks Drawn from Uniform Distribution,  = 0.001,
Shocks Drawn from Uniform Distribution,  = 0.001,
Shocks Drawn from Uniform Distribution,  = 0.002,
Shocks Drawn from Uniform Distribution,  = 0.002,

9.5

9.4

0

0.05

 = 0.00
 = 0.02
 = 0.00
 = 0.02

0.1
0.15
0.2
Average Percent Decline in TFP

0.25

0.3

0.25

0.3

Worker Reallocation
0.4
Proportional Shocks, all ,  = 0.00
Shocks Drawn from Uniform Distribution,  = 0.001,
Shocks Drawn from Uniform Distribution,  = 0.001,
Shocks Drawn from Uniform Distribution,  = 0.002,
Shocks Drawn from Uniform Distribution,  = 0.002,

0.35

Worker Reallocation

0.3

 = 0.00
 = 0.02
 = 0.00
 = 0.02

0.25
0.2
0.15
0.1
0.05
0

0

0.05

0.1
0.15
0.2
Average Percent Decline in TFP

Figure 9: The E¤ect of Negative Productivity Shocks

31

Welfare Effects of Amenity Shocks
10

9.8

Welfare

9.6

9.4

9.2

Proportional Shocks,  = 0.001,  = 0.00
Shocks Drawn from Uniform Distribution,  = 0.001,
Shocks Drawn from Uniform Distribution,  = 0.001,
Proportional Shocks,  = 0.002,  = 0.00
Shocks Drawn from Uniform Distribution,  = 0.002,
Shocks Drawn from Uniform Distribution,  = 0.002,

9

8.8

0

0.05

 = 0.00
 = 0.02
 = 0.00
 = 0.02

0.1
0.15
0.2
Average Percent Decline in Amenities

0.25

0.3

0.25

0.3

Worker Reallocation
Proportional Shocks,  = 0.001,  = 0.00
Shocks Drawn from Uniform Distribution,  = 0.001,
Shocks Drawn from Uniform Distribution,  = 0.001,
Proportional Shocks,  = 0.002,  = 0.00
Shocks Drawn from Uniform Distribution,  = 0.002,
Shocks Drawn from Uniform Distribution,  = 0.002,

Worker Reallocation

0.5

0.4

 = 0.00
 = 0.02
 = 0.00
 = 0.02

0.3

0.2

0.1

0

0

0.05

0.1
0.15
0.2
Average Percent Decline in Amenities

Figure 10: The E¤ect of Negative Productivity Shocks
We can also study the e¤ect of amenity shocks. Figure 10 presents the results of a proportional
(amenities change in all cities by the same proportion) and a random uniformly distributed proportional shock (the average of the shock amounts to a given proportion). When the amenity shock is
proportional, there is reallocation of people across cities since the overall attractiveness of a city is
32

also formed by productivity and the e¤ectiveness in providing urban infrastructure.
The welfare losses from these shocks are larger than in the case of productivity. Since we know that
amenities amount to around 28% of average utility, we would expect welfare to go down by slightly
more than one quarter of the original shock. The calculation is not exact since reallocation and
other adjustments change the actual welfare losses, but it provides a helpful benchmark. In fact, the
good accuracy of this back-of-the-envelope calculation shows that the bene…ts from reallocation are
again very small. Adding externalities in this case always increases welfare, although not necessarily
reallocation (the e¤ect depends on the value of ). In the case of amenity shocks, an increase in the
value of

has a greater negative e¤ect on welfare, compared to the case of productivity shocks. This

happens because amenity shocks imply more reallocation than productivity shocks. The conclusion
is that shocks that yield on average a 30% reduction in amenities reduce welfare by around 7%.
6. CHINA
The most important …nding so far is that eliminating di¤erences in e¢ ciency, amenities or excessive
frictions leads to large reallocations of people but to small welfare e¤ects. It is unclear whether this
conclusion is general, inherent to the model, or speci…c to the U.S. To address this question, we
carry out a similar analysis for the case of China.
The details of the database we built for 212 Chinese cities for 2005 are given in Appendix B.2. The
data we need are the same as for the U.S. and come from China City Statistics and from the 2005 1%
Population Survey. Two further comments are in place. First, in China a prefecture-level city is an
administrative division below a province and above a county. Prefecture-level cities cover the entire
Chinese geography, and include both the urban parts and the rural hinterlands, and are therefore not
the same as cities in the U.S. Luckily, the data tend to provide separate information for the urban
parts of cities (referred to as districts under prefecture-level cities or also as city proper). In our
database we focus on those districts under prefecture-level cities, as these are the closest equivalents
to MSAs in the U.S. Second, when using Chinese data, the issue of their quality inevitably comes
up. City level data tend to be collected by local statistical agencies, and are commonly perceived to
be of very high quality.11
In order to estimate e¢ ciency, amenities and excessive frictions, we need to use parameter values
speci…c to the Chinese economy. We set the capital share of income
1 1 See

= 0:5221 and the real interest

Au and Henderson (2006) for a further discussion of the quality of city-level data in China.

33

rate r = 0:2008 (Bai et al., 2006). Consistent with our analysis of the U.S., we use the same approach
as McGrattan and Prescott (2009) to estimate

for China and …nd a value of 1:5247. Once again,

Appendix B.2 provides more details. In any case, the exact values for the di¤erent parameters play a
limited role. When using the U.S. parameter values for our exercise on China, the main …ndings are
largely unchanged. The reason is that modifying any of the parameter values has a limited impact
on the distribution of the relevant variables across cities. We set externalities equal to zero in all
exercises with Chinese data.
China: Counterfactuals Without One Shock,  = 0.001 ,  = 0 ,  = 0
Counterfactual Utility = 14.6992, Reallocation = 0.64395
0

-1

-1
ln(prob > population)

ln(prob > population)

Model Utility = 10
0

-2
-3
-4
-5

13

-3
-4
-5

Actual
Modeled

-6
12

-2

14
15
ln(population)

16

-6

17

0

-1

-1

-2
-3
-4
-5
-6

10

10

12
14
ln(population)

16

12
14
ln(population)

16

18

-2
-3
-4
-5

Actual
Avg. Amenities
8

8

Counterfactual Utility = 9.8496, Reallocation = 0.070892

0

ln(prob > population)

ln(prob > population)

Counterfactual Utility = 11.2977, Reallocation = 0.5001

Actual
Avg. Efficiency

-6
12

18

Actual
Avg. Exc. Frictions
13

14
15
ln(population)

16

17

Figure 11: China Counterfactuals Without one Shock
For the purpose of comparison, we run the same benchmark counterfactual exercise as in the
case of the U.S. This exercise shuts down in turn each of the three shocks (e¢ ciency, amenities and
34

excessive frictions). Results for China are shown in Figure 11, and should be compared to the results
for the U.S. in Figure 2.12 The most striking di¤erence with the U.S. is that the welfare e¤ects in
China are now an order of magnitude larger. If all Chinese cities had the same level of e¢ ciency,
welfare would increase by 47%, and if all had the same level of amenities, welfare would increase
by 13%. The corresponding …gures for the U.S. are 2.5% and 2.3%.13 Another way of seeing the
di¤erence in magnitude is that in order to maintain utility at its original level, it would be enough to
give all Chinese cities an e¢ ciency level corresponding to the lowest 27th percentile. Note also that
the total reallocation of population is similar to that in the U.S. even though the welfare gains are
much larger. Some examples can be informative: Both Beijing and Shanghai would lose about 31%
of its population if we equalize productivity. In contrast, if we equalize amenities, Beijing would lose
10% of its population while Shanghai would lose only 1%. Equalizing excessive frictions also leads to
large e¤ects in some cities. For example, Shenzhen, one of the “special economic zone” cities would
lose 71% of its population if we equalize excessive frictions.
Another di¤erence with the U.S. is that when equalizing e¢ ciency or amenities across Chinese
cities, the size distribution becomes more dispersed, with the larger cities being larger and the smaller
cities being smaller. Large cities in China in general are more e¢ cient, but have worse amenities,
than smaller cities (in comparison, in the U.S. larger cities score better on both accounts). If all
cities had the same amenities, the larger ones would become more attractive, making them even
larger. The opposite would happen with the smaller cities. Given that larger cities tend to be more
e¢ cient, it is not immediately obvious why equalizing e¢ ciency levels skews the distribution towards
larger cities. What happens here is that some of the intermediate-sized cities, with higher amenities
than the largest cities, now get higher levels of e¢ ciency, and end up becoming very large cities.
In other words, when equalizing amenities, the already larger cities become even larger, whereas
when equalizing e¢ ciency, some intermediate-sized cities become much larger. This is consistent
with population reallocation being lower when equalizing amenities (50%) than when equalizing
e¢ ciency (64%). Another potential explanation is that large cities, even though they are better
at everything, are arti…cially kept small by migration restrictions. The relatively small population
combined with large e¢ ciency would lead our model to estimate low amenities and high frictions for
1 2 There

is one di¤erence with the exercise we perform for the U.S. When shutting down a shock, we set it equal to
the median, rather than the weighted mean, of all cities. This change underestimates the di¤erence between China
and the U.S. We do this di¤erently because the weighted mean of Chinese city TFP would make cities so productive
that an equilibrium with the same number of cities does not exists.
1 3 Shocks in China were set equal to their median. Given that the median is below the mean, the …gures for China
should be interpreted as lower bounds.

35

these cities, leading to the mechanism described above. This would be consistent with the …nding
of Au and Henderson (2006) that Chinese cities are too small.
We have not yet discussed the e¤ect of equalizing excessive frictions across cities. When setting
excessive frictions equal to the median, we …nd that welfare declines by 1.5%. Though much smaller
than the e¤ects of amenities and e¢ ciency, its e¤ect is, once again, an order of magnitude larger
than in the U.S., where the corresponding number is an improvement of 0.05%. The relatively small
e¤ect does not imply that excessive frictions are small in China. To see this, Figure 12 shows the
impact on welfare and on the city size distribution if excessive frictions are set equal to the 90th and
the 10th percentile of the distribution of excessive frictions. If all cities had the excessive frictions of
the 90th percentile, welfare would drop by 6%, and the larger cities would become smaller. Likewise,
if all cities had the excessive frictions of the 10th percentile, welfare would improve by 4%, and the
larger cities would become larger. These e¤ects are substantially larger than the U.S. and far from
negligible.
Excessive Frictions Counterfactuals: China
0

-1

ln(prob > population)

-2

-3

-4

-5
All Excessive Frictions at 90 Percentile, Utility = 9.3989
All Excessive Frictions at 50 Percentile, Utility = 10
All Excessive Frictions at 10 Percentile, Utility = 10.3834
-6
10

11

12

13
14
ln(population)

15

Figure 12: Changing Excessive Frictions in China

36

16

17

7. CONCLUSION
In this paper we have decomposed the size distribution of cities into three main characteristics:
e¢ ciency, amenities, and excessive frictions. We …nd that each one of these components is important.
Eliminating di¤erences in any of them would imply large reallocations of people. In the U.S. the
welfare gains or losses associated with particular distributions of these characteristics are very small.
Eliminating any di¤erences in characteristics across cities yields welfare gains of at most 3%. Note
that the actual population movements required can be larger than 50%, so any small reallocation cost
would turn these gains into losses. We also include externalities in both productivity and amenities.
The welfare e¤ects associated with eliminating particular characteristics of cities are even smaller in
these cases, although we …nd a strong selection e¤ect in the counterfactual distributions. Namely,
many cities exit or become extremely small.
The negligible e¤ect in terms of welfare are not inherent to the model. Applying the same methodology to Chinese cities reveals welfare e¤ects that are an order of magnitude higher. Of course,
dynamic models in which reallocation a¤ects the growth rate could also lead to larger changes in
welfare in the U.S. The impact on welfare could be further enhanced if one were to add distributional e¤ects in a model with heterogeneous agents, or if the number of cities were smaller, making
reallocation by moving to similar cities more di¢ cult.
The results for the U.S. also suggest that a potential lack of mobility across locations (that could
be caused, for example, by agents being “underwater” with their mortgages) can at most involve
limited e¤ects on welfare. We …nd that a 20% reduction in productivity leads to a reduction in
welfare of between 3% and 4%, while a reduction of 20% in amenities leads to a reduction in welfare
of between 5% and 6%. These reductions in welfare change only by a small fraction of a percent
if we use idiosyncratic city shocks that average to the same decline. These results suggest that the
implied reallocation of agents that results from idiosyncratic shocks has small welfare e¤ects in the
U.S.
More generally, we have provided a simple methodology to study the determinants of the size
distribution of cities. This methodology can be useful in comparing urban systems across countries.
We have illustrated this by also analyzing the case of China. The data requirements to do the
exercise are not extreme, and it could shed light on the sources of deviations in urban systems across
countries. Such a comparison will be informative about the e¤ectiveness and the welfare e¤ects of
di¤erent policies aimed at making the location of agents across cities more e¢ cient.

37

REFERENCES
[1] Albouy, D., 2008. “Are Big Cities Really Bad Places to Live? Improving Quality-of-Life Estimates
across Cities,” NBER Working Papers 14472.
[2] Albouy, D., 2009. “What Are Cities Worth? Land Rents, Local Productivity, and the Capitalization
of Amenity Values,” NBER Working Papers 14981.
[3] Asdrubali, P., Sorensen, B.E. and Yosha, O., 1996. “Channels of Interstate Risk Sharing: United
States 1963-1990,” Quarterly Journal of Economics, 111, 1081-1110.
[4] Au, C.-C. and Henderson, J.V., 2006. “Are Chinese Cities Too Small?”, Review of Economic Studies,
73, 549-576.
[5] Bai, C.-E., Hsieh, C.-T. and Qian, Y., 2006. “The Return to Capital in China,” Brookings Papers
on Economic Activity, 37, 61-102.
[6] Behrens, K., Duranton, G. and Robert-Nicoud, F., 2010. “Productive Cities: Sorting, Selection, and
Agglomeration,” unpublished manuscript.
[7] Behrens, K., Mion, G., Murata, Y., and Südekum, J., 2010. Agglomeration and Firm Selection,
unpublished manuscript.
[8] Bleakley, H. and Lin J., 2010. “Portage: Path Dependence and Increasing Returns in U.S. History,”
NBER Working Papers 16314.
[9] Carlino, G., Chatterjee, S., and Hunt, R., 2006. “Urban Density and the Rate of Invention,”Working
Paper 06-14, Federal Reserve Bank of Philadelphia.
[10] Chari, V. V., Kehoe, P., McGrattan, E., 2007. “Business Cycle Accounting,” Econometrica, 75,
781-836.
[11] Combes, P, Duranton, G., Gobillon, L., Puga, Diego and Roux, S., 2009. “The productivity advantages of large cities: Distinguishing agglomeration from …rm selection,” CEPR Discussion
Papers 7191.
[12] Congressional Budget O¢ ce, 2007. “Trends in Public Spending on Transportation and Water Infrastructure, 1956 to 2004”, August.

38

[13] Córdoba, Juan Carlos, 2008. “On the Distribution of City Sizes,” Journal of Urban Economics, 63,
177-197.
[14] Davis, S.J. and Haltiwanger, J., 1992. “Gross Job Creation, Gross Job Destruction, and Employment
Reallocation,” Quarterly Journal of Economics, 107, 819-63.
[15] Davis, D., and Weinstein,D., 2002. “Bones, Bombs, and Break Points: The Geography of Economic
Activity,” American Economic Review, 92, 1269-1289.
[16] Duranton, Gilles, 2007. “Urban Evolutions: The Fast, the Slow, and the Still,”American Economic
Review, 97, 197-221.
[17] Duranton, Gilles and Henry Overman, 2008. “Exploring the Detailed Location Patterns of U.K.
Manufacturing Industries Using Micro-Geographic Data,”Journal of Regional Science, 48, 213243.
[18] Gabaix, X., 1999a. “Zipf’S Law for Cities: An Explanation,” Quarterly Journal of Economics, 114,
739-767.
[19] Gabaix, X., 1999b. “Zipf’s Law and the Growth of Cities,”American Economic Review, 89, 129-132.
[20] Garofalo, G.A. and Yamarik, S., 2002. “Regional Convergence: Evidence from a New State-by-State
Capital Stock Series,” Review of Economics and Statistics, 84, 316-323.
[21] Glaeser, E., Kolko, J., and Saiz, A., 2001. “Consumer City,” Journal of Economic Geography, 1,
27-50.
[22] Glaeser, E., Gyourko, J. and Saks, R., 2005. “Why Is Manhattan So Expensive? Regulation and
the Rise in Housing Prices,” Journal of Law and Economics, 48, 331-369.
[23] Hess, G.D. and Shin, K., 1997. “International and Intranational Business Cycles,”Oxford Review of
Economic Policy, 13, 93-109.
[24] Holmes, T., 2005. “The Location of Sales O¢ ces and the Attraction of Cities,” Journal of Political
Economy, 113, 551-581.
[25] Holmes, T., and Stevens, J., 2002. “Geographic Concentration and Establishment Scale,”The Review
of Economics and Statistics, 84, 682-690.

39

[26] Holmes, T., and Stevens, J., 2004. “Spatial distribution of economic activities in North America,”
Handbook of Regional and Urban Economics, in: J. V. Henderson & J. F. Thisse (ed.), V. 4,
Chapter 63, 2797-2843, Elsevier.
[27] Lucas, R. E., 1987. Models of Business Cycles, Basil Blackwell.
[28] Lustig, H. and Van Nieuwerburgh, S., 2010. “How Much Does Household Collateral Constrain
Regional Risk Sharing?”, Review of Economic Dynamics, 13, 265-294.
[29] McGrattan, E. and Prescott, E., 2009. “Unmeasured Investment and the Puzzling U.S. Boom in the
1990s ,” Research Department Sta¤ Report 369, Federal Reserve Bank of Minneapolis.
[30] Rappaport, J., 2008. “Consumption amenities and city population density,” Regional Science and
Urban Economics, 38, 533-552.
[31] Rappaport, J., 2009. “The increasing importance of quality of life,”Journal of Economic Geography,
9, 779-804.
[32] Rappaport, J. and Sachs, J. D., 2003. “The United States as a Coastal Nation,”Journal of Economic
Growth, 8, 5-46.
[33] Rossi-Hansberg, Esteban and Mark Wright, 2007. “Urban Structure and Growth,” Review of Economic Studies, 74, 597-624.
[34] Storesletten, K., Telmer, C. and Yaron, A., 2001. “The Welfare Cost of Business Cycles Revisited:
Finite Lives and Cyclical Variation in Idiosyncratic Risk,” European Economic Review, 45,
1311-1339. Economic Review, 45, 1311-1339.

40

Detroit‐Warren‐Livonia
Tampa‐St. Petersburg‐Clearwater
San Diego‐Carlsbad‐San Marcos
Savannah
Virginia Beach‐Norfolk‐Newport News
Utica‐Rome
Eugene‐Springfield
Augusta‐Richmond County
San Francisco‐Oakland‐Fremont
Dallas‐Fort Worth‐Arlington
Salem
Gainesville
Brownsville‐Harlingen
Baltimore‐Towson
York‐Hanover
Deltona‐Daytona Beach‐Ormond Beach
Fayetteville‐Springdale‐Rogers
Philadelphia‐Camden‐Wilmington
Canton‐Massillon
Houston‐Sugar Land‐Baytown
Orlando‐Kissimmee
Poughkeepsie‐Newburgh‐Middletown
Johnstown
Jackson
Denver‐Aurora‐Broomfield
Reading
Kalamazoo‐Portage
Modesto
Cincinnati‐Middletown
Yakima
Boston‐Cambridge‐Quincy
Portland‐Vancouver‐Beaverton
Lansing‐East Lansing
Bellingham
Buffalo‐Niagara Falls
Austin‐Round Rock
Minneapolis‐St. Paul‐Bloomington
Pittsburgh
Oklahoma City
Binghamton
Las Vegas‐Paradise
St. Louis
Cleveland‐Elyria‐Mentor
Bremerton‐Silverdale
Honolulu
Corpus Christi
San Jose‐Sunnyvale‐Santa Clara
Kansas City
Jacksonville
Rockford
Sioux Falls
Albuquerque
Provo‐Orem
Youngstown‐Warren‐Boardman
Niles‐Benton Harbor
Topeka
Columbia
Fayetteville
Mobile
Raleigh‐Cary

Santa Fe
Palm Bay‐Melbourne‐Titusville
Pensacola‐Ferry Pass‐Brent
Tucson
Champaign‐Urbana
Holland‐Grand Haven
El Paso
Flint
Fort Collins‐Loveland
Asheville
Chico
Springfield
Salinas
Fresno
Ogden‐Clearfield
Bakersfield
Bloomington
Riverside‐San Bernardino‐Ontario
Visalia‐Porterville
Worcester
Stockton
Tallahassee
Santa Cruz‐Watsonville
Los Angeles‐Long Beach‐Santa Ana
Phoenix‐Mesa‐Scottsdale
New York‐Northern New Jersey‐Long Island
Laredo
Chicago‐Naperville‐Joliet
Colorado Springs
Oxnard‐Thousand Oaks‐Ventura
Anderson
Allentown‐Bethlehem‐Easton
Atlanta‐Sandy Springs‐Marietta
Hickory‐Lenoir‐Morganton
Cape Coral‐Fort Myers
Sacramento‐Arden‐Arcade‐Roseville

Percentage Change in Population
opulation

Dayton
Hagerstown‐Martinsburg
Lancaster
Vineland‐Millville‐Bridgeton
Muskegon‐Norton Shores
Columbus
Grand Rapids‐Wyoming
Lynchburg
Akron
Tulsa
Richmond
Tuscaloosa
Seattle‐Tacoma‐Bellevue
Springfield
Rochester
Racine
Duluth
Pueblo
Salt Lake City
Albany‐Schenectady‐Troy
Milwaukee‐Waukesha‐West Allis
Memphis
Scranton‐Wilkes‐Barre
Indianapolis‐Carmel
Toledo
Erie
Birmingham‐Hoover
Naples‐Marco Island
Joplin
Boise City‐Nampa
Syracuse
Columbus
Johnson City
Chattanooga
Jacksonville
Ocala
Omaha‐Council Bluffs
Coeur d'Alene
Lubbock
San Luis Obispo‐Paso Robles
Spokane
Ann Arbor
Janesville
San Antonio
Hartford‐West Hartford‐East Hartford
Saginaw‐Saginaw Township North
Wichita
Huntington‐Ashland
Portland‐South Portland‐Biddeford
Medford
Peoria
Fort Wayne
Harrisburg‐Carlisle
Baton Rouge
Charlotte‐Gastonia‐Concord
Knoxville
McAllen‐Edinburg‐Mission
Greeley
Norwich‐New London
Springfield
Eau Claire
Punta Gorda
Iowa City
Amarillo
Reno‐Sparks
Greensboro‐High Point
Huntsville
Beaumont‐Port Arthur
Lexington‐Fayette
La Crosse
Davenport‐Moline‐Rock Island
Evansville
Madison
Roanoke
Boulder
Green Bay
Winston‐Salem
Durham‐Chapel Hill
Napa
Charleston
Des Moines‐West Des Moines
Bridgeport‐Stamford‐Norwalk
Trenton‐Ewing
Appleton
Cedar Rapids
Billings
Waterloo‐Cedar Falls
Gulfport‐Biloxi
Bloomington‐Normal
Bangor
Burlington‐South Burlington
Wausau
Lafayette
South Bend‐Mishawaka
Santa Rosa‐Petaluma
Fargo

Percentage Change in Population
pulation

APPENDIX A: THEORY-BASED COUNTERFACTUAL POPULATION
CHANGES

Cities with Largest Percentage Change in City Population
Without Amenity Differences

15
14
13
12
11
10
9
8
7
6
5
4
3
2
1
0

Cities with Smallest Percentage Change in City Population
Without Amenity Differences

0.8
1

0.6

0.4
0
4

0.2

‐0.2
0

‐0.4

‐0.6

‐0.8

‐1

Figure A1: Changes in Population Sizes with Average Amenities

41

Knoxville
Napa
Huntsville
Hartford‐West Hartford‐East Hartford
San Luis Obispo‐Paso Robles
Appleton
Reno‐Sparks
Harrisburg‐Carlisle
Lexington‐Fayette
Fort Wayne
Omaha‐Council Bluffs
Baton Rouge
Wichita
Peoria
San Antonio
Milwaukee‐Waukesha‐West Allis
Indianapolis‐Carmel
Beaumont‐Port Arthur
Madison
Wausau
Greensboro‐High Point
Springfield
Boulder
Norwich‐New London
Ann Arbor
Billings
Birmingham‐Hoover
Green Bay
Memphis
Cedar Rapids
Burlington‐South Burlington
Roanoke
Charlotte‐Gastonia‐Concord
Davenport‐Moline‐Rock Island
San Jose‐Sunnyvale‐Santa Clara
Huntington‐Ashland
Sioux Falls
Syracuse
Richmond
Rochester
Columbus
Cleveland‐Elyria‐Mentor
Evansville
Spokane
Winston‐Salem
Columbus
Boston‐Cambridge‐Quincy
Toledo
Kansas City
Minneapolis‐St. Paul‐Bloomington
Dayton
Portland‐South Portland‐Biddeford
Pittsburgh
Tulsa
Albany‐Schenectady‐Troy
Houston‐Sugar Land‐Baytown
Iowa City
Philadelphia‐Camden‐Wilmington
Saginaw‐Saginaw Township North
Jacksonville
Amarillo
Waterloo‐Cedar Falls
Las Vegas‐Paradise
Bangor
Portland‐Vancouver‐Beaverton
Cincinnati‐Middletown
Dallas‐Fort Worth‐Arlington
Raleigh‐Cary
Grand Rapids‐Wyoming
Jacksonville
Charleston
Oklahoma City
Honolulu
Austin‐Round Rock
Buffalo‐Niagara Falls
Denver‐Aurora‐Broomfield
Akron
Des Moines‐West Des Moines
Albuquerque
Fayetteville
Detroit‐Warren‐Livonia
Seattle‐Tacoma‐Bellevue
New York‐Northern New Jersey‐Long Island
San Francisco‐Oakland‐Fremont
Columbia
Baltimore‐Towson
Salt Lake City
Salem
Bloomington‐Normal
Youngstown‐Warren‐Boardman
Fargo
Chicago‐Naperville‐Joliet
Trenton‐Ewing
Orlando‐Kissimmee
Chattanooga

Percentage Change in Population
opulation

Rockford
Phoenix‐Mesa‐Scottsdale
Lynchburg
Tuscaloosa
Bremerton‐Silverdale
Augusta‐Richmond County
Springfield
Binghamton
Topeka
Niles‐Benton Harbor
Kalamazoo‐Portage
Allentown‐Bethlehem‐Easton
Yakima
York‐Hanover
Fayetteville‐Springdale‐Rogers
Eau Claire
Colorado Springs
Bakersfield
Fresno
Oxnard‐Thousand Oaks‐Ventura
El Paso
Utica‐Rome
Canton‐Massillon
Eugene‐Springfield
Worcester
Lafayette
Vineland‐Millville‐Bridgeton
Tucson
Gainesville
Hickory‐Lenoir‐Morganton
Savannah
Cape Coral‐Fort Myers
Springfield
St. Louis
Jackson
Joplin
Anderson
Flint
Reading
Tallahassee
Riverside‐San Bernardino‐Ontario
Holland‐Grand Haven
Bloomington
Palm Bay‐Melbourne‐Titusville
Medford
Champaign‐Urbana
Santa Cruz‐Watsonville
Fort Collins‐Loveland
Asheville
Pensacola‐Ferry Pass‐Brent
Stockton
Bellingham
Visalia‐Porterville
Salinas
Ogden‐Clearfield
Chico
Brownsville‐Harlingen
Deltona‐Daytona Beach‐Ormond Beach
Laredo
Poughkeepsie‐Newburgh‐Middletown
Modesto
Provo‐Orem
Santa Fe
Johnstown
McAllen‐Edinburg‐Mission
Pueblo
Ocala
Greeley
Hagerstown‐Martinsburg
Punta Gorda
Muskegon‐Norton Shores
Coeur d'Alene

Duluth
Sacramento‐Arden‐Arcade‐Roseville
South Bend‐Mishawaka
Lansing‐East Lansing
Corpus Christi
Mobile
Racine
Janesville
Lancaster
Naples‐Marco Island
Bridgeport‐Stamford‐Norwalk

Durham‐Chapel Hill
Boise City‐Nampa
Atlanta‐Sandy Springs‐Marietta
Scranton‐Wilkes‐Barre
Virginia Beach‐Norfolk‐Newport News
Johnson City
Gulfport‐Biloxi
Lubbock
Los Angeles‐Long Beach‐Santa Ana
Santa Rosa‐Petaluma
Erie
San Diego‐Carlsbad‐San Marcos
La Crosse
Tampa‐St. Petersburg‐Clearwater

Percentage Change in Population
opulation

Cities with Largest Percentage Change in City Population
Without Efficency Differences

34

29

24

19

14

9

4

‐1
1

Cities with Smallest Percentage Change in City Population
Without Efficency Differences

0

‐0.2

‐0.4

‐0.6

‐0.8

‐1

Figure A2: Changes in Population Sizes with Average E¢ ciency

42

Hagerstown‐Martinsburg
Muskegon‐Norton Shores
Coeur d'Alene
Medford
Santa Fe
Bangor
Poughkeepsie‐Newburgh‐Middletown
St. Louis
Fargo
McAllen‐Edinburg‐Mission
Ocala
Reading
Bellingham
Riverside‐San Bernardino‐Ontario
Modesto
Springfield
Cape Coral‐Fort Myers
Phoenix‐Mesa‐Scottsdale
Eau Claire
Asheville
Roanoke
Chattanooga
Provo‐Orem
Joplin
Burlington‐South Burlington
Boise City‐Nampa
San Antonio
Punta Gorda
Savannah
Oxnard‐Thousand Oaks‐Ventura
Portland‐South Portland‐Biddeford
Johnstown
Billings
Canton‐Massillon
Ogden‐Clearfield
Tampa‐St. Petersburg‐Clearwater
South Bend‐Mishawaka
Lancaster
Palm Bay‐Melbourne‐Titusville
Worcester
Amarillo
La Crosse
Wausau
Greeley
Deltona‐Daytona Beach‐Ormond Beach
Santa Cruz‐Watsonville
Atlanta‐Sandy Springs‐Marietta
Appleton
Los Angeles‐Long Beach‐Santa Ana
Fort Collins‐Loveland
Jacksonville
Madison
Pueblo
Naples‐Marco Island
Stockton
Lubbock
Springfield
Tallahassee
Orlando‐Kissimmee
Raleigh‐Cary
Laredo
Columbus
Allentown‐Bethlehem‐Easton
Reno‐Sparks
Cedar Rapids
Sioux Falls
Sacramento‐Arden‐Arcade‐Roseville
Pensacola‐Ferry Pass‐Brent
Baltimore‐Towson
Las Vegas‐Paradise
Eugene‐Springfield
Kansas City
Dallas‐Fort Worth‐Arlington
San Jose‐Sunnyvale‐Santa Clara
Hickory‐Lenoir‐Morganton
San Diego‐Carlsbad‐San Marcos
Salinas
Akron
Mobile
Salem
Columbia
Austin‐Round Rock
Vineland‐Millville‐Bridgeton
San Francisco‐Oakland‐Fremont
Fayetteville‐Springdale‐Rogers
Grand Rapids‐Wyoming
Minneapolis‐St. Paul‐Bloomington
Albuquerque
Albany‐Schenectady‐Troy
Lexington‐Fayette
Chico
Denver‐Aurora‐Broomfield

Percentage Change in Population
pulation

Chicago‐Naperville‐Joliet
Colorado Springs
Huntsville
New York‐Northern New Jersey‐Long Island
Seattle‐Tacoma‐Bellevue
Santa Rosa‐Petaluma
Portland‐Vancouver‐Beaverton
Knoxville
Tucson
York‐Hanover
Gainesville
Janesville
Winston‐Salem
Visalia‐Porterville
Greensboro‐High Point
Fresno
Des Moines‐West Des Moines
Flint
Utica‐Rome
Rockford
Philadelphia‐Camden‐Wilmington
Oklahoma City
Omaha‐Council Bluffs
Lynchburg
Boston‐Cambridge‐Quincy
Birmingham‐Hoover
Tulsa
Topeka
Erie
Memphis
Corpus Christi
Scranton‐Wilkes‐Barre
Cincinnati‐Middletown
Salt Lake City
Bakersfield
Wichita
Harrisburg‐Carlisle
Indianapolis‐Carmel
Brownsville‐Harlingen
San Luis Obispo‐Paso Robles
Norwich‐New London
Detroit‐Warren‐Livonia
Virginia Beach‐Norfolk‐Newport News
Kalamazoo‐Portage
Pittsburgh
Youngstown‐Warren‐Boardman
Richmond
Rochester
Duluth
Honolulu
Toledo
Hartford‐West Hartford‐East Hartford
Tuscaloosa
Jackson
Augusta‐Richmond County
Buffalo‐Niagara Falls
Iowa City
Champaign‐Urbana
Binghamton
Charlotte‐Gastonia‐Concord
Syracuse
Holland‐Grand Haven
Waterloo‐Cedar Falls
Bridgeport‐Stamford‐Norwalk
Gulfport‐Biloxi
Spokane
Lansing‐East Lansing
Davenport‐Moline‐Rock Island
Houston‐Sugar Land‐Baytown
Cleveland‐Elyria‐Mentor
Green Bay
Bloomington‐Normal
Milwaukee‐Waukesha‐West Allis
Boulder
Huntington‐Ashland
Fort Wayne
Peoria
El Paso
Bremerton‐Silverdale
Johnson City
Beaumont‐Port Arthur
Bloomington
Napa
Saginaw‐Saginaw Township North
Yakima
Dayton
Trenton‐Ewing
Springfield
Baton Rouge
Niles‐Benton Harbor
Racine
Ann Arbor
Lafayette
Charleston
Evansville
Anderson
Fayetteville
Durham‐Chapel Hill
Columbus
Jacksonville

Percentage Change in Population

Cities with Positive Percentage Change in City Population
Without Excessive Friction Differences

1.8

1.6

1.4

1.2

0.8
1

0.6

0.4

0.2

0

Cities with Negative Percentage Change in City Population
Without Excessive Friction Differences

0

‐0.2

‐0.4

‐0.6

‐0.8

‐1

Figure A3: Changes in Population Sizes with Average Excessive Frictions

43

South Bend‐Mishawaka
Waterloo‐Cedar Falls
Santa Rosa‐Petaluma
Cedar Rapids
Fargo
Burlington‐South Burlington
Appleton
Napa
Wausau
Roanoke
Billings
Iowa City
Amarillo
Bangor
La Crosse
Janesville
Eau Claire
Vineland‐Millville‐Bridgeton
Joplin
Oxnard‐Thousand Oaks‐Ventura
Medford
Bakersfield
Cape Coral‐Fort Myers
Fresno
Worcester
Anderson
Bellingham
El Paso
Tallahassee
Tucson
Bloomington
Flint
Santa Cruz‐Watsonville
Holland‐Grand Haven
Asheville
Champaign‐Urbana
Palm Bay‐Melbourne‐Titusville
Pensacola‐Ferry Pass‐Brent
Santa Fe
Los Angeles‐Long Beach‐Santa Ana
Salinas
Riverside‐San Bernardino‐Ontario
Chico
Phoenix‐Mesa‐Scottsdale
Ogden‐Clearfield
Visalia‐Porterville
Stockton
Colorado Springs
New York‐Northern New Jersey‐Long Island
Chicago‐Naperville‐Joliet
Laredo
Allentown‐Bethlehem‐Easton
Atlanta‐Sandy Springs‐Marietta
Hickory‐Lenoir‐Morganton
Sacramento‐Arden‐Arcade‐Roseville
Detroit‐Warren‐Livonia
Tampa‐St. Petersburg‐Clearwater
San Diego‐Carlsbad‐San Marcos
Virginia Beach‐Norfolk‐Newport News
Savannah
Dallas‐Fort Worth‐Arlington
San Francisco‐Oakland‐Fremont
Salem
Poughkeepsie‐Newburgh‐Middletown
Augusta‐Richmond County
Utica‐Rome
Eugene‐Springfield
Baltimore‐Towson
Philadelphia‐Camden‐Wilmington
Houston‐Sugar Land‐Baytown
Orlando‐Kissimmee
York‐Hanover
Gainesville
Fayetteville‐Springdale‐Rogers
Denver‐Aurora‐Broomfield
Muskegon‐Norton Shores
Canton‐Massillon
Hagerstown‐Martinsburg
Boston‐Cambridge‐Quincy
Cincinnati‐Middletown
Kalamazoo‐Portage
Provo‐Orem
Portland‐Vancouver‐Beaverton
Jackson
Minneapolis‐St. Paul‐Bloomington
Buffalo‐Niagara Falls
Pittsburgh

Bloomington‐Normal
Brownsville‐Harlingen
Deltona‐Daytona Beach‐Ormond Beach
Fort Collins‐Loveland
Gulfport‐Biloxi
Johnstown
Lafayette
Modesto
Springfield

Percentage Change in Population
opulation

Austin‐Round Rock
Yakima
Pueblo
Lansing‐East Lansing
Reading
Las Vegas‐Paradise
Oklahoma City
Cleveland‐Elyria‐Mentor
Coeur d'Alene
San Jose‐Sunnyvale‐Santa Clara
Honolulu
Sioux Falls
Kansas City
Binghamton
Jacksonville
Corpus Christi
Bremerton‐Silverdale
Albuquerque
Youngstown‐Warren‐Boardman
Dayton
Ocala
Columbia
Rockford
Raleigh‐Cary
Fayetteville
Columbus
Richmond
St. Louis
Grand Rapids‐Wyoming
Tulsa
Rochester
Mobile
Akron
Niles‐Benton Harbor
Topeka
Milwaukee‐Waukesha‐West Allis
Lancaster
Indianapolis‐Carmel
Seattle‐Tacoma‐Bellevue
Memphis
Albany‐Schenectady‐Troy
Lynchburg
Salt Lake City
Birmingham‐Hoover
Toledo
Tuscaloosa
Racine
Punta Gorda
Duluth
Syracuse
Springfield
Greeley
Scranton‐Wilkes‐Barre
McAllen‐Edinburg‐Mission
Erie
Columbus
Boise City‐Nampa
Naples‐Marco Island
San Luis Obispo‐Paso Robles
Jacksonville
Johnson City
Omaha‐Council Bluffs
Hartford‐West Hartford‐East Hartford
Chattanooga
Ann Arbor
Spokane
San Antonio
Wichita
Charlotte‐Gastonia‐Concord
Baton Rouge
Lubbock
Peoria
Huntington‐Ashland
Harrisburg‐Carlisle
Fort Wayne
Saginaw‐Saginaw Township North
Portland‐South Portland‐Biddeford
Knoxville
Norwich‐New London
Springfield
Greensboro‐High Point
Reno‐Sparks
Huntsville
Beaumont‐Port Arthur
Lexington‐Fayette
Evansville
Davenport‐Moline‐Rock Island
Madison
Green Bay
Boulder
Durham‐Chapel Hill
Winston‐Salem
Bridgeport‐Stamford‐Norwalk
Charleston
Des Moines‐West Des Moines
Trenton‐Ewing

Percentage Change in Population

Cities with Largest Percentage Change in City Population
Without Amenity Differences

15
14
13
12
11
10
9
8
7
6
5
4
3
2
1
0
‐1

Cities with Smallest Percentage Change in City Population
Without Amenity Differences

0.8
1

0.6

0
4
0.4

0.2

‐0.2
0

‐0.4

‐0.6

‐0.8

‐1

Figure A4: Changes in Population Sizes with Average Amenities (with Externalities)

44

Appleton
Evansville
Greeley
Knoxville
McAllen‐Edinburg‐Mission
Modesto
Ocala
Poughkeepsie‐Newburgh‐Middletown
Provo‐Orem
Pueblo
Punta Gorda
South Bend‐Mishawaka
Waterloo‐Cedar Falls
Laredo
Chico
Hagerstown‐Martinsburg
Johnstown
Coeur d'Alene
Muskegon‐Norton Shores
Asheville
Fort Collins‐Loveland
Santa Fe
Santa Cruz‐Watsonville
Reading
St. Louis
Bellingham
Rochester
Vineland‐Millville‐Bridgeton
Joplin
Memphis
Toledo
Milwaukee‐Waukesha‐West Allis
Indianapolis‐Carmel
Birmingham‐Hoover
Medford
Syracuse
Johnson City
Lubbock
Columbus
Janesville
Jacksonville
Portland‐South Portland‐Biddeford
Eau Claire
Spokane
San Antonio
Saginaw‐Saginaw Township North
Omaha‐Council Bluffs
Ann Arbor
Huntington‐Ashland
Amarillo
Wichita
La Crosse
Peoria
Iowa City
Harrisburg‐Carlisle
Fort Wayne
Norwich‐New London
San Luis Obispo‐Paso Robles
Springfield
Hartford‐West Hartford‐East Hartford
Roanoke
Reno‐Sparks
Huntsville
Bangor
Baton Rouge
Billings
Lexington‐Fayette
Greensboro‐High Point
Madison
Charlotte‐Gastonia‐Concord
Napa
Beaumont‐Port Arthur
Boulder
Green Bay
Davenport‐Moline‐Rock Island
Cedar Rapids
Burlington‐South Burlington
Winston‐Salem
Wausau
San Jose‐Sunnyvale‐Santa Clara
Sioux Falls
Des Moines‐West Des Moines
Richmond
Charleston
Cleveland‐Elyria‐Mentor
Boston‐Cambridge‐Quincy
Columbus
Fargo
Trenton‐Ewing
Houston‐Sugar Land‐Baytown
Minneapolis‐St. Paul‐Bloomington
Dayton
Pittsburgh
Bloomington‐Normal
Kansas City

Percentage Change in Population
pulation

Durham‐Chapel Hillll
n
Philadelphia‐Camden‐Wilmington
xi
Gulfport‐Biloxi
Tulsaa
Albany‐Schenectady‐Troyy
Santa Rosa‐Petalumaa
n
Dallas‐Fort Worth‐Arlington
n
Cincinnati‐Middletown
n
Portland‐Vancouver‐Beaverton
Las Vegas‐Paradisee
Bridgeport‐Stamford‐Norwalkk
d
New York‐Northern New Jersey‐Long Island
d
Denver‐Aurora‐Broomfield
Buffalo‐Niagara Fallss
u
Honolulu
Oklahoma Cityy
Detroit‐Warren‐Livoniaa
Austin‐Round Rockk
Raleigh‐Caryy
Fayettevillee
Grand Rapids‐Wyomingg
Jacksonvillee
et
Chicago‐Naperville‐Joliet
San Francisco‐Oakland‐Fremontt
Akron
n
Salem
m
Baltimore‐Towson
n
Albuquerquee
Los Angeles‐Long Beach‐Santa Anaa
Atlanta‐Sandy Springs‐Mariettaa
n
Youngstown‐Warren‐Boardman
Seattle‐Tacoma‐Bellevuee
Salt Lake Cityy
Columbiaa
Orlando‐Kissimmeee
Virginia Beach‐Norfolk‐Newport Newss
Scranton‐Wilkes‐Barree
San Diego‐Carlsbad‐San Marcoss
Tampa‐St. Petersburg‐Clearwaterr
Sacramento‐Arden‐Arcade‐Rosevillee
Eriee
Chattanoogaa
Boise City‐Nampaa
Lansing‐East Lansingg
h
Duluth
Racinee
Lafayettee
ti
Corpus Christi
Mobilee
Phoenix‐Mesa‐Scottsdalee
Rockford
d
Lancasterr
Naples‐Marco Island
d
Augusta‐Richmond Countyy
Bremerton‐Silverdalee
Tuscaloosaa
Lynchburgg
n
Binghamton
Niles‐Benton Harborr
Topekaa
Yakimaa
n
Allentown‐Bethlehem‐Easton
Kalamazoo‐Portagee
York‐Hanoverr
Fayetteville‐Springdale‐Rogerss
d
Bakersfield
Colorado Springss
o
Fresno
d
Springfield
o
El Paso
n
Tucson
Oxnard‐Thousand Oaks‐Venturaa
Utica‐Romee
Worcesterr
d
Eugene‐Springfield
Gainesvillee
n
Hickory‐Lenoir‐Morganton
n
Canton‐Massillon
d
Springfield
n
Jackson
h
Savannah
n
Anderson
o
Riverside‐San Bernardino‐Ontario
Flintt
Cape Coral‐Fort Myerss
n
Holland‐Grand Haven
Bloomington
n
Tallahasseee
Palm Bay‐Melbourne‐Titusvillee
Champaign‐Urbanaa
Pensacola‐Ferry Pass‐Brentt
n
Stockton
Visalia‐Portervillee
Salinass
d
Ogden‐Clearfield
n
Brownsville‐Harlingen
h
Deltona‐Daytona Beach‐Ormond Beach

Percentage Change in Population

Cities with Largest Percentage Change in City Population
Without Efficency Differences

11

9

7

5

3

1

‐1

Cities with Smallest Percentage Change in City Population
Without Efficency Differences

0

‐0.2

‐0.4

‐0.6

‐0.8

‐1

Figure A5: Changes in Population Sizes with Average E¢ ciency (with Externalities)

45

Fort Collins‐Loveland
Janesville
Laredo
Lubbock
McAllen‐Edinburg‐Mission
Modesto
Santa Cruz‐Watsonville
Oxnard‐Thousand Oaks‐Ventura
Visalia‐Porterville
Lexington‐Fayette
York‐Hanover
Madison
Huntington‐Ashland
Fayetteville‐Springdale‐Rogers
Boulder
Pensacola‐Ferry Pass‐Brent
Kalamazoo‐Portage
Mobile
Rockford
Huntsville
Scranton‐Wilkes‐Barre
Palm Bay‐Melbourne‐Titusville
Deltona‐Daytona Beach‐Ormond Beach
Salinas
Holland‐Grand Haven
Bremerton‐Silverdale
Reno‐Sparks
Yakima
Lancaster
Ogden‐Clearfield
Boise City‐Nampa
Duluth
Binghamton
Hickory‐Lenoir‐Morganton
Gulfport‐Biloxi
Racine
Erie
Springfield
Utica‐Rome
Norwich‐New London
Portland‐South Portland‐Biddeford
Eugene‐Springfield
Saginaw‐Saginaw Township North
Champaign‐Urbana
Tallahassee
Cape Coral‐Fort Myers
Johnson City
Chattanooga
Provo‐Orem
Savannah
Canton‐Massillon
Bloomington
Lynchburg
Gainesville
Anderson
Topeka
Niles‐Benton Harbor
Tuscaloosa
Naples‐Marco Island
Poughkeepsie‐Newburgh‐Middletown
Bloomington‐Normal
Waterloo‐Cedar Falls
Springfield
Cedar Rapids
Chico
Jackson
Asheville
Reading
St. Louis
Napa
Roanoke
Iowa City
Greeley
Ocala
Amarillo
Appleton
Burlington‐South Burlington
Pueblo
South Bend‐Mishawaka
Vineland‐Millville‐Bridgeton
Santa Rosa‐Petaluma
Joplin
Billings
Johnstown
La Crosse
Punta Gorda
Wausau
Bellingham
Santa Fe
Eau Claire
Fargo
Hagerstown‐Martinsburg

Percentage Change in Population
pulation

Medford
Bangor
Muskegon‐Norton Shores
Coeur d'Alene
Riverside‐San Bernardino‐Ontario
Phoenix‐Mesa‐Scottsdale
San Antonio
Tampa‐St. Petersburg‐Clearwater
Los Angeles‐Long Beach‐Santa Ana
Atlanta‐Sandy Springs‐Marietta
Worcester
Jacksonville
Orlando‐Kissimmee
Sioux Falls
Columbus
Dallas‐Fort Worth‐Arlington
Raleigh‐Cary
Baltimore‐Towson
Stockton
Springfield
San Jose‐Sunnyvale‐Santa Clara
Sacramento‐Arden‐Arcade‐Roseville
Las Vegas‐Paradise
Kansas City
New York‐Northern New Jersey‐Long Island
San Diego‐Carlsbad‐San Marcos
Chicago‐Naperville‐Joliet
Allentown‐Bethlehem‐Easton
Salem
San Francisco‐Oakland‐Fremont
Minneapolis‐St. Paul‐Bloomington
Denver‐Aurora‐Broomfield
Austin‐Round Rock
Portland‐Vancouver‐Beaverton
Akron
Columbia
Philadelphia‐Camden‐Wilmington
Grand Rapids‐Wyoming
Albany‐Schenectady‐Troy
Albuquerque
Boston‐Cambridge‐Quincy
Tucson
Colorado Springs
Knoxville
Seattle‐Tacoma‐Bellevue
Fresno
Oklahoma City
Detroit‐Warren‐Livonia
Cincinnati‐Middletown
Greensboro‐High Point
Pittsburgh
Birmingham‐Hoover
Memphis
Indianapolis‐Carmel
Omaha‐Council Bluffs
San Luis Obispo‐Paso Robles
Des Moines‐West Des Moines
Virginia Beach‐Norfolk‐Newport News
Tulsa
Winston‐Salem
Richmond
Bakersfield
Flint
Rochester
Hartford‐West Hartford‐East Hartford
Houston‐Sugar Land‐Baytown
Honolulu
Wichita
Buffalo‐Niagara Falls
Harrisburg‐Carlisle
Youngstown‐Warren‐Boardman
Charlotte‐Gastonia‐Concord
Corpus Christi
Cleveland‐Elyria‐Mentor
Toledo
Salt Lake City
Milwaukee‐Waukesha‐West Allis
Brownsville‐Harlingen
Bridgeport‐Stamford‐Norwalk
Augusta‐Richmond County
Syracuse
El Paso
Lansing‐East Lansing
Dayton
Davenport‐Moline‐Rock Island
Spokane
Fort Wayne
Baton Rouge
Peoria
Green Bay
Beaumont‐Port Arthur
Trenton‐Ewing
Ann Arbor
Lafayette
Evansville
Charleston
Fayetteville
Durham‐Chapel Hill
Columbus
Jacksonville

Percentage Change in Population

Cities with Largest Percentage Change in City Population
Without Excessive Friction Differences

3.5
4

2.5
3

1.5
2

0.5
1

‐0.5
0

‐1

Cities with Smallest Percentage Change in City Population
Without Excessive Friction Differences

0

‐0.2

‐0.4

‐0.6

‐0.8

‐1

Figure A6: Changes in Population Sizes with Average Excessive Frictions (with Externalities)

46

Without Differences in Amenities:

Without Differences in Efficiency:

Without Differences in Excessive Frictions:

Figure A7: Maps of Changes in Population Sizes

47

Without Differences in Amenities:

Without Differences in Efficiency:

Without Differences in Excessive Frictions:

Figure A8: Maps of Changes in Population Sizes with Externalities, ! = 0:02

48

Counterfactuals Without One Shock,  = 0.001 , Year = 20052008
Counterfactual Utility = 10.446
0

-1

-1
ln(prob > population)

ln(prob > population)

Model Utility = 10
0

-2
-3
-4
-5

12

13

-3
-4
-5

Actual
Modeled

-6
11

-2

14
15
ln(population)

16

-6

17

Actual
Avg. Efficiency
0

5

0

-1

-1

-2
-3
-4
-5
-6

6

8

10
12
ln(population)

14

20

-2
-3
-4
-5

Actual
Avg. Amenities
4

15

Counterfactual Utility = 10.0047

0

ln(prob > population)

ln(prob > population)

Counterfactual Utility = 10.2875

10
ln(population)

16

-6
10

18

Actual
Avg. Exc. Frictions
11

12

13
14
ln(population)

Figure A9: Counter-factuals with Theory-Based Capital Measures

49

15

16

17

0

-1

ln(prob > population)

-2

-3

-4

-5
Actual Distribution, Utility = 10
Optimal Allocation, Utility = 10.006
-6

4

6

8

10
12
ln(population)

14

16

Figure A10: Optimal Allocation with Externalities, ! = 0:02

50

18

APPENDIX B: DATA APPENDIX
B.1 United States
This section provides a detailed description of the U.S. metropolitan data we use.
Unit of observation. The unit of observation is the metropolitan statistical area (MSA). A
metropolitan statistical area is a collection of counties with at least one urbanized area of 50,000
or more inhabitants. We use data from 2005 to 2008. Going further back in time is complex, as
the de…nition of MSAs changed in 2003, and there was a subsequent lag in the adoption of the new
de…nitions. More recent data (for 2009) are not available yet for some of the relevant variables.
Production. Measured by Gross Domestic Product by Metropolitan Area. Source: Bureau of
Economic Analysis, Regional Economic Accounts.
Private consumption. The measure of consumption used to compute the labor wedge is private
consumption. There are no ready-to-use data on private consumption at the metropolitan area level.
We start by decomposing private consumption into private consumption net of housing services and
private consumption of housing services.
We proxy private consumption net of housing services by retail earnings. In particular, we use
retail earnings (at the MSA level) multiplied by private consumption net of housing (at the U.S.
level) divided by retail earnings (at the U.S. level). Data on retail earnings are de…ned as personal
earnings from retail trade and come from the Bureau of Economic Analysis Regional Economic
Accounts, Table CA05. Data on private consumption net of housing comes from the Bureau of
Economic Analysis National Income and Product Accounts (NIPA), Table 2.3.5. In using this
proxy, we follow the literature on interregional risk sharing which has used retail sales as a proxy for
private consumption (Asdrubali et al., 1996, Hess and Shin, 1997, Lustig and Van Nieuwerburgh,
2009). Note that those papers use retail sales, rather than retail earnings, by using data from
the Survey of Buying Power published by Sales & Marketing Management. However, that survey
got interrupted during the period 2006-2008. Both proxies are very similar though. For 2005 and
2008 the correlation between retail earnings and retail sales at the MSA level is about 0.80. In
addition, the correlation between private consumption and retail earnings at the U.S. level for the
years 2001-2008 is 0.99.

51

We proxy private consumption of housing services by taking the sum of aggregate gross rent of
renter-occupied housing and the rental value of the aggregate value of owner-occupied housing. Both
variables are available at the MSA level, and come from the annual American Community Survey
run by the U.S. Census Bureau. To compute the rental value of owner-occupied housing, we assume
that the aggregate value of owner-occupied housing is the discounted sum of future rental ‡ows,
taking into account depreciation. The rental value of owner-occupied housing is then computed as
the aggregate value of owner-occupied housing multiplied by r +
benchmark calculation, we take r =

and divided by 1 + r. For the

= 0:02, as in the rest of the paper (see Table 1).

Capital stock. Again, there are no ready-to-use capital stock data at the MSA level. We start
by decomposing the capital stock into non-residential and residential capital.
We proxy non-residential capital at the MSA level by using sectoral non-residential capital stock
data at the U.S. level and allocating it to the di¤erent MSAs in function of their sectoral weights.
This is similar to the approach taken by Garofalo and Yamarik (2004) when estimating state capital
stocks. Sectoral non-residential capital stock data come from the National Economic Accounts from
the BEA. We take the sum of private and public capital. For private non-residential capital we take
current-cost net stock of private …xed assets by industry (Table 3.1ES); for public non-residential
capital we take current-cost net stock of government …xed assets at both the federal level and the
state & local level (Table 7.1B). We then allocate the sectoral capital stock to the MSAs in function
of their shares of sectoral earnings. In particular, capital stock in sector s in MSA i is computed
as the capital stock in sector s in the U.S. multiplied by earnings in sector s in MSA i divided by
earnings in sector s in the U.S. Data on sectoral earnings both at the MSA and the U.S. levels come
from the Regional Economic Accounts of the Bureau of Economic Analysis (Table CA05N).
Non-residential capital at the MSA level is easier to come by. We take the sum of aggregate
value of renter-occupied and of owner-occupied housing. In the case of owner-occupied housing,
that information is available from the American Community Survey of the U.S. Census Bureau. In
the case of renter-occupied housing, the same data source gives information on the aggregate gross
rent. This allows us to compute the value of rental-occupied housing as the aggregate gross rent
multiplied by 1 + r divided by r + . This assumes, as before, that the value of housing is equal to
the discounted sum of future rental streams, where future rental streams are the same as today’s
rental stream corrected for depreciation.

52

Hours worked. To compute average hours worked we take the total hours worked divided by the
population 16 years old and above. We use data from the Current Population Survey (CPS) and
compute total hours worked at the MSA level by summing up the total hours worked by individuals
(weighted by their representativeness in the sample) and then dividing them by all individuals aged
16 and above in the sample (weighted by their representativeness in the sample). To limit errors
due to small sample problems, we leave out MSAs that have information on less than 50 individuals.
The share of time worked is then equal to the average hours worked per day divided by 14.
Housing rental prices. As measure for housing rental prices, we take the median gross rent of
rental-occupied housing. Data at the MSA level are available from the American Community Survey
from the U.S. Census Bureau.
B.2 China
This section provides a detailed description of the Chinese city-level data we use.
Unit of observation. The unit of observation is are Districts under Prefecture-Level Cities. This
corresponds to the urban part of Prefecture-Level Cities, sometimes referred to as the city proper.
Note that Prefecture-Level Cities cover the entire Chinese geography, and include both the urban
parts (proxied for by Districts under Prefecture-Level Cities) and the rural hinterlands. We focus
on 2005, and have data on 212 cities.
Production. Measured by Gross Domestic Product at the level of Districts under Prefecture-Level
Cities. Source: China City Statistics, China Data Center.
Private consumption. To compute private consumption at the level of Districts under PrefectureLevel Cities, we multiply retail sales of consumer goods at the level of Districts under Prefecture-Level
Cities by the ratio of …nal consumption expenditure to total retail sales of consumer goods at the
national level. Source: China City Statistics and National Statistics, China Data Center.
Population.

Population and Population 15 years and above. Source: China City Statistics, China

Data Center.

53

Hours worked. To compute average hours worked we take the total hours worked divided by
the population 15 years old and above. We use the 2005 1% Population Survey to get data on
population 15 years and above, population employed, and average hours worked by the employed.
We then multiply population employed by average hours worked by employed and divide it by the
population 15 years and above. These data are available for most Prefecture-Level Cities but often
not for Districts under Prefecture-Level Cities. In order not to lose too many observations, we use
the data at the level of Prefecture-Level Cities.
Parameter values. Bai et al. (2006) provide time series estimates for the capital share of income
and for the real interest rate. Taking the average for 2000-2005, we set
To be consistent with the case of the U.S., where we took
we use the same formula as they do:

=

(1

)(1 h)
h )(1
,
1+ c )ch

= 0:5221 and r = 0:2008.

from McGrattan and Prescott (2009),
where c is consumption per capita (data

de…ned above), h are hours worked as share of total hours (average hours worked per year as de…ned
above divided by 5110),
personal income) and

c

h

is the tax rate on labor (de…ned as personal income tax as a share of

the tax rate on consumption (de…ned as the sum of consumption tax and

value added tax as a share of total consumption expenditures). The data needed to compute these
tax rates come from the National Bureau of Statistics of China, and are for 2004. This gives us a
value

= 1:5247.

54

