NBER WORKING PAPER SERIES

A FUNCTIONAL FILTERING AND NEIGHBORHOOD TRUNCATION APPROACH
TO INTEGRATED QUARTICITY ESTIMATION
Torben G. Andersen
Dobrislav Dobrev
Ernst Schaumburg
Working Paper 17152
http://www.nber.org/papers/w17152

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
June 2011

We thank participants at the 2010 SETA Conference at Singapore Management University and the
"Nonlinear and Financial Econometrics Conference: A Tribute to A. Ronald Gallant,'' Toulouse, France,
May 2011, along with Federico Bandi, Peter R. Hansen, Andrew Patton, Peter C. B. Phillips and Kevin
Sheppard for comments on an earlier draft. Excellent research assistance was provided by Patrick Mason.
Andersen gratefully acknowledges financial support from the NSF through a grant to the NBER and
by CREATES funded by the Danish National Research Foundation. The views in this paper are solely
those of the authors and should not be interpreted as reflecting the views of the Board of Governors
of the Federal Reserve System, the Federal Reserve Bank of New York, any other person associated
with the Federal Reserve System, or the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2011 by Torben G. Andersen, Dobrislav Dobrev, and Ernst Schaumburg. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

A Functional Filtering and Neighborhood Truncation Approach to Integrated Quarticity Estimation
Torben G. Andersen, Dobrislav Dobrev, and Ernst Schaumburg
NBER Working Paper No. 17152
June 2011
JEL No. G12,G13,G17
ABSTRACT
We provide a first in-depth look at robust estimation of integrated quarticity (IQ) based on high frequency
data. IQ is the key ingredient enabling inference about volatility and the presence of jumps in financial
time series and is thus of considerable interest in applications. We document the significant empirical
challenges for IQ estimation posed by commonly encountered data imperfections and set forth three
complementary approaches for improving IQ based inference. First, we show that many common deviations
from the jump diffusive null can be dealt with by a novel filtering scheme that generalizes truncation
of individual returns to truncation of arbitrary functionals on return blocks. Second, we propose a new
family of efficient robust neighborhood truncation (RNT) estimators for integrated power variation
based on order statistics of a set of unbiased local power variation estimators on a block of returns.
Third, we find that ratio-based inference, originally proposed by Barndorff-Nielsen and Shephard,
has desirable robustness properties and is well suited for our empirical applications. We confirm that
the proposed filtering scheme and the RNT estimators perform well in our extensive simulation designs
and in an application to the individual Dow Jones 30 stocks.

Torben G. Andersen
Kellogg School of Management
Northwestern University
2001 Sheridan Road
Evanston, IL 60208
and NBER
t-andersen@kellogg.northwestern.edu
Dobrislav Dobrev
Federal Reserve Board of Governors
20th Street and Constitution Avenue NW
Washington, DC 20551
Dobrislav.P.Dobrev@frb.gov

Ernst Schaumburg
Federal Reserve Bank of New York
33 Liberty Street
New York, NY 10045
ernst.schaumburg@ny.frb.org

1

Introduction
It is by now widely accepted that intraday data are highly informative regarding the

contemporaneous level of volatility relative to daily returns. The use of high-frequency
returns is, however, not without its problems. The main issue is the pronounced inhomogeneity of the intraday return series across the trading day as diurnal patterns interspersed
with news events and market microstructure frictions complicate direct modeling of the
high-frequency volatilities and introduces a variety of idiosyncratic features that are largely
irrelevant for longer horizon inter-daily volatility. The realized volatility (RV) approach
“solves” this problem by aggregating the intraday return observations to a daily frequency
in a manner that retains the majority of the inherent volatility information while removing the bulk of any irregular noise or diurnal patterns. The RV approach has been widely
adopted in applications involving liquid asset markets and availability of intraday price,
ever since the formal introduction of RV as a nonparametric consistent estimator of the
return variation for arbitrage-free return processes in Andersen and Bollerslev (1998).1 In
parallel with the rapidly growing number of empirical RV applications a large body of
theoretical work on model-free, nonparametric estimation and inference for components of
the realized return variation process of continuous-time semimartingales has arisen. Initial
econometric issues are addressed in Andersen, Bollerslev, Diebold and Labys (2001, 2003)
and Barndorff-Nielsen and Shephard (henceforth BNS) (2002), while additional work on inference regarding the contribution of jumps and the precision of the integrated continuous
return variation is developed in BNS (2002, 2004b, 2006).2 Subsequently, this literature
further developed into dealing with market microstructure issues as the drive towards exploiting data at the utmost highest frequencies was pursued by, e.g., Zhang, Mykland and
Ait-Sahalia (2005), Bandi and Russell (2008), and Barndorff-Nielsen, Hansen, Lunde and
Shephard, henceforth BNHLS, (2008).
The main conceptual distinction between realized volatility and standard volatility modeling is that the former focuses on ex-post measurement of the actual realization of the
(stochastic) return variation process over a given period while the latter produces ex-ante
expectations of the future return variance. Once the attention shifts towards actual realizations, it is natural to push the framework further and seek additional information from
the high-frequency returns. In particular, the full potential of the RV approach is not attained until we can provide robust and reliable procedures for ex-post day-by-day measures
of the precision of the integrated return variation and identify the impact of jump components. Both features are critical for a variety of issues in real-time financial management,
including improved volatility forecasting, analysis of the dynamic properties of jumps and
1

Corresponding measures were previously considered informally on an ad hoc basis, see, e.g., Schwert
(1989), Hsieh (1991) and Zhou (1996).
2
Related general technical insights are provided in Jacod and Protter (1998).

1

news events, derivatives pricing, estimation of return correlations, determination of returnvolatility asymmetries (the leverage effect), and for developing insights into asset pricing via
better understanding of the empirical interplay between the return volatility and covariation
and the general macroeconomic conditions.
The critical ingredient for inference regarding the return variation and for the reliability
of jump test procedures is the so-called integrated quarticity (IQ). To illustrate the importance of accurate IQ measures, we informally review a few basic results from the RV
literature. Let the continuously evolving logarithmic (log-) price for a single asset be given
by Yt . This price process constitutes a semimartingale with respect to an underlying filtered probability space. The associated ex-post daily realized quadratic variation (QV ) for
Yt may be decomposed into an integrated (diffusive) volatility, IV , and a residual (jump)
component, JV :
dYt
QVt

=

µt dt + σt dWt + dJY,t

=

Z t
0

|

σu2 du +
{z

IV

}

X

(1)

(∆JY,u )2

0≤u≤t

|

{z

JV

}

where µt and σt denote the instantaneous drift and diffusion coefficients, while Wt and JY,t
are adapted Wiener and finite activity jump processes respectively.
For a given trading day covering t ∈ [0, 1], we consider the ideal scenario in which we
observe N equally-spaced (log) returns, ri = Y i − Y i−1 ,
N

N

i = 1, · · · , N .

In this case,

the realized volatility (RV) is a consistent nonparametric estimator of QV, as the number
of intraday observations diverges, N → ∞ (in-fill asymptotics):
RVN =

N
X

ri2 → QV .

i=1

Furthermore, in the absence of price jumps, the limiting distribution of the RV estimator
is known to be a Gaussian mixture of the following form,
√

N (RVN − IV )

where IQ =

R1
0

→ N (0, 2 IQ)

σu4 du which, as observed by BNS (2002), can be consistently estimated

from the high-frequency data themselves via the Realized Quarticity (RQ) statistic:
RQN =

N
NX
r4 → IQ
3 i=1 i

It is evident that reliable estimates for IQ are critical for accurate inference about the
integrated variance. Unfortunately, IQ estimation is challenging because it involves estimating fourth order return moments from a large set of noisy intraday returns characterized
2

by numerous outliers and the confounding effects of market microstructure frictions. For
example, it is well recognized that the RQ estimator above is quite imprecise and highly
non-robust in many realistic scenarios, even if jumps are absent. Moreover, the problem
only grows worse in the presence of jumps as the standard nonparametric RV theory is
highly non-robust in this dimension. First, when price jumps are present, RV is no longer
consistent for IV. Second, the RQ statistic is now divergent: RQN → ∞ as N → ∞.
Given the compelling evidence for jumps in many prominent asset price series, further corroborated below, this is critical in practice. Consequently, one may conclude that inference
on the integrated variance or the presence of jumps should, as a matter of routine, exploit
jump-robust measures for integrated quarticity (and integrated variance). While various
such jump-robust estimators have been developed, they are known to be rather imprecise,
at least in some empirically relevant settings, and there simply exists no systematic evidence
regarding the performance of alternative jump-robust procedures across a range of realistic
empirical scenarios.
Recognizing the above problems, a variety of different, and largely ad hoc, procedures for
IQ estimation have been proposed and implemented in the empirical literature. The early
literature often maintained the assumption of a purely diffusive price process when assessing
the precision of the integrated variance, enabling direct reliance on the basic RV theory. For
example, BNS (2004a) exploit 10-minute foreign exchange returns in estimating IQ through
a statistic closely related to RQ. Similarly, Bandi and Russell (2008) recommend using
RQ sampled at the 15-20 minute frequency for estimating IQ. These relatively conservative
sampling intervals reflect the sensitivity of fourth moment returns to market microstructure
noise and outliers: these effects are attenuated as the return frequency shrinks. On the
other hand, robust IQ estimators are essential for statistical power in jump tests so jumprobust procedures invariably have been used in that context. For example, BNS (2004b)
rely on 5-minute returns for constructing the so-called quadpower estimator of IQ while
Huang and Tauchen (2005) also exploit 5-minute returns for computing a variety of jumprobust IQ measures, including the tripower and quadpower statistics.3 Both sets of authors
provide evidence regarding the reliability of the procedures, but the focus is strictly on the
performance of the jump test statistic and not on the IQ estimator. In fact, recognizing the
considerable imprecision of such jump-robust IQ estimators, Jiang and Oomen (2008) opt
for simply squaring their jump-robust IV estimator, thus settling for a Jensen inequality
bias in their IQ estimator rather than relying on prevailing consistent, but arguably more
inaccurate, jump-robust estimators. In particular, Jiang and Oomen (2008) worry about
distortions due to market microstructure noise when applying standard jump-robust IQ
estimators to their one-minute IBM transaction return series.
As an illustration of the practical importance of jump robustness, consider drawing
3

We formally define these estimators in the next section.

3

inference about the IV of IBM stock returns across three days in February 2008 using the
non-jump robust RQ/RV measures versus a pair of jump robust measures4 :
20080225

20080226

20080227

116

116

116

114

114

114

112

112

112

110

110

110

108

108

108

−3

−3

x 10

−3

x 10

x 10

3

3

3

2

2

2

1

1

1

0

0
RV

MedRV

0
RV

MedRV

RV

MedRV

Figure 1: The point estimate (red line), and the inter-quartile range as well as two standard
deviation IV confidence bands for IBM for three trading days in February 2008.
The jump on 2/26/2008 is readily identified visually and easily detected using a jump
robust test statistic. In fact, the robust MedRV estimates and associated standard error
bands, based on MedRQ, suggest a relative stable volatility process across the three trading
days. In contrast, the regular RV estimate for IV is greatly inflated on 2/26/2008, and
the confidence band is huge, reflecting a diverging RQ statistic. Hence, the reliance on non
jump-robust statistics has two consequences. First, when jumps are present the IV estimate
is upward biased because the jump component in QV is attributed to IV.5 Second, the
associated confidence band is grossly overstated, indicating very poor estimation precision
whereas, in fact, the robust estimate appears quite reliable. Hence, non-robust inference
may produce excessively erratic IV estimates and convey a sense of exaggerated imprecision
associated with these techniques. While the misleading inference afforded by the regular
RV and RQ estimators is apparent in Figure 1, at least when contrasted with the robust
inference and a depiction of the price path, it can be less obvious in cases with higher
volatility levels and relatively smaller jumps. As such, it is important to develop feasible
4

We rely on the MedRV/MedRQ estimators of Andersen, Dobrev and Schaumburg (2009) here, but any
other sensible pair of robust IV and IQ estimators would suffice in this particular case as the evidence for
a single significant jump is compelling and the associated empirical inference problem thus very straightforward. The robust estimators will be introduced later in the paper.
5
As a consequence, real-time predictions regarding the expected volatility over the following trading days
will likely also be exaggerated on 2/26/2008 because the jump component of QV typically is much less
persistent than the IV component, see, e.g., Andersen, Bollerslev and Diebold (2007).

4

robust and efficient procedures for estimating IQ and conducting inference for IV.
One main contribution of this paper is to explore the virtues and drawbacks of alternative estimation procedures for IQ, including their robustness and sensitivity to a variety
of features of the return generating process and the presence of relevant market frictions.
Although a variety of authors in recent years have extended their estimators to also cover
higher order integrated power variation, the present paper, to the best of our knowledge,
constitutes the first in-depth look at the performance of robust estimation procedures for IQ
based on high-frequency financial data when the underlying price process contains jumps.
A second contribution is the development of an outlier filtering procedure that operates
directly on an estimation functional of interest rather than on the individual tick-by-tick
returns. This functional filtering principle serves to adapt the filter to the specific assumptions underlying a given estimator. Hence, the filter controls the impact, and potential
distortion, of abnormal outliers in the exact metric in which they contribute to the ultimate
estimator. By design, this filter can be applied extremely conservatively under the null
hypothesis so that it has a negligible impact on the properties of the estimators. In applications to individual equity return data we find this filter indispensable for rendering entire
classes of promising candidate IQ estimators viable. Third, we develop a new class of robust
neighborhood truncation (RNT) estimators that generalize existing nearest neighbor and
quantile RV estimators. They involve the application of a second layer of order statistics to
suitably chosen return functionals, thus robustifying the inference for IQ without sacrificing much efficiency. We find such RNT estimators to perform admirably, especially when
exploited in combination with the ratio statistic, IQ/IV 2 , which previously has been found
to provide improved finite sample inference for IV and enhance the power of jump tests.
The unifying theme behind our new class of estimators and universal filtering procedure is
to operate directly on the functional space of local power variation estimates rather than
the underlying individual returns, which constitutes a special case.
The remainder of the paper is structured as follows. In section 2 we briefly review the
principles behind the modern approach to robust estimation of integrated power variation,
including IV and IQ, and introduce our novel filtering procedure. Section 3 reviews existing
estimators and associated techniques for controlling the impact of outliers and develops
our new class of robust neighborhood truncation estimators for IV and IQ. In section 4 we
conduct an extensive simulation study to elucidate the potential importance of common
types of data features as well as imperfections and how these traits impact alternative IQ
estimators. Finally, in Section 5, we analyze the set of Dow Jones 30 stocks between January
2005 and July 2009. We highlight the importance of (mild) filtering and study the relative
performance of a wide range of robust IQ estimators. Section 6 concludes.

5

2

Jump-Robust Power Variation Estimation and Filtering

We begin with an informal review of the modern approach to integrated power variation
estimation. In the process, we discuss some important trade-offs that must be confronted
in empirical work when dealing with objects involving high powers of volatility, such as
integrated quarticity. In particular, we argue that existing filters, developed for realized
volatility measures, are inadequate to deal with the complications associated with many
relevant jump-robust procedures that exploit overlapping blocks of adjacent returns. Hence,
we end by highlighting a novel filtering procedure which is instrumental for obtaining highquality empirical measures of higher order integrated power variation for a promising set of
novel robust estimators that we introduce later on.

2.1

The Modern Approach to Jump-Robust Volatility Estimation

The basic estimation strategy is straightforward. First, no-arbitrage conditions in a frictionless continuous-time setting ensures that the log-price process is a semimartingale. Hence,
over short time intervals, the expected returns are an order of magnitude smaller than the
realized return innovations, so the drift term may typically be ignored in deriving the asymptotic distribution for volatility estimators. Second, given sufficient regularity, we may break
the trading period, say, [0, 1] into K smaller blocks and treat volatility as constant within
each block, even if the return variation evolves stochastically and the price path contains
finite activity jumps. Combined, these features greatly simplify matters, as nonparametric
jump-robust estimators are easy to devise when volatility is constant. The strategy is then
simply to estimate the local (power of) volatility for each block and cumulate across blocks
to obtain the overall integrated power variation.
2.1.1

Consistent Estimation under the Diffusive Null Hypothesis

Assume we have m + 1 equally-spaced log-price observations, and thus m continuously
compounded returns, per block. The total number of returns per trading period is then
N = K · m. Each block covers
over an interval length of

1
N.

1 th
K

of the period and each return reflects the price evolution

The associated distribution theory is developed using standard

in-fill asymptotics, letting N grow indefinitely, while requiring
fixed and K diverges directly in line with N .

m
K

→ 0. In most cases, m is

A generic estimator of the pth order return variation, for p an even positive integer, is
obtained as a sum of local estimates of σ p based on a functional f operating on blocks of m
adjacent (absolute) returns.6 The specification of the functional depends on the estimator
6

In general, these returns may themselves have been generated via standard noise-reduction techniques
such as sub-sampling or pre-averaging, possibly performed on prices that have been pre-filtered for errors in
the raw tick-by-tick data. We address the need for filtering procedures in this context below.

6

adopted, which is not critical for the current exposition.7 For each integer i, 1 ≤ i ≤ N −
m + 1, we have the return block, (ri , ri+1 , . . . , ri+m−1 ). Under the null hypothesis that the
returns within the block are distributed i.i.d. N (0, σi2 / N ), we let fi = f (|ri |, ..., |ri+m−1 |)

denote the functional exploited by a specific estimator to obtain an unbiased estimate of
σip / N for the i’th block. The associated estimator of the integrated pth order variation is,
N −m+1
X
N
fi .
N − m + 1 i=1

The consistency of the estimator follows as, subject to sufficient regularity, we have,8
1
N −m+1

N −m+1
X
i=1

N · fi ≈

1
N −m+1

N −m+1
X

σip

→

i=1

Z 1
0

σup du .

A few critical issues determine whether the approach works well in practice. First, the
ideal assumptions ignore the impact of data errors and market microstructure frictions.
Higher order return moments can be particularly sensitive to faulty price observations or
inappropriate assumptions regarding the evolution of ultra-high frequency return data. Second, even if jump robust estimators are designed to avoid, or greatly alleviate, any asymptotic bias stemming from discontinuities, jumps will nonetheless often have a severe adverse
effect on the finite sample properties of the estimators, especially for p > 2. The following
sections discuss the basic strategy for dealing with such issues.
2.1.2

Eliminating Obvious Errors from the Tick-by-Tick Price Series

Any large set of raw transactions data is invariably subject to recording errors that infuse
noise into the observed high-frequency returns. Most dramatically, faulty prices create
artificial outliers, causing so-called “bounce-backs” in returns, as there is a “jump” both
when the flawed price first appears and then later, often shortly thereafter, when the price
reverts to the correct level. Hence, the need for effective cleaning procedures has long been
acknowledged. BNHLS (2009) lay out a systematic framework for dealing with trade data
from NYSE-TAQ. In their terminology, we apply the filters P1-P3 and T1-T4.9 These filters
are arguably mild and uncontroversial and simply aim to eliminate obvious data errors.
7
Candidates include the multipower variation, truncated power variation, and quantile power variation
estimators.
8
Of course, this is purely heuristic. The asymptotic properties of the relevant estimators must be proven
rigorously in each case.
9
P1: Retain only observations with time stamps between 9:30am and 4:00pm. P2: Retain only trades
with positive prices. P3: Retain only trades originating from the main exchange (NYSE for all stocks except
MSFT and INTL for which it is NASDAQ). T1: Delete entries with corrected trades. T2: Delete entries
with abnormal sale condition. T3: If multiple trades occurred with the same time stamp, use the median
price. T4: Delete entries with prices above the ask (or under the bid) by more than one bid-ask spread.

7

In estimating higher order return power variation measures, we deal with procedures
that are highly sensitive to erroneous outliers. As such, the existing conservative error filtering techniques, including those discussed above, are insufficient. In a separate subsection
below, we detail our construction of a suitable filter to deal with the robust power variation
estimators operating on return blocks.
2.1.3

Alleviating the Impact of Microstructure Features

In practice, the theoretical assumptions justifying the presence of a diffusive return component are systematically violated at the tick-by-tick level by various market microstructure
features, including the finite price grid and the presence of a bid-ask spread. This implies
that tick-by-tick price changes often are an order of magnitude larger than what is consistent
with a diffusive characterization. One effective approach to mitigating the impact of such
noise is to apply so-called pre-averaging, as originally suggested by Podolskij and Vetter
(2009). This is achieved by collapsing a higher number of ultra high-frequency returns into
a smaller set of averaged, and thus less erratic “smoothed,” returns. This implies that each
of the m returns within a block are obtained as averages from separate, non-overlapping
subsets of tick-by-tick returns. The benefit is a dramatic reduction in the impact of idiosyncratic noise and, in particular, the distortions introduced by bounce-backs. The drawback
is a substantial drop in the underlying sampling frequency. The latter impacts the choice
of the window width, m, as the (diffusive) volatility fluctuates more widely across longer
blocks. We apply the pre-averaging procedure in the simulation and empirical sections
below. Our implementation of the pre-averaging technique is detailed in Appendix C.
2.1.4

Jump-Robust Power Variation Estimation

Finally, we outline the basic principles behind the construction of return variation estimators
that are robust to the presence of finite activity jump processes. Asymptotically, as the
block sizes shrink towards zero and the number of blocks grows indefinitely, there will
be a finite number of blocks containing a single jump each. Hence, in the limit, the power
variation associated with the blocks containing jumps is negligible. It follows that the power
variation can be estimated consistently as long as the contribution from the “jump blocks”
is an order of magnitude less than the overall power variation measure,

R1
0

σup du, which of

course is O(1). However, the jumps are themselves of order O(1) so the functional f must
ensure that the jumps are dampened sufficiently to eliminate their impact asymptotically.

More formally, for any given sampling frequency, we may denote the set of indices
corresponding to returns for which the associated block contains a jump by IJ . Thus, for
i ∈ IJ , there is a jump within the return block (ri , ri+1 , . . . , ri+m−1 ). We may then write

8

the generic power variation estimator as,
N
N −m+1

N −m+1
X



fi =

i=1

N

N −m+1

N −m+1
X



fi +

i=1, i∈I
/ J

X

fi  .

i∈IJ

The first term estimates the integrated power variation consistently, i.e.,
N
N −m+1

N −m+1
X
i=1, i∈I
/ J

fi −→

Z 1
0

σup du ,

as N −→ ∞ .

The contribution from the blocks containing jumps is negligible, in the limit, if each
such block is of order less than O(1). Thus, the associated power variation estimator is
consistent as long as fi ∼ O(N −h ), h > 0, for i ∈ IJ .10 This is accomplished in different
ways by the estimators reviewed in Sections 3.1-3.3. Moreover, their practical effectiveness
is largely determined by the degree to which they accomplish sufficient dampening of the
jump contributions in finite samples.

2.2

Filtering via Truncation of Return Functionals

Even for returns based on pre-averaged tick data and sampled at moderate frequencies, microstructure features and other data irregularities may induce inhomogeneous and serially
correlated observations that blatantly violate our distributional assumptions. For quarticity estimation, in particular, it is paramount to control the impact of this type of data
imperfections to achieve a beneficial trade-off between robustness and efficiency.
This section outlines a general truncation principle for return functionals that enhances
the robustness of integrated power variation estimators operating on return blocks. It
may be viewed as an extension of existing techniques that employ truncation to alleviate
the impact of jumps or data errors. However, the philosophy and implementation are
very different. Existing procedures truncate returns based on whether a single observation
constitutes a significant outlier. Moreover, the truncation is an essential step in rendering
the estimator robust as it dampens, and asymptotically eliminates, the distortion induced by
price jumps on the estimated power variation. For this to be effective, the detection of larger
jumps must be reliable, and it is common to apply a threshold for jumps that correspond
to “three sigmas” or a p-value of about 0.3%. As a result, the procedure generates a nontrivial amount of type I errors because diffusive returns based on high-frequency return data
inevitably will be subject to unwarranted truncation. Recognizing the resulting downward
bias under the null hypothesis, Corsi, Pirino and Reno (2010), henceforth CPR, develop a
rescaling procedure intended to alleviate this effect.
10

Naturally, additional dampening is required to establish a limiting distribution theory (Central Limit
Theory or CLT) for the power variation measures. In this case, fi ∼ O(N −h ), h > 12 , for i ∈ IJ .

9

In contrast, we develop a filtering procedure that operates directly on the jump-robust
functional and is intended more broadly to alleviate distortions induced by deviations from
the null that the block consists of i.i.d. draws from a normal distribution. In this scenario,
jump robustness is, in principle, already assured by the choice of an appropriate functional.
Hence, the filtering is merely intended to eliminate truly excessive estimates of local power
variation, driven by functional values incompatible with the maintained null hypothesis. As
such, we rely on an extremely conservative threshold for truncation, typically with p-values
around 10−6 or below. Under the maintained null hypothesis, this implies that we expect
to truncate less than one single realization of the return functional across our entire sample.
In practice, the underlying assumptions are violated and truncation occurs with non-trivial
frequency which helps control the associated distortion in the power variation estimators.
The flowchart shown in Figure 2 illustrates the difference between the truncation of individual returns and the truncation of local estimates, which themselves are functionals of
blocks of adjacent returns.
TRUNCATION OF
LOCAL ESTIMATES

TRUNCATION
OF RETURNS

Raw data
p0 , . . . , p n

Raw data
p0 , . . . , p n
Filter quotes & prices
(Data Errors)

Filter quotes & prices
(Data Errors)
Raw returns
r1 , . . . , r n

Raw returns
r1 , . . . , r n
Pre-averaging/sub-sampling
(MMS noise)

Pre-averaging/Sub-sampling
(MMS noise)
Agg. returns
r1 , . . . , r N

Agg. returns
r1 , . . . , r N
Truncation of individual returns
(Deviations from local BM null)

Truncation of individual estimates
(Deviations from local BM null)

Local estimates
p
σ̂1p , . . . , σ̂N

Truncated returns
r1 , . . . , r N

Truncated estimates
p
σ̂1p , . . . , σ̂N

Local estimates
p
σ̂1p , . . . , σ̂N

Power variation
p
1 �
i σ̂i
N

Power variation
p
1 �
i σ̂i
N

Figure 2: Flowchart contrasting the standard filtering approach based on truncation of individual
returns with the proposed new filtering approach based on truncation of individual local estimates.
1

10

2.2.1

The Infeasible Functional Truncation Filter

We first provide an infeasible version of the filtering procedure. Recall that we define
N · fi = N · f (|ri |, ..., |ri+m−1 |) as the functional providing an unbiased estimator of the
local power variation, σip under the null hypothesis. Now, for a given α ∈ (0, 10−5 ), we

let Q (1−α) [g] denote the (1 − α)th -quantile of the distribution of a random variable g. Set
(1−α)

gi = fi · σi−p and define a corresponding truncated functional fi
(1−α)
fi

=

(

fi
0

as follows:

if fi σi−p ≤ Q (1−α) [ fi · σi−p ]
else.

Accordingly, define the following realized truncated estimator based on f (1−α) :

PN −m+1
i=1

N
−p
I{ fi · σ < Q (1−α) [ fi · σ −p ]}

N −m+1
X

(1−α)

fi

,

i=1

where I{A} equals one if the expression A is true and zero otherwise.
Setting α = 0 we obtain the usual realized estimator based on f without truncation.
Moreover, if m = 1 our functional filtering is equivalent to the usual return filtering at the
given significance level, α.

2.2.2

The Feasible Functional Truncation Filter

The truncated estimator defined above requires knowledge of the latent σip on each block of

returns. To obtain a feasible version, we rely on a highly jump-robust and sufficiently local
estimator σ̂ip calculated on a centered block of returns of size 2L+1, where M < 2L+1 < N .
In particular, we employ the following asymptotically unbiased estimators:11

p
(2L+1)


c
N 2 M edian{|r1 |, |r2 |, ..., |r2L+1 |}p

 M ed,p
p
(2L+1)
σ̂ip =
2 M edian{|ri−L |, |ri−L+1 |, ..., |ri+L |}p
c
N
M ed,p

 (2L+1)
p

 c
|, |r
|, ..., |r |}p
N 2 M edian{|r
N −2L

M ed,p

N −2L+1

N

i≤L
L<i<N −L+1
i≥N −L+1

(2L+1)

The scaling factor c M ed,p can be determined with arbitrary precision by simulation.
(51)

(51)

For example, using L = 25, we obtain c M ed,2 = 2.12 and c M ed,4 = 4.06.

The key difference is that the feasible version accommodates the uncertainty arising

from using an estimate, σ̂ p , rather than the true σ p . In particular, we set g̃i = fi · (σ̂ip )−1
11

The efficiency of the estimator is not critical as long as it is sufficiently robust. A Quantile RV type
estimator, exploiting a moderate quantile, known to be extremely outlier robust but also downward biased
and inefficient, may work well.

11

(1−α)
and define the truncated functional f˜i
= f˜(1−α) (|ri |, |ri+1 |, ..., |ri+m−1 |) as follows,
(1−α)
f˜i

=

(

fi
0

if fi · (σ̂ip )−1 ≤ Q (1−α) [fi · (σ̂ip )−1 ]
else

This leads to the following feasible realized truncated estimator based on f˜(1−α) ,
N −m+1
X
N
(1−α)
f˜i
PN −m+1
p −1
p
(1−α)
−1
I{fi · (σ̂i ) ≤ Q
[fi · (σ̂i ) ]} i=1
i=1

In summary, our filtering approach has some major advantages. First, by truncating
directly the values of the functional f we guard against departures from the null for the
return block as a whole. This ensures robustness to consecutive jumps and multiple bouncebacks, exactly for the same reason this is achieved by existing truncation estimators. Second,
as noted, it is sufficient to work with very small truncation probabilities (under the null),
e.g., 10−6 or 10−7 , so that for realistic sample sizes one avoids the need for computationallyintensive (recursive) bias correction as implemented by CPR. Third, and most important,
the direct truncation of the functional f also limits the potential distortions stemming
from a diverse set of other microstructure effects such as basic bid-ask bouncing and price
discreteness, but also more challenging effects associated with gradual and directional price
changes that may arise from the price dynamics generated by the splitting of large orders or
block trades and their interaction with active trading strategies and the reactive behavior
of market makers. All such features can potentially induce significant short term serial
correlation and non-homogeneity in high frequency returns.

3
3.1

Theory: New and Existing Power Variation Estimators
The Setting and Basic Assumptions

The main part of our theoretical exposition assumes we operate within a frictionless market
where a single financial asset is traded continuously. We deviate from this framework only
when we consider the impact of market microstructure noise on our estimation and inference
procedures. In this ideal environment, equilibrium ensures that arbitrage opportunities are
absent. This implies that the (log) asset price process constitutes a semimartingale with
respect to the underlying filtered probability space, see, e.g., Back (1991) and Andersen,
Bollerslev and Diebold (2010) for discussion. Hence, for most of the subsequent analysis we
invoke the following condition.

12

The continuously compounded return process, rt , is governed by a jump-

Assumption 1

diffusive semimartingale,
Z t

rt = Y0 +

0

au du +

Z t
0

σu− dBu + Jt ,

(2)

where a is a locally bounded and predictable process, σ is an adapted cadlag process bounded
away from zero, and J is a finite activity jump process.
When discussing central limit theorems (CLTs) we typically require some additional structure on the volatility process.
The volatility process, σt , follows a jump-diffusive semimartingale,

Assumption 1A
σt = σ0 +

Z t
0

ãu du +

Z t
0

σ̃u− dBu +

Z t
0

ṽu− dWu + Jσ,t ,

where ã is locally bounded and predictable, σ̃, ṽ are cadlag, the Brownian motions B, W
are uncorrelated, and Jσ is a finite activity jump process.

3.2
3.2.1

Some Existing Jump-Robust Power Variation Estimators
Multi-Power Variation Estimators

The first (finite activity) jump-robust integrated volatility estimators were the Realized
Multi-Power Variation (MPV) statistics, inspired by BNS (2002). Absent frictions, and
letting m > p/2, MPV is consistent for the integrated power variation,
p

M P VN (m, p) = dm,p

where

dm,p = µ−m
p/m ;

N2
N −m+1

N −m+1
X

p

p

P

|ri | m · · · |ri+m−1 | m →

i=1

µp = E|Z|p = 2p/2

Γ((p + 1)/2)
;
Γ(1/2)

Z 1
0

σup du ,

Z ∼ N (0, 1)

The intuition for the consistency result is straightforward: If ri , . . . , ri+m−1 ∼ i.i.d.N (0, σ 2 )
then E[|ri |p/m · · · |ri+m−1 |p/m ] ∝ σ p and, suitably normalized, each term of the MPV measure delivers an unbiased estimate of the local (spot) power variation. On the other hand,
if there is a single jump within a given block (asymptotically there are never more) then
the contribution of this term is dampened by the multiplication of powers of m − 1 adjacent
diffusive returns. It is readily demonstrated that the contribution of the “jump block” is
p

of order O(N −1+ 2m ). Asymptotically, give the m > p/2 condition, this term is negligible.
However, it is also evident that the finite sample distortions of a jump, for fixed N , is
13

alleviated (declines) as the block length, m, increases.
The MPV statistics afford inference for both IV (p = 2) and IQ (p = 4) as special
cases,12
√

√

N [ M P VN (m, 2) − IV ]

Stable L

N (0, η(m, 2) IQ ) , m > 2

N [ M P VN (m, 4) − IQ ]

Stable L

N 0, η(m, 4)

→

→



Z 1
0



σu8 du

, m>4

where the known “efficiency factors” η(m, p) are increasing in the block size m. Hence, low
values of m improve efficiency under the no-jump null hypothesis. Prominent examples of
MPV estimators for IQ are the fourth order versions of the Tripower (m = 3), Quadpower
(m = 4) and Quintpower (m = 5) variation estimators,
T QN
M P QN (4)
M P QN (5)

=
=
=

M P VN (3, 4) = d3,4
M P VN (4, 4) = d4,4
M P VN (5, 4) = d5,4

N2
N −2
N2
N −3
N2
N −4

N
−2
X
i=1
N
−3
X

|ri |4/3 |ri+1 |4/3 |ri+2 |4/3
|ri | · · · |ri+3 |

i=1
N
−4
X

|ri |4/5 · · · |ri+4 |4/5

i=1

As noted, the lower order MPV estimators are more efficient than their higher order counterparts. On the other hand, they are less jump robust, in finite samples, and may lack
a limiting distribution under the alternative as they employ fewer neighboring terms to
dampen the jumps. Empirically, one therefore faces the familiar tradeoff between efficiency
(under the no-jump null) and robustness to jumps (and other data imperfections) that will
be comprehensively discussed below.
From the perspective of the blocking strategy, the basic MPV statistics operate with a
relatively narrow window size of m returns. However, in our empirical implementation, the
individual returns are obtained via pre-averaging from a set of non-overlapping tick-by-tick
returns so, depending on market liquidity, the windows for the higher order statistics may
end up covering decidedly non-trivial time intervals.
12
The distributional convergence is stable with a mixed Gaussian limit,
R 1 i.e., a normal distribution conditional on the realization of the integrated power variation, P V (q) = 0 σuq du, where, importantly, the
limiting normal variate is independent of the (random) power variation process, and we have q = 4 and
q = 8 in this case. See, e.g., Jacod and Shiryaev (2003), Chapter IX, for an introduction to the concept of
stable convergence.

14

3.2.2

Truncated Power Variation Estimators

A recent approach to robust IV (and IQ) estimation is the truncation based RV and BV
estimators of Mancini (2009), further developed by CPR, which achieve jump robustness
by truncating observations exceeding a pre-specified threshold. Under infill asymptotics,
we may stipulate that the threshold converges toward zero slowly enough (slower than
1
N

log(N )) that the limiting distribution of the resulting estimators is identical to their

non-truncated counterparts. In particular, the truncated RV is the most efficient among all
jump robust IV estimators, and similarly the truncated RQ is the most efficient jump-robust
estimator for IQ. Moreover, it is evident that the jump distortion is determined by the size
of the truncation threshold and thus is under direct control in designing the estimator. The
general form of the (symmetric) threshold multi-power variation estimator of order m takes
the form,
p

TMPV(p, m) =

µ−m
p/m

N2
N −m+1

N −m+1
X m−1
Y
i=1

p

|ri+j | m I{r 2

j=0

i+j

P

≤ ϑi−j }

−→

Z 1
0

σup du

Of course, in finite samples the choice of threshold matters and can be delicate. As noted
by CPR, it is beneficial to truncate aggressively to reduce the jump distortion by choosing a
relatively low threshold. However this will also imply that non-jump returns are truncated
with non-trivial probability. Hence, CPR suggest a finite sample upscaling to correct for the
downward bias (under the no-jump hypothesis) induced by truncation of diffusive returns.
Given the time variation in volatility, any such correction must rely on an estimate of the
local volatility. Hence, they implement an iterative scheme to obtain a fixed point at which
the expectation of the truncated estimator equals the true (estimated) volatility under the
null hypothesis. While conceptually appealing, this approach has some drawbacks. First,
the modified estimator is no longer linear in the unobserved σ 2 and thus suffers from a
downwards bias, due to Jensen’s inequality, even in the ideal Brownian case, because it
requires inserting a local volatility estimate. Second, the approach uses a two-sided window
of a given length (e.g., 50 observations) to arrive at the local volatility estimate, thereby
rendering it susceptible to an additional downward bias due to time variation in volatility
across the block. Both of these effects are evident in the simulation results reported in
Section 4.
3.2.3

Nearest Neighbor Truncation Estimators

Andersen, Dobrev and Schaumburg, henceforth ADS, (2009) introduced a couple of IV
estimators designed to improve on the trade-off between jump robustness and efficiency
confronting the MPV estimators while also allowing for a limiting theory under the jump

15

alternative. The estimators are given as,
M inRVN
M edRVN

N
N −1

= dMin,2



= dMed,2



 NX
−1

min (|ri |, |ri+1 |)2

i=1

N
N −2

 NX
−1

med (|ri−1 |, |ri |, |ri+1 |)2

i=2

where, for Zi ∼ i.i.d. N (0, 1), i = 1, 2, 3 , the normalization constants are determined as,
dMin,p = ( E [ min ( |Z1 |p , |Z2 |p ) ] ) −1 and dMed,p = ( E [ med ( |Z1 |p , |Z2 |p , |Z3 |p ) ] ) −1 .
Under relatively weak conditions, the MinRV and MedRV estimators are consistent
under the finite jump scenario and we may establish an associated asymptotic distribution
theory which is independent of the finite activity jump process. Moreover, in finite samples,
the distortion due to isolated jumps is of order O(1/N ) versus the higher order O(N −1+h ),
for h =

p
2m

> 0, in the case of the MPV estimators.

As noted previously, the need to dampen the (finite sample) impact of jumps becomes
increasingly acute as one estimates higher order power variation measures. The nearest
neighbor truncation principle may be particularly advantageous in this context as isolated
large jumps are effectively annihilated. Consequently, we extend the theory of nearest
neighbor truncation to cover general integrated power variation estimation by developing
the following jump-robust estimators,
p

M inP VN (p) = dMin,p
M edP VN (p) = dMed,p

N2
N −1
p
2

! N −1
X

N
N −2

[ min (|ri |, |ri+1 |) ]p

i=1

! N −2
X

[ med (|ri |, |ri+1 |, |ri+2 |) ]p

i=1

and establish the following properties (proofs are relegated to the appendix):
Proposition 1 If Assumption 1 applies and p is a positive, even integer then, as N → ∞,
M inP VN (p) −→
P

Z 1
0

σup du

M edP VN (p) −→
P

and

Z 1
0

σup du

A corresponding asymptotic distribution theory is available,
Proposition 2 If Assumptions 1 and 1A both apply then, for any positive, even integer, p,
√
√

N (M inP VN (p) −
N (M edP VN (p) −

Z 1
0

Z 1
0

σup du)
σup du)

Stable L

→

Stable L

→



Z 1



Z 1

N 0, η(M in, p)
N 0, η(M ed, p)

where η(M in, p) and η(M ed, p) are known constants.
16

0

0



σu2p du



σu2p du

Moreover, these results remain valid for infinite activity jump processes in volatility subject
to the regularity conditions of Barndorff-Nielsen, Shephard and Winkel (2006).13
Of course, our main focus is Integrated Quarticity (IQ) estimation. Proposition 2 provides the following realized quarticity estimators for the case of p = 4,
M inRQN
M edRQN

=
=

M inP VN (4) = dMin,4
M edP VN (p) = dMed,4

N2
N −1
N2

! N −1
X

N −2

[min (|ri |, |ri+1 |)]4

i=1

! N −2
X

[med (|ri |, |ri+1 |, |ri+2 |)]4 .

i=1

Proposition 2 mirrors the existing limit theory for the MPV statistics. Table 1 provides
the efficiency factors for some select estimators. Panel A demonstrates, as is well known,
that the RV estimator is most efficient, followed by low order MPV estimators. Estimation
of IV by MinRV entails a significant increase in the asymptotic variance relative to, say,
BV, while MedRV is much closer to matching the efficiency of BV. Likewise, Panel B shows
that MedRQ is more efficient than quadpower, M P Q4 = M P V (4, 4), in estimating IQ.
These observations suggest that MedRV and MedRQ will outperform all MPV estimators
that allow for an asymptotic distribution theory under the jump alternative, as the latter
correspond to MPV(m,2) for m ≥ 3 in the case of IV and MPV(m,4) for m ≥ 5 in the
case of IQ. In addition, the nearest neighbor truncation estimators have the advantage of
near elimination of finite sample distortion stemming from isolated price jumps. Finally,
from the perspective of the blocking strategy, the MinPV and MedPV estimators operate
with narrow window widths of m = 2 and m = 3, respectively. Thus, they are highly
localized estimators which equips them with robustness towards time variation in volatility,
matching the relatively favorable features of the bipower and tripower variation measures
in this regard. As such, MedRV and MedRQ may be potentially attractive candidates for
jump-robust inference and jump test applications.
Finally, we note that the nearest neighbor truncation estimators are limited in their
ability to adapt to shifts in the underlying efficiency-robustness trade-off due to the use of
very small return blocks. The following section provides a generalization of the underlying
estimation principle to enable added flexibility in dealing with different orders of return
power variation.

3.3

Robust Neighborhood Truncation Estimation

The nearest neighbor truncation approach selects a specific order statistic for absolute
returns on a small block to obtain an unbiased power variation estimator under the null
13

These conditions become increasingly stringent as the order of the power variations rises, so we do not
discuss this potential extension any further.

17

Table 1: Comparison of efficiency of selected multi power variation and nearest neighbor
truncation estimators. Panel A: Efficiency factors (from best to worst) for IV, η( · , 2).
Panel B: Efficiency factors for IQ, η( · , 4).
Panel A:

RV

BV

MedRV

TV

MPV4

MPV5

MPV6

MinRV

MPV7

2.00

2.65

2.96

3.06

3.38

3.61

3.78

3.81

3.91

RQ
10.66

BQ
12.00

TQ
13.65

MedRQ
14.16

MPQ4
14.92

MPQ5
15.85

MinRQ
18.54

Panel B:

of constant local volatility. This set-up facilitates the design of simple strategies to ensure
robustness in directions of particular concern. However, the relative importance of factors
impacting the trade-off between statistical efficiency and robustness changes substantially
as we move from estimating the integrated return variation to higher order power variation.
Hence, the most suitable design for the integrated return variation, or p = 2, is unlikely to
be preferable when estimating the integrated quarticity, or p = 4. Consequently, we now
extend the nearest neighbor truncation principle to allow for a larger block size and an
enhanced menu of inference procedures based on order statistics.
3.3.1

Neighborhood Truncation Estimators

Before presenting the general estimator we introduce some useful notation. First, we denote
the ith block of absolute returns r i,m = ( |ri | , · · · , |ri+m−1 | ), i = 1, . . . , N − m + 1. Next,

qj ( |r1 |, . . . , |rm | ), = qj (r i,m ), j = 1, · · · , m, is the j th order statistic of the ith absolute
return block, so q1 (r i,m ) ≤ . . . ≤ qm (r i,m ) . Under the null hypothesis that these returns
p

are i.i.d. N ( 0, σi2 /N ), we may also write N 2 r i,m = σi Z i,m , highlighting the fact that

all observations and estimators for the block ultimately are functionals operating on the
realization of an m-dimensional standard normal random vector.
In this setting, we naturally have m separate unbiased estimators for σip , namely

one for each order statistic. We denote these “Neighborhood Truncation” estimators, or
(j,m)

N TN

(p). In analogy with the MinPV and MedPV estimators, they take the form,

(j,m)
N TN
(p)

p

= d(j,m) (p) ·

N2
N −m+1

! N −m+1
X h



qj r i,m

 ip

,

j = 1, . . . , m ,

i=1

where the scaling factor d(j,m) (p) = (E [ qj (|Z1 |p , · · · , |Zm |p )])−1 , Zi ∼ i.i.d. N (0, 1), i =

1, . . . , m , ensures that the scaled pth power of the j th absolute return order statistic provides an unbiased estimator for σ p . Since these scaling factors are obtained as the inverse

18

of a set of order statistics we have the ranking, d(1,m) (p) > . . . > d(m,m) (p).14

This class provides a direct extension of the original nearest neighbor truncation esti(1,2)

mators as we have, M inP V (p) = N TN

(2,3)

(p) and M edP V (p) = N TN

factors, dM in (p) = d(1,2) (p) , and dM ed (p) = d(2,3)

(p), with scaling

(p).15

If we focus on a single return block, r i,m , for a given power variation estimator, we may

consider N, m, and p fixed, and we will suppress either of these indices whenever convenient
as long as their exclusion does not lead to ambiguity. Under the block null, we then define
the neighborhood truncation estimator based on the j th order statistic applied to a given
return block as,
p

Ej = d(j,m) (p) · N 2 · qj r i,m
h



 ip

= σip · d(j,m) (p) · qj Z i,m
h



 ip

.

If we want to be explicit
about
the estimator referring
to the ith return block, we




may loosely write Ej = Ej r i,m , or even Ej = Ej Z i,m . Under the maintained null,
the set of unbiased neighborhood truncation estimators for σip is summarized by, E =

{ E1 , . . . , Em }. 16

In this notation, picking a specific NT estimator amounts to, a priori, selecting a given
integer j from the set {1, · · · , m}. However, viewed from this perspective, it is natural
to explore whether estimators with superior properties may be obtained via, say, a linear
combination of NT estimators.17 To formalize this idea, we introduce a “selector index”
vector which identifies the order statistics used in the construction of a given estimator.
Hence, we let I = ( k1 , . . . kH ), 1 ≤ H ≤ m , be a 1xH vector consisting of an ordered
subset of integers from {1, · · · , m}, where the integer kh , h = 1, · · · , H , denotes the hth

order statistic from the original block to be included in the selection. Hence, the final
estimator exploits the candidate set { Ek1 , · · · EkH }. . For example, Ej is obtained by stipu-

lating I = {j} , while estimators exploiting the joint information in several NT estimators
specifies I as a vector with multiple indices. The total number of distinct non-empty sub-

sets of {1, · · · , m} is 2m − 1. Denoting the set of all possible selector index vectors I, a
specific combination of estimators is uniquely identified by the vector, I ∈ I, ranging from
14

For p ≥ 4 and m ≥ 3, these scaling factors become quite large for the lower order statistics and very
small for the higher ones; e.g., for IQ estimation based on order statistics for a block with five returns, we
obtain d(1,5) (4) = 35.0, d(2,5) (4) = 5.74, d(3,5) (4) = 1.44, d(4,5) (4) = 0.40, d(5,5) (4) = 0.086, see Table 10 in
the appendix.
15
For the integrated variance (p = 2), these estimators may be interpreted as a redesigned version of
the original Quantile Realized Variation, or QRV, estimator of Christensen, Oomen and Podolskij (COP)
(2008), where the QRV estimator is adapted to quantiles based on absolute rather than raw returns. The
adaptation of QRV to cover the ADS (2009) nearest neighbor truncation estimators is discussed in COP
(2010).
16
In this generic notation it is evident that E may designate an arbitrary set of m ordered, unbiased σip
estimators obtained as functionals of the underlying return block. Many of the insights below will continue
to apply in this general context.
17
This is analogous to the use of such linear combinations for the QRV estimator by COP (2008).

19

one-dimensional vectors, identifying the original NT estimators at the one extreme, to the
full vector {1, · · · , m} indicating the use of all candidate estimators, at the other extreme.
It is evident that superior asymptotic performance will be obtained by combining, and
thus exploiting the information associated with, all the estimators as long as we remain
within the ideal setting of Assumptions 1 and 1A. However, this must be weighed against
the robustness objective of ensuring reliable inference in finite samples in the presence
of jumps as well as other potential sources of noise. In fact, such robustness concerns
motivate us to consider an even broader class of alternative estimators, leading to the
“Robust Neighborhood Truncation,” or RNT, principle to which we now turn.
3.3.2

Robust Neighborhood Truncation Estimators

This section develops a procedure for robust estimation of integrated power variation based
on order statistics of a set of unbiased local power variation estimators on a block of returns.
In principle, this original set of estimators may be obtained by a variety of functionals and
estimation strategies, and need not originate from the neighborhood truncation approach.
The general features of our discussion will remain similar for such scenarios. Below, however,
we focus on the case where the initial set consists exclusively of NT estimators. As for the
basic neighborhood truncation estimators, the idea is to obtain robustness by relying on a
scaled order statistic, but now applied in a second step to the candidate unbiased estimators,
and not the underlying absolute returns. Since this involves a second layer of order statistics,
the notation is necessarily more complex, and we first introduce some useful conventions.
First, as indicated in the preceding section, for each return block we rely on a set of
H unbiased candidate estimators for σ p obtained via the corresponding order statistics,
{ Ek1 , · · · EkH }. It is evident that the appropriate scaling factor, converting an order statistic, applied to such a set of unbiased σ p estimators, into a new unbiased (and robust)

estimator, will depend on the specific composition of the set. Hence, the definition of this
scaling factor must reference the underlying NT estimators explicitly. Consequently, we
denote them d(j,I ) (p). They are often not available in closed form, but they may be char-

acterized in terms of functionals of independent standard normal variables which allows for
straightforward determination by computational means.
Second, combining the above conventions, we may define the robust neighborhood truncation estimator based on the j’th order statistic among the unbiased candidate estimators,
as d(j,I ) (p) · qj ( Ek1 , · · · , EkH ). Written more explicitly, this becomes,
p

d(j,I ) (p) · N 2 · qj d(k1 ,m) (p) · qk1 r pi,m , · · · , d(kH ,m) (p) · qkH
h







r pi,m

i

We may then define the Robust Neighborhood Truncation estimator obtained from the

20

j’th order statistic of the candidate set as,
(j,I )

RN TN

(p) = d(j,I ) (p)

1
(N − m + 1)

N −m+1
X

qj Ek1 ( r i,m ), · · · , EkH ( r i,m )
h

i

i=1

where the scaling factor is given by,
d(j,I ) (p) =



p
p
E qj ( d(k1 ,m) (p) Z(k
, · · · , d(kH ,m) (p) Z(k
)
1 ,m)
H ,m)

h

i  −1

,

and Z(k,m) denotes the k’th absolute order statistic from a block of M i.i.d. N (0,1) random

variables. While the scaling factor, d(j,I ) (p), generally is not available in closed form it is

readily determined, to an arbitrary degree of precision, by simulation. As before, we achieve
jump robustness by constructing an estimator that avoids using the largest order statistic
among the available set.
By analogous arguments to those for the nearest neighbor truncation estimators, the
RNT estimator is consistent.
Proposition 3 If Assumption 1 applies and p is a positive, even integer then, as N → ∞,
(j,I)
RN TN (p)

P

−→

Z 1
0

j = 1, · · · , H .

σup du ,

In addition, the associated asymptotic distribution theory is similar.
Proposition 4 If Assumptions 1 and 1A both apply then, for any positive, even integer, p,
√



(j,I)

N RN TN

(p) −

Z 1
0



σup du

Stable L

→



N 0, η(j, I; p)

Z 1
0



σu2p du

,

j = 1, · · · , H ,

where η(j, I; p) is a known constant.
This result encompasses the Neighborhood Truncation and Nearest Neighbor Truncation
estimators as special cases as the latter involve a specific choice for the vector I . Consequently, this constitutes a new class of estimators that may compare favorably to existing
inference procedures for integrated return power variation in some dimensions. In particular, the application of a sequence of order statistics offer great flexibility in accommodating
specific robustness features of concern in a given application. Of course, the leading applications of RNT will be for estimation of integrated return variation and integrated return
quarticity. Hence, whenever there is no concern about ambiguity, we often suppress the additional indices and refer to the RNT(2) estimator as RNTV and RNT(4) as RNTQ, so that
the notation is better aligned with the one usually adopted for these orders of integrated
power variation.
21

The simulation and empirical work in the following sections exploit fairly small blocks
of M ≤ 5 in order to retain resiliency relative to rapidly changing volatility levels during
the trading day. In addition, the highest order statistics among the set I are excluded to
achieve a reasonable degree of jump robustness. Finally, we also find it useful to eliminate
estimators that stem from the lowest order statistics of the underlying returns as these
are relatively more affected by market microstructure noise such as price discreteness and
bid-ask bounce. In addition, these estimates obtain unbiasedness by scaling the original
small returns by a large factor, implying that any potential microstructure features are
aggravated. Hence, we typically exclude E1 , and often also E2 , from I . Figure 3 exemplifies
the construction of RNTQMin5, our simplified notation for the RN T Q1,(3,4,5) estimator,

Robust
- An
Example
which
plays aNeighborhood
prominent role in ourTruncation
analysis in Sections
4 and
5.

RNTQMin5

1

2

3

4

5

Retains three largest absolute returns

Ordered abs returns
{0.0, 2.8, 3.0, 3.5, 5.0}

1
Retain largest 3
{0.0, 2.8, 3.0, 3.5, 5.0}

Raises the returns to 4th power

2

Scales each to an unbiased estimator of σ 4
Selects suitable low order quantile (e.g. Min)
Scales result to yield unbiased final estimate

Take 4th power
{0.0, 61.5, 81.0, 150.1, 625.0}

3
Scale to unbiased est.
{0.0, 353.0, 116.7, 59.8, 53.9}

4
Apply Min
53.9

5
Scale to unbiased est.

140.5

Figure 3: Schematic
of the construction
of the
RNTQMin5
estimaAndersen,representation
Dobrev & Schaumburg
Integrated Quarticity
Estimation
2
tor of σ 4 on a block of five adjacent returns.

The example in Figure 3 warrants a few comments. First, for illustration, we display
the estimators obtained from the first and second return order statistics along with the
rest, even if the former are excluded from the ultimate construction of the estimator. As
such, the third box from the top displays the five fourth order returns that would have
been included in the standard RQ estimator. The extreme right skew of the components is
evident, spanning 0 to 625, even if the initial returns do not appear particularly scattered.
The zero return is, of course, fairly common due to the discreteness of the price grid.
22

Second, the step between box 3 and 4 reflects the application of the relevant scaling factors
(j,5)

for the set of neighborhood truncation estimators, N TN

(4), which is given by d(j,5) (4) for

j = 1, . . . , 5, explicitly listed in footnote 14. In particular, the large scaling factor (5.74)
associated with the fourth power of the second order absolute return statistic produces the,
by far, largest realized unbiased estimator among the set in box four (353) at more than
three times the second largest estimator. Finally, excluding the NT estimators stemming
from the two lowest absolute returns (0, 353), we pick the minimum of the remainder and
upscale this first order statistic from the subset of unbiased estimators (53.9) suitably to
obtain this particular local RNT estimator of σ 4 of 140.5. In the end, this specific functional

realization is based on the largest order statistic from the original block of returns (5.0), but
the low scaling factor of (the fourth power of) this return (0.086, as indicated in footnote
14) implies that the associated (unbiased) NT estimator in box four is the smallest of the
relevant estimators. Third, the appropriate scaling factor for this smallest order statistic
among the given set of candidate estimators is then, d(j,I ) (p) = d(1,(3,4,5) (4), which is readily

determined by simulation under the null hypothesis. Overall, the final local estimate of 140.5
falls squarely in the middle to upper ranges of the potential candidate RQ style estimators
in box 3 and NT estimators in box 4, as seems natural when constructing a robust estimator
based on a set of initial estimators that are drawn from a severely right skewed distribution.
Finally, we note that the second layer of order statistics associated with the RNT estimators involves a nonlinear transformation that takes them outside the basic class of NT
or QRV estimators. Moreover, as we document below, it embeds them with properties that
typically are very distinct from, and often preferable to, those obtained by existing high
order integrated power variation estimators in dimensions of practical interest.

√
3.4

Using the Ratio cI Q for Robust IV Inference
IV
c

The primary applications of IQ estimation is to draw inference about IV and to test for the
presence of jumps under the null hypothesis of no-jumps. For these procedures to perform
well, it is essential to have estimators of IV and, especially, IQ with good efficiency and
finite sample jump robustness.
d, IQ
c be suitable jump-robust estimators of IV and IQ within, say, the MPV,
Let IV

nearest neighbor truncation, or truncation MPV estimator class. Then the natural approach
for drawing inference about IV is based on the limiting distribution of:
√
d − IV ] Stable L
N [IV
q
→ N (0, 1)
c
η IQ
where η is a scaling factor that depends on the specific choice of estimator.
Letting RV denote the realized volatility estimator, which is the efficient estimator of
23

IV under the null, the natural Hausman test statistic for the presence of jumps, see BNS
(2004) and Huang and Tauchen (2005), is given by
√
d − IV
d] StableL
N [RV
q
→ N (0, 1) .
c
(η − 2) IQ
An asymptotically equivalent set of test statistics with better finite sample properties, proposed by BNS (2002), can be derived by applying the delta method to the log-transform
of the volatility measures. This has the benefit that IQ enters only in terms of the ratio
√
IQ/IV which, as also demonstrated in our empirical investigation below, has a stabilizing
d.
effect on the variance of log IV
√
d ) − log(IV ) ]
N [ log( IV
v
u c
u  ηI Q
t
2
Ic
V

Stable L

→

N (0, 1) .

The corresponding Hausman test statistic for the presence of jumps is
√
d ) − log(IV
d) ] StableL
N [ log( RV
v
→ N (0, 1) .
u
Q
u(η − 2)  Ic
2
t
Ic
V

In fact, the simulation and empirical results below are sufficiently compelling that we
advocate using this ratio for jump-robust inference concerning integrated return variation.
However, reliance on this ratio will also affect the way market microstructure noise impacts
our inference. While it is impossible to provide a complete answer regarding the degree
of noise robustness of the ratio statistic - it will hinge on the specific estimator and the
nature of the noise - we find suggestive evidence pointing towards the favorable properties
of the ratio statistic relative to the raw statistic in this dimension as well. The intuition
is, as before, that particular biases tend to manifest themselves simultaneously in the IQ
and IV statistics so that there is a partial cancelation of errors. The appendix provides
an illustration of this point through computations involving the non-robust versions of the
IQ and IV estimators which allow for relatively simple analytical expressions. The issue is
further pursued within the simulation set-up entertained in the following section.

4

Finite Sample Simulation Evidence
We carefully design a series of Monte Carlo experiments, each focusing on a distinct

feature of the data generating process that may affect the finite sample behavior of the
√
various IV, IQ and IQ/IV (ratio) estimators. In particular, we compare the performance
24

of pre-averaged RNT to different truncation, nearest neighbor and multi-power variation
estimators for alternative simulation designs representing distinct stylized features of the
intraday return series. The emphasis is on understanding the qualitative impact of each
feature in isolation. In reality, multiple features are interacting simultaneously, creating
rather complex patterns in tick-by-tick data. The joint presence of various factors, which
partially offset or reinforce the effect of each other, render it difficult to infer the significance
and impact of individual features. Hence, our simulation designs do not intend to replicate
the empirical results in all dimensions, but rather to assist in identifying what market
characteristics are plausible candidates for explaining the systematic patterns we observe
in performance across the alternative estimators.

4.1

Estimators

We adopt the novel filtering procedure, based on (mildly) truncating the local power variation functional, for all the estimators except those already truncating individual returns
more aggressively, i.e., the truncation power variation estimators, TRV, TBV, TRQ, and
TBQ. For the latter, the impact of an additional layer of mild truncation is negligible so
leaving these estimators intact allows for a more direct comparison of the alternative approaches.18 In implementing the truncation estimators, we adopt the CPR procedure as
a benchmark as they explore alternative versions of these estimators in some depth. As
mentioned, all other estimators are subjected to the mild truncation of the local estimating
functional. This set of IV and IQ estimators include,
1. Multi-power variation benchmark estimators: MVP3, MPV4 and MPV5, as well as
MPQ3, MPQ4 and MPQ5. This type of estimators was first considered by BNS
(2004);
2. Nearest neighbor truncation estimators: NTVMin2 = N T V 1,2 ≡ M inRV and NTVMed3 =
N T V 2,3 ≡ M edRV , along with NTQMin2 = N T Q1,2 ≡ M inRQ and NTQMed3 =
N T Q2,3 ≡ M edRQ. These are developed by ADS (2009) and in this paper;
3. Robust Neighborhood Truncation estimators: RNTVMin2 = RN T V 1,(1,2) , RNTVMed3 =
RN T V 2,(1,2,3) , RNTVMin5 = RN T V 1,(3,4,5) , and RNTVMed5 = RN T V 2,(3,4,5) , as
well as RNTQMin2 = RN T Q1,(1,2) , RNTQMed3 = RN T Q2,(1,2,3) , RNTQMin5 =
RN T Q1,(3,4,5) , and RNTQMed5 = RN T Q2,(3,4,5) , as developed in the current paper.
In addition, in our analysis of IV estimators, we include the standard (non-truncated and
non-functional filtered) RV estimator, serving as a non jump-robust benchmark, along with
18

We confirm that our filtering procedure under the BM null, applied to pre-averaged returns, only is
active for about 1-in-106 return blocks, while the filter of CPR is applied to roughly 1-in-103 returns on
average.

25

the QRV estimator of COP (2010). We omit an IQ counterpart of QRV from our analysis
because we find the block size of 20 or more returns, necessary in order to establish the
quantiles, to be prohibitively large for reliable inference on actual data that are subject to
typical imperfections such as irregular sampling intervals and pronounced intraday variation
in volatility. In addition, as discussed previously, one may interpret our nearest neighbor
estimators as modified QRV estimators based on the absolute returns over very small blocks,
while the new RNT class of estimators is inherently different.
Finally, taking into account the need to apply suitable noise-reduction technique when
using the estimators in practice, we focus our Monte Carlo analysis exclusively on the preaveraged implementation of all estimators, as defined in more detail in appendix C and
further discussed in section 4.2.4 below.

4.2

Simulation Results

We largely follow the comprehensive simulation design in Andersen et al (2009) adopted
for comparing IV estimators. We calibrate the unconditional daily IV to 0.000159, or
roughly 20% per year, across all scenarios. For each scenario we simulate 250,000 trading
days, corresponding to about 1,000 years, from 9:30 am to 4:00 pm with new prices arriving
every 3 seconds on average, so we have 7,800 distinct prices each day.
We consider three major types of departure from the Gaussian benchmark: (i) jumps
in returns: these stem from one or multiple intraday price jumps; (ii) time-varying
volatility: stochastic and deterministic (diurnal pattern) variation in volatility along with
volatility jumps; (iii) market microstructure noise: bid-ask bounce, price recording
errors, irregular trade intervals, and price decimalization (discreteness). Each scenario is
briefly described below, with additional details available in Andersen et al. (2009). In each
√
case we focus on estimators of IQ, IV , and the ratio IQ/IV , where the latter is calculated
using the same type of estimator in both numerator and denominator.19 Our findings for
IV are summarized in Tables 2-3, those for IQ are reported in Tables 4-5, while the ones
√
for IQ/IV appear in Tables 6-7.
4.2.1

Brownian motion: The “BM” baseline scenario

This is our baseline Brownian motion model with sampling on an equispaced time grid.
It is an ideal setting under which the finite sample performance of all estimators should
mimic the underlying asymptotic theory. The results in Tables 2-7, Panel A, reveal that all
estimators are unbiased at the higher frequencies and the ordering of estimators by finite
sample RMSEs is as expected. Nonetheless, it is striking that TBV and TRV are the only
19
Although it may, in theory, be preferable to employ a different type of estimators for the numerator
and denominator, our experimentation points towards significant gains in retaining estimators within the
identical class, as this facilitates more effective cancelation of noise and outliers.

26

IV estimators suffering from a minor downward bias at the lower frequencies in Tables 2-3,
Panel A, and likewise, TBQ and TRQ are the only IQ estimators in Tables 4-5, Panel A,
that are mildly downward biased in the BM scenario for the lower frequencies. These biases
stem from estimation noise in the truncation and recursive bias-correction of the estimators.
Since the individual returns are truncated at three (estimated) standard deviations, unbiasedness necessitates an upward adjustment to mitigate the impact of occasional erroneous
truncations of diffusive returns but this involves some degree of error, even under the BM
null. By contrast, all remaining MPV, NT and RNT estimators are almost perfectly unbiased under the BM null. This reflects the much more conservative truncation level (p-value
of 10−6 ) adopted when filtering outliers among the individual functional estimators of local
√
power variation. For the ratio IQ/IV (true value equal to unity for BM), Tables 6-7,
Panel A, reveal a slightly more systematic downward bias across all estimators from about
the three minute sampling interval and increasing at the lower frequencies. This stems from
a finite sample Jensen effect, impacting all estimators to a similar degree.20
In accordance with the asymptotic theory, TRV and TRQ are superior in terms of
(RMSE) efficiency under the BM null. However, the RNTVMin5 and RNTQMin5 estimators are close to TRV and TRQ and are the best of the remaining estimators. As such, the
behavior of these estimators under the various alternative scenarios, and in particular the
jump setting, will be important in assessing their overall standing.
√
Finally, and importantly, when estimating the ratio IQ/IV , the pairing of RNTVMin5
and RNTQMin5 significantly outperforms all other estimators, including the ratio based on
TRQ and TRV (Panel A, Tables 6-7). The efficiency gains associated with the RNTQ/RNTV
estimators reflect a more effective dampening of outliers in both the numerator and denominator of the ratio statistic, attainable through the specific design of the RNT estimators.

20

The improved performance of the TBQ-TBV ratio is due to a fortuitous cancelation of the biases of the
individual terms in numerator and denominator under the BM null.

27

28

Estimator Class:
RV MPV
Block Size:
1
3
Functional: Prod Prod
Selector Index:
1
1­3
Panel A: BM
30 sec
1.00 1.00
60 sec
1.00 1.00
90 sec
1.00 1.00
120 sec
1.00 1.00
180 sec
1.00 1.00
300 sec
1.00 1.00
600 sec
1.00 1.00
Panel B: BM + 1 Jump
30 sec
1.25 1.01
60 sec
1.25 1.02
90 sec
1.25 1.03
120 sec
1.25 1.03
180 sec
1.25 1.04
300 sec
1.25 1.06
600 sec
1.25 1.08
Panel C: BM + 4 Jumps
30 sec
1.25 1.03
60 sec
1.25 1.05
90 sec
1.25 1.06
120 sec
1.25 1.07
180 sec
1.25 1.09
300 sec
1.25 1.11
600 sec
1.25 1.14
Panel D: SV­U
30 sec
1.00 1.00
60 sec
1.00 0.99
90 sec
1.00 0.99
120 sec
0.99 0.98
180 sec
0.99 0.98
300 sec
0.99 0.97
600 sec
0.98 0.95
Panel E: BM + 1 Volatility Jump
30 sec
1.00 1.00
60 sec
1.00 1.00
90 sec
1.00 0.99
120 sec
1.00 0.99
180 sec
1.00 0.99
300 sec
1.00 0.98
600 sec
0.99 0.96
1.01
1.02
1.02
1.03
1.03
1.04
1.06
1.03
1.04
1.05
1.06
1.07
1.09
1.12
0.99
0.99
0.98
0.98
0.97
0.95
0.93
1.00
0.99
0.99
0.99
0.98
0.97
0.94

1.03
1.04
1.05
1.06
1.08
1.10
1.13
0.99
0.99
0.98
0.98
0.97
0.96
0.94
1.00
1.00
0.99
0.99
0.99
0.98
0.95

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.01
1.02
1.02
1.03
1.04
1.05
1.07

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
0.99
0.99
0.99
0.98
0.97
0.93

1.00
0.99
0.99
0.99
0.98
0.97
0.96

1.03
1.05
1.06
1.07
1.10
1.13
1.16

1.01
1.01
1.02
1.03
1.03
1.05
1.08

1.00
1.00
1.00
1.00
1.00
0.99
0.99

1.00
0.99
0.99
0.98
0.98
0.96
0.92

0.99
0.99
0.99
0.98
0.97
0.96
0.92

1.02
1.03
1.04
1.05
1.06
1.08
1.10

1.00
1.01
1.01
1.01
1.02
1.02
1.03

1.00
1.00
0.99
0.99
0.99
0.98
0.97

0.99
0.98
0.98
0.97
0.96
0.93
0.90

0.98
0.96
0.95
0.94
0.92
0.91
0.90

1.02
1.03
1.05
1.06
1.07
1.10
1.14

1.01
1.01
1.01
1.02
1.02
1.04
1.06

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
0.99
0.99
0.98
0.97

1.00
0.99
0.99
0.99
0.98
0.97
0.96

1.01
1.02
1.03
1.04
1.05
1.07
1.11

1.00
1.01
1.01
1.01
1.02
1.03
1.04

1.00
1.00
1.00
1.00
1.00
1.00
1.00

MPV MPV TRV TBV QRV NTV
4
5
1
2
20
2
Prod Prod Prod Prod Quant Min
1­4 1­5
1
1­2 16­19 1­2

Relative Bias

1.00
1.00
0.99
0.99
0.99
0.98
0.96

1.00
0.99
0.99
0.98
0.98
0.97
0.95

1.01
1.02
1.03
1.04
1.06
1.08
1.12

1.00
1.01
1.01
1.01
1.02
1.03
1.05

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
1.00
0.99
0.99
0.97

1.00
0.99
0.99
0.99
0.98
0.98
0.96

1.02
1.04
1.05
1.06
1.08
1.11
1.14

1.01
1.01
1.02
1.02
1.03
1.04
1.07

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
0.99
0.99
0.98
0.97

1.00
0.99
0.99
0.98
0.98
0.97
0.95

1.02
1.04
1.05
1.06
1.08
1.10
1.14

1.01
1.01
1.02
1.02
1.03
1.04
1.07

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
0.99
0.99
0.99
0.98
0.97
0.95

0.99
0.99
0.98
0.97
0.97
0.95
0.93

1.02
1.03
1.04
1.05
1.07
1.09
1.13

1.00
1.01
1.01
1.02
1.02
1.04
1.06

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
1.00
0.99
0.99
0.99
0.98
0.96

0.99
0.99
0.98
0.98
0.97
0.95
0.93

1.02
1.04
1.05
1.06
1.08
1.11
1.15

1.01
1.01
1.02
1.02
1.03
1.04
1.07

1.00
1.00
1.00
1.00
1.00
1.00
1.00

NTV RNTV RNTV RNTV RNTV
3
2
3
5
5
Med Min Med Min Med
1­3 1­2 1­3 3­5 3­5

NTV RNTV RNTV RNTV RNTV
3
2
3
5
5
Med Min Med Min Med
1­3 1­2 1­3 3­5 3­5

0.80 1.05 1.11 1.15 0.81 0.97 1.02 1.27 1.05 1.02 0.97 0.94 0.88
1.63 2.13 2.25 2.33 1.65 1.97 2.30 2.57 2.12 2.06 1.96 1.91 1.79
2.46 3.20 3.38 3.51 2.48 2.96 3.76 3.85 3.20 3.09 2.95 2.89 2.72
3.29 4.27 4.51 4.69 3.32 3.96 5.35 5.13 4.27 4.11 3.93 3.87 3.64
4.93 6.37 6.75 7.05 4.98 5.95 8.83 7.64 6.36 6.14 5.87 5.85 5.50
8.23 10.50 11.19 11.77 8.27 9.93 16.36 12.49 10.49 10.11 9.70 9.88 9.28
16.45 20.69 22.23 23.63 16.35 19.78 32.30 24.31 20.77 19.76 19.23 20.20 19.06

0.60 0.78 0.82 0.85 0.60 0.72 0.83 0.94 0.77 0.75 0.71 0.70 0.65
1.21 1.56 1.64 1.70 1.22 1.45 1.82 1.89 1.56 1.52 1.44 1.41 1.32
1.81 2.35 2.47 2.56 1.82 2.19 2.82 2.85 2.34 2.28 2.16 2.12 1.99
2.42 3.11 3.28 3.41 2.42 2.91 3.79 3.77 3.10 3.02 2.87 2.83 2.66
3.60 4.62 4.89 5.09 3.59 4.36 5.63 5.59 4.61 4.48 4.26 4.24 3.99
5.93 7.57 8.02 8.38 5.88 7.21 8.99 9.13 7.53 7.33 6.97 7.00 6.59
11.55 14.76 15.73 16.51 11.48 14.25 16.62 17.63 14.67 14.22 13.62 13.78 12.96

37.27 1.24 1.11 1.06 0.83 0.77 0.80 0.92 0.78 0.92 0.86 0.76 0.80
38.15 2.65 2.41 2.30 2.06 1.73 1.84 1.98 1.72 2.14 1.99 1.73 1.87
39.03 4.11 3.75 3.61 3.45 2.77 3.03 3.13 2.77 3.49 3.25 2.82 3.10
39.89 5.57 5.14 4.96 4.94 3.87 4.31 4.35 3.87 4.93 4.58 3.98 4.41
41.63 8.47 7.94 7.73 8.04 6.13 7.10 6.92 6.22 7.92 7.34 6.47 7.19
45.14 14.24 13.65 13.45 14.30 10.70 13.35 12.41 11.31 14.10 13.04 11.80 13.00
54.08 28.60 28.36 28.52 28.60 21.57 30.73 27.41 25.10 29.44 27.26 26.08 27.72

74.03 0.83 0.82 0.82 0.56 0.65 0.60 0.85 0.70 0.71 0.67 0.63 0.60
74.93 1.76 1.73 1.73 1.19 1.33 1.27 1.75 1.45 1.49 1.41 1.32 1.28
75.84 2.73 2.66 2.65 1.88 2.03 1.98 2.65 2.22 2.32 2.19 2.04 1.99
76.74 3.74 3.64 3.62 2.60 2.76 2.74 3.60 3.00 3.20 3.00 2.79 2.73
78.53 5.81 5.65 5.64 4.15 4.24 4.39 5.52 4.62 5.04 4.71 4.36 4.29
82.11 10.05 9.82 9.83 7.52 7.30 8.20 9.54 8.07 8.99 8.38 7.77 7.75
91.26 21.42 21.30 21.57 16.93 15.31 19.86 20.44 17.59 20.16 18.68 17.59 17.70

0.53 0.69 0.73 0.75 0.53 0.63 0.58 0.84 0.69 0.67 0.64 0.61 0.57
1.07 1.41 1.48 1.53 1.08 1.28 1.20 1.70 1.40 1.36 1.29 1.25 1.17
1.61 2.12 2.23 2.31 1.62 1.93 1.85 2.55 2.11 2.04 1.95 1.88 1.77
2.16 2.84 3.00 3.11 2.16 2.58 2.51 3.43 2.83 2.73 2.61 2.52 2.37
3.24 4.30 4.56 4.73 3.25 3.88 3.92 5.18 4.27 4.13 3.94 3.83 3.59
5.44 7.27 7.72 8.04 5.45 6.53 7.02 8.72 7.24 6.98 6.67 6.54 6.13
11.04 15.02 16.08 16.88 11.05 13.20 15.82 17.85 14.93 14.28 13.78 13.74 12.84

RV MPV MPV MPV TRV TBV QRV NTV
1
3
4
5
1
2
20
2
Prod Prod Prod Prod Prod Prod Quant Min
1
1­3 1­4 1­5
1
1­2 16­19 1­2

Relative MSE

the relative bias (left half of the table) and MSE (right half of the table) factors for different estimators of IV for the following models: BM
(panel A), BM + 1 Jump (panel B), BM + 4 Jumps (panel C), SV-U (panel D), BM + 1 Volatility Jump (panel E). The rows in each panel
correspond to each of the following considered pre-averaging window sizes: 30, 60, 90, 120, 180, 300, 600 seconds. The table columns represent
the considered different estimators: the top row of each column header indicates the estimator class, the second row provides the chosen block
size, the third row gives the functional used by the estimator, the fourth row of each column header lists the selector index, as defined in the
c − IV )2 /IV 2 , where IV is the true
text. The relative MSE is computed using baseline window size of 60-seconds as the sample mean of 390(IV
simulated integrated variance and integrated quarticity on each day.

Table 2: Relative bias and relative mean squared error (MSE) factors for pre-averaged estimators of IV. We report

29

Estimator Class:
RV MPV MPV MPV TRV TBV QRV
Block Size:
1
3
4
5
1
2
20
Functional: Prod Prod Prod Prod Prod Prod Quant
Selector Index:
1
1­3 1­4 1­5
1
1­2 16­19
Panel A: BM
30 sec
1.00 1.00 1.00 1.00 1.00 1.00 1.00
60 sec
1.00 1.00 1.00 1.00 1.00 1.00 1.00
90 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
120 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
180 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
300 sec
1.00 1.00 1.00 1.00 0.99 0.98 1.00
600 sec
1.00 1.00 1.00 1.00 0.99 0.97 1.00
Panel B: BM + IID Noise
30 sec
1.03 1.03 1.03 1.03 1.03 1.03 1.03
60 sec
1.01 1.01 1.01 1.01 1.00 1.00 1.01
90 sec
1.00 1.00 1.00 1.00 1.00 1.00 1.00
120 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
180 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
300 sec
1.00 1.00 1.00 1.00 0.99 0.98 1.00
600 sec
1.00 1.00 1.00 1.00 0.99 0.97 1.00
Panel C: BM + 1 Bounceback
30 sec
1.01 1.01 1.00 1.00 1.00 1.00 1.00
60 sec
1.00 1.00 1.00 1.00 1.00 1.00 1.00
90 sec
1.00 1.00 1.00 1.00 1.00 1.00 1.00
120 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
180 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
300 sec
1.00 1.00 1.00 1.00 1.00 0.98 1.00
600 sec
1.00 1.00 1.00 1.00 0.99 0.97 1.00
Panel D: BM + Sparcity
30 sec
1.00 0.96 0.96 0.96 0.99 0.97 0.97
60 sec
1.00 0.98 0.98 0.98 0.99 0.98 0.99
90 sec
1.00 0.99 0.99 0.98 0.99 0.98 0.99
120 sec
1.00 0.99 0.99 0.99 1.00 0.99 0.99
180 sec
1.00 0.99 0.99 0.99 1.00 0.98 1.00
300 sec
1.00 1.00 1.00 1.00 0.99 0.98 1.00
600 sec
1.00 1.00 1.00 1.00 0.99 0.97 1.00
Panel E: BM + Discrete Pricing
30 sec
1.02 1.00 0.97 0.94 1.02 1.01 1.02
60 sec
1.01 1.00 1.00 0.99 1.00 1.00 1.00
90 sec
1.00 1.00 1.00 0.99 1.00 1.00 1.00
120 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
180 sec
1.00 1.00 1.00 1.00 1.00 0.99 1.00
300 sec
1.00 1.00 1.00 1.00 0.99 0.98 1.00
600 sec
1.00 1.00 1.00 1.00 0.99 0.97 1.00
1.03
1.01
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
0.96
0.98
0.99
0.99
0.99
1.00
1.00
1.02
1.01
1.00
1.00
1.00
1.00
1.00

1.03
1.01
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
0.95
0.98
0.98
0.99
0.99
1.00
1.00
1.02
1.01
1.00
1.00
1.00
1.00
1.00

1.02
1.00
1.00
1.00
1.00
1.00
1.00

0.97
0.98
0.99
0.99
1.00
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.03
1.01
1.00
1.00
1.00
1.00
1.00

1.02
1.01
1.00
1.00
1.00
1.00
1.00

0.97
0.98
0.99
0.99
0.99
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.03
1.01
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.01
1.00
1.00
1.00
1.00
1.00
1.00

0.97
0.98
0.99
0.99
0.99
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.03
1.01
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.02
1.00
1.00
1.00
1.00
1.00
1.00

0.98
0.99
0.99
0.99
1.00
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.03
1.01
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

1.00
1.00
1.00
1.00
1.00
1.00
1.00

NTV RNTV RNTV RNTV RNTV
3
2
3
5
5
Med Min Med Min Med
1­3 1­2 1­3 3­5 3­5

NTV
2
Min
1­2

Relative Bias

NTV RNTV RNTV RNTV RNTV
3
2
3
5
5
Med Min Med Min Med
1­3 1­2 1­3 3­5 3­5

0.68 0.71 1.04 2.16 0.64 0.71 0.73 1.05 0.86 0.80 0.81 0.67 0.72
1.09 1.42 1.51 1.62 1.08 1.29 1.22 1.72 1.42 1.38 1.31 1.26 1.19
1.62 2.13 2.25 2.34 1.62 1.93 1.86 2.56 2.12 2.05 1.95 1.89 1.78
2.16 2.85 3.01 3.12 2.17 2.58 2.52 3.43 2.83 2.74 2.61 2.53 2.37
3.25 4.31 4.56 4.73 3.25 3.89 3.92 5.18 4.27 4.14 3.94 3.83 3.59
5.44 7.26 7.70 8.02 5.44 6.52 7.00 8.72 7.23 6.96 6.66 6.53 6.12
10.99 14.93 16.00 16.80 11.00 13.15 15.74 17.77 14.86 14.22 13.71 13.66 12.77

0.59 1.23 1.40 1.51 0.62 1.07 0.85 1.71 1.32 1.06 1.07 1.06 0.84
1.13 1.53 1.63 1.70 1.14 1.43 1.29 1.91 1.56 1.47 1.40 1.37 1.25
1.68 2.17 2.29 2.37 1.68 2.03 1.89 2.64 2.18 2.10 2.00 1.95 1.81
2.22 2.86 3.02 3.12 2.22 2.66 2.54 3.46 2.86 2.77 2.63 2.57 2.40
3.31 4.29 4.53 4.70 3.31 3.94 3.94 5.15 4.27 4.15 3.94 3.86 3.62
5.51 7.24 7.68 7.98 5.51 6.55 7.05 8.67 7.21 6.98 6.65 6.54 6.13
11.11 14.97 16.02 16.82 11.11 13.20 15.89 17.77 14.89 14.25 13.74 13.75 12.87

0.78 0.71 0.75 0.77 0.54 0.64 0.59 0.84 0.69 0.69 0.65 0.62 0.59
1.09 1.42 1.49 1.54 1.08 1.28 1.21 1.71 1.41 1.37 1.30 1.26 1.18
1.62 2.12 2.24 2.32 1.62 1.93 1.85 2.56 2.12 2.05 1.95 1.89 1.77
2.16 2.84 3.01 3.12 2.16 2.58 2.52 3.44 2.84 2.74 2.61 2.53 2.37
3.25 4.30 4.55 4.73 3.25 3.88 3.92 5.19 4.28 4.14 3.95 3.83 3.60
5.46 7.28 7.73 8.04 5.46 6.53 7.05 8.73 7.24 6.99 6.68 6.55 6.13
11.09 15.07 16.13 16.93 11.10 13.23 15.92 17.92 15.01 14.32 13.83 13.80 12.92

0.87 1.05 1.09 1.11 0.82 0.93 0.94 1.20 1.04 1.02 0.99 0.95 0.92
1.10 1.44 1.52 1.57 1.09 1.29 1.24 1.74 1.43 1.39 1.32 1.28 1.20
1.63 2.13 2.25 2.32 1.62 1.92 1.86 2.56 2.12 2.05 1.96 1.89 1.78
2.17 2.85 3.01 3.12 2.17 2.58 2.52 3.44 2.83 2.74 2.61 2.53 2.38
3.25 4.31 4.56 4.73 3.25 3.88 3.92 5.18 4.27 4.13 3.94 3.83 3.59
5.43 7.25 7.69 8.01 5.44 6.51 7.00 8.71 7.22 6.96 6.65 6.52 6.11
10.99 14.93 15.99 16.80 11.00 13.14 15.75 17.76 14.86 14.22 13.71 13.66 12.78

0.53 0.69 0.73 0.75 0.53 0.63 0.58 0.84 0.69 0.67 0.64 0.61 0.57
1.07 1.41 1.48 1.53 1.08 1.28 1.20 1.70 1.40 1.36 1.29 1.25 1.17
1.61 2.12 2.23 2.31 1.62 1.93 1.85 2.55 2.11 2.04 1.95 1.88 1.77
2.16 2.84 3.00 3.11 2.16 2.58 2.51 3.43 2.83 2.73 2.61 2.52 2.37
3.24 4.30 4.56 4.73 3.25 3.88 3.92 5.18 4.27 4.13 3.94 3.83 3.59
5.44 7.27 7.72 8.04 5.45 6.53 7.02 8.72 7.24 6.98 6.67 6.54 6.13
11.04 15.02 16.08 16.88 11.05 13.20 15.82 17.85 14.93 14.28 13.78 13.74 12.84

RV MPV MPV MPV TRV TBV QRV NTV
1
3
4
5
1
2
20
2
Prod Prod Prod Prod Prod Prod Quant Min
1
1­3 1­4 1­5
1
1­2 16­19 1­2

Relative MSE

the relative bias (left half of the table) and MSE (right half of the table) factors for different estimators of IV for the following models: BM
(panel A), BM + IID Noise (panel B), BM + 1 Bounceback (panel C), BM + Sparcity (panel D), BM + Discrete Pricing (panel E). The rows in
each panel correspond to each of the following considered pre-averaging window sizes: 30, 60, 90, 120, 180, 300, 600 seconds. The table columns
represent the considered different estimators: the top row of each column header indicates the estimator class, the second row provides the chosen
block size, the third row gives the functional used by the estimator, the fourth row of each column header lists the selector index, as defined in
c − IV )2 /IV 2 , where IV is the
the text. The relative MSE is computed using baseline window size of 60-seconds as the sample mean of 390(IV
true simulated integrated variance and integrated quarticity on each day.

Table 3: Relative bias and relative mean squared error (MSE) factors for pre-averaged estimators of IV. We report

30

Estimator Class:
MPQ MPQ MPQ TRQ TBQ NTQ NTQ RNTQ RNTQ RNTQ RNTQ
Block Size:
3
4
5
1
2
2
3
2
3
5
5
Functional: Prod Prod Prod Prod Prod Min
Med
Min
Med
Min
Med
Selector Index:
1­3
1­4
1­5
1
1­2
1­2
1­3
1­2
1­3
3­5
3­5
Panel A: BM
30 sec
1.00
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00
1.00
60 sec
1.00
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00
1.00
90 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
300 sec
1.00
1.00
1.00
0.98
0.98
1.00
1.00
1.00
1.00
1.00
1.00
600 sec
1.00
1.00
1.00
0.97
0.96
1.00
1.00
1.00
1.00
1.00
1.00
Panel B: BM + 1 Jump
30 sec
1.09
1.05
1.04
1.02
1.01
1.01
1.01
1.03
1.02
1.01
1.02
60 sec
1.12
1.08
1.06
1.05
1.02
1.02
1.02
1.05
1.04
1.03
1.04
90 sec
1.14
1.09
1.07
1.07
1.04
1.03
1.03
1.07
1.06
1.04
1.05
120 sec
1.16
1.10
1.08
1.09
1.05
1.04
1.04
1.09
1.07
1.05
1.07
180 sec
1.18
1.13
1.10
1.13
1.06
1.05
1.06
1.12
1.10
1.07
1.09
300 sec
1.22
1.15
1.13
1.19
1.09
1.07
1.08
1.16
1.14
1.10
1.13
600 sec
1.26
1.20
1.17
1.28
1.13
1.12
1.13
1.25
1.21
1.16
1.20
Panel C: BM + 4 Jumps
30 sec
1.16
1.11
1.08
1.09
1.05
1.04
1.04
1.09
1.07
1.05
1.07
60 sec
1.21
1.15
1.12
1.17
1.09
1.07
1.07
1.15
1.12
1.09
1.12
90 sec
1.24
1.17
1.14
1.22
1.12
1.09
1.10
1.19
1.16
1.12
1.16
120 sec
1.26
1.19
1.16
1.27
1.15
1.12
1.13
1.23
1.20
1.15
1.20
180 sec
1.29
1.23
1.20
1.34
1.19
1.16
1.17
1.29
1.25
1.19
1.25
300 sec
1.33
1.27
1.24
1.43
1.25
1.21
1.24
1.36
1.32
1.25
1.32
600 sec
1.39
1.34
1.31
1.54
1.32
1.30
1.33
1.45
1.40
1.35
1.42
Panel D: SV­U
30 sec
0.98
0.98
0.97
0.98
0.98
0.99
0.98
0.99
0.98
0.97
0.97
60 sec
0.97
0.96
0.95
0.96
0.97
0.98
0.97
0.98
0.97
0.95
0.95
90 sec
0.95
0.94
0.93
0.95
0.95
0.97
0.95
0.97
0.95
0.93
0.93
120 sec
0.94
0.92
0.91
0.94
0.94
0.96
0.94
0.96
0.94
0.91
0.91
180 sec
0.92
0.90
0.88
0.91
0.91
0.94
0.92
0.94
0.92
0.88
0.88
300 sec
0.88
0.86
0.84
0.88
0.87
0.91
0.88
0.91
0.88
0.84
0.84
600 sec
0.82
0.80
0.78
0.84
0.81
0.85
0.82
0.86
0.82
0.78
0.78
Panel E: BM + 1 Volatility Jump
30 sec
0.99
0.99
0.99
0.97
0.99
0.99
0.99
0.99
0.99
0.99
0.99
60 sec
0.98
0.98
0.98
0.96
0.97
0.99
0.99
0.99
0.99
0.98
0.98
90 sec
0.98
0.97
0.97
0.95
0.96
0.98
0.98
0.98
0.98
0.97
0.97
120 sec
0.97
0.96
0.96
0.94
0.95
0.97
0.97
0.98
0.97
0.96
0.96
180 sec
0.96
0.95
0.94
0.91
0.93
0.96
0.96
0.96
0.96
0.94
0.95
300 sec
0.93
0.91
0.90
0.86
0.89
0.94
0.93
0.94
0.93
0.91
0.92
600 sec
0.88
0.86
0.83
0.75
0.79
0.89
0.88
0.90
0.89
0.85
0.86

Relative Bias

3.27
6.65
10.00
13.46
20.35
34.50
72.40

3.11
6.32
9.51
12.75
19.28
32.50
67.62

3.36
6.85
10.32
13.91
21.06
35.79
75.74

MPQ
5
Prod
1­5
2.44
4.88
7.28
9.68
14.48
24.12
48.22

TRQ
1
Prod
1
3.90
7.92
11.93
16.02
24.02
40.52
82.94

3.11
6.32
9.57
12.81
19.25
32.60
67.44

NTQ
3
Med
1­3

3.00
6.10
9.16
12.25
18.46
31.25
63.97

2.79
5.68
8.54
11.44
17.28
29.18
60.71

2.59
5.28
7.94
10.63
16.11
27.57
58.12

2.45
5.00
7.55
10.09
15.30
26.10
54.91

RNTQ RNTQ RNTQ RNTQ
2
3
5
5
Min
Med
Min
Med
1­2
1­3
3­5
3­5

3.02
4.13
3.32
4.09
3.44
2.84
2.90
6.54
8.75
7.10
9.89
7.90
6.23
6.59
10.34 13.67 11.17 16.76 13.02
9.95 10.78
14.46 18.95 15.48 24.63 18.70 14.01 15.38
23.13 29.94 24.62 42.14 31.23 22.87 25.57
42.20 54.52 45.39 82.06 59.36 42.92 49.24
96.31 126.41 106.71 205.26 142.34 104.58 119.85

2.82
5.71
8.55
11.41
17.07
28.49
56.73

NTQ
2
Min
1­2

Relative MSE
TBQ
2
Prod
1­2

5.04
9.12
12.56
15.61
20.95
30.33
50.94
6.50
12.58
18.14
23.33
32.89
49.35
82.55

8.41
8.82
9.06
16.21 16.97 17.43
23.40 24.48 25.14
30.16 31.56 32.37
42.14 44.12 45.38
62.62 65.99 68.22
110.11 115.21 118.83

6.60
12.06
16.79
20.85
28.09
40.15
65.71

6.66
12.09
16.71
20.76
27.99
40.40
66.98

6.44
11.94
16.74
20.90
28.28
40.25
64.82

8.28
15.67
22.25
27.63
37.97
54.34
85.43

6.44
12.01
16.76
20.83
28.24
40.24
64.40

6.37
12.14
17.12
21.62
29.56
42.55
68.30

5.80
10.78
15.09
18.86
25.63
36.62
59.16
7.66 10.52
8.44
8.11
7.57
14.80 20.12 16.24 15.73 14.65
21.36 28.88 23.52 22.62 21.20
27.52 37.02 30.30 29.00 27.40
38.63 51.38 42.47 40.72 38.44
57.23 75.10 62.88 60.47 57.45
93.12 131.28 110.79 106.29 101.78

5.92
11.01
15.36
19.04
25.86
37.14
60.52

7.03
13.71
19.97
25.82
36.70
55.98
99.53

5.23
9.57
13.36
16.76
22.85
33.41
55.76

6.68
13.05
19.02
24.69
35.09
53.57
95.85

4.94
9.10
12.70
15.97
21.80
31.98
53.38

18.70 10.23
7.53
6.66
4.38
5.09
4.40
8.31
6.26
4.17
5.37
34.92 20.87 16.09 18.78 10.90 12.23 11.10 21.94 16.38 10.49 14.66
49.45 31.31 24.83 33.13 18.60 21.01 19.58 38.29 28.58 17.99 26.21
63.29 41.79 33.90 48.57 26.93 31.01 29.39 55.57 41.94 26.26 39.29
88.42 62.00 51.97 81.05 44.88 53.73 51.62 92.26 69.86 44.49 67.11
133.85 101.81 89.02 145.73 82.42 104.39 99.86 165.86 124.31 84.15 121.44
241.32 202.77 186.94 284.86 173.24 242.86 226.03 329.08 245.59 189.46 242.44

10.67
6.34
4.94
2.76
22.65 13.43 10.57
6.66
34.35 20.60 16.39 11.31
45.74 27.97 22.60 16.60
67.45 42.82 35.13 28.71
106.48 71.83 60.78 57.16
201.80 150.60 133.66 142.30

MPQ
4
Prod
1­4

MPQ
3
Prod
1­3

the relative bias (left half of the table) and MSE (right half of the table) factors for different estimators of IQ for the following models: BM
(panel A), BM + 1 Jump (panel B), BM + 4 Jumps (panel C), SV-U (panel D), BM + 1 Volatility Jump (panel E). The rows in each panel
correspond to each of the following considered pre-averaging window sizes: 30, 60, 90, 120, 180, 300, 600 seconds. The table columns represent
the considered different estimators: the top row of each column header indicates the estimator class, the second row provides the chosen block
size, the third row gives the functional used by the estimator, the fourth row of each column header lists the selector index, as defined in the
c − IQ)2 /IQ2 , where IQ is the true
text. The relative MSE is computed using baseline window size of 60-seconds as the sample mean of 390(IQ
simulated integrated quarticity for each day.

Table 4: Relative bias and relative mean squared error (MSE) factors for pre-averaged estimators of IQ. We report

31

Estimator Class:
MPQ MPQ MPQ TRQ TBQ NTQ NTQ RNTQ RNTQ RNTQ RNTQ
Block Size:
3
4
5
1
2
2
3
2
3
5
5
Functional: Prod Prod Prod Prod Prod Min
Med
Min
Med
Min
Med
Selector Index:
1­3
1­4
1­5
1
1­2
1­2
1­3
1­2
1­3
3­5
3­5
Panel A: BM
30 sec
1.00
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00
1.00
60 sec
1.00
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00
1.00
90 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
300 sec
1.00
1.00
1.00
0.98
0.98
1.00
1.00
1.00
1.00
1.00
1.00
600 sec
1.00
1.00
1.00
0.97
0.96
1.00
1.00
1.00
1.00
1.00
1.00
Panel B: BM + IID Noise
30 sec
1.06
1.06
1.06
1.04
1.05
1.06
1.06
1.06
1.06
1.06
1.06
60 sec
1.02
1.02
1.02
1.00
1.01
1.01
1.02
1.01
1.02
1.01
1.01
90 sec
1.01
1.01
1.01
0.99
1.00
1.01
1.01
1.01
1.01
1.00
1.01
120 sec
1.00
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
300 sec
1.00
1.00
1.00
0.98
0.98
1.00
1.00
1.00
1.00
1.00
1.00
600 sec
1.00
1.00
1.00
0.97
0.96
1.00
1.00
1.00
1.00
1.00
1.00
Panel C: BM + 1 Bounceback
30 sec
1.02
1.01
1.01
1.01
1.01
1.01
1.01
1.02
1.01
1.01
1.01
60 sec
1.01
1.01
1.01
0.99
1.00
1.01
1.01
1.01
1.01
1.00
1.01
90 sec
1.00
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
300 sec
1.00
1.00
1.00
0.98
0.98
1.00
1.00
1.00
1.00
1.00
1.00
600 sec
1.00
1.00
1.00
0.98
0.96
1.00
1.00
1.00
1.00
1.00
1.00
Panel D: BM + Sparcity
30 sec
0.96
0.94
0.93
1.05
0.98
0.96
0.97
0.99
0.98
0.97
0.99
60 sec
0.98
0.97
0.97
1.02
0.99
0.98
0.98
1.00
0.99
0.98
0.99
90 sec
0.99
0.98
0.98
1.01
0.99
0.99
0.99
1.00
0.99
0.99
1.00
120 sec
0.99
0.99
0.98
1.00
0.99
0.99
0.99
1.00
0.99
0.99
1.00
180 sec
0.99
0.99
0.99
1.00
0.98
0.99
1.00
1.00
1.00
0.99
1.00
300 sec
1.00
1.00
0.99
0.99
0.98
1.00
1.00
1.00
1.00
1.00
1.00
600 sec
1.00
1.00
1.00
0.98
0.96
1.00
1.00
1.00
1.00
1.00
1.00
Panel E: BM + Discrete Pricing
30 sec
1.04
1.03
1.02
1.02
1.03
1.04
1.04
1.04
1.04
1.03
1.04
60 sec
1.01
1.01
1.01
0.99
1.00
1.01
1.01
1.01
1.01
1.01
1.01
90 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
1.00
1.00
1.00
0.98
0.99
1.00
1.00
1.00
1.00
1.00
1.00
300 sec
1.00
1.00
1.00
0.98
0.98
1.00
1.00
1.00
1.00
1.00
1.00
600 sec
1.00
1.00
1.00
0.97
0.96
1.00
1.00
1.00
1.00
1.00
1.00

Relative Bias

4.94
6.89
10.12
13.57
20.40
34.29
71.93
3.51
6.75
10.06
13.51
20.42
34.65
72.79
4.43
6.92
10.14
13.50
20.36
34.52
72.48
3.82
6.79
10.08
13.55
20.39
34.33
71.96

3.52
6.44
9.58
12.80
19.36
32.66
68.14
3.80
6.63
9.78
12.99
19.50
32.76
67.97
3.83
6.46
9.59
12.84
19.32
32.41
67.15

3.27
6.65
10.00
13.46
20.35
34.50
72.40

3.11
6.32
9.51
12.75
19.28
32.50
67.62
4.76
6.56
9.63
12.86
19.33
32.39
67.15

MPQ
4
Prod
1­4

MPQ
3
Prod
1­3

3.65
6.97
10.39
14.01
21.08
35.59
75.26

4.92
7.13
10.38
13.83
20.94
35.69
75.80

3.54
6.95
10.37
13.96
21.13
35.95
76.11

5.05
7.10
10.44
14.03
21.09
35.55
75.26

3.36
6.85
10.32
13.91
21.06
35.79
75.74

MPQ
5
Prod
1­5

2.71
4.89
7.31
9.72
14.53
24.08
47.99

4.01
5.75
8.06
10.44
15.26
24.96
49.16

2.59
4.93
7.28
9.69
14.51
24.21
48.52

3.31
4.91
7.31
9.73
14.54
24.08
47.97

2.44
4.88
7.28
9.68
14.48
24.12
48.22

TRQ
1
Prod
1

3.38
5.78
8.58
11.46
17.10
28.45
56.41

3.27
6.11
8.98
11.83
17.55
28.92
57.14

2.93
5.78
8.59
11.44
17.18
28.66
57.08

4.15
5.84
8.61
11.48
17.11
28.44
56.44

2.82
5.71
8.55
11.41
17.07
28.49
56.73

TBQ
2
Prod
1­2

4.90
8.09
12.01
16.08
24.01
40.54
82.38

4.93
8.45
12.37
16.41
24.55
41.08
83.52

4.03
8.04
12.02
16.08
24.24
40.82
83.68

5.61
8.19
12.07
16.12
24.03
40.54
82.41

3.90
7.92
11.93
16.02
24.02
40.52
82.94

NTQ
2
Min
1­2

4.00
6.47
9.64
12.85
19.25
32.57
66.94

3.81
6.77
9.95
13.17
19.74
33.12
67.92

3.23
6.43
9.63
12.88
19.40
32.82
68.12

4.76
6.56
9.68
12.88
19.27
32.57
66.94

3.11
6.32
9.57
12.81
19.25
32.60
67.44

NTQ
3
Med
1­3

Relative MSE

3.68
6.22
9.23
12.32
18.51
31.13
63.70

3.62
6.74
9.85
12.92
19.21
31.94
64.90

3.47
6.26
9.23
12.30
18.58
31.43
64.37

4.58
6.31
9.27
12.35
18.51
31.11
63.79

3.00
6.10
9.16
12.25
18.46
31.25
63.97

3.59
5.81
8.61
11.51
17.31
29.12
60.32

3.28
6.02
8.88
11.76
17.60
29.58
61.07

3.07
5.80
8.61
11.49
17.38
29.33
61.18

4.42
5.90
8.65
11.54
17.32
29.10
60.35

2.79
5.68
8.54
11.44
17.28
29.18
60.71

3.05
5.38
8.00
10.70
16.15
27.45
57.75

3.17
5.62
8.26
10.94
16.45
27.85
58.61

2.72
5.36
8.00
10.67
16.19
27.68
58.63

4.10
5.47
8.03
10.72
16.16
27.43
57.80

2.59
5.28
7.94
10.63
16.11
27.57
58.12

3.16
5.12
7.62
10.15
15.33
26.04
54.50

2.83
5.35
7.89
10.45
15.70
26.50
55.58

2.67
5.10
7.61
10.14
15.39
26.24
55.55

4.03
5.20
7.65
10.18
15.33
26.04
54.52

2.45
5.00
7.55
10.09
15.30
26.10
54.91

RNTQ RNTQ RNTQ RNTQ
2
3
5
5
Min
Med
Min
Med
1­2
1­3
3­5
3­5

the relative bias (left half of the table) and MSE (right half of the table) factors for different estimators of IQ for the following models: BM
(panel A), BM + IID Noise (panel B), BM + 1 Bounceback (panel C), BM + Sparcity (panel D), BM + Discrete Pricing (panel E). The rows in
each panel correspond to each of the following considered pre-averaging window sizes: 30, 60, 90, 120, 180, 300, 600 seconds. The table columns
represent the considered different estimators: the top row of each column header indicates the estimator class, the second row provides the chosen
block size, the third row gives the functional used by the estimator, the fourth row of each column header lists the selector index, as defined in
c − IQ)2 /IQ2 , where IQ is the
the text. The relative MSE is computed using baseline window size of 60-seconds as the sample mean of 390(IQ
true simulated integrated quarticity for each day.

Table 5: Relative bias and relative mean squared error (MSE) factors for pre-averaged estimators of IQ. We report

32

√

Estimator Class:
MPQ MPQ MPQ TRQ TBQ NTQ NTQ RNTQ RNTQ RNTQ RNTQ
Block Size:
3
4
5
1
2
2
3
2
3
5
5
Functional: Prod Prod Prod Prod Prod Min
Med
Min
Med
Min
Med
Selector Index:
1­3
1­4
1­5
1
1­2
1­2
1­3
1­2
1­3
3­5
3­5
Panel A: BM
30 sec
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
60 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
90 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
1.00
1.00
1.00
300 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
0.99
0.99
0.99
600 sec
0.98
0.98
0.98
0.98
1.00
0.98
0.98
0.98
0.98
0.98
0.98
Panel B: BM + 1 Jump
30 sec
1.03
1.01
1.01
1.00
1.00
1.00
1.00
1.01
1.00
1.00
1.00
60 sec
1.03
1.02
1.01
1.01
1.00
1.00
1.00
1.01
1.01
1.00
1.01
90 sec
1.03
1.02
1.01
1.01
1.01
1.00
1.00
1.01
1.01
1.00
1.01
120 sec
1.03
1.02
1.01
1.02
1.01
1.00
1.00
1.01
1.01
1.00
1.01
180 sec
1.03
1.02
1.01
1.02
1.01
1.00
1.00
1.02
1.01
1.00
1.01
300 sec
1.03
1.01
1.00
1.03
1.01
1.00
1.00
1.02
1.01
1.00
1.01
600 sec
1.01
1.00
0.99
1.03
1.02
0.99
0.99
1.01
1.01
1.00
1.00
Panel C: BM + 4 Jumps
30 sec
1.04
1.02
1.01
1.02
1.01
1.01
1.01
1.02
1.01
1.01
1.01
60 sec
1.04
1.02
1.02
1.03
1.01
1.01
1.01
1.03
1.02
1.01
1.02
90 sec
1.04
1.02
1.02
1.04
1.02
1.01
1.01
1.03
1.02
1.01
1.02
120 sec
1.04
1.02
1.01
1.04
1.02
1.01
1.01
1.04
1.03
1.01
1.02
180 sec
1.04
1.02
1.01
1.05
1.02
1.01
1.02
1.04
1.03
1.02
1.03
300 sec
1.03
1.01
1.01
1.05
1.03
1.01
1.02
1.04
1.03
1.01
1.03
600 sec
1.01
1.00
0.99
1.04
1.02
1.00
1.01
1.02
1.01
1.00
1.01
Panel D: SV­U
30 sec
0.99
0.99
0.99
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
60 sec
0.99
0.99
0.98
0.98
0.99
0.99
0.99
0.99
0.99
0.98
0.99
90 sec
0.98
0.98
0.98
0.98
0.99
0.98
0.98
0.99
0.98
0.98
0.98
120 sec
0.98
0.98
0.97
0.97
0.98
0.98
0.98
0.98
0.98
0.97
0.97
180 sec
0.97
0.97
0.96
0.97
0.98
0.97
0.97
0.98
0.97
0.97
0.97
300 sec
0.96
0.95
0.95
0.96
0.97
0.96
0.96
0.96
0.96
0.95
0.95
600 sec
0.94
0.93
0.93
0.94
0.95
0.94
0.94
0.94
0.94
0.94
0.94
Panel E: BM + 1 Volatility Jump
30 sec
1.00
0.99
0.99
0.99
0.99
0.99
1.00
1.00
1.00
0.99
1.00
60 sec
0.99
0.99
0.99
0.98
0.99
0.99
0.99
0.99
0.99
0.99
0.99
90 sec
0.99
0.98
0.98
0.98
0.99
0.98
0.99
0.99
0.99
0.99
0.99
120 sec
0.98
0.98
0.98
0.97
0.98
0.98
0.98
0.98
0.98
0.98
0.98
180 sec
0.97
0.97
0.97
0.96
0.97
0.97
0.97
0.97
0.97
0.97
0.97
300 sec
0.96
0.95
0.95
0.94
0.96
0.96
0.96
0.96
0.96
0.96
0.96
600 sec
0.93
0.92
0.91
0.90
0.93
0.93
0.93
0.93
0.93
0.92
0.93

Relative Bias

0.35
0.61
0.81
0.98
1.23
1.55
2.03
0.46
0.70
0.87
1.00
1.18
1.41
1.81
0.53
0.88
1.16
1.37
1.74
2.32
3.53
0.72
1.33
1.86
2.35
3.27
4.92
8.82

1.19
1.63
1.86
2.01
2.17
2.29
2.49
0.53
0.91
1.20
1.43
1.82
2.41
3.61
0.71
1.30
1.81
2.27
3.12
4.63
8.14

0.09
0.17
0.25
0.33
0.48
0.77
1.39

0.09
0.19
0.27
0.36
0.53
0.84
1.52
0.86
1.48
1.90
2.19
2.56
2.90
3.19

MPQ
4
Prod
1­4

MPQ
3
Prod
1­3

0.73
1.35
1.91
2.43
3.41
5.21
9.50

0.52
0.86
1.12
1.32
1.68
2.26
3.47

0.25
0.41
0.54
0.65
0.81
1.06
1.50

0.19
0.35
0.49
0.61
0.80
1.09
1.58

0.08
0.16
0.23
0.31
0.45
0.71
1.28

MPQ
5
Prod
1­5

0.63
1.21
1.78
2.35
3.47
5.60
10.27

0.44
0.73
0.94
1.12
1.43
1.96
3.09

0.24
0.59
0.91
1.18
1.60
2.09
2.48

0.09
0.22
0.36
0.50
0.79
1.31
2.24

0.10
0.18
0.27
0.35
0.51
0.82
1.50

TRQ
1
Prod
1

0.68
1.26
1.78
2.27
3.16
4.71
7.77

0.50
0.85
1.10
1.28
1.60
2.06
2.88

0.14
0.31
0.49
0.67
0.99
1.51
2.31

0.10
0.22
0.33
0.45
0.69
1.12
2.01

0.10
0.19
0.28
0.37
0.54
0.85
1.52

TBQ
2
Prod
1­2

1.02
1.82
2.49
3.11
4.18
6.00
10.15

0.77
1.32
1.76
2.09
2.69
3.59
5.30

0.24
0.55
0.89
1.24
1.89
2.88
4.31

0.19
0.40
0.61
0.82
1.22
1.96
3.44

0.18
0.36
0.53
0.70
1.01
1.60
2.85

NTQ
2
Min
1­2

0.75
1.36
1.91
2.41
3.29
4.84
8.43

0.55
0.95
1.26
1.50
1.92
2.57
3.88

0.17
0.43
0.72
1.01
1.55
2.27
3.13

0.12
0.25
0.39
0.53
0.79
1.29
2.24

0.11
0.22
0.32
0.43
0.62
0.99
1.79

NTQ
3
Med
1­3

Relative MSE

0.75
1.38
1.90
2.37
3.25
4.76
8.27

0.57
1.01
1.34
1.63
2.10
2.82
4.21

0.47
1.08
1.66
2.15
2.94
3.85
4.57

0.22
0.53
0.85
1.18
1.80
2.79
4.38

0.12
0.24
0.35
0.47
0.68
1.10
2.01

0.64
1.17
1.64
2.08
2.86
4.26
7.56

0.48
0.83
1.09
1.30
1.67
2.23
3.35

0.25
0.61
0.96
1.28
1.77
2.31
2.73

0.13
0.29
0.47
0.64
0.97
1.52
2.41

0.08
0.17
0.24
0.32
0.47
0.75
1.38

0.55
1.05
1.51
1.95
2.78
4.33
8.04

0.40
0.67
0.89
1.06
1.37
1.87
2.89

0.10
0.25
0.39
0.52
0.75
1.08
1.47

0.07
0.15
0.23
0.31
0.48
0.76
1.29

0.06
0.11
0.17
0.22
0.32
0.52
0.95

0.52
0.99
1.42
1.83
2.61
4.06
7.50

0.37
0.63
0.84
1.00
1.29
1.77
2.72

0.17
0.46
0.75
1.02
1.41
1.76
1.84

0.07
0.17
0.27
0.38
0.57
0.91
1.40

0.05
0.10
0.15
0.19
0.28
0.45
0.84

RNTQ RNTQ RNTQ RNTQ
2
3
5
5
Min
Med
Min
Med
1­2
1­3
3­5
3­5

IQ/IV . We
report the relative bias (left half of the table) and MSE (right half of the table) factors for different estimators of IQ/IV for the following
models: BM (panel A), BM + 1 Jump (panel B), BM + 4 Jumps (panel C), SV-U (panel D), BM + 1 Volatility Jump (panel E). The rows in
each panel correspond to each of the following considered pre-averaging window sizes: 30, 60, 90, 120, 180, 300, 600 seconds. The table columns
represent the considered different estimators: the top row of each column header indicates the estimator class, the second row provides the chosen
block size, the third row gives the functional used by the estimator, the fourth row of each column header lists
q the selector index, as defined in
c IV
c − √IQ/IV )2 /(√IQ/IV )2 ,
the text. The relative MSE is computed using baseline window size of 60-seconds as the sample mean of 390( IQ/
where IV and IQ are the true simulated integrated variance and integrated quarticity for each day.

Table 6: Relative bias and relative mean squared error (MSE) factors for pre-averaged estimators
of
√

33

√

Estimator Class:
MPQ MPQ MPQ TRQ TBQ NTQ NTQ RNTQ RNTQ RNTQ RNTQ
Block Size:
3
4
5
1
2
2
3
2
3
5
5
Functional: Prod Prod Prod Prod Prod Min
Med
Min
Med
Min
Med
Selector Index:
1­3
1­4
1­5
1
1­2
1­2
1­3
1­2
1­3
3­5
3­5
Panel A: BM
30 sec
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
60 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
90 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
1.00
1.00
1.00
300 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
0.99
0.99
0.99
600 sec
0.98
0.98
0.98
0.98
1.00
0.98
0.98
0.98
0.98
0.98
0.98
Panel B: BM + IID Noise
30 sec
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
60 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
90 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
1.00
1.00
1.00
300 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
0.99
0.99
0.99
600 sec
0.98
0.98
0.98
0.98
1.00
0.98
0.98
0.98
0.98
0.98
0.98
Panel C: BM + 1 Bounceback
30 sec
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
60 sec
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
90 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
1.00
1.00
1.00
300 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
0.99
0.99
0.99
600 sec
0.98
0.98
0.98
0.98
1.00
0.98
0.98
0.98
0.98
0.98
0.98
Panel D: BM + Sparcity
30 sec
1.02
1.01
1.01
1.03
1.02
1.03
1.03
1.03
1.02
1.02
1.02
60 sec
1.01
1.01
1.00
1.02
1.01
1.01
1.01
1.01
1.01
1.01
1.01
90 sec
1.00
1.00
1.00
1.01
1.01
1.01
1.01
1.01
1.01
1.00
1.00
120 sec
1.00
1.00
1.00
1.00
1.01
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
300 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
0.99
0.99
0.99
600 sec
0.98
0.98
0.98
0.98
1.00
0.98
0.98
0.98
0.98
0.98
0.99
Panel E: BM + Discrete Pricing
30 sec
1.02
1.04
1.07
1.00
1.00
1.00
1.00
1.00
1.00
1.00
1.00
60 sec
1.00
1.01
1.02
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
90 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
120 sec
1.00
1.00
1.00
0.99
1.00
1.00
1.00
1.00
1.00
1.00
1.00
180 sec
0.99
1.00
1.00
0.99
1.00
0.99
0.99
0.99
1.00
1.00
1.00
300 sec
0.99
0.99
0.99
0.99
1.00
0.99
0.99
0.99
0.99
0.99
0.99
600 sec
0.98
0.98
0.98
0.98
1.00
0.98
0.98
0.98
0.98
0.98
0.98

Relative Bias

0.08
0.17
0.25
0.33
0.48
0.77
1.39
0.10
0.17
0.25
0.33
0.48
0.77
1.38
0.18
0.20
0.27
0.35
0.50
0.78
1.39
0.81
0.20
0.25
0.33
0.48
0.77
1.39

0.12
0.19
0.27
0.36
0.53
0.84
1.52
0.26
0.24
0.31
0.39
0.55
0.85
1.53
0.23
0.19
0.27
0.36
0.53
0.84
1.52

0.09
0.17
0.25
0.33
0.48
0.77
1.39

0.09
0.19
0.27
0.36
0.53
0.84
1.52
0.09
0.18
0.27
0.36
0.53
0.84
1.52

MPQ
4
Prod
1­4

MPQ
3
Prod
1­3

2.12
0.25
0.24
0.31
0.44
0.70
1.28

0.14
0.18
0.25
0.32
0.45
0.71
1.27

0.09
0.16
0.23
0.31
0.45
0.71
1.28

0.08
0.16
0.23
0.31
0.44
0.71
1.28

0.08
0.16
0.23
0.31
0.45
0.71
1.28

MPQ
5
Prod
1­5

0.09
0.18
0.27
0.35
0.51
0.82
1.50

0.54
0.27
0.29
0.35
0.50
0.81
1.49

0.09
0.18
0.27
0.35
0.52
0.82
1.50

0.09
0.18
0.27
0.35
0.51
0.82
1.50

0.10
0.18
0.27
0.35
0.51
0.82
1.50

TRQ
1
Prod
1

0.10
0.19
0.28
0.37
0.54
0.85
1.52

0.33
0.26
0.33
0.40
0.57
0.88
1.54

0.10
0.19
0.28
0.37
0.54
0.86
1.52

0.09
0.19
0.28
0.37
0.54
0.85
1.52

0.10
0.19
0.28
0.37
0.54
0.85
1.52

TBQ
2
Prod
1­2

0.17
0.36
0.53
0.70
1.01
1.60
2.86

0.53
0.48
0.60
0.76
1.06
1.64
2.89

0.19
0.36
0.53
0.70
1.01
1.60
2.85

0.17
0.35
0.53
0.70
1.01
1.60
2.86

0.18
0.36
0.53
0.70
1.01
1.60
2.85

NTQ
2
Min
1­2

0.11
0.22
0.32
0.43
0.62
1.00
1.79

0.41
0.31
0.38
0.47
0.66
1.02
1.81

0.12
0.22
0.32
0.43
0.63
0.99
1.79

0.11
0.22
0.32
0.43
0.62
1.00
1.79

0.11
0.22
0.32
0.43
0.62
0.99
1.79

NTQ
3
Med
1­3

Relative MSE

0.12
0.24
0.35
0.47
0.68
1.10
2.02

0.50
0.36
0.42
0.52
0.73
1.13
2.04

0.16
0.24
0.35
0.47
0.69
1.10
2.01

0.11
0.24
0.35
0.47
0.68
1.10
2.02

0.12
0.24
0.35
0.47
0.68
1.10
2.01

0.08
0.17
0.24
0.32
0.47
0.75
1.38

0.30
0.23
0.28
0.35
0.49
0.77
1.39

0.10
0.17
0.24
0.32
0.47
0.76
1.38

0.08
0.16
0.24
0.32
0.47
0.75
1.38

0.08
0.17
0.24
0.32
0.47
0.75
1.38

0.06
0.11
0.17
0.22
0.32
0.52
0.95

0.20
0.16
0.19
0.24
0.33
0.52
0.96

0.06
0.11
0.16
0.22
0.32
0.52
0.95

0.05
0.11
0.16
0.22
0.32
0.52
0.96

0.06
0.11
0.17
0.22
0.32
0.52
0.95

0.05
0.10
0.15
0.19
0.28
0.46
0.83

0.22
0.15
0.17
0.21
0.30
0.46
0.84

0.06
0.10
0.15
0.19
0.28
0.45
0.84

0.05
0.10
0.15
0.19
0.28
0.46
0.84

0.05
0.10
0.15
0.19
0.28
0.45
0.84

RNTQ RNTQ RNTQ RNTQ
2
3
5
5
Min
Med
Min
Med
1­2
1­3
3­5
3­5

IQ/IV . We
report the relative bias (left half of the table) and MSE (right half of the table) factors for different estimators of IQ/IV for the following models:
BM (panel A), BM + IID Noise (panel B), BM + 1 Bounceback (panel C), BM + Sparcity (panel D), BM + Discrete Pricing (panel E). The rows
in each panel correspond to each of the following considered pre-averaging window sizes: 30, 60, 90, 120, 180, 300, 600 seconds. The table columns
represent the considered different estimators: the top row of each column header indicates the estimator class, the second row provides the chosen
block size, the third row gives the functional used by the estimator, the fourth row of each column header lists
q the selector index, as defined in
c IV
c − √IQ/IV )2 /(√IQ/IV )2 ,
the text. The relative MSE is computed using baseline window size of 60-seconds as the sample mean of 390( IQ/
where IV and IQ are the true simulated integrated variance and integrated quarticity on each day.

Table 7: Relative bias and relative mean squared error (MSE) factors for pre-averaged estimators
of
√

4.2.2

Jumps in returns: The “BM + 1 Jump” and “BM + 4 Jump” scenarios

To compare the finite sample jump-robustness of the estimators, we augment the BM model
with return jumps of the Poisson-Gaussian type that are independent of volatility and
account for 20% of the daily QV (25% of IV). We focus on two scenarios, one with a single
jump per day, the “BM + 1 Jump” scenario reported in Panel B of Tables 2, 4, and 6, and
one with four jumps per day, the “BM + 4 Jumps” scenario reported in Panel C of the
same tables. Both scenarios feature the same overall jump contribution to daily variance
and returns are sampled on an equispaced time grid.
We infer from panels B and C in Table 2 that TRV, TBV, QRV, RNTVMin5 and
RNTVMed5 provide the best robust IV inference in terms of RMSE. It is also clear that
the relative performance of the estimators within this group shifts as we move from a single
to four jumps with, in particular, RNTVMin5 and TBV improving their standing as the
jump intensity increases. This tendency is even more pronounced for IQ estimation, where
panels B and C in Table 4 reveal that RNTQMin5 is the best performer in both jump
scenarios for frequencies spanning 90 seconds and 3 minutes. Finally, and very strikingly,
panels B and C of Table 6 show that the pairing of RNTQMin5 and RNTVMin5 dominate
√
all the other estimators by a significant margin in terms of estimating the ratio IQ/IV ,
which governs the precision of log(IV). Thus, from the perspective of finite sample jumprobustness, the RNTQ estimators introduced in this paper seem to offer attractive efficiency
√
improvements, especially for estimation of IQ and the ratio IQ/IV .
Juxtaposing Panel B or C in Table 4 and Panel B or C in Table 6, we also note that the
distortions induced by jumps appear much less pronounced for the ratio statistic than for
IQ. This is due to a partial cancelation of the resulting upward bias in both the numerator
and the denominator. Thus, ratio-based inference is likely to be preferable regardless of the
choice of estimator. Given the superior performance of the RNTQMin5 and RNTVMin5
pairing, it emerges as a natural candidate for practical jump-robust power variation estimation and jump testing in particular. Below, we explore whether this estimator is robust
to other common “irregularities” in high-frequency return data as well.
4.2.3

Time-varying volatility: The “SV-U” and “BM + 1 Volatility Jump”
scenarios

Pronounced intraday variation as well as seemingly abrupt changes (jumps) in spot volatility
are prevalent in high-frequency returns. This poses a challenge for power variation estimation, as jump-robust estimators may not be able to distinguish sharply between abrupt
shifts in volatility and return jumps. For example, in the context of IV estimation, ADS
(2009) provide compelling evidence for a sizeable finite sample distortion in IV estimators
when the intraday volatility is stochastic and subject to a diurnal pattern reminiscent of
34

the form characterizing most stock data. This section extends their analysis and draws
√
broader conclusions for estimation of IQ and IQ/IV by exploring two distinct scenarios
that violate the (locally) constant volatility assumption.
Our first scenario, denoted “SV-U” (Panel D, Tables 2, 4, and 6), is a modified version
of the corresponding model in ADS (2009) where the diurnal pattern now is calibrated
to tick-time sampled trade data for individual stocks. In this way, the “SV-U” scenario
is roughly tailored to match the deterministic U-Shape pattern in the data used in our
empirical illustrations, as shown in Figure 5.21 In particular, we simulate a two-factor affine
stochastic volatility model and superimpose an asymmetric diurnal pattern (Hasbrouck,
1999) for which the variance at the open is more than four times the midday variance while
the variance at the close is about the same as the midday variance. The latter distinguishes
the intraday volatility pattern in tick time sampled trade data from tick-time quote data.
The second scenario, denoted “BM + 1 Volatility Jump” (Panel E, Tables 2, 4, and
6), involves a six-fold spike in the intraday variance at a point uniformly distributed across
the trading day. Volatility is constant before the jump and it remains constant at the new
higher level following the jump. In this way, the scenario approximates the effect of sudden
bursts in market activity that have inspired the development of alternative volatility jump
specifications.
The striking similarity between Panels D and E of Tables 2, 4, and 6 indicates that these
two distinct forms of time variation in volatility have a qualitatively similar impact on the
estimators in terms of finite sample bias and RMSE. This may be attributed to the fact
that both scenarios render neighboring returns inhomogeneous, resulting in a downward
bias due to scaling factors that are incorrectly sized as well as inappropriate truncation of
diffusive returns that are misclassified as jumps due to the fluctuating level of the return
variance. The less “local” estimators are more exposed to such heterogeneity in returns.
This explains the ordering of the biases of the IV and IQ estimators in Panels D and E of
tables 2 and 4, with estimators relying on block size one to three being the least biased,
those based on blocks of four or five returns being slightly more biased, and finally the
estimators relying on substantially larger block sizes (such as 20 for QRV in Table 2) being
most biased. In summary, the results concerning the bias in Table 4, Panels D and E,
provide compelling evidence against the use of sparser sampling frequencies, such as ten
minutes or lower, for IQ estimation. This runs counter to some recommendations in the
early literature, suggesting that systematic biases in IQ estimation may be avoided through
sparse sampling. In contrast, we find that, regardless of the block size of the IQ estimator,
the bias is much more tolerable at sample frequencies higher than two minutes versus ten
minutes or lower.
21

Our results are qualitatively similar for the “SV-U” scenario of ADS (2009) which is more consistent
with quote data.

35

√

Most important of all, Panels D and E in Table 6, confirm that the biases for the ratio
IQ/IV are less pronounced and more uniform across the full range of estimators, as

may be expected given that there is scope for partial cancelation of the downward biases
affecting both the numerator and denominator. Moreover, the ratio estimator based on
RNTQMin5 and RNTVMin5 again performs the best from an efficiency standpoint in spite
of its seemingly less desirable block size of five. For comparison, increasing the block size of
the MPQ and MPV estimators from three to five enhances rather than reduces the RMSE
√
for IQ/IV in the “BM + 1 Volatility Jump” scenario, as documented in Panel E of Table
6. Consequently, the superior efficiency of RNTQMin5 and RNTVMin5 in estimating the
√
ratio IQ/IV stems from the design of our RNT estimators rather than from the increased
block size.
We conclude that inference based on the ratio

√

IQ/IV appears to be attractive also

under time-varying volatility. Moreover, the RNTQMin5 and RNTVMin5 estimators seem
to provide superior performance in this setting as well, particularly for frequencies higher
than two minutes.
4.2.4

Microstructure noise: The “BM + IID Noise”, “BM + 1 Bounceback”,
“BM + Sparcity”, and “BM + Discrete Pricing” scenarios

There is often a delicate tradeoff in the choice of sampling frequency with jump robustness improving and resiliency to market microstructure noise deteriorating as the return
interval shrinks. Hence, it is important to analyze the effectiveness in dealing with the adverse impact of various noise features by applying pre-averaging and sampling at moderate
frequencies around 1-2 minutes.
Specifically, we consider four separate market imperfections. First, in our “BM + IID
Noise” scenario (Panel B, Tables 3, 5, and 7), we simulate Gaussian i.i.d. noise with a noiseto-signal ratio of λ = 0.25, in line with what is typical for trade data on individual stocks.
Second, we consider a “BM + 1 Bounceback” scenario (Panel C, Tables 3, 5, and 7), in
which (isolated) errors in the recorded price induce so-called “bounce-backs” in returns, i.e.,
two large adjacent jumps of opposite sign due to immediate price reversals. We calibrate
the magnitude of the bounceback to match 20% of the daily QV (25% of IV). The third
source of noise is irregular sampling, and the associated results are captured by our “BM
+ Sparcity” scenario (Panel D, Tables 3, 5, and 7). It is generated via random arrivals
of the 7,800 distinct quotes by sampling without replacement from the numbers in the
range of 1 through 23,400. While not necessarily realistic, this model is helpful in exploring
the potential distortion of the estimators when applied on non-homogeneously sampled
returns, effectively inducing spurious variations in their volatility. Finally, in our “BM +
Discrete Pricing” scenario (Panel E, Tables 3, 5, and 7), we mimic price decimalization by
rounding all intraday prices to the nearest cent with a moderate starting price of $50. Price
36

discreteness is a major reason for the presence of multiple zero returns in high-frequency
samples, leading to pronounced downward biases of many jump-robust estimators.22
The first general conclusion to be drawn from Tables 3, 5 and 7 is that, irrespective of the
particular type of noise, it is necessary to avoid sampling at the highest frequencies (e.g., not
exceeding one minute) to obtain reasonably unbiased and efficient estimates of IV, IQ and
√
IQ/IV . Second, the noise reduction benefit from pre-averaging appears to be greatest
in the “BM + 1 Bounceback” scenario (Panel C, Tables 3, 5, and 7). This is explained
by the near perfect cancelation of adjacent jumps of opposite sign when constructing the
individual pre-averaged returns (see appendix C). Third and most important, across all
noise scenarios, the biases of the IQ estimators (Table 5) are about twice larger than those
√
for the corresponding IV estimators (Table 3), while the biases for the ratio IQ/IV
(Table 7) are smaller. Thus, partial cancelation of biases in numerator and denominator
again renders the ratio statistic better behaved in the presence of distortions.
As a final note, there are no dramatic changes in the ordering of the estimators in
terms of RMSE in each noise scenario compared to the BM null (Panel A in each table).
Our RNTQMin5 and RNTVMin5 estimators retain their appeal, especially for ratio-based
inference in the preferred range of frequencies from one to two minutes.

5

An analysis of the Dow Jones 30 stocks

This section gauges the empirical performance of competing estimators of IV , IQ, and
√
IQ/IV on the Dow Jones 30 stocks using tick time sampling of NYSE TAQ trade data
from January 1, 2005 through July 31, 2009. We split our sample period into a low volatility
period, January 2005 - May 2007, and a high volatility period, June 2007 - July 2009. This
serves as a robustness check against different noise-to-signal ratios and liquidity levels in
√
the two periods. The main focus is on the estimates for IQ and IQ/IV while the IV
results are provided as a more familiar benchmark for comparison of the RNT estimators
and the impact of our proposed filtering scheme with previous studies.

5.1

Truncation of Return Functionals

Power variation estimators are generally quite sensitive to deviations from the local diffusive
null that may arise due to market microstructure features and sampling errors. While
common data-error filtering procedures, e.g., as proposed by BNHLS (2009), do eliminate
extreme outliers, they are not sufficient to ensure sensible estimates of IQ on observed stock
returns for many of the candidate estimators of interest. The reason IQ (and higher order
power variation) estimators are substantially more affected by such irregularities is that IQ
22

MPV and MPQ, in particular, as they are based on products of adjacent (absolute) returns.

37

estimators typically are scaled by a factor proportional to the sampling frequency and/or
involve raising individual returns to a high power. At high frequencies, even relatively
small noise terms can therefore be significantly inflated, leading to dramatic divergence
across estimators.
Panel A: Mean of IQ for filtered estimators (truncated local functionals).
M P Q5
M EDRQ
T RQ
T BQ
RN T QM in5
M P Q3

Mean x 108

10
8
6
4
2
30

60

90

120

150

180

225

300
Frequency (sec)

450

600

Panel B: Mean of IQ for non-filtered estimators (non-truncated local functionals).
M P Q5
M EDRQ
T RQ
T BQ
RN T QM in5
M P Q3

Mean x 108

10
8
6
4
2
30

60

90

120

150

180

225

300
Frequency (sec)

450

600

Figure 4: IQ signature plots, showing the effect of filtering via truncation of local functionals (Panel

A) versus no-filtering (Panel B) on the average IQ estimate as a function of sampling frequency for
subset of estimators. In Panel A all estimators (except TRQ and TBQ) are subject to the novel
filtering procedure based on truncation of return functionals as described in Section 2.2, while Panel
B depicts their non-filtered counterparts (except TRQ and TBQ). The TRQ and TBQ benchmarks
in both panels are based on standard truncation of individual returns. The average is across all
stocks in the DJ30 index during the January 2005-May 2007 sampling period and all estimates are
pre-averaged and sub-sampled based on tick-time sampling.

Figure 4 illustrates this point by showing that, without additional filtering, most IQ
estimators become erratic at higher frequencies. This problem has been noted sporadically
in the empirical literature and has motivated some authors to rely on low, and thus relatively
inefficient but also less error prone, frequencies for IQ estimation, e.g., BNS (2004a) and
Bandi and Russell (2008). Similarly, Jiang and Oomen (2008) uses the squared IV as a
simple approximation to IQ, thereby accepting a significant bias in exchange for variance
reduction of the IQ estimator. Another striking feature of Figure 4 is that the truncation
of return functionals is effective in flattening out the IQ estimators at an average level
compatible with the benchmark truncation estimators, TRQ and TBQ. This is encouraging
as it suggests that our functional filtering combined with the good efficiency properties of the
38

RNT estimators, documented in the simulation section, will render these estimators good
candidates for practical applications. Moreover, the nominal size of our filter is set to 10−6
and the fraction of observations filtered on actual data typically ranges from 0.01% to 0.05%
for the 60-180 second range, depending on the sampling frequency and the sample period.
Overall, more than 70% of the stock days are untouched by our functional truncation.
It is important to keep in mind the different philosophy behind the mild functional
truncation filtering relative to TRQ and TBQ. The latter employ truncation of single returns as the primary tool for achieving jump robustness, and thus need to ensure that asymptotically - all jumps are prevented from impacting the IQ estimator. This requires
relatively aggressive truncation and, inevitably, some diffusive returns will also be truncated, motivating the CPR adjustment to mitigate the resulting finite-sample bias.23 In
contrast, the functional filtering is intended only to capture gross deviations from the local Gaussian null hypothesis. As such, the functional truncation will remove some large
jumps - along with other data irregularities - inducing truly extreme realizations of the
functional, but it will leave many moderately sized jumps untouched. Instead, the impact
of the latter is controlled by the functional form of the operator itself, designed explicitly
to ensure jump robustness. As may be expected, these fundamentally different rationales
behind the truncation procedures induce dramatic differences in the frequencies with which
they are applied on real data. For example, the TBQ estimator truncates 1.5% - 3.0% of
the returns in the 60-180 second range, which is about 100 times more aggressively than
for the functional filtering. Likewise, while the functional filtering leaves the returns on the
majority of the days in our sample untouched, TBQ truncates at least one observation on
99.9% of the days. Overall, the evidence is compatible with the objective that the functional
filtering serves to control major data irregularities while avoiding excessively intrusive, and
potentially distorting, truncation of the underlying returns.

5.2

The Intraday Volatility Pattern

It is commonly asserted that an important benefit of tick-time sampling of transactions
data is the mitigation of the well-known intra-day volatility U-shape observed in calendar
time. Figure 5 demonstrates that the tick-time sampling does succeed in regularizing the
average volatility pattern across the main part of the trading day, but there is little impact
on the elevated level of volatility in the first 60-90 minutes of trading. Our Monte Carlo
experiments found such intraday variation in volatility to be a potent source of systematic
√
and severe biases in power variation estimates, with the ratio statistic IQ/IV being less
sensitive to such distortions than the raw IQ and IV measures.
23

The effects of these procedures were studied explicitly in Section 4.

39

T BV

T RV

MPV 3

MPV 5

M EDRV

RN T V M in5

MPV 3

6
4
2
0

M EDRV

RN T V M in5

6
4
2
0

0

50

100

150
200
250
Intraday Bin (min)

300

350

0

50

100

150
200
250
Intraday Bin (min)

(a)
T BV

T RV

MPV 3

MPV 5

300

350

(b)
M EDRV

RN T V M in5

T BV

T RV

MPV 3

MPV 5

M EDRV

RN T V M in5

8
Diurnal Variance Factor

8
Diurnal Variance Factor

MPV 5

8
Diurnal Variance Factor

Diurnal Variance Factor

T BV

T RV

8

6
4
2
0

6
4
2
0

0

50

100

150
200
250
Intraday Bin (min)

300

350

0

(c)

50

100

150
200
250
Intraday Bin (min)

300

350

(d)

Figure 5: Diurnal U-shape variance factors across stock-days based on local estimates of σ 2 in one

minute buckets using tick time (Panels a and c) or calendar time (Panels b and d) sampling. On
each stock-day, the factor in each one-minute bucket is computed by normalizing by the average of
the 390 variance estimates on that day. The average variance factor is then computed by averaging
across all stock-days in the first sample (Panels a and b) or second sample (Panels c and d).

To systematically assess the empirical relevance of intra-day volatility fluctuations, and
in particular the diurnal volatility pattern, for our Dow Jones 30 stock sample, we split
the stock-days of each sample period into sub-groups consisting of stock-day combinations
representing the top and bottom deciles with respect to a simple scale-free proxy for the
daily intraday variation in volatility. This proxy, denoted V oV (volatility-of-volatility), is
constructed by splitting the trading day into 26 blocks, and then obtaining the median
30 second absolute returns within each block after first having eliminated all zero returns.
Our V oV proxy is then defined as the coefficient of variation (standard deviation divided
by mean) of these 26 medians.24 Importantly, the V oV measure is designed to pick up
any significant variation in intra-day volatility even if it is not in the form of the commonly
occurring U-shape. In the following section, we provide signature plots that broadly support
our interpretation of the simulation evidence.

24

We find that different constructions of similar robust volatility-of-volatility measures lead to qualitatively
similar results in the analysis below.

40

5.3

Signature Plots for Integrated Power Variation

Figures 6 and 7 show IV signature plots for each of the two sample periods. The plots in
Panel A represent average estimates across all available stocks and days. They are plotted
as a function of the sampling frequency implied by the pre-averaging window size. As
expected, the non-jump robust RV estimator lies above the jump-robust IV estimators,
which are bundled closely together.25 The lone exceptions are MPV5 at frequencies higher
than 120 seconds and QRV at frequencies lower than 90 seconds. At the highest frequencies,
the drop in MPV5 (and to a lesser extent MPV3) may be explained by the presence of zero
returns which has a particularly pronounced impact on these estimators. Consistent with
this explanation, RV is the only estimator that does not show any tendency to fall off at
the highest frequencies. At the lower frequencies, the striking downward bias of QRV is
in line with the evidence gleaned from the simulation results for this particular estimator.
While all the jump-robust measures feature negatively sloping signature plots at the lowest
frequencies, QRV is easily the one subject to the most significant distortion.
The IQ estimators, shown in Figures 8 and 9, Panel A, display a similar but more pronounced pattern of decline at the lowest sampling frequencies, consistent with the evidence
from the simulation scenarios with time-varying volatility. In particular, the estimators are
roughly ordered by block size, with the 5-block estimators at the bottom and the 3-block
estimators at the top. The truncation based IQ estimators, although nominally based on a
short block, are likely disproportionately impacted by time variation in volatility due to the
wide window necessary for determining the truncation thresholds, explaining the relatively
sharp decline in their signature plots. As mentioned previously, we chose not to include an
IQ analogue to the QRV estimator as it, invariably, is more severely downward biased than
the others.
The ratio signature plots for

√

IQ/IV shown in Figures 10-11, Panel A, display a rela-

tively flat but distinct monotonically declining pattern. This reflects the fact that the various microstructure effects, afflicting estimators at the highest frequencies, cancel out more
effectively at moderate frequencies consistent with the simulation evidence. The multipower variation estimators display clear abnormalities at the highest frequencies, primarily
due to an imperfect offset of the zero returns in the denominator. At sampling frequencies of
60 seconds or lower, however, all the estimators are tightly clustered and downward sloping
in accordance with the findings from the simulation scenarios with time-varying volatility.
To further explore the impact of time varying volatility on the estimators in the Dow
Jones 30 data, Panels B and C of each figure depict signature plots, respectively, for the
top and bottom deciles with respect to our volatility-of-volatility proxy, V oV , across the
25

The distance from the (non-functional filtered) RV curve to the set of robust IV measures in this figure
provides an estimate of the average jump contribution to the quadratic return variation across all stocks
over the sample period.

41

combined stock-day sample. It is evident that both the IQ and IV signature plots on high
VoV days are dramatically more steeply sloped than on low VoV days, consistent with
the hypothesis that the slope is caused primarily by time-varying volatility due to factors
like the intraday U-shape pattern, volatility jumps, and volatility bursts associated with
news effects. For the ratio statistic (Figures 10-11), the signature plots for low VoV days
are essentially (with the exception of the multi-power estimators) flat when viewed on the
scale of the high VoV days, highlighting the fact that time variation in volatility also has a
pronounced impact on the ratio statistic.
5.3.1

Panel regressions

While the totality of the evidence in the preceding sections makes a fairly compelling case
that VoV has a pronounced impact on the slope of the signature plots, it is based on grand
averages across stocks and days and does not allow for formal statements about statistical
significance. To provide a more rigorous analysis, controlling for the potential impact of a
few outlier stocks, we run a series of panel regressions, capturing the average effect of VoV
on the slope of the signature plot for each individual stock.
Let Eω,i,t be any of our IV, IQ or ratio measures estimated at frequency ω ∈ {30sec, . . . , 600sec} for stock i ∈ {1, . . . , 33} on day t ∈ {1, . . . , N }. Choosing ω = 90sec as
the baseline, we relate the discrepancy between each specific estimator across the different
sampling frequencies to the same estimator at the baseline frequency, Eω,i,t − E90sec,i,t . A
formal measure of the dependence of the slope of the signature plot on VoV, for stock i on
day t, is then obtained as follows:26
Eω,i,t − E90sec,i,t = aω,i + bω VoVi,t + uω,i,t
This panel regression allows for a stock fixed effect but imposes a common slope bω across
stocks. In Panels A-B of Tables 8 − 9 we report the estimated slopes b̂ω in the first and
second sample periods. Based on the evidence from the aggregate IV and IQ signature plots,
we expect a negative effect (relative to 90 sec) of VoV for frequencies lower than 90sec and
a positive effect for frequencies higher than 90sec. In addition, we might expect this pattern
to be somewhat stronger for the “less local” estimators. This prediction is indeed borne out
by Panels A-B of Tables 8-9: the impact is clearly monotonic in the sampling frequency
ω and, within a given estimator class, the less local estimators generally display a more
significant dependence on VoV. The main exception to this pattern is observed at the 30sec
frequency where the results appear less significant, likely due to the confounding effect of
microstructure noise. We also note that the level of significance generally is considerably
26

The sample is winsorized as follows: For each sample frequency and estimator, we drop observations
less than 2 times the 1 percentile or greater than 2 times the 99 percentile. This procedure eliminates less
than 0.5% of the sample.

42

lower in the second sample period. This is likely due to the substantially larger number of
observations in recent years which, all else equal, tends to reduce the scale of the diurnal
volatility pattern for tick-time sampled data.
The panel regression results for the ratio statistic in Panel C of Tables 8-9 are particularly interesting because the limiting population value of the ratio statistic itself, by
construction, is a scale-free measure of volatility of volatility, equal to one if and only if
volatility is constant and market microstructure noise is absent. In finite samples, of course,
the Jensen effect also induces downwards bias, as documented in our simulation study, and
this is further magnified in the presence of time varying volatility. The VoV panel regressions corroborate this fact, revealing the expected monotone pattern at very high levels of
significance. Notably, it is not generally true that this effect is stronger for less local estimators, as the bias cancelation between the numerator and denominator again is operative.
This is consistent with the estimators being in near full agreement about the average level
of the ratio at 60 second and lower frequencies as seen in the signature plots.
In summary, we find all major qualitative features of the simulation designs to also be
reflected in the actual data. As such, we deem our recommendations regarding the preferred
filtering procedure, choice of estimator and suitable sampling frequency for estimation of IQ
and the ratio statistic to be fairly robust. This should allow for improved practical inference
regarding IV and the presence of price jumps.

43

Figure 6: Average estimates of IV across 33 DJ30 stocks between January 1, 2005 and May 31,
2007. We provide signature plots for the mean of each pre-averaged estimator of IV as a function of pre-averaging
window size matching the sampling frequency (measured in seconds on the x-axis). Panel (A) plots the mean across
all days. Panel (B) plots the mean across the top 10% days with respect to intraday variation in volatility. Panel
(C) plots the mean across the bottom 10% days with respect to intraday variation in volatility. Intraday variation
in volatility is measured by the V oV measure of volatility of volatility described in Section 5.
Panel A: Mean of IV for all days.
RV

MPV 3

MPV 5

M EDRV

T RV

T BV

QRV

RN T V M in5

2.5

Mean x 104

2
1.5
1
0.5
30

60

90

120

150

180

225

300
Frequency (sec)

450

600

Panel B: Mean of IV for the top 10% days in terms of intraday variation of volatility.
RV

MPV 3

MPV 5

M EDRV

T RV

T BV

QRV

RN T V M in5

2.5

Mean x 104

2
1.5
1
0.5
30

60

90

120

150

180

225

300
Frequency (sec)

450

600

Panel C: Mean of IV for the bottom 10% days in terms of intraday variation of volatility.
RV

MPV 3

MPV 5

M EDRV

T RV

T BV

QRV

RN T V M in5

2.5

Mean x 104

2
1.5
1
0.5
30

60

90

120

150

180

225

300
Frequency (sec)

44

450

600

Figure 7: Average estimates of IV across 33 DJ30 stocks between June 1, 2007 and July 31,
2009. We provide signature plots for the mean of each pre-averaged estimator of IV as a function of pre-averaging
window size matching the sampling frequency (measured in seconds on the x-axis). Panel (A) plots the mean across
all days. Panel (B) plots the mean across the top 10% days with respect to intraday variation in volatility. Panel
(C) plots the mean across the bottom 10% days with respect to intraday variation in volatility. Intraday variation
in volatility is measured by the V oV measure of volatility of volatility described in Section 5.
Panel A: Mean of IV for all days.
RV

MPV 3

MPV 5

M EDRV

T RV

T BV

QRV

RN T V M in5

14

Mean x 10

4

12
10
8
6
4
30

60

90

120

150

180

225

300
Frequency (sec)

450

600

Panel B: Mean of IV for the top 10% days in terms of intraday variation of volatility.
RV

MPV 3

MPV 5

M EDRV

T RV

T BV

QRV

RN T V M in5

14

Mean x 10

4

12
10
8
6
4
30

60

90

120

150

180

225

300
Frequency (sec)

450

600

Panel C: Mean of IV for the bottom 10% days in terms of intraday variation of volatility.
RV

MPV 3

MPV 5

M EDRV

T RV

T BV

QRV

RN T V M in5

14

Mean x 10

4

12
10
8
6
4
30

60

90

120

150

180

225

300
Frequency (sec)

45

450

600

√
Figure 8: Average estimates of IQ across 33 DJ30 stocks between January
1, 2005 and May
√
31, 2007. We provide signature plots for the mean of each pre-averaged estimator of IQ as a function of pre-

averaging window size matching the sampling frequency (measured in seconds on the x-axis). Panel (A) plots the
mean across all days. Panel (B) plots the mean across the top 10% days with respect to intraday variation in
volatility. Panel (C) plots the mean across the bottom 10% days with respect to intraday variation in volatility.
Intraday variation in volatility is measured by the V oV measure
of volatility of volatility described in Section 5.
√
p

3

Panel A: Mean of

M P Q3

p

M P Q5

p

M EDRQ

IQ for all days.
p

T RQ

p

T BQ

p

RN T QM in5

Mean x 104

2.5
2
1.5
1

30

60

90

120

150

Panel B: Mean of
p

3

180

225

300
Frequency (sec)

450

600

√
IQ for the top 10% days in terms of intraday variation of volatility.

M P Q3

p

M P Q5

p

M EDRQ

p

T RQ

p

T BQ

p

RN T QM in5

Mean x 104

2.5
2
1.5
1

30

60

90

120

Panel C: Mean of
p

3

150

√

180

225

300
Frequency (sec)

450

600

IQ for the bottom 10% days in terms of intraday variation of volatility.

M P Q3

p

M P Q5

p

M EDRQ

p

T RQ

p

T BQ

p

RN T QM in5

Mean x 104

2.5
2
1.5
1

30

60

90

120

150

180

225

300
Frequency (sec)

46

450

600

√
Figure 9: Average estimates of IQ across 33 DJ30 stocks between
√ June 1, 2007 and July 31,
2009. We provide signature plots for the mean of each pre-averaged estimator of IQ as a function of pre-averaging
window size matching the sampling frequency (measured in seconds on the x-axis). Panel (A) plots the mean across
all days. Panel (B) plots the mean across the top 10% days with respect to intraday variation in volatility. Panel
(C) plots the mean across the bottom 10% days with respect to intraday variation in volatility. Intraday variation
in volatility is measured by the V oV measure of volatility of √
volatility described in Section 5.
p

Panel A: Mean of

M P Q3

p

M P Q5

p

M EDRQ

IQ for all days.
p

T RQ

p

T BQ

p

RN T QM in5

16
Mean x 10

4

14
12
10
8
6
4
30

60

90

120

150

225

300
Frequency (sec)

450

600

√
IQ for the top 10% days in terms of intraday variation of volatility.

Panel B: Mean of
p

180

M P Q3

p

M P Q5

p

M EDRQ

p

T RQ

p

T BQ

p

RN T QM in5

16
Mean x 10

4

14
12
10
8
6
4
30

60

90

120

Panel C: Mean of
p

150

√

180

225

300
Frequency (sec)

450

600

IQ for the bottom 10% days in terms of intraday variation of volatility.

M P Q3

p

M P Q5

p

M EDRQ

p

T RQ

p

T BQ

p

RN T QM in5

16
Mean x 10

4

14
12
10
8
6
4
30

60

90

120

150

180

225

300
Frequency (sec)

47

450

600

√
Figure 10: Average estimates of IQ/IV across 33 DJ30 stocks between January
1, 2005 and
√
May 31, 2007. We provide signature plots for the mean of each pre-averaged estimator of IQ/IV as a function

of pre-averaging window size matching the sampling frequency (measured in seconds on the x-axis). Panel (A) plots
the mean across all days. Panel (B) plots the mean across the top 10% days with respect to intraday variation in
volatility. Panel (C) plots the mean across the bottom 10% days with respect to intraday variation in volatility.
Intraday variation in volatility is measured by the V oV measure
of volatility of volatility described in Section 5.
√
Panel A: Mean of

√

M P Q3
MPV 3

√

M P Q5
MPV 5

√

IQ/IV for all days.

M EDRQ
M EDRV

√

T RQ
T RV

√

T BQ
T BV

√

RN T QM in5
RN T V M in5

3

Mean

2.5
2
1.5
1

30

60

90

120

Panel B: Mean of
√

150

180

225

300
Frequency (sec)

450

600

√
IQ/IV for the top 10% days in terms of intraday variation of volatility.

M P Q3
MPV 3

√

M P Q5
MPV 5

√

M EDRQ
M EDRV

√

T RQ
T RV

√

T BQ
T BV

√

RN T QM in5
RN T V M in5

3

Mean

2.5
2
1.5
1

30

60

90

120

Panel C: Mean of

√

√

150

180

225

300
Frequency (sec)

450

600

IQ/IV for the bottom 10% days in terms of intraday variation of volatility.

M P Q3
MPV 3

√

M P Q5
MPV 5

√

M EDRQ
M EDRV

√

T RQ
T RV

√

T BQ
T BV

√

RN T QM in5
RN T V M in5

3

Mean

2.5
2
1.5
1

30

60

90

120

150

180

225

300
Frequency (sec)

48

450

600

√
Figure 11: Average estimates of IQ/IV across 33 DJ30 stocks between June
1, 2007 and July
√
31, 2009. We provide signature plots for the mean of each pre-averaged estimator of IQ/IV as a function of

pre-averaging window size matching the sampling frequency (measured in seconds on the x-axis). Panel (A) plots
the mean across all days. Panel (B) plots the mean across the top 10% days with respect to intraday variation in
volatility. Panel (C) plots the mean across the bottom 10% days with respect to intraday variation in volatility.
Intraday variation in volatility is measured by the V oV measure
of volatility of volatility described in Section 5.
√
Panel A: Mean of

√

M P Q3
MPV 3

√

M P Q5
MPV 5

√

IQ/IV for all days.

M EDRQ
M EDRV

√

T RQ
T RV

√

T BQ
T BV

√

RN T QM in5
RN T V M in5

Mean

2.5
2
1.5
1

30

60

90

120

Panel B: Mean of
√

150

180

225

300
Frequency (sec)

450

600

√
IQ/IV for the top 10% days in terms of intraday variation of volatility.

M P Q3
MPV 3

√

M P Q5
MPV 5

√

M EDRQ
M EDRV

√

T RQ
T RV

√

T BQ
T BV

√

RN T QM in5
RN T V M in5

Mean

2.5
2
1.5
1

30

60

90

120

Panel C: Mean of

√

√

150

180

225

300
Frequency (sec)

450

600

IQ/IV for the bottom 10% days in terms of intraday variation of volatility.

M P Q3
MPV 3

√

M P Q5
MPV 5

√

M EDRQ
M EDRV

√

T RQ
T RV

√

T BQ
T BV

√

RN T QM in5
RN T V M in5

Mean

2.5
2
1.5
1

30

60

90

120

150

180

225

300
Frequency (sec)

49

450

600

Table 8: Panel data regressions for the period January 1, 2005 - May 31, 2007. We investigate
the dependence of the curvature and slope of IV (Panel A), IQ (Panel B) and ratio (Panel C) signature plots on
the measure of intraday volatility of volatility V oV described in Section 5. For each estimator E and frequency
ω ∈ {30sec, 60sec, . . .}, we run a regression of Eω − E90sec (i.e. the estimator compared to itself at a 90sec base
frequency) on VoV30sec and stock fixed effects across a pooled sample of 33 stocks and 606 days between January
2005 and May 2007:
Eω,i,t − E90sec,i,t = aω,i + bω VoV30sec,i,t + uω,i,t
In the case of the ratio statistic, the ratio is calculated on each day for each stock. The table reports b̂ω with robust
t-stats in square brackets calculated by two-way clustering by stock and date according to Thompson (2006).
Estimator Class
Block Size
Functional
Selector Index

MPV
MPQ
3
Prod
1-3

MPV
MPQ
4
Prod
1-4

MPV
MPQ
5
Prod
1-5

TRV
TRQ
1
Prod
1

TBV
TBQ
2
Prod
1-2

NTV
NTQ
3
Med
1-3

RNTV
RNTQ
5
Min
3-5

Panel A: IV
30sec
60sec
120sec
180sec
300sec
600sec
Panel B:

√

60sec
120sec
180sec
300sec
600sec
Panel C:

0.12

0.19

0.01

0.02

−0.06

[1.31]

[1.92]

[0.10]

[0.24]

[-0.66]

[0.60]

0.05

0.07*

0.09*

0.07*

0.05

0.06

0.08*

[1.64]

[2.20]

[2.64]

[2.76]

[1.76]

[1.92]

−0.07*

−0.07*

−0.08*

−0.08*

−0.06*

−0.07*

[-4.04]

[-4.50]

[-4.47]

[-5.20]

[-3.69]

[-3.84]

−0.21*

−0.22*

−0.25*

−0.21*

−0.20*

−0.23*

[-5.40]

[-5.30]

[-5.62]

[-5.28]

[-4.39]

[-5.20]

−0.44*

−0.50*

−0.54*

−0.49*

−0.45*

−0.46*

0.05

[3.14]

−0.10*
[-6.68]

−0.27*
[-6.52]

−0.51*

[-6.41]

[-7.25]

[-7.65]

[-7.62]

[-6.24]

[-6.92]

−0.71*

−0.76*

−0.82*

−0.79*

−0.83*

−0.74*

[-7.66]

[-7.07]

[-7.93]

[-7.79]

[-8.33]

[-7.88]

[-6.72]

[-7.54]

0.54*

−0.77*

IQ

30sec

√

0.04
[0.43]

0.31*

0.30

0.34*

0.76*

0.52*

0.53*

[2.00]

[1.92]

[2.65]

[6.07]

[3.79]

[3.70]

[4.53]

0.30*

0.23*

0.25*

0.41*

0.34*

0.38*

0.33*

[5.19]

[4.59]

[5.17]

[9.40]

[7.15]

[6.90]

−0.30*

−0.28*

−0.30*

−0.33*

−0.28*

−0.28*

[-7.67]

[-8.50]

[-8.30]

[-10.37]

[-10.17]

[-8.99]

−0.76*

−0.78*

−0.83*

−0.86*

−0.80*

−0.83*

[-10.55]

[-9.98]

[-11.28]

[-12.01]

[-10.26]

[-9.67]

−1.53*

−1.55*

−1.59*

−1.60*

−1.50*

−1.53*

[8.40]

−0.32*
[-10.18]

−0.91*
[-9.84]

−1.58*

[-10.86]

[-11.38]

[-11.66]

[-9.75]

[-10.11]

[-10.62]

[-11.32]

−2.25*

−2.30*

−2.31*

−2.40*

−2.47*

−2.24*

−2.30*

[-9.18]

[-10.60]

[-10.90]

[-10.23]

[-9.98]

[-9.31]

[-9.75]

IQ/IV
30sec
60sec
120sec
180sec
300sec
600sec

0.32*

0.09

−0.17

[4.45]

[0.89]

[-1.10]

0.68*
[17.97]

0.27*

0.56*
[12.26]

0.27*

0.62*
[12.45]

0.25*

0.55*
[13.12]

0.22*

0.19*

0.16*

[8.84]

[6.68]

[4.09]

[18.67]

[14.43]

[11.91]

0.25*

−0.18*

−0.18*

−0.18*

−0.19*

−0.19*

−0.18*

[-12.43]

[-11.62]

[-9.16]

[-18.10]

[-17.26]

[-13.54]

[-15.18]

−0.44*

−0.45*

−0.46*

−0.44*

−0.45*

−0.43*

−0.48*

[16.07]

−0.20*

[-17.13]

[-15.50]

[-13.38]

[-22.31]

[-19.59]

[-16.99]

[-20.13]

−0.75*

−0.78*

−0.77*

−0.71*

−0.75*

−0.72*

−0.78*

[-18.08]

[-17.72]

[-14.81]

[-22.77]

[-21.16]

[-18.73]

[-20.96]

−0.98*

−1.03*

−1.02*

−0.99*

−1.08*

−0.95*

−1.02*

[-20.31]

[-20.52]

[-17.74]

[-26.21]

[-23.57]

[-20.78]

[-22.35]

50

Table 9: Panel data regressions for the period June 1, 2007 - July 31, 2009. We investigate

the dependence of the curvature and slope of IV (Panel A), IQ (Panel B) and ratio (Panel C) signature plots on
the measure of intraday volatility of volatility V oV described in Section 5. For each estimator E and frequency
ω ∈ {30sec, 60sec, . . .}, we run a regression of Eω − E90sec (i.e. the estimator compared to itself at a 90sec base
frequency) on VoV30sec and stock fixed effects across a pooled sample of 33 stocks and 545 days between June 2007
and July 2009:
Eω,i,t − E90sec,i,t = aω,i + bω VoV30sec,i,t + uω,i,t
In the case of the ratio statistic, the ratio is calculated on each day for each stock. The table reports b̂ω with robust
t-stats in square brackets calculated by two-way clustering by stock and date according to Thompson (2006).
Estimator Class
Block Size
Functional
Selector Index

MPV
MPQ
3
Prod
1-3

MPV
MPQ
4
Prod
1-4

MPV
MPQ
5
Prod
1-5

TRV
TRQ
1
Prod
1

TBV
TBQ
2
Prod
1-2

NTV
NTQ
3
Med
1-3

RNTV
RNTQ
5
Min
3-5

Panel A: IV
30sec
60sec
120sec
180sec
300sec
600sec
Panel B:

√

60sec
120sec
180sec
300sec
600sec
Panel C:

0.77*

1.12*

[2.36]

[2.30]

0.13

0.25*

0.39*

[1.37]

−0.15

[2.27]

[2.27]

−0.24*

−0.35*

[-1.08]

[-2.47]

[-3.45]

−0.48*

−0.75*

−0.95*

[-2.03]

[-3.50]

[-3.93]

−1.13*

−1.43*

−1.69*

−0.54

−0.37

−0.50

[-0.84]

[-0.69]

[-0.75]

−0.09

−0.01

−0.12

[-0.41]

[-0.07]

[-0.41]

−0.03

−0.06

0.05

[-0.16]

[-0.37]

[0.19]

−0.13

−0.25

−0.12

−0.16
[-0.30]

0.09
[0.32]

−0.08
[-0.43]

−0.52

[-0.33]

[-0.76]

[-0.25]

[-1.48]

−0.80

−0.74

−0.65

−1.06*

[-3.10]

[-4.53]

[-4.36]

[-1.45]

[-1.56]

−1.65*

−2.04*

−2.36*

−1.66*

−1.67*

[-3.11]

[-4.23]

[-4.27]

[-2.15]

[-2.21]

[-1.17]

[-2.23]

−1.41

−1.74*

[-1.69]

[-2.46]

1.64

IQ

30sec

√

0.27
[1.31]

0.85

1.20

1.95*

1.04

0.54

0.63

[1.00]

[1.75]

[3.05]

[0.84]

[0.49]

[0.55]

[1.51]

0.56

0.66*

0.86*

0.64

0.59

0.46

0.77

[1.34]

[2.10]

[3.21]

[1.46]

[1.15]

−0.80*

−0.83*

−0.97*

−0.80*

−0.87*

[0.78]

−0.63

[-2.38]

[-2.19]

[-3.37]

[-2.75]

[-2.45]

[-1.50]

−2.59*

−2.56*

−2.65*

−2.27*

−2.15*

−1.82*

[-3.10]

[-3.62]

[-4.36]

[-3.48]

[-3.37]

[-2.48]

−4.61*

−4.83*

−5.00*

−4.67*

−4.27*

−4.26*

[-3.54]

[-3.95]

[-4.72]

[-4.08]

[-3.68]

[-3.60]

−6.47*

−6.88*

−7.12*

−6.92*

−7.12*

−6.71*

[-3.67]

[-4.10]

[-4.35]

[-4.15]

[-4.03]

[-3.62]

[1.38]

−0.78*
[-2.75]

−2.39*
[-3.59]

−4.64*
[-4.09]

−6.61*
[-4.04]

IQ/IV
30sec
60sec
120sec
180sec
300sec
600sec

0.38*

0.36*

0.32

[5.15]

[2.96]

[1.73]

0.52*
[13.44]

0.21*

0.46*
[9.79]

0.21*

0.49*
[10.85]

0.21*

0.45*
[12.22]

0.18*

0.17*

0.17*

[5.81]

[3.76]

[3.00]

[13.64]

[10.60]

[13.09]

0.22*

−0.15*

−0.16*

−0.17*

−0.16*

−0.15*

−0.16*

[-8.21]

[-6.17]

[-5.21]

[-15.93]

[-13.38]

[-14.24]

[-18.47]

−0.39*

−0.40*

−0.40*

−0.40*

−0.39*

−0.40*

−0.41*

[12.19]

−0.16*

[-12.96]

[-9.04]

[-6.52]

[-20.39]

[-19.25]

[-17.28]

[-25.00]

−0.66*

−0.68*

−0.68*

−0.66*

−0.66*

−0.65*

−0.68*

[-12.49]

[-9.63]

[-7.44]

[-25.11]

[-22.01]

[-22.20]

[-25.25]

−0.91*

−0.93*

−0.93*

−0.94*

−1.00*

−0.90*

−0.92*

[-12.82]

[-9.76]

[-8.42]

[-26.28]

[-21.40]

[-24.03]

[-25.59]

51

6

Conclusion

We provide a first in-depth look at robust estimation of integrated quarticity (IQ) based
on high frequency data. We review the basic theory and provide a novel set of jump-robust
estimators that are defined in terms of order statistics of suitable return functionals and
generalize the existing nearest neighbor truncation estimators of ADS (2010). This new
class of robust neighborhood truncation (RNT) estimators can be designed to enhance the
robustness properties vis-à-vis microstructure noise features of the data as well as reducing
the finite sample sensitivity to outliers. We find that such RNT estimators outperform
existing estimators by a considerable margin in terms of efficiency in estimating the key
ratio of IQ over IV squared. The latter quantity is extremely useful for robust inference
regarding IV and in testing for price jumps, as documented by BNS (2002).
In the empirical implementation, we emphasize the importance of appropriate filtering
for gross violations of the particular null hypothesis associated with a given estimation
procedure. In particular, we develop a novel functional filtering scheme for local power
variation estimators, which generalizes truncation of individual returns to truncation of
return functionals and is easy to apply for a broad range of popular estimators. By invoking
this new approach to filtering directly at the level of the local power variation estimators,
the threshold can be set very conservatively, thereby avoiding systematic biases arising from
overly aggressive truncation and eliminating the need for ex-post bias correction.
The unifying theme behind the proposed universal filtering procedure and new class of
estimators is to operate directly on the functional space of local power variation estimates
instead of restricting attention to the underlying individual returns, which can be viewed
as a special case. Combining the proposed novel filtering procedure with the new RNT
class of estimators enables efficient inference in an extensive simulation design and delivers
sensible results in an empirical application to the set of Dow Jones 30 stocks. Overall, the
study provides a set of new guidelines for the construction of practical robust and efficient
estimation and inference regarding IV and IQ.

52

References
Andersen, T. G. and T. Bollerslev. Answering the skeptics: Yes, standard volatility models do
provide accurate forecasts. International Economic Review 39.
Andersen, T. G., T. Bollerslev, and F. X. Diebold (2007). Roughing it up: Including jump components in the measurement, modeling, and forecasting of return volatility. Review of Economics
and Statistics 89.
Andersen, T. G., T. Bollerslev, and F. X. Diebold (2010). Parametric and Nonparametric Volatility
Measurement. North Holland. In Handbook of Financial Econometrics, Volume 1 - Tools and
Techniques; Yacine Aït-Sahalia, Lars P. Hansen, and Jose A. Scheinkman (Eds.).
Andersen, T. G., T. Bollerslev, F. X. Diebold, and P. Labys (2001). The distribution of realized
exchange rate volatility. Journal of the American Statistical Association 96, 42–55.
Andersen, T. G., T. Bollerslev, F. X. Diebold, and P. Labys (2003). Modeling and forecasting
realized volatility. Econometrica 71.
Andersen, T. G., T. Bollerslev, and D. Dobrev. No-arbitrage semi-martingale restrictions for
continuous-time volatility models subject to leverage effects, jumps and i.i.d. noise: Theory
and testable distributional implications. Journal of Econometrics 138.
Andersen, T. G., D. P. Dobrev, and E. Schaumburg (2008). Duration based volatility estimation.
Manuscript, Northwestern University.
Andersen, T. G., D. P. Dobrev, and E. Schaumburg (2009). Jump-robust volatility estimation
using nearest neighbor truncation. NBER Working Paper (15533).
Back, K. Asset pricing for general processes. Journal of Mathematical Economics 20.
Bandi, F. M. and J. R. Russell (2008). Microstructure noise, realized variance, and optimal sampling. Review of Economic Studies 75.
Barndorff-Nielsen, O. E., S. E. Graversen, J. Jacod, M. Podolskij, and N. Shephard (2006). A
central limit theorem for realized power and bipower variations of continuous semimartingales.
in From stochastic calculus to mathematical finance : the Shiryaev Festschrift, Springer Verlag.
Barndorff-Nielsen, O. E., S. E. Graversen, J. Jacod, and N. Shephard. Limit theorems for bipower
variation in financial econometrics. Econometric Theory 22.
Barndorff-Nielsen, O. E., P. R. Hansen, A. Lunde, and N. Shephard (2008). Designing realized
kernels to measure the ex post variation of equity prices in the presence of noise. Econometrica 76, 1481–1536.
Barndorff-Nielsen, O. E., P. R. Hansen, A. Lunde, and N. Shephard (2009). Realised kernels in
practice: Trades and quotes. Econometrics Journal 12, C1–C32.
Barndorff-Nielsen, O. E. and N. Shephard. Econometric analysis of realized covariation: High frequency based covariance, regression, and correlation in financial economics. Econometrica 72.
Barndorff-Nielsen, O. E. and N. Shephard. Econometrics of testing for jumps in financial economics
using bipower variation. Journal of Financial Econometrics 4.
Barndorff-Nielsen, O. E. and N. Shephard. Estimating quadratic variation using realized variance.
Journal of Applied Econometrics 17.

53

Barndorff-Nielsen, O. E. and N. Shephard. Power and bipower variation with stochastic volatility
and jumps. Journal of Financial Econometrics 2.
Barndorff-Nielsen, O. E., N. Shephard, and M. Winkel (2006). Limit theorems for multipower
variation in the presence of jumps. Stochastic Processes and Their Applications 116, 796–806.
Christensen, K., R. Oomen, and M. Podolskij (2008). Realized quantile-based estimation of integrated variance. Working paper; CREATES, University of Aarhus, Denmark.
Christensen, K., R. Oomen, and M. Podolskij (2010). Realized quantile-based estimation of integrated variance. Journal of Econometrics 159, 74–98.
Corsi, F., D. Pirino, and R. Renò (2010). Threshold bipower variation and the impact of jumps
on volatility forecasting. Journal of Econometrics 159.
Hasbrouck, J. The dynamics of discrete bid and ask quotes. Journal of Finance 54.
Hsieh, D. A. Chaos and nonlinear dynamics: Applications to financial markets. Journal of Finance 46.
Huang, X. and G. Tauchen. The relative contribution of jumps to total price variance. Journal of
Financial Econometrics 3.
Jacod, J., Y. Li, P. Mykland, M. Podolskij, and M. Vetter (2009). Mirostructure noise in the
continuous case: the pre-averaging approach. Stochastic Processes and Their Applications 26.
Jacod, J. and P. Protter (1998). Asymptotic error distributions for the euler method for stochastic
differential equations. Annals of Probability 26.
Jacod, J. and A. N. Shiryaev (2003). Limit theorems for stochastic processes (2nd ed.).
Grundlehren der mathematischen Wissenschaften. Berlin; New York: Springer.
Jiang, G. J. and R. C. Oomen (2008). Testing for jumps when asset prices are observed with noise
- a “swap variance” approach. Journal of Econometrics 144.
Mancini, C. (2009). Non-parametric threshold estimation for models with stochastic diffusion
coefficient and jumps. Scandinavian Journal of Statistics 36.
Mykland, P. A. and L. Zhang (2009). Inference for continuous semimartingales observed at high
frequency. Econometrica 77.
Podolskij, M. and M. Vetter (2009). Estimation of volatility functionals in the simultaneous presence of microstructure noise and jumps. Bernoulli 15, 634–658.
Schwert, G. W. Why does stock market volatility change over time? The Journal of Finance 44.
Zhang, L., P. A. Mykland, and Y. Aït-Sahalia. A tale of two time scales: Determining integrated
volatility with noisy high-frequency data. Journal of the American Statistical Association 100.
Zhou, B. (1996). High-frequency data and volatility in foreign-exchange rates. Journal of Business
and Economic Statistics 14.

54

A

Proofs of Propositions

This appendix provides proofs of Propositions 1-4 for the general case of estimating the integrated power
variation of order p, where p is a positive and even integer. The proofs are initially given for the MinPV
and MedPV type estimators and subsequently shown to extend to the RNT estimators in Lemma 12 below.
The (integrated) power variation, P V (p), is formally defined as,

Z

1

P V (p) =

σup du .

(3)

0

Obviously, p = 4 corresponds to the theoretical quantity relevant for the M inRQ and M edRQ estimators
while p = 2 refers to the integrated variance underlying the M inRV and M edRV estimators. The higher
order integrated power variation estimators are less commonly used but do appear in the recent literature.
For example, p = 8 is required to assess the (asymptotic) precision of integrated quarticity estimators.

A.1

Basic Setting

Let Yt be the log price process following a Brownian semimartingale
t

Z
Yt

=

Y0 +

Z
au du +

0

t

σu− dBu ,

(4)

0

where a is a locally bounded and predictable process and σ is adapted, cadlag and bounded away from
zero. Without loss of generality, we further assume that the functions a, σ are uniformly bounded and
inf t>0 σt > 0 a.s.27 The extension allowing for finite activity jumps in Yt is dealt with Section A.6 below.
When discussing central limit theorems (CLTs) we require in addition that the volatility process follows
a generalized Itô process:

Z
Assumption (A1) : σt = σ0 +

t

t

Z
ãu du +

0

Z

t

σ̃u− dBu +
0

ṽu− dWu ,
0

where ã is locally bounded and predictable and σ̃, ṽ are cadlag and the Brownian motions B, W are uncorrelated. We impose, without loss of generality, that the functions ã, σ̃, and ṽ are uniformly bounded as well
as inf t>0 σ̃t > 0 and inf t>0 ν̃t > 0 a.s. We further note that, when the volatility process {σt }t≥0 satisfies
Assumption A1, then the power variation process, {σt2 }t≥0 , also conforms to this general characterization.
We assume Y is observed at N +1 evenly spaced time points spanning the interval [0; 1]. Below, we denote
these observations by Yi/N , i = 0, . . . , N , and the associated log-returns by ∆N
i Y = Yi/N − Y(i−1)/N , i =
1, . . . , N . The proofs involve sequences of standardized return observations and corresponding approximating
sequences for which volatility is fixed across one or more returns. Hence, we introduce non-overlapping blocks
of M ≥ 1 returns for which the volatility process is constant. We assume we have K = N/M such blocks in
the sample. Consequently, we define the quantities,
χN
i
βiN,M

√
=
=

√

N ∆N
i Y ,
N

σ b (i−1)/M c M ∆N
i B

(5)

√
=

N

σ b (i−1)/M c ∆N
i B

N

,

(6)

K

where b·c indicates the integer part of an expression. Hence, for each of the K return blocks, corresponding
to βiN,M , the volatility remains fixed at the value it attains at the beginning of the block.
27

As argued in Barndorf-Nielsen, Graversen, Podolskij, Jacod and Shephard (2006), henceforth BNGJPS,
(k)
(k)
this follows from working with the stopped versions of the processes: Tt = Yt∧Tk and σt = σt∧Tk where
Tk = inf{t||at | + |σt− | ≥ k} and Tk % ∞ a.s.

55

A.2

The Min and Med Power Variation Estimators

Let p be a fixed positive even integer and let gmin,p : R2 7→ R+ be given by,
gmin,p (a)
dmin,p

=
=

dmin,p min ( |a1 |p , |a2 |p ) ,
p

p

( E [ min ( |Z1 | , |Z2 | ) ] )

where the scaling constant takes the form,
−1

(7)

and Z1 , Z2 ∼ i.i.d.N (0, 1)

,

π
π
For example, we have dmin,2 = π−2
and dmin,4 = 3π−8
.
Similarly, we define the median-based function gmed,p : R3 7→ R+ and scaling factors,

gmed,p (a)

=

dmed,p med ( |a1 |p , |a2 |p , |a3 |p ) , where

dmed,p

=

( E [ med ( |Z1 |p , |Z2 |p ), |Z3 |p ) ] ) −1 ,

In this case, dmed,2 =

6−4

π
√

3+π

and dmed,4 =

and

Z1 , Z2 , Z3 ∼ i.i.d.N (0, 1) .

3π √
.
9π+72−52 3

For any even positive integer, p, we define the nearest neighbor truncation estimators of the p’th order
power variation by,
MinPVN (p) = dmin,p

N −1
N −1
X


1 X
1
p
N
p
N
min (χN
)
,
(χ
)
=
gmin,p χN
i
i+1
i , χi+1 ,
N −1
N −1
i=1

MedPVN (p) = dmed,p

1
N −2

i=1

N −2

X

p
N
p
N
p
min (χN
i ) , (χi+1 ) , (χi+2 )



=

i=1

N −2

1 X
N
N
gmed,p χN
i , χi+1 , χi+2 .
N −2
i=1

For the cases of primary interest, i.e., p = 2 and p = 4, these estimators are identical to the M in and
M ed estimators introduced in Section 2.1. Specifically, we have

A.3

MinPVN (2) = MinRVN ,

MedPVN (2) = MedRVN ,

MinPVN (4) = MinRQN ,

MedPVN (2) = MedRQN .

Additional Notation and Preliminary Results

We provide a detailed proof of the results in Propositions 1 and 2 concerning the MinPVN (p) estimator. The
proofs for MedPVN (p) may be derived similarly. Moreover, we henceforth consider a fixed even, positive
integer, p, so the gmin,p function is uniquely defined. We refer to it simply as g below.
First, we observe that, for any bivariate vectors, a = (a1 , a2 ) and b = (b1 , b2 ), we have the following
useful bound,
| g(a) − g(b) | ≤ dmin,p ( | ap1 − bp1 | + | ap2 − bp2 | ) ,

(8)

and furthermore that, except on the null set {(a1 , a2 ) ∈ R2 |a1 = a2 }, we have
1
lim
[ min( ap1 , ap2 + ε z) − min( ap1 , ap2 ) ] =
ε→0 ε

(

z
0

if
if

|a2 | < |a1 |
|a2 | > |a1 |

The proofs of Propositions 1 and 2 revolve around the sequences,

VN =

N −1

1 X
N
g χN
i , χi+1
N
i=1

and

M
UN
=

N −1

1 X
N,M
.
g βiN,M , βi+1
N
i=1

56

(9)

Since MinPVN (p) = NN−1 VN , the VN sequence is asymptotically equivalent to our M inP V estimator, while
N,M
M
UN
is an approximating sequence as, for large N, χN
.
i ≈ βi
For any adapted, integrable, d-dimensional cadlag process, X , and for N ≥ j > i − 1 ≥ 0 , we define the
expectation conditional on information at time i−1
:
N

h

i

Ei−1 X j

h

= E X j |F i−1

N

i

(10)

N

N

A useful implication of our ability to focus on the case with uniformly bounded drift and volatility functions
is that, using the Burkholder-Davis-Grundy inequalities, we have,
Ei−1



q
|χN
i |



≤ C

and

Ei−1



| βiN,M |q



≤ C,

(11)

where q > 0 and C denotes a generic positive constant which we (with slight abuse of notation) allow to
take on disparate values in different places.
We decompose our estimators for the power variation, P V (p), into a sum of conditional expectations
M
M
M
where,
+ U2N
= U1N
and the associated martingale difference sequences: VN = V1N + V2N and UN
V1N =

N −1


1 X
N
,
Ei−1 g χN
i , χi+1
N

V2N =

i=1

i=1

N −1

M
U1N
=

1 X
N

N −1
 N N 
1 X
N
g(χN
i , χi+1 ) − Ei−1 g(χi , χi+1 )
N
N −1

N,M
Eb i−1 cM g βiN,M , βi+1





M

M
, U2N
=

i=1

n
1 X
N

N,M
N,M
) − Eb i−1 cM g(βiN,M , βi+1
)
g(βiN,M , βi+1



M

i=1

1
and similarly for the individual pieces
When M = 1 we will use the shorthand βiN ≡ βiN,1 , UN ≡ UN
U1N and U2N . These definitions allow us to decompose the main estimator:

VN

=

U1N + U2N + (V1N − U1N ) + (V2N − U2N )

(12)

Consistency of VN can then be obtained by showing consistency of the estimator applied to the approximating Brownian path with piecewise constant volatility (UN = U1N + U2N ) and then showing that the
difference VN − UN (the last two terms in (12) above) is asymptotically negligible. This is what we do in
Section A.4 below. To prove a CLT, we exploit a different decomposition (similar to Mykland and Zhang
(2007)), in which we show the CLT for our estimator applied to an approximating Brownian motion for
which volatility is piecewise constant over blocks of length M . We then proceed to show that the difference
between the original estimator and the estimator applied to the approximating process is negligible. This
analysis is carried out in Section A.5 based on the decomposition:
√
N ( VN − P V (p) )

=
+

A.4

√
√
√
N (V1N − U1N ) + N ( V2N − U2N ) + N ( U1N − P V (p) )
√
√
M
M
N ( U2N − U2N
) + N U2N

(13)

Proposition 2: Consistency

We proceed by analyzing equation (12) term by term through a series of lemmas. For brevity, we focus
on the features that are specific to our estimator, while referring to proofs in the extant literature when
feasible. This also serves to highlight the underlying structural similarities between our P V (p) measure and
previously proposed power variation estimators and, in particular, IV and IQ estimators.

57

o

.

Lemma 5 Under the maintained assumptions we have,
P

U1N → P V (p)

(14)

Moreover, if Assumption (A1) holds we obtain,
√
P
N ( U1N − P V (p) ) → 0

(15)

Proof. First, note that
N
g βiN , βi+1



h

=

N
g βiN , βi+1
−g





βiN ,

i


√
√
N
N
B
+
g
β
,
∆
B
N σ i−1 ∆N
N
σ
i−1
i+1
i
i+1
N

N

so we may write

U1N

N −1
N −1
h

i
√

1 X
1 X p
N
− g βiN , N σ i−1 ∆N
+
Ei−1 g βiN , βi+1
σ i−1
i+1 B
N
N
N
N

=

i=1

(16)

i=1

The first sum in (16) tends to zero in probability. To see this, note that the bound (8) implies the following
limit in L2 -norm:
N −1
h

i
√

1 X
N
Ei−1 g βiN , βi+1
− g βiN , N σ i−1 ∆N
E
i+1 B
N
N
i=1

2

C
≤
E
N

" N −1
X
i=1

#
|σ pi − σ pi−1 | 2
N

→ 0

N

(17)
where the convergence (17), and thus also convergence in probability, follows from the fact that σtp has
p
finite quadratic variation (since σt is a cadlag semimartingale).
 In addition,
 since {σt } t≥0 is uniformly
σup − σ pbuN c

bounded and cadlag, the pointwise dominated convergence of

→ 0 for u ∈ [0; 1] follows

N

and Lebesgue’s theorem yields

"
X Z

N −1

i
N



(i−1)
N

i=1

σup

#



p

− σ (i−1)

a.s.

→ 0

du

(18)

N

Together (17) and (18) imply P V (p) − U1N → 0 , which establishes (14). To show (15) we need the
√
stronger assumption (A1). Define the sequence of independent standard normals Zi = N ∆N
i B , then
Assumption (A1) yields

h

p
p
Ei−1 (σ pi − σ i−1
) Zi+1
1|Zi+1 |<|Zi |
N

i

h

p
= Ei−1 (σ pi − σ i−1
) ϕ(Zi )
N

N

i

= OP (1/N )

(19)

N

p
since ϕ(Zi ) = Ei [ Zi+1
1|Zi+1 |<|Zi | ] is an even function of the Brownian path {Bt }(i−1)/N <t<i/N . Now the
property (9) yields

h



N
Ei−1 g βiN , βi+1
− g βiN ,



√

N σ i−1 ∆N
i+1 B

i

= OP (1/N )

This ensures that the first term in (16) is asymptotically negligible, even when scaled up by
the remaining task is to show,
√
N

!

N −1
1 X p
σ i−1 − P V (p)
N
N

(20)

N

P

→ 0.

i=1

58

√
N . Hence,

However, this is analogous to the common task of showing that
√
N

N −1
1 X 2
σ i−1 − IV
N
N

!
P

→ 0.

i=1

in the IV literature and the method of proof is, by now, well established; see, e.g., BNGJPS where the
result is shown in a general setting (allowing for infinite activity jumps) of which the current framework is
a special case. A more intuitive and detailed exposition is provided by Barndorff-Nielsen, Graversen, Jacod,
and Shephard (2006), henceforth BNGJS.
Lemma 6 Under the maintained assumptions, we have
P

U2N → 0

(21)

Proof. To simplify notation, define the martingale difference sequence
N
N
ηiN = g(βiN , βi+1
) − Ei−1 g(βiN , βi+1
)



n

1
N

ηiN , F

o
i
N

:

i≥0



Note that E[ (ηiN )2 |F i−1 ] ≤ C , so applying the Cauchy-Schwartz inequality,
N

"
V

N
1 X N
ηi
N
i=1

#

1
=
E
N

"

N

1 X
N
(ηiN )2 + 2ηiN ηi+1
N

#

i=1

The L2 convergence implies

1
N

PN
i=1

C
≤
E
N

"

N
1 X
E[ (ηiN )2 |F i−1 ]
N
N
i=1

#
≤

C
→ 0.
N

P

ηiN → 0 .

Lemma 7 Under the maintained assumptions, we have,
P

( V1N − U1N ) → 0 .

(22)

Under Assumption (A1), we obtain,
√
P
N ( V1N − U1N ) → 0 .

(23)

Proof. We must show,
V1N − U1N =

N −1


1 X
N
N
N
Ei−1 g(χN
→ 0 as N → ∞ .
i , χi+1 ) − g(βi , βi+1 )
N

(24)

i=1

Using the bound (8), it follows that,
V1N − U1N

1
≤
E
N

" N −1
X

#
N
N
N
| g(χN
i , χi+1 ) − g(βi , βi+1 ) |

i=1

"

N
X
C
p
N p
≤
E
(χN
i ) − (βi )
N

#
=

i=1

N 

√
C X
p
Ei−1 h( N ∆N
Y
)
−
σ
i
i−1
N
N
i=1

where we have defined the function h(x) = xp . This formulation maps directly into the setting of BNGJPS
where the results of this lemma are proven in a more general setting and for a generic h(x) function subject
to regularity conditions. In particular, our h function trivially satisfies the continuous differentiability and
polynomial growth conditions necessary for the applicability of their analysis. An accessible, albeit lengthy,

59

account of the steps of the argument may be found in BNGJS (2006, pp. 713-719). So while this proof is
quite involved, the above reformulation of the relevant inequalities, as they arise within our specific setting,
allows us to simply refer to previously published work for the result.
Lemma 8 Under the maintained assumptions, we have,
P

( V2N − U2N ) → 0 .

(25)

Moreover, we may strengthen this result further to obtain,
√
P
N ( V2N − U2N ) → 0 .

(26)

Proof. In order to demonstrate the second result of the lemma, which obviously implies the first, we define,
√



N
N
N
ξiN = (1/ N ) g χN
,
i , χi+1 − g βi , βi+1
and we must then prove that,
N −1

X

ξiN − Ei−1 [ ξiN ]



P

→ 0.

i=1

This is a martingale difference sequence with respect to the filtration F
N −1

X

E



(ξiN )2



= E

" N −1
X

i=1

i
N

, so it suffices to show,

#
Ei−1



(ξiN )2



→ 0

as

N → ∞.

i=1

Mimicking the type of steps undertaken in the proof of the previous lemma, including application of the
N
uniform bound on moments of χN
i and βi , we obtain,
N −1

X

E



(ξiN )2



1
E
N

=

i=1

" N −1
X

#
Ei−1

g( χN
i ,

χN
i+1 )

−

g(βiN ,

)

2

i=1

"

N
h
X
2 i
C
N
E
Ei−1
h(χN
i ) − h(βi )
N

≤

N
βi+1

#
.

i=1

As for the previous lemma, our reformulation of the task maps the problem into the corresponding task in
BNGJPS (2006) who prove a corresponding lemma in a more general setting. A detailed account of the
requisite steps to complete this part of the proof may again be gleaned from BNGJS (2006, pp. 704-706).
Taken together, Lemma 5 - 6 and the first parts of Lemma 7 - 8 imply the consistency of our estimator
under the minimal maintained assumptions. The second parts of Lemmas 7 - 8 are critical for the proof of
the central limit theorem below.

A.5

Proposition 3: The CLT

Lemma 9 Under assumption (A1), we have
√
M
N U2N

stable D

−→


N

Z
0, ν

1

σ

2p


du

(27)

0

where the constant ν = Var [g(Z0 , Z1 ] + 2 Cov [g(Z0 , Z1 ), g(Z1 , Z2 )] for Z0 , Z1 , Z2 ∼ i.i.d.N (0, 1).

60

Proof. Consider splitting the N scaled return observations into K blocks, the kth of which is the vector
√
N
χM
k = { N ∆i Y }i∈{(k−1)M +1,...,kM } . The corresponding vector of observations from the approximating
Brownian motion where volatility is held constant over the block is βkN,M = {βiN,M }i∈{(k−1)M +1,...,kM } .
Next, define by gM (·) : RM 7→ R the block estimator of volatility:
gM (βkN,M ) =

1
M

kM −1

X

N,M
g(βiN,M , βi+1
)

(28)

i=(k−1)M +1

√
M
We wish to apply Theorem IX.7.28
 in Jacod and Shiryaev (2003) to N U2N . Defining the martingale
√
difference sequence ψkN,M = M gM (βkN,M ) − MM−1 σ 2(k−1) we can write
K

K
K−1 
√


1 X N,M
1 X
M
N,M
N,M
N,M
N,M
N U2N
= √
g(
β
,
β
)
ψk
+ √
g( βkM
, βkM
)
−
E
k−1
kM
kM +1
+1
K
K k=1
N k=1
K
1 X N,M
= √
ψk
+ oP (1)
K k=1

(29)

The last equality follows from the fact that each term in the second sum is centered and has bounded variance
√
(given the uniform bound on σt ). Thus the sum divided by N will tend to zero provided K = oP (N ).
We must now verify conditions (7.27)-(7.31) of Theorem IX.7.28. First note that E[ ψkN,M | F k−1 ] = 0
K
so that condition (7.27) is trivially satisfied. Condition (7.28) follows from the fact that
K
1 X
E
K

"

√


M

k=1

M −1 p
σ (k−1)
gM ( βkM ) −
M
K

#

 2
| F k−1
K

Z 1
K
ν X 2p
P
σ k−1 → ν
=
σu2p du (30)
K
K
0
k=1

where the convergence in probability (and in fact a.s.) is a consequence of the volatility
process
 being

M
cadlag and uniformly bounded. Next, we turn to condition (7.29). Let ∆k B = B k − B (k−1) , then
K

E

h

ψkN,M ∆M
k B

F k−1

i

ψkN,M

= 0, which follows from the fact that the variables

K

h

i

K

are centered and that gM

P

is an even function. Condition (7.30), stating that E (ψkN,M )2 1|ψN,M |>ε → 0, follows straightforwardly
k
from the fact that σ is uniformly bounded.
Finally, let {Nt }t∈[0;1] be a bounded martingale orthogonal
to B(i.e. the covariation hB, N it = 0 a.s.).

We want to show that, for each block k, E[ψkN,M N k − N (k−1)
the martingale difference sequence Mt = E
M k−1 +

R

K

k
K
k−1
K



ψkN,M

K

K

|F k−1 ] = 0. For t >
K

k−1
K

consider

Ft . By the martingale representation theorem, Mt =

ϕu dBu for some predictable process ϕu . Therefore the processes {Mt }t> k−1 and {Nt −
K

N k−1 }t> k−1 are orthogonal and the product, {Mt (Nt − N k−1 )} is again a martingale which must then have
K
K
K
mean zero. This verifies condition (7.31) and Theorem IX.7.28 in Jacod and Shiryaev (2003) states that as
N (and hence K and M ) tend to infinity:
√
M stable
N U2N
−→ N



Z
0, ν

1

σ

2p


du

(31)

0

Lemma 10 Under the maintained assumptions, we have
√
N

M
U2N − U2N



P

→ 0

(32)

61

N,M
N,M
Proof. Defining ηiN,M = g(βiN,M , βi+1
)−Eb(i−1)/M cM g(βiN,M , βi+1
) , we note that





n

√1
N

(ηiN − ηiN,M )

o

 i≥1
√
M
is a martingale difference sequence with respect to the filtration {Fi/N }. To show that N U2N − U2N
=
√
PN −1 N
N,M
(ηi − ηi
)/ N → 0 in probability, it therefore suffices (by Doobs inequality, e.g. Revuz and Yor
i=1
(1999)) to show that
1
E
N

" N −1
X

#
g(βiN ,

N
βi+1
)

−

g(βiN,M ,

N,M 2
βi+1
)

−

g(βiN,M ,

2
N,M
βi+1
)

→ 0

(33)

i=1

By the bound of g(·) we have
1
E
N

" N −1
X

#
g(βiN ,

N
βi+1
)

i=1

"

#

"

N
X
C
≤
E
Ei−1 (βiN )p − (βiN,M )p
N

2

i=1

N

X p
C
≤
σ i−1 − σ pb(i−1)/M cM
E
N
N
N

2

#

Z



p

2

p

σ buN c − σ buK c

= C E
0

i=1

1

N

du = oP (1) ,

(34)

K

where the last inequality follows from the uniform boundedness of σt and Lebesgues theorem.
Importantly, the specification of the volatility process in Assumption (A1) may be extended to include
finite as well as infinite activity jump processes subject only to the regularity conditions stipulated in
BNGJPS. This follows from the fact that the only terms in (13) affected by the inclusion of jumps are the
√
√
terms N (V1N −U1N ) and N (V2N −U2N ) which map into the corresponding terms in BNGJPS as outlined
in the proofs above. As such, the distributional results of the paper cover a wide range of underlying return
generating processes.

A.6

The Asymptotic Distribution under Jump Alternatives

Suppose now the log price process is given as X = Y + J, where Y is a Brownian semimartingale of the form
(4) while J is a finite activity jump process. We show below that the above results continue to hold.28 The
√
key is that N |Y i − Y i−1 | = OP (| log(N )|1/2 ), which follows readily from Levy’s modulus of continuity
N
N
theorem for Brownian motion. This immediately yields:
Proposition 11 When J is a finite activity jump process, the asymptotic distribution of the minP V (p)
and M edP V (p) estimators applied to the processes {Xt } and {Yt } are identical.
Proof. As before, we deal only with the M inP V case as the M edP V case is analogous. On a given
realization of the path there is a finite number of jumps, so (asymptotically) at most one of the terms
| X i − X i−1 | or | X i+1 − X i | includes a jump. Therefore, each term in the estimator (up to a normalizing
N
N
N
N
constant) is
min



|X

i
N

− X i−1 |p , |X i+1 − X i |p
N

N

N




= OP

28

(log N )p/2
N



As for the volatility process, the specification may be generalized to infinite activity jump processes
along the lines of Barndorff-Nielsen et al (2006c).

62

regardless of whether a (single) jump occurred or not over [
N h
X



min |X

i
N

− X i−1 |p , |X i+1 − X i |p
N





− min |Y

N

N

i−1 i+1
, N
N

i
N

]. Since only finitely many terms differ,

− Y i−1 |p , |Y i+1 − Y i |p
N

i

N

N

j=1


= OP

(log N )p/2
N



1
= oP ( √ )
N

so neither consistency nor convergence in distribution is affected by the presence of finite activity jumps.

A.7

Robust Neighborhood Truncation Estimators

We consider the family of robust neighborhood truncation (RNT) estimators on a block of m i.i.d. N (0, σ 2 )
returns, {Z1 , . . . , Zm }. The estimator is then constructed by taking the j th quantile of H unbiased estimators
of σ p on the block. Denoting these primitive estimators by E1 , . . . , EH , we can write the RNT estimator as
(j,I )

RN TN

(p) = d(j,I ) (p)

1
(N − m + 1)

N −m+1

X

qj [ E1 , . . . , EH ]

i=1

where the d(j,I ) (p) is a scaling factor.
Lemma 12 Let p be a positive even integer and assume that the estimators E1 , . . . , EH satisfy the conditions
(j,I)
of Proposition 1 and Proposition 2, then the robust neighborhood truncation estimator, RN TN (p), defined
p
in (35) is consistent for σ and satisfies a CLT.
Proof. We need to verify the three properties,(8)-(9) and symmetry, of the g()˙ function used in the theorem
(j,I )
are satisfied when g(·) = RN TN (p). We deal with each condition in turn.
(j,I )
Clearly, if each primitive estimator Ei is symmetric, so is RN TN (p). Moreover, if each Ei satisfies a
(j,I )
bound of the type (8), so will RN TN (p) as it is simply an order statistic of such bounded functionals.
Finally, assume that each Ei satisfies (9). Except on a null set, there exists a neighborhood around each
(j,I )
p
m-tuple (z1 , . . . , zm ), on which RN TN (p) = Ei (z1p , . . . , zm
) for some 1 ≤ i ≤ H. Therefore it follows that
(j,I )
also RN TN (p) satisfies (9).
Remark 13 Since the NT estimators (up to a scale factor) essentially are a special case of RNT, the lemma
applies to these as well.

B

Noise Robustness Properties of the Ratio IQ/IV 2

The ratio IQ/IV 2 plays an important role for both IV inference and jump attribution in finite samples. This
section extends the analysis of Huang and Tauchen (2005) to show that the ratio IQ/IV 2 has certain desirable
robustness features in the presence of microstructure noise. Following Ait-Sahalia and Mykland (2005), we
assume that the true price process (p∗i ) is observed at N + 1 discrete points in time with an independent
stationary (possibly autocorrelated) measurement error (ui ) that results in an MA error structure in observed
returns:
pi = p∗i + ui ⇒ ri = ri∗ + εi where εi = ui − ui−1
For simplicity, we focus the discussion here on the (RV,RQ) pairing and denote:

c=
IV

N
X
i=1

ri2

∗

, IV =

N
X

ri∗2

N
N
N X ∗4
N X 4
∗
c
ri , IQ =
ri
, IQ =

3

i=1

63

i=1

3

i=1

The presence of microstructure noise produces a bias in both the IQ and IV estimators of the form:

c
E[IQ]
2

c ]
E[IV

N2
E[ε4i ] + 2N E[IV ∗ ]E[ε2i ]
3

=

E[IQ∗ ] +

=

E[IV ∗2 ] + N E[ε4i ] + N (N − 1)(E[ε2i ])2 + 2(N + 2)E[IV ∗ ]E[ε2i ]
N −1

+2

X

(N − m)Cov(ε21 , ε21+m )

(35)

m=1

In the special case where ui ∼ N (0, σu2 ) is serially uncorrelated and denoting the noise to signal ratio
λ = σu2 /( N1 E[IV ∗ ]), the expressions above simplify to

c
E[IQ]
2

c ]
E[IV

=

E[IQ∗ ] + 4E[IV ∗2 ](λ + λ2 )

=

E[IV ∗2 ] + 4E[IV ∗2 ](λ + λ2 ) + O



1
N



(36)

Under the null of no jumps, IQ∗ , IV ∗ are asymptotically unbiased and consistent and

c
IQ
c
IV

P

−→

2

IQ + 4IV 2 (λ + λ2 )
as N → ∞
IV 2 + 4IV 2 (λ + λ2 )

The downwards bias of the limiting ratio depends on the noise-to-signal ratio λ and preaveraging of
returns therefore plays an important role in reducing λ and the associated distortions.29 Moreover, for
sufficiently pre-averaged returns, there is very little evidence of serial correlation, as pointed out by COP
(2010), and the serially uncorrelated noise case considered above is therefore the empirically most relevant
case.30 In finite samples, this downward bias is further compounded by a pure Jensen (concavity) effect
as readily seen from the Monte Carlo results for the Brownian motion scenario Path by path, the Cauchy2
c IV
c ≥ 31 must hold regardless of the noise structure or other
Schwartz inequality of course implies that IQ/
imperfections.
2
c IV
c may have a
In the presence of other deviations from the Brownian null, forming the ratio IQ/
stabilizing effect provided that the resulting distortion is uniform and roughly proportional to squared
returns since this will lead to a cancelation in numerator and denominator. We see this effect at work in the
simulations with price discreteness but in other instances, e.g., sparsity, it clearly fails. In cases involving
additive distortions such as jumps, there will be no cancelation of biases and the ratio will tend to (in the
case of upward biases) diverge at high frequencies due to the scaling by N in the numerator.
29

By Hölder’s inequality, IQ ≥ IV 2 , so that the distortion due to microstructure noise in general will
result in a downward bias in the limiting ratio.
Pq
30
In the general case where εi is a MA(q) process: εi = νi + k=1 θk νi−k , we have

c
E[IQ]
2

c ]
E[IV

=

E[IQ∗ ] + E[IV 2 ] θ12 + . . . + θq2 + 1

=

E[IV ∗2 ] + E[IV 2 ] θ12 + . . . + θq2 + 1

64

2

λ2 + 2E[IV 2 ] θ12 + . . . + θq2 + 1 λ

2



λ2 + 2E[IV 2 ] θ12 + . . . + θq2 + 1 λ + O





1
N



C

IV and IQ estimators based on pre-averaged returns

Given N equally-spaced (log) returns, ri = Y i −Y i−1 , i = 1, · · · , N , we define corresponding pre-averaged
N
N
returns for any pre-averaging window size 2K ≤ N :
ri =

2K−1
K−1
1 X
1 X
Y i+j −
Y i+j , i = 1, · · · , N − 2K + 1 .
N
N
K
K
j=K

(37)

j=0

An equivalent definition with analytically more tractable expression is given by:
2K−1

ri = 2

X

g

j=1



j
2K



ri+j , i = 1, · · · , N − 2K + 1 ,

(38)

where g(x) = x∧(1−x) , x ∈ [0, 1] is the pre-averaging kernel. We further define ψK =

1
2K

P2K−1
j=1

4g

j
2K

2

R1

as the finite sample analog of the variance scaling factor ψ = 0 4 g(u)2 du = 31 induced by the pre-averaging
kernel.31
Consider the following 2K sub-samples of non-overlapping pre-averaged returns:
S1

=

S2

=

n
n

N
2K
j
ko
N −1
: s = 1, ...,
2K

r1+2(s−1)K : s = 1, ...,
r2+2(s−1)K

j

ko

...
S 2K

n

=

r2K+2(s−1)K : s = 1, ...,

 

j

N − 2K + 1
2K

ko

 

c S i and IQ
c S i , i = 1, · · · , 2K denote the raw IV and IQ estimates obtained on each subLet IV
c [r· ] and IQ
c [r· ] for
sample of pre-averaged returns. Then the pre-averaged (and sub-sampled) estimators IV
N −2K+1
the full set of pre-averaged returns r· = {ri }i=1
can be defined as follows:
c [r· ]
IV

=

2K
1 X 1c 
IV S i
2K
ψ
i=1

c [r· ]
IQ

=

2K
1 X 1 c 
IQ S i

2K

i=1

ψ2

After incorporating finite sample bias correction, these take the following final form that we use in our
pre-averaged implementation of all estimators:

c
IV

Adj

[r· ]

=

2K
N
 
1 X 1
2K
c Si
 N −i+1
 IV
2K
ψK
2K
i=1

c
IQ

Adj

[r· ]

=

2K
1 X 1

2K

i=1

2
ψK

N
2K

2

 
c Si
 N −i+1 2 IQ
2K

Consistency and asymptotic normality are clearly preserved by pre-averaging and sub-sampling, while
noise-robustness improves. In particular, bounce-backs are near perfectly annihilated given that adjacent
returns are subject to almost identical kernel weights. For further details on pre-averaging please refer to
Podolskij and Vetter (2009) and Jacod, Li, Mykland, Podolskij and Vetter (2009) among others.
31

Note that the factor 4 arises from the multiplication by 2 in equation (38).

65

D

Tabulating Moments of Order Statistics for Standard Gaussian Return Blocks

Table 10 provides the second and fourth moments of all order statistics for Gaussian return blocks of dimension two through five.

Table 10: We compute the second and fourth moments of order statistics based on blocks of powers of independent
standard normals, Zi ∼ N (0, 1). Panel A: Expectation of order statistics of squared normals. Panel B: Expectation
of order statistics of normals raised to the 4th power.
Panel A: 2nd moments
Block Size

2
Z(1)

2
Z(2)

2

π−2
π
=1.636619772367581

2+π
π
=0.3633802276324187

√
−6+2 3+π
π
=0.1927984737408401

√
6−4 3+π
π
=0.7045437354155758

√
2 3
π
=2.102657790843584

√
12−8 3+π
π

1

3

4

1+

√
4(4 3−9)
3π

=0.1207021413774029

2
Z(3)

2
Z(4)

2
Z(5)

1+

=0.4090874708311517

√8
3π
=2.470210387791445

1+

·

·

·

·

·

=0.08307731289708446

=0.2712014552986765

=0.6159164941298644

=1.256055670580090

=2.773749067094284

4
Z(3)

4
Z(4)

4
Z(5)

5

Panel B: 4th moments
Block Size

4
Z(1)

4
Z(2)

2

3 − π8
=0.4535209105296746

3 + π8
=5.546479089470325

3

3+

π

=0.1387464919112216

4

5

3+

√
72−52 3+9π
3π

26 −24
√
3

√
4(4(13 3−27)π−9)

9π 2
= 0.05766408946789071

=1.083069747766581

3+

4(9+(36−26

√

√26
3π
=7.778183760322198

3+

3)π )

3π 2
=0.3819936992412144

12
π2
=1.784145796291947

3−

3+

√
4(9+26 3π )

9π 2
=9.776196414998948

·

·

·

·

·

=0.02855480767257635

=0.1741012166491482

=0.6938324231293139

=2.511021378400369

=11.59249017414859

66

