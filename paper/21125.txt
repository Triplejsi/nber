NBER WORKING PAPER SERIES

IDENTIFICATION AND EFFICIENT SEMIPARAMETRIC ESTIMATION OF A
DYNAMIC DISCRETE GAME
Patrick Bajari
Victor Chernozhukov
Han Hong
Denis Nekipelov
Working Paper 21125
http://www.nber.org/papers/w21125

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
April 2015

The authors acknowledge generous research supports from the NSF and able research assistance from
Timothy Armstrong and Boyu Wang. We would like to thank our colleagues and numerous conference
and seminar participants for helpful comments. The usual disclaimer applies. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2015 by Patrick Bajari, Victor Chernozhukov, Han Hong, and Denis Nekipelov. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

Identification and Efficient Semiparametric Estimation of a Dynamic Discrete Game
Patrick Bajari, Victor Chernozhukov, Han Hong, and Denis Nekipelov
NBER Working Paper No. 21125
April 2015
JEL No. C01,C14,C57,C7,C73,L0
ABSTRACT
In this paper, we study the identification and estimation of a dynamic discrete game allowing for discrete
or continuous state variables. We first provide a general nonparametric identification result under the
imposition of an exclusion restriction on agent payoffs. Next we analyze large sample statistical properties
of nonparametric and semiparametric estimators for the econometric dynamic game model. We also
show how to achieve semiparametric efficiency of dynamic discrete choice models using a sieve based
conditional moment framework. Numerical simulations are used to demonstrate the finite sample properties
of the dynamic game estimators. An empirical application to the dynamic demand of the potato chip
market shows that this technique can provide a useful tool to distinguish long term demand from short
term demand by heterogeneous consumers.

Patrick Bajari
University of Washington
331 Savery Hall
UW Economics Box 353330
Seattle, Washington 98195-3330
and NBER
Bajari@uw.edu
Victor Chernozhukov
Department of Economics
MIT
Cambridge, MA 02142
vchern@mit.edu

Han Hong
Stanford University
Landau Economics Building
579 Serra Mall
Stanford, CA 94305
doubleh@stanford.edu
Denis Nekipelov
Department of Economics
University of Virginia
254 Monroe Hall
Charlottesville, VA 22904-4182
dn4w@virginia.edu

1

Introduction

In this paper, we study the identification and efficient sieve estimation of a dynamic discrete
game. We provide a general nonparametric identification result under the imposition of an
exclusion restrictions on agents payoffs and analyze large sample statistical properties of
nonparametric and semiparametric estimators for the econometric dynamic game model.
We also show how to achieve semiparametric efficiency of dynamic discrete choice models
using a sieve based conditional moment framework of Ai and Chen (2003). Numerical
simulations are used to demonstrate the finite sample properties of the dynamic game
estimators.
A dynamic discrete game is a generalization of a dynamic discrete choice model as in
Rust (1987), Hotz and Miller (1993). As in these earlier papers, agents in the model are
assumed to solve a dynamic programming problem.

Payoffs in each time period depend

on the agent’s actions, the state variables and random preference shocks.

Given current

choices, the state variables evolve according to a law of motion which can depend on an
agent’s actions. A dynamic game generalizes this single agent model to allow the payoffs
of one agent to depend on the actions of other agents. Dynamic game models are applicable in many areas such as industrial organization dynamic oligopoly with collusions, e.g.
Fershtman and Pakes (2009).

Recently, a number of papers have proposed methods to

estimate dynamic games including Aguirregabiria and Mira (2002, 2007), Berry, Pakes, and
Ostrovsky (2003), Pesendorfer and Schmidt-Dengler (2010), Bajari, Benkard, and Levin
(2007) and Jenkins, Liu, McFadden, and Matzkin (2004).
Our identification framework for dynamic discrete games builds on an extensive recent
literature including Aguirregabiria and Mira (2007), Berry, Pakes, and Ostrovsky (2003),
Pesendorfer and Schmidt-Dengler (2010). In particular, the important contribution by
Magnac and Thesmar (2002) developed a recoverability technique for a single agent dynamic
model that also provides a much credited building block to identify closely related dynamic
discrete games. Our framework builds directly on this profound literature and makes use
of a recoverability method that follows directly from the single agent model analyzed in
Magnac and Thesmar (2002). We generalizes in that we allow the state variables to be either
discrete or continuous. This is attractive for empirical work since in many applications state
1

variables are naturally modeled as continuous. The model is nonparametrically identified
if the researcher is willing to make exclusion restrictions, that is, not all state variables
can enter the payoffs of all agents. Such restrictions are commonly imposed in empirical
research.

For example, cost and demand shifters for one firm are frequently excluded

from the payoffs of other firms. These include the distance to its distribution center in
retail store entry models (Jia (2008) and Holmes (2011)), and the distance of a firm to the
project location in highway procurements (Somaini (2011)).
Second, we analyze semiparametric and non-parametric estimation procedures. In a
semiparametric model, imposing parametric functional form on the static payoff also allows
for possible cross equation restrictions between players that can differentiate the current
setup from most existing models. We begin with the analysis of a semiparametric setup,
where we only use non-parametric identification assumptions and parameterize the identifiable payoffs of the players without additional restrictions on the state transition law.
We find the semiparametric efficiency bound for the payoff parameters, which is the minimum variance of the parameter estimates without parametric assumptions regarding the
state transition. Moreover, we show that obtaining the semiparametrically efficient estimates does not require solving for equilibria of the game and computing the corresponding
likelihood function. We demonstrate that the treatment of the player’s decision problem
as a moment equation, generated by her first-order condition allows use to estimate the
payoff parameters in one step. We also show that the estimation procedure that allows one
to achieve the semiparametric efficiency bound belongs to our class of one-step estimation
methods. This is a new approach to the analysis of dynamic games and it generalizes the
existing two-step estimation techniques such as those proposed by Aguirregabiria and Mira
(2007), Berry, Pakes, and Ostrovsky (2003) and Pesendorfer and Schmidt-Dengler (2010).
An additional advantage of our approach is that it does not rely on the discreteness of
the state space which is in particular achieved by using an estimation approach that does
not need preliminary estimation of the continuation values of the players. In applied work,
many researchers choose to discretize a continuous state variable. Increasing the number of
grid points in a two step estimator reduces the bias of the first stage. However, this comes at
the cost of increasing the variance of the first stage estimates. In fact, when there are d = 4

2

or more continuous state variables, it can be shown that it is not possible to obtain through
√
discretization T consistent and asymptotically normal parameter estimates in the second
stage, where T is the sample size.2 . Therefore, discretizing the state space does not provide
a solution to continuous state variables. The estimation approach of Bajari, Benkard, and
Levin (2007) allows for continuous state variables. However, it requires a parametric first
stage and the resulting estimates will be biased if the first stage is misspecified.
Third, we find that the reduction of the estimation procedure to one stage allows us to
estimate payoffs of players fully non-parametrically. The structure of the non-parametric
estimator is based on the player’s first-order condition similarly to the semiparametric case.
The estimates of the payoff function have a slower than parametric convergence rate. This
rate depends on the smoothness of the distribution of the state transition as well as on the
support condition on the policy functions of the players. We analyze the non-parametric
estimator from the perspective of the mean-square optimality and offer a choice of trimming
for the sieve representation of the payoff functions as well as the value functions that provides
the procedure with the minimum mean squared error while converging at an optimal nonparametric rate. For the non-parametric estimator we develop a unified large sample theory
that nests both continuous and discrete state variables as special cases.
Furthermore, the one step semiparametric conditional moment estimator proposed in
this paper does not require one to determine numerically the value functions as they are
nonparametrically estimated within the conditional moment formulation. This constitutes a
considerable advantage over an identification based estimator and other existing multi-step
estimation procedure for dynamic discrete choice models.
Section 2 discusses identification in a static discrete game model. Section 3 extends
the identification analysis to a dynamic game. Section 3.7 develops nonparametric and
semiparametric estimation methods which follow the lines of the identification conditions to
construct estimates for the payoffs based on the non-parametric estimates of the conditional
choice probabilities. Section 4 demonstrates how the multi-stage estimation strategy can
be improved by representing the decision problem of a player in a dynamic game as a
2

To see this follow the arguments in Newey and McFadden (1994). A requirement for the second stage
√
√
T consistent is that both the bias T h2 and the variance 1/(T hd ) should

parameter estimates to be

converge to 0 as T → ∞. This is not possible when d > 4.

3

conditional moment equation. Moreover, it demonstrates how to obtain the estimates for the
payoff parameters with the minimum variance over the class of models without parametric
assumptions regarding the choice probabilities. It also derives the asymptotic distribution
for the estimates of the payoff parameters. Section 4.3 briefly describes nonparametric
estimation and section 5 demonstrates the finite sample properties of the estimators in a
monte carlo simulation. Section 7 concludes.

2

Nonparametric identification of static games

We begin by describing the model for the case of static games. This serves two purposes.
First, this will allow us to discuss our modeling assumptions in a simpler setting. Second,
we prove the identification for the static model. This will highlight some key ideas in our
identification of the full dynamic model and also will be used as a step in the identification
of the more general dynamic model.
In the model, there are a finite number of players i = 1, ..., n. Each player simultaneously
chooses an action ai ∈ {0, 1, . . . , K} out of a finite set. We assume that the set of actions
are identical across players. This assumption is for notational convenience only and could
easily be relaxed. Let A = {0, 1, . . . , K}n denote the set of possible actions for all players
and a = (a1 , ..., an ) denote a generic element of A. Also, let a−i = (a1 , ...ai−1 , ai+1 , ..., an )
denote a vector of strategies for all players excluding i. The vector si ∈ Si denotes the
state variable for player i. The set Si can be discrete, continuous or both.

Also, define

S = Πi Si and let s = (s1 , ..., sn ) ∈ S denote a vector of state variables for all n players.
We assume that s is common knowledge to all players in the game and is observable to the
econometrician.
For each agent, there are K + 1 private shocks i (ai ) indexed by the actions ai . Let
εi = (εi (0), ..., εi (K)) have a density f (i ) and assume that the shocks i are i.i.d across
agents and actions ai . We shall assume that i (ai ) is distributed extreme value.
Assumption 1 The error terms i (ai ) are distributed i.i.d. across actions and agents.
Furthermore, the error term has an extreme value distribution with density
f (i ) = exp(− (i + γ̄)) exp(− exp(− (i + γ̄))).
4

In the above γ̄ is the Euler’s constant, γ̄ ≈ 0.577. This location shift ensures that the error
terms have mean zero.
We could easily weaken this assumption. However, it is commonly used in the applied
literature and will allow us to write a number of formulas in closed form which will simplify
our study of identification. The vNM utility function for player i is:
ui (a, s, i ) = Πi (ai , a−i , s) + i (ai ).
In the above, Πi (ai , a−i , s) is a scalar which depends on i’s own actions, the actions of all
other agents a−i and the entire vector of state variables s. We assume that the iid preference
shocks i (ai ) are private information for player i. The assumption that the error term i (ai )
is private information is not universal in the literature. For example, Bresnahan and Reiss
(1991) assume that the error terms are common knowledge. However, this model requires
quite different econometric methods which account for the presence of multiple equilibrium
and the possibility of mixed strategies.
A strategy for agent i is a function ai = δi (s, i ) which maps the state s and agent i’s
private information i to an action ai . Note that agent i’s strategy does not depend on −i
since this is assumed to be private information to the other agents in the game. Define
Z
σi (ai = k|s) = 1 {δi (s, i ) = k} f (i )di .
This is the probability that agent i will play strategy k after we margin out i .
In equilibrium, player i’s belief is that j will play strategy k with probability σj (aj =
P
k|s). Therefore, i’s expected utility from choosing the strategy ai is a−i Πi (ai , a−i , s)σ−i (a−i |s)+
i (ai ).
Moving forward, it will be useful to define the choice specific value function as
Πi (ai , s) =

X

Πi (ai , a−i , s)σ−i (a−i |s).

(1)

a−i

Note that we can write the expected utility from choosing ai as
Πi (ai , s) + i (ai ).

5

(2)

Recall that the error terms are distributed extreme value. Standard results about the
logit model plus the definition of the choice specific value function imply that
exp(Πi (ai , s))
.
0
a0 ∈Ai exp(Πi (ai , s))

σi (ai |s) = P

i

Definition 1 Fix the state s. A Bayes-Nash equilibrium is a collection of probabilities,
σi∗ (ai = k|s) for i = 1, ..., n and k = 0, ..., K such that for all i and all k
exp(Πi (ai , s))
0
a0 ∈Ai exp(Πi (ai , s))

σi∗ (ai |s) = P

and

i

Πi (ai , s) =

X

∗
Πi (ai , a−i , s)σ−i
(a−i |s).

a−i

An equilibrium requires the actions of all players to be a best response to the actions of all
other players. Moving forward, it is convenient to define an equilibrium in terms of σi (ai |s)
instead of δi (s, i ).

2.1

Identification of the static model

An important question is whether it is possible for us to identify the parameters of our
model.

One approach to identification is to impose parametric restrictions on Πi (a, s).

In what follows, we allow Πi (a, s) to be a general function of s and do not specify the
payoffs Πi (ai , s) parametrically. We identify Πi (ai , a−i , si ) nonparametrically by imposing
exclusion restrictions on this function.
Our proof of identification is constructive. Assuming that the population probabilities
σi (ai = k|s) for all k, i and s are known, we reverse engineer the Πi (ai , a−i , si ) that
rationalize the data. Simple algebra implies that
exp(Πi (ai , s))
0
a0 ∈Ai exp(Πi (ai , s))

(3)

σi (ai = k|s) = P

i

log(σi (ai = k|s)) − log(σi (ai = 0|s)) = Πi (ai = k, s) − Πi (ai = 0, s)
Equation (4) is the well known Hotz-Miller inversion.

(4)

This equation implies that it is

possible to learn the choice specific payoff functions, Πi (ai = k, s) up to a first difference
from knowledge of the choice probabilities σi (ai = k|s). Since these choice-specific payoff
6

functions can only be learned up to a first difference, we need to impose the normalization
that an “outside good” action always yields zero utility:
Πi (ai = 0, a−i , s) = 0.

(5)

Assumption 2 For all i, all a−i and all s, Πi (ai = 0, a−i , s) = 0.
Having identified the choice specific payoff functions Πi (a, s), we next turn to the problem of identifying primitive mean utilities Πi (ai , a−i , s). The definition of the choice specific
payoff function implies that these two objects are related by the following equation:
X
Πi (ai , s) =
σ−i (a−i |s)Πi (ai , a−i , s),
∀i = 1, . . . , n, ai = 1, . . . , K.

(6)

a−i

Given s, this is a system of n × K equations, because there are n agents and for each
agent, there are K + 1 choices. Then Πi (ai , a−i , s) are n × K × (K + 1)n−1 free parameters
in equation (6). Recall that for each agent, we have normalized the utility for the action
ai = 0 to zero regardless of the actions of the other players.

Therefore, for each agent

i, there are K × (K + 1)n−1 free parameters corresponding to the K actions available to
i which yield nonzero utility and the (K + 1)n−1 actions of the other agents.
n × K × (K +

1)n−1

Clearly,

> n × K, which implies that the model is underidentified.

In order to identify the model, we will impose exclusion restrictions on i’s payoffs.
Partition s = (si , s−i ), and assume that
Πi (ai , a−i , s) = Πi (ai , a−i , si )

(7)

depends only on the subvector si . In other words, we are excluding some component of s
from i’s payoffs.

Such assumptions are commonly used in applied work.

For example,

many oligopoly models predict that after we control for −i’s strategies, i’s profits are not
influenced by certain cost or demand shifters for −i.
If we impose these exclusion restrictions, we can rewrite (6) as
X
Πi (ai , s−i , si ) =
σ−i (a−i |s−i , si )Πi (ai , a−i , si ),

(8)

a−i

If there are (K + 1)n−1 points in the support of the conditional distribution of s−i given si ,
we will have more equations than unknowns.
7

Theorem 1 Suppose that Assumptions 1 and 2 hold. Also suppose that for each si , there
exist (K +1)n−1 points in the support of the conditional distribution of s−i given si . Assume
that the (K + 1)n−1 equations defined by (8) are linearly independent almost surely. Then
the latent utilities Πi (ai , s−i , si ) are identified for almost every si and s−i .
We can alternatively state a rank condition, similar to the linear least squares regression
model, that is sufficient for identification. This rank condition requires that given each si ,
the second moment matrix of the “regressors” σ−i (a−i |s−i , si ),
Eσ−i (a−i |s−i , si )σ−i (a−i |s−i , si )0

(9)

is nonsingular. Intuitively, we interpret Πi (ai , s−i , si ) as the dependent variable in an ols
regression and σ−i (a−i |s−i , si ) as a regressor.
The rank condition in Theorem 1 is stated in terms of the equilibrium choice probabilities, which implicitly depend on the primitive parameters in the instantaneous payoffs
Πi (ai , a−i , s). For a given set of primitive utility and transition density parameters, whether
the induced equilibrium choice probabilities satisfy the rank condition may not be easy to
verify. In the two by two case if the discount rate is close to zero, the rank condition holds
as long as the instaneous payoffs are different between the two players. Pesendorfer and
Schmidt-Dengler (2010) gave elegant conditions for the discrete state space model in more
details. Verifying the rank condition for continuous state space models can be more difficult. Theorem 1 does have the advantage that it can be verifiable using observed data.
Furthermore, while whether the equilibrium choice probabilities induced by an arbitrarily
given set of model primitive parameters satisfy the rank condition is an open question,
it always holds for the primitive model utility functions recovered by the nonparametric
identification procedure. By construction, the nonparametrically identified primitive utility
functions satisfy the Bellman equation and the fixed point conditions for the Markov perfect
equilibrium, and induce equilibrium choice probabilities that satisfy the rank condition as
long as it is satisfied in the data.
We also note the identification arguments above can be extended where there are some
state variables s0 common to all payoffs. While this might slightly weaken the source of
the exclusion restriction, it can be important in practice. In order for the identification
8

arguments to go through, the discount rate β is assumed to be known. This follows from
known nonidentification results in one-player dynamic optimization problems from e.g. Rust
(1987) and in dynamic auctions from Jofre-Bonet and Pesendorfer (2003).

3

Nonparametric identification of dynamic games

3.1

Dynamic game of incomplete information

In this section, we extend our model to allow for non-trivial dynamics.

Our model is

similar to the framework proposed by Aguirregabiria and Mira (2007), Berry, Pakes, and
Ostrovsky (2003), and Pesendorfer and Schmidt-Dengler (2010) and Pesendorfer, SchmidtDengler, and Street (2008).

Period returns are defined using a static logit model.

The

current actions a and state influence the future evolution of the state variable. We shall
restrict attention to Markov perfect equilibrium. The methods that we propose here could
be applied to other dynamic games, such as a finite horizon where payoffs and the low of
motion are time dependent.

These extensions require considerable additional notational

complexity.

3.2
3.2.1

The Environment
Payoffs

In the model, there are t = 1, ..., ∞ time periods. At each time t, we let ait ∈ {0, 1, . . . , K}
denote the choice for agent i. We shall assume that the choice set is identical for all agents
and does not depend on the state variable. Both assumptions could be dropped at the cost
of notational complexity. Let si,t ∈ Si denote the state variable for agent i at time t. As
in the previous section, Si is a collection of real valued vectors and the state can either be
continuous or discrete.
Let εit = (εit (0), ..., εit (K)) denote a vector of iid shocks to agent i’s payoffs at time t.
As in the previous section, we shall assume that the error terms are distributed extreme
value. Player i’s period utility function is
ui (ait , a−it , st , it ) = Πi (ait , a−it , st ) + it (ait ).
9

As in the previous section, we shall develop the model assuming that Πi (ait , a−it , st ) is a
general function of the state variables rather than a member of a particular parametric
family. Let σi (ai |s) denote the probability that i plays ai given that the state is s. As in
P
the previous section, we define Πi (ait , s) as Πi (ai , s) = a−i Πi (ai , a−i , s)σ−i (a−i |s).

3.3

Value Functions

In the model, the evolution of the state variable depends on the current state and the
actions of all players. We assume that the state variable evolves according to a first order
Markov process g(s0 |s, ai , a−i ).

As before, s is perfectly observed by the agent and the

econometrician. Player i maximizes expected discounted utility using a discount factor β.
Let Wi (s, i ; σ) be player i’s value function given s and i .

The value function holds

fixed the strategies of the other agents σ−i . The value function then satisfies the following
recursive relationship:

Wi (s, i ; σ−i ) = max Πi (ai , s) + i (ai )
ai ∈Ai

Z X
0
0
0 0
0 0
+β
Wi (s , i ; σ−i )g(s |s, ai , a−i )σ−i (a−i |s)f (i )di ds .

(10)

a−i

At each state, agents choose an action ai ∈ Ai to maximize expected discounted utility.
The term Πi (ai , s) + i (ai ) is the current period return from choosing ai . The second term
captures i’s utility from future time periods.

In our model, agents choose their actions

simultaneously. Therefore, agent i’s beliefs about the evolution of the state given his current
P
information will be a−i g(s0 |s, ai , a−i )σ−i (a−i |s). This integrates out agent i’s uncertainty
about the actions of −i. The agent also needs to take into account expectations about next
periods preference shocks, 0i , by integrating out their distribution using the density f (0i ).
Definition 2 A Markov perfect equilibrium is a collection of policy functions, δi (s, i ) and
corresponding conditional choice probabilities σi (ai |s) such that for all i, all s and all i ,
δi (s, i ) maximizes the value function Wi (s, i ; σ−i ) defined in (10)
In a Markov perfect equilibrium, an agent’s strategy δi (s, i ) is restricted to be a function
of the state (s, i ). This solution concepts restricts equilibrium behavior by not allowing
10

for time dependent punishment strategies, such as trigger strategies or tit-for-tat which
do not depend on payoff relevant state variables.

While the Markov perfect equilibrium

assumption restricts behavior considerably, it has the advantage that equilibrium behavior
can be expressed using familiar techniques from dynamic programming. Since the focus of
this paper is on nonparametric identification and estimation, existence of equilibrium will
be taken as given in the following analysis.

3.4

Nonparametric identification

Next, we turn to the problem of identification of the model. The strategy for identifying
the model will be similar to the static model. We begin with some preliminaries by first
defining the choice specific value function and deriving some key equations that must hold
in our dynamic model.
The starting point of our analysis is to define the choice specific value function
Z X
Vi (ai , s) = Πi (ai , s) + β
Wi (s0 , 0i ; σ)g(s0 s, ai , a−i )σ−i (a−i |s)f (0i )d0i ds0 .

(11)

a−i

Similar to (1), the choice specific value function is the expected utility from choosing the
action ai , excluding the current period error term i (ai ). As in the static setting, the term
Πi (ai , s) integrates out player i’s expectations about the actions of the other players. In a
dynamic setting, however, we have to include the utility from future time periods. We do
this by integrating out the value function Wi (s0 , 0i ; σ) with respect to next periods private
information, 0i , and state s0 . In words, we can interpret the choice specific value function
as the returns, excluding i (ai ), from choosing ai today and then reverting to the solution
to the dynamic programming problem (10) in all future time periods. Next, we define the
ex ante value function, or social surplus function, as
Z
Vi (s) = Wi (s, i ; σ)f (i )di

(12)

The ex ante value function is the expected value of Wi tomorrow given that the state today
is s. In order to compute this expectation, we integrate over the distribution of i given
that the current state is s.

11

Using equations (11) and (12), the ex ante and choice specific value functions are related
to each other through the following equation


Vi (ai , s) = Πi (ai , s) + βE Vi (s0 )|s, ai .

(13)

In the dynamic model, if the state is equal to s, the ex ante value function is related to the
choice specific value function by:
Vi (s) = Ei max [Vi (ai , s) + i (ai )] .
ai

(14)

That is, the utility maximizing action maximizes the sum of the choice specific value function
plus the private information i (ai ). As in the static model, the equilibrium probabilities
and the choice specific value functions are relate through the following equation
exp(Vi (ai , s))
.
σi (ai |s) = P
0
a0 exp(Vi (ai , s))

(15)

i

3.5

Constructive Proof of Identification

As in the static model, we prove the identification of our model constructively. Our strategy
is to assume that the econometrician has knowledge of the population choice probabilities
σi (ai |s). We then show that it is possible to uniquely recover Πi (ai , a−i , s) after making
appropriate normalizations and checking a rank condition.
As in the static model, we begin by taking the log of both sides of (15). Straightforward
algebra implies that
log(σi (ai = k|s)) − log(σi (ai = 0|s)) = Vi (ai = k, s) − Vi (ai = 0, s)

(16)

This equation demonstrates that it is possible to recover the choice specific value functions
up to a first difference, if we know the population choice probabilities.
Next, it follows from (14) and the properties of the extreme value distribution that:
Vi (s) = Ei max Vi (ai , s) + i (ai ) = log
ai

= log

K
X

K
X

exp(Vi (k, s))

k=0

exp(Vi (k, s) − Vi (0, s)) + Vi (0, s).

k=0

12

(17)

The second equality follows from a property of the multinomial logit specification (derived
in e.g. Anderson, DePalma, and Thisse (1992)). Using (16), (17) can also be written more
concisely as
Vi (s) = − log σi (ai = 0|s) + Vi (0, s) .

(18)

In particular, (18) shows that Vi (s) is known as soon as Vi (0, s) is.
We now combine (17) with equation (13) to yield:
Vi (0, s) = Πi (ai = 0, s) + βE [Vi (s0 )|s, ai = 0]
= Πi (ai = 0, s) + βE [− log σi (ai = 0|s0 ) + Vi (0, s0 )|s, ai = 0]
(19)
= Πi (ai = 0, s) + βE [− log σi (ai =

0|s0 ) |s, ai

= 0]

+βE [Vi (0, s0 )|s, ai = 0] .
Next, suppose that we are willing to make the “outside good” assumption as in equation
(5). Then equation (16) implies that:



Vi (0, s) = βE − log σi ai = 0|s0 + Vi (0, s0 )|s, ai = 0



= βE − log σi ai = 0|s0 |s, ai = 0


+ βE Vi (0, s0 )|s, ai = 0 .
Since the population probabilities σi (ai = k|s) are assumed to be known for the purposes
of our identification argument, the term



βE − log σi ai = 0|s0 |s, ai = 0
can be treated as a known constant. Then, equation (19) is a functional equation involving
the unknown function Vi (0, s). Blackwell’s sufficient conditions (e.g. Theorem 3.3 in Stokey,
Lucas, and Prescott (1989)) imply that for fixed σi (ai |s), (19) is a contraction mapping and
therefore there is a unique solution for Vi (0, s), which can be computed e.g. using methods
discussed in section 5.2. As a result, we have shown that Vi (0, s) is identified. Moreover,
Vi (k, s) is identified for all k by substituting Vi (0, s) into (16) . Finally, we note that the
ex ante value functions can be identified by (17) or (18) given that we have identified the
Vi (k, s).
13

Next, note that (13) implies that


Πi (ai = k, s) = Vi (ai = k, s) − βE Vi (s0 )|s, ai = k .

(20)

Our identification arguments imply that both terms on the right hand side of (20) are
known. This implies that Πi (ai = k, s) is identified. Alternatively, using (13), (16) and (18)
one obtains




Πi (k, s) = Vi (0, s) + log [σi (k|s) /σi (0|s)] − βE Vi 0, s0 − log σi ai = 0|s0 |s, ai = k ,
which directly establishes the identification of Πi (k, s) from the knowledge of Vi (0, s).
The rest of identification proof can then follow exactly as in equations (6)-(8), as once
Πi (k, s) is known, the argument with exclusion restrictions of section 2.1 applies to identify
Πi (k, a−i , s). We simply need to construct the Πi (ai , a−i , si ) from the static choice specific
value functions Πi (ai , s) by imposing exclusion restrictions.
Theorem 2 Suppose that Assumptions 1-2 hold. Also suppose that for each si , there exist
(K +1)n−1 points in the support of the conditional distribution of s−i given si . Assume that
the (K + 1)n−1 equations defined by (8) are linearly independent. Then the latent utilities
Πi (ai , a−i , si ) are identified.

3.6

Nonparametric Shock Distribution

Our results has thus far focused on nonparametric identification and semiparametric estimation of the payoff function taking the parametric known distribution of the shocks as given.
As is well known in the discrete choice model literature, without imposing strong identification at infinity assumptions, it is clearly not possible to identify both the mean utility
functions and the shock distributions entirely nonparametrically. In Nekipelov, Bajari, and
Hong (2010), we show that if we are willing to impose a parametric structure on the mean
utility functions, then it is possible to identify and estimate a nonparametric specification
of the shock distributions, which is assumed to be fully independent of the state variables.
These results apply to both the static game and the dynamic discrete game.

14

3.7

Identification-based estimation procedures

Under the assumption that one has access to a data set from a collection of independent
markets m = 1, . . . , M with at least two periods of observations each, a nonparametric
multi-step estimator can be constructed by using the empirical analogue of our identification
strategy.

The translation from identification arguments to the nonparametric estimator

essentially only requires replacing the appropriate conditional expectations with analog
sample projections. There are many possible local and global nonparametric smoothing
techniques to estimate conditional expectations. For example, series expansions have been
a popular choice as most of the recent literature (e.g. Newey (1994) and Chen, Linton, and
Van Keilegom (2003)).
In step 1, Vbi (k, s)− Vbi (0, s) can be estimated using (16) given a flexible estimator σ
bi (ai |s)
of the equilibrium choice probabilities σi (ai |s), in
V̂i (k, s) − V̂i (0, s) = log(b
σi (k|s)) − log(b
σi (0|s)).
We also need to construct an estimate of g(s0 |s, ai , a−i ).
g(s0 |s, ai , a−i ) will vary with the application.

The details of estimating

In many problems, the law of motion for

the state variable is deterministic and therefore does not need to be directly estimated.
Another common case is when g(s0 |s, ai , a−i ) is defined by a density, which can be modeled
by a flexible parametric density or estimated nonparametrically.
In step 2, an estimate of V̂i (0, s), the baseline choice specific value function for k = 0,
can be constructed by iterating on the empirical analogue of equation (19), using a numerical quadrature method possibly in combination with discretization of the state spaces.
See e.g. section 5.2. If the numerical quadrature used to implement (19) is integrating
against an estimated conditional density function, then Blackwell’s sufficient condition for
contraction mapping will be automatically satisfied. If the conditional expectation in (19)
is approximated by least square projections then iterating on the least square projection
might not ensure the contraction mapping property. However, the semiparametric conditional moment estimator that we propose below will still be consistent and does not require
iterating on the contraction mapping relation.
In step 3, we evaluate the empirical analogue of (20) to estimate the static choice specific
payoff function which we denote as Π̂i (k, s). From the previous step, we have constructed
15

an estimate of V̂i (0, s) and from step 1 we have constructed an estimate of Vbi (k, s) − Vbi (0, s).
Putting these two steps together implies that we have an estimate of Vbi (k, s) for all i, k, s.
The empirical analogue of equations (17) and (20) is then
Z
b i (ai = k, s) = Vbi (ai = k, s) − β
Π

log

K
X

!
exp(Vbi (k, s))) gb(s0 |s, ai = k)ds0 .

(21)

k=0

Standard methods from numerical integration can be used to compute the integrals.
The final step is to perform the empirical analogue of inverting the linear system (8)
b i (ai , a−i , si ). Recall that the state
in order to estimate the nonparametric mean utilities Π
has to be partitioned as s = (si , s−i ) and the variables s−i are assumed not to enter into
i’s mean utilities.

This allows us to write i’s utility as Πi (ai , a−i , si ). One approach to

inverting this system will be to run a local linear regression (see Fan and Gijbels (1992)).
Local linear regression is essentially a weighted least squares regressions where the weights
are defined using a kernel distance between the observations. The exclusion restrictions
guarantee that the standard rank condition from the theory of regression is satisfied.
Without a sufficiently large sample, nonparametric estimators suffer from a curse of
dimensionality and may be poorly estimated. Therefore, it might be desirable to have a
semiparametric approach to the problem where the transition density is specified nonparametrically while the utility functions Πi (a, si , θ) are specified to depend on a finite number
of parameters. Frequently, applied researchers will assume that utility is linear in the structural parameters:
Πi (a, si ) = Φi (a, si )0 θi,a .

(22)

Here, Φi (a, si ) is a known vector valued function and θ is used to weight the elements of
the basis function.
In the semiparametric model, steps 1-3 of the nonparametric section are left unchanged.
It is only necessary to modify step 4 to include the parametric restrictions in (22).
An advantage of the semiparametric estimator is that it can be shown that θb converges to
the true parameter value at a rate proportional to the square root of the sample size and has
a normal asymptotic distribution. This is a common result in semiparametric estimation.
Even though the nonparametric part of our model, σ̂−i (a−i |sm,t ) and Π̂i (ai , sm,t ) can only
be estimated at nonparametric slower rates, the payoff parameters θ converge at the faster
16

parametric rates. Derivation of the limit distribution of the multi-step semiparametric
estimator can be found in a previous online working paper version of this article.

3.8

Unobserved heterogeneity

Unobserved heterogeneity is an important concern for dynamic discrete choice models. A
recent insight from this literature (Hu and Shum (2008), Kasahara and Shimotsu (2008))
is that it is sufficient to estimate a reduced form model of conditional choice probabilities
and transition probabilities that account for the presence of the unobserved heterogeneity.
A variety of such methods are available in the recent literature, some allowing for a fixed
number of support points in the distribution of unobserved state variables while others
allowing for continuous unobserved state variables. For each of the discrete and continuous
support cases of the unobserved state variables, some methods are limited to only non time
varying unobserved state variables while other methods might allow for serially correlated
unobserved state variables.
In the following, we will take as given the ability to estimate a first stage model of
conditional choice probabilities and conditional transition probabilities that incorporate
the presence of general (discrete and continuous, time invariant and serially correlated)
state variables. Therefore, we will assume that it is possible to use one of the methods
available in the existing literature to estimate a reduced form model of σ̂i (k|s) , ∀i, k and
ĝ (s0 |s, a), where now s0 and s include both observed and unobserved state variables that
can be either discrete or continuous, either time-invariant or serially correlated.
We now note that the entire nonparametric identification process in section 3.4 and the
entire estimation procedure, both nonparametric and semiparametric, described in section
3.7, depend only on the first stage σ̂i (k|s) , ∀i, k and ĝ (s0 |s, ai ). Therefore, as long as the
state transition process is assumed to be common across individuals, we can follow exactly
the same procedures outlined in sections 3.4 and 3.7 to estimate the primitive mean utility
functions Πi (a, si ) and Φi (a, si )0 θ. Perhaps the best way to understand this argument
is through simulations. Given knowledge of σ̂i (k|s) , ∀i, k and ĝ (s0 |s, ai ), a researcher can
generate a data set with as many markets and as many time periods as desired, and apply the
estimation procedures described in the previous subsections of section 3.7 to the simulated

17

data set.

4

Efficient Semiparametric and Nonparametric Estimation

In the previous section we described a multi-stage procedure which allows us to estimate
both a finite-dimensional and an infinite dimensional specification of the profit function.
This procedure is very intuitive because it follows directly from the identification argument.
The asymptotic distribution of this estimator also has an explicit analytic structure. However, this approach inherits the disadvantages of many multi-stage estimation techniques.
First of all, the standard errors are hard to compute because of propagation of errors from
the previous steps of the procedure which will depend on the degree of smoothness of the
unknown functions of the model. Second, this multistage estimation procedure is not efficient. It is well known that it is difficult to design multistage estimation procedures that can
achieve efficiency bounds, because each subsequent step has to compensate the estimation
errors that will arise from previous estimation errors.
In this section we will propose an efficient one step estimation procedure using the
framework of conditional moment models. It has the advantage that given the choice of
instrument functions and the weighting matrix, practical inference can be performed using
standard parametric methods as if a finite dimensional linear parametric model of Vi (k, s)
and Π (a, si )0 θ is estimated, as long as the estimation noise in the estimation of σi (k|s) is
appropriately accounted for.
By formulating the model in a conditional moment framework and making use of the
stationary controlled Markov process structure, we can avoid direct estimation of the transition density of the state variable. This simplifies the derivation of the efficiency bound
of the model and the statement of the regularity conditions for the efficient estimator.
The efficient estimation procedure is applicable to both semiparametric and nonparametric
models.

18

4.1

Semiparametric efficient estimation

The conditional moment formulation is derived from the Bellman equations for individual
players. Recall the Bellman equations of interest:
Z
Vi (k, s) = Πi (k, s; γ) + β

X

σ−i (a−i |s) log

a−i ∈A−i

"K
X

#
0

exp (Vi (l, s )) g (s0 |s, ai = k, a−i ) ds0 ,

l=0

where
σi (ai = k|s) =

exp (Vi (k, s))
K
P

,

exp (Vi (l, s))

l=0

di,l

for i = 1, . . . , n and k = 0, . . . , K. Denote
the dummy for choice l by player i. We can
use the second equation to substitute it into the first one, which leads to n × K conditional
moment equations for each (T − 1) × M observations:

E di,k
m,t (Vi (0, sm,t ) − βVi (0, sm,t+1 ) + β log σi (0|sm,t+1 ))
−di,k
m,t



1−

di,0
m,t





(23)

[Πi (ai , a−i , sm,t ; γ) + log σi (0|sm,t ) − log σi (ai |sm,t )] sm,t = 0.

Together with the following n × (K + 1) moment conditions for each T × M observations,


E di,k
|s
= σi (k|sm,t ) ,
(24)
m,t
m,t
(23) and (24) form a system of conditional moment restrictions that fully characterize the
implications from the structural dynamic discrete choice model. This system of conditional
moment restrictions can be used to obtain asymptotically normal semiparametric estimators
that can achieve the semiparametric efficiency bound by adapting the recipe prescribed in
Ai and Chen (2003). In their notation of E [ρ (wm,t , γ, V (·) , σ (·)) |sm,t ] = 0, where wm,t are
all the random variables in the model, γ are the finite dimensional parameters, V (·) and
σ (·) are the infinite dimensional unknown parameters, we can write, for h (·) = (V (·) , σ (·)):
0
ρ (wm,t , γ, h (·)) = ρ1 (wm,t , γ, V (·) , σ (·))0 , ρ2 (wm,t , γ, V (·) , σ (·))0 ,
i ,k
where ρ1 is the T × m × n × K dimensional collection of dam,t
− σi (k|sm,t ), and

ρ2 (wm,t , γ, V (·) , σ (·)) = di,k
(V (0, sm,t ) − βVi (0, sm,t+1 ) + β log σi (0|sm,t+1 ))

m,t i
i,k
ai ,0
−dm,t 1 − dm,t [Πi (ai , a−i , sm,t ; γ) + log σi (0|sm,t ) − log σi (ai |sm,t )] .
19

Strictly speaking, the original efficiency bound in Ai and Chen (2003) requires the same
conditioning variables in the moment restrictions. However, for each m = 1, . . . , M , the
collection of moment conditions in (23) and (24) involve different conditioning variables
st , t = 1, . . . , T − 1. In addition, the moment condition (24) can also be used at time t = T .
Fortunately, the Markov structure of the model implies that conditioning on st is equivalent
to conditioning on s1 , . . . , st . Therefore the conditioning sets form an increasing sequence of
sigma-algebra, and the sequential conditional moment model of Ai and Chen (2009) applies
to substantiate the semiparametric efficiency bound.
The conditional moment restrictions in (23) and (24) can be transformed into unconditional moments by forming an instrument matrix zm,t using the state variables sm,t , its
lags sm,t−τ and polynomial powers sm,t and its lags, such that the number of instruments
in zm,t increases at appropriate rates as the sample size increases to infinity. Equations (23)
and (24) implies the following moment vectors with elements


σ (ai |sm,t+1 )
σ (ai |sm,t )
i,p
− β log σii (0|s
E dm,t zm,t Vi (0, sm,t ) − βV (0, sm,t+1 ) + log σii (0|s
m,t )
m,t+1 )


− 1 − di,0
m,t [Πi (ai , a−i , sm,t ; γ) − β log σi (ai |sm,t+1 )]

i,0
+dt β log σi (0|sm,t+1 )
= 0,


and Ezm,t di,p
−
σ
(p|s
)
= 0. To estimate γ we can follow two steps.
i
m,t
m,t
Step 1
We approximate the conditional choice probabilities using orthogonal series:
σi (ai = p | s) = q k1 (M T )0 (s) b1i,p + ∆k1 (M T ) ,
and approximate the value function similarly
Vi (0, s) = q k2 (M T )0 (s) b2i + ∆k2 (M T ) ,
where ∆k1 (M ) and ∆k2 (M T ) are numerical approximation errors that decrease to zero as
k1 (M T ) and k2 (M T ) increase to infinity with M T at appropriate rates.
Step 2
Next we form an instrument zm,t by stacking an orthogonal series of functions of the state
20


variables sm,t , q0 (sm,t ) , . . . , qk3 (M T ) (sm,t ) . This produces an over-identified empirical


i , ∀i, p ,
moment vector with the elements, for b = bi,p
,
b
2
1
ϕ
b (γ, b) =

X

ϕm,t (γ, b)

where ϕm,t (γ, b) = ρ (wm,t , γ, b) ⊗ zm,t .

m,t

Then we introduce a weighting matrix W with both row and column dimensions dim (zm,t )×
dim (ρ).

In the simplest case we can use the identity matrix in lieu of W.

Using a

given weighting matrix we form a GMM objective and minimize it with respect to parameters of interest γ as well as the parameters of the expansion of the value function
min ϕ
b (γ, b)0 W ϕ
b (γ, b) . In particular, as shown in Ackerberg, Chen, and Hahn (2011), if
γ, b

we let Z ≡ (zm,t , ∀, m, t)0 denote the data matrix for the instruments, the following choice
of the weighting matrix
!
0

W=I⊗ ZZ

−1

X

Ω−1
m,t

⊗

0
zm,t zm,t

I ⊗ Z 0Z

−1

.

m,t

yields the semiparametric minimum distance estimators of Ai and Chen (2003). In the above
Ωm,t is a candidate estimate of the conditional variance covariance matrix of ρ (wm,t , γ, h (·))
given sm,t . When Ωm,t ≡ I an identity matrix, the estimator becomes a nonlinear two stage
least square estimator. When Ωm,t = Ω is homoscedastic across observations, this becomes
a nonlinear three stage least square estimators. Semiparametric efficiency bound is achieved
when Ωm,t is a consistent estimate of V ar (ρ (wm,t , γ, h (·)) |sm,t ), in which case it becomes
a heteroscedasticity weighted nonlinear three stage least square estimator. When ρ (·) is
a scalar, the semiparametric efficient minimum distance estimator is a weighted nonlinear
two stage least square estimator.
Remark 1:
By appropriate choices of the instrument functions and the weighting matrix, the conditional
moment framework also incorporates the multistage procedure in the previous section as
special cases. If the same orthogonal series is used in approximating Vi (0, sm,t ), σi (p|sm,t )
and in obtaining the instruments, and if k1 (M T ) = k2 (M T ) = k3 (M T ), the instrumented
moment conditions (24) are exactly identifying, and σi (p|s) are computed from least square

21

regressions:
!−1
σ
bi (ai = p | s) = q

k(M T )0

(s)

X

q

k(M )

(sm,t ) q

k(M T )0

(sm,t )

m,t

X

q k(M T ) (sm,t ) dat i ,p .

m,t

Given the estimate of σ
bi (ai = p | s), the component of the instrumented moment condition ρ2 (wm,t , ·) that corresponds to k = 0 is also exactly identifying and depends only
on Vi (0, s). Hence Vi (0, s) can be estimated by a single equation two stage least square
regression with dependent variables β log σ
bi (0|sm,t+1 ), independent variables q k(M T ) (sm,t )−
βq k(M T ) (sm,t+1 ) and instrument matrix q kM T (sm,t ). Subsequently, given estimates of Vbi (0, s)
and σ
bi (ai = p | s), the parameters
γip

=



p
γi,a
, ∀a−i
−i



,

for i = 1, . . . , n, p = 1, . . . , K in a linear profit function specification Πi (p, a−i ; γ) =
Φi (p, a−i )0 γip , can be estimated by single equation linear two stage least square regression
methods when Ω (xi ) ≡ I, with dependent variables
σ
bi (ai |sm,t )
1
− β log
Yi,p,m,t = Vbi (0, sm,t ) − β Vb (0, sm,t+1 ) + log
σ
bi (0|sm,t )
σ
bi (0|sm,t+1 )
and the vector of independent variables Xt with elements


Xi,p,m,t = − 1 − di,0
m,t Φi (p, a−i ) ,
and instrument matrix Z = (zm,t , ∀m, t)0 . Efficiency can be improved by weighted 2SLS or
weighted 3SLS by choosing Ω̂ (xi ) appropriately.
Remark 2:
The semiparametric efficient minimum distance estimator of Ai and Chen (2003) can be
interpreted both in light of weighted nonlinear three stage least square estimator and the
efficient instrument method of Newey (1990) for finite dimensional parameters. The semiparametric minimum distance objective function can be equivalently rewritten as
X
ρ̂ (sm,t , b, γ)0 Ω̂−1
m,t ρ̂ (sm,t , b, γ) ,
m,t

22

where ρ̂ (sm,t , b, γ) is an estimate of E (ρ (wm,t , b, γ) |sm,t ),
ρ̂ (s, b, γ) = z Z 0 Z

−1 X

zm,t ρ (wm,t , b, γ)0 .

m,t

Its first order condition resembles the efficient instrument estimator of Newey (1990):
X
m,t

∂
ρ̂ (sm,t , b, γ)0 Ω̂−1
m,t ρ̂ (sm,t , b, γ) .
∂ (b, γ)

The efficient instrument estimator of Newey (1990) only differs in using ρ (sm,t , b, γ) in place
of the second ρ̂ (sm,t , b, γ) in light of the law of iterated expectation, and instead uses the
first order condition of
X
m,t

∂
ρ̂ (sm,t , b, γ)0 Ω̂−1
m,t ρ (sm,t , b, γ) .
∂ (b, γ)

The following theorem adapts the semiparametric efficiency bound in Ai and Chen (2003)
to our model. In our model the unknown function V (·) enters non-linearly as a function of
the state variable in the period t and in the period t + 1.
Using the results from Ai and Chen (2003) we can provide the semiparametric efficiency
bound for estimating the parameter γ of the payoff function. Denote
Σ0 (sm,t ) = Var (ρ (wm,t , γ0 , h0 (·)) |sm,t ) .
The semiparametric efficiency bound expressed in theorem 3 will depend on the functional
derivatives of the moment conditions ρ1 in (23) and ρ2 in (24) on the unknown functions
hi1 (·) = Vi (0, ·) and hi,k
2 (·) = σi (k|·). The functional derivative of the conditional moment functions with respect to these unknown functions can be expressed using the linear
expectation operator


Pik ◦ f = E f (sm,t+1 ) | sm,t = s, aim,t = k ,
where expectation is defined for the conditional density
X
g (sm,t+1 |sm,t = s, ai = k, a−i ) σ−i (a−i |sm,t = s) .
a−i

23

n
o∞
The operator Pik ◦f is assumed to have a discrete spectrum with eigenfunctions Θi,k
(s)
j
j=0
n
o∞
i,k
different from zero. Then we can find that
and eigenvalues λj
j=0

h
i
d E ρi,k
(w
,
γ
,
h
(·))
|s
m,t
0
0
m,t
1
d hi1

[ψ] = σi (k|s)

∞
X



ψj 1 − βλi,k
Θi,k
j
j (s) ,

j=0

(
for all sequences of real numbers ψ which belong to H =

ψ

)

∞
P

|ψj |

j=0

Furthermore, we also calculate that
i
h
(w
,
γ
,
h
(·))
|s
d E ρi,k
m,t 0 0
m,t
1
d hi,0
2


[ψ] = βE

di,k
m,t

and for k 6= 0 the linear derivative of,
i
h
(w
,
γ
,
h
(·))
|s
d E ρi,k
m,t 0 0
m,t
1
d hi,k
2

Θi,k
j

(s) < ∞ ,


1
i,0
h (sm,t+1 ) |sm,t .
σi (0|sm,t+1 ) 2

[ψ] = hi,k
2 (sm,t ) .

Finally, for all k,
i
h
(w
,
γ
,
h
(·))
|s
d E ρi,k
m,t 0 0
m,t
2
d hi,k
2

[ψ] = −hi,k
2 (sm,t ) .

The functional derivatives in the direction of the unknown functions

d E[ρ(wm,t ,γ0 ,h0 (·))|sm,t ]
dh

are formed by stacking the above individual components together.
Then for each component of γ solve the minimization problem


d E[ρ(wm,t ,γ0 ,h0 (·))|sm,t ]
d E[ρ(wm,t ,γ0 ,h0 (·))|sm,t ]  (j,0) 
−
ψ
Σ0 (sm,t )−1
min E
d γj
dh
ψ (j,0) ∈H

×



d E[ρ(wm,t ,γ0 ,h0 (·))|sm,t ]
d γj

−

d E[ρ(wm,t ,γ0 ,h0 (·))|sm,t ]
dh



ψ (j,0)



.

Form the vector
Dψ(0) (sm,t ) =

d E [ρ (wm,t , γ0 , h0 (·)) |sm,t ] d E [ρ (wm,t , γ0 , h0 (·)) |sm,t ] h (0) i
−
ψ
.
d γ0
dh

The following theorem follow directly from the result provided in Ai and Chen (2003):
24

[ψ]

Theorem 3 The semiparametric efficiency bound for estimation of γ in equation (23) can
be found as
h
i−1
.
V (γ) = E Dψ(0) (sm,t )0 Σ0 (sm,t )−1 Dψ(0) (sm,t )

4.2

Asymptotic distribution for semiparametric estimator

We impose the following regularity assumptions on the functions in the model to assure that
the two-stage conditional moment-based estimation method delivers consistent estimates for
the Euclidean parameter in the per period payoff function as well as the non-parametric
estimate of the continuation value of players.
Assumption 3
1. Parameter space Γ is a convex compact set. Profit function Πi (ai , a−i , s; γ) is continuous
in γ for each (ai , a−i ) ∈ A. Moreover, for each γ ∈ Γ profit function is bounded:
sup

|Πi (ai , a−i , s; γ)| < ∞.

a∈A, s∈S

2. The data

n
oM
T −1
{a1t , . . . , ant , st , st+1 }t=1

m=1

are i.i.d. generated by the stationary distribu-

tion determined by Markov transition kernel for the state variable.
3. The approximating series expansion {q k(M T ) } forms a basis in C k(M T ) (S), such that the


eigenvalues of E q k(M T ) (st+1 ) q k(M T )0 (st+1 ) |st = s are bounded away from zero for all
s ∈ S. The operator
Pi ◦ f = E [f (sm,t+1 ) | sm,t = s, ai ] ,
where expectation is defined for the conditional density
X
g (sm,t+1 |sm,t = s, ai = k, a−i ) σ−i (a−i |sm,t = s) ,
a−i

n
o∞
which has a discrete spectrum with eigenfunctions Θi,k
(s)
such that for each j we can
j
j=0

find

j0

≤ j for which

k(M T )
hqj
,

Θi,k
j i

=
6 0. In addition,


i
k(M T )
q
< ∞.
lim sup E (T M )−1/2 1 + βΛi,k
j
j
h

m→∞

25

4. The value function Vi (st ) is piece-wise continuous on S and bounded. Moreover, for each
h
2 i
Vi (·) ∈ V there exists a vector µ ∈ Rk(n) such that E V (st ) − µ0 q k
= o (1).
5. For a given V (·) and transition density, there exists a unique solution γ ∈ Γ to the system
of equations
E [ϕi (st , st+1 , a; Vi , γ) | st ] = 0,
for i = 1, . . . , n.
These assumptions allow us to apply the results from Newey and Powell (2003) for each
order of approximation k(M T ). By the appropriate choice of basis we can guarantee that
the approximation error is negligible as compared to the estimation error. The estimation
problem is linear in parameters: expansion coefficients for V (·) and the Euclidean parameter
γ. For each finite approximation order k(M T ) we can assure that the estimated parameters
are consistent estimates for the functions given the order of approximation. When M T → ∞
approximation error approaches zero and the estimated coefficients will be consistent for
the true coefficients. Given that by assumption the value function admits consecutive
approximations in the basis {q K (s)} for each K ∈ N, the fitted values bbK0 q K (s) will be
consistent for the true value function in the limit.
We can provide a similar set of assumptions that will assure the asymptotic normality
of the estimates.
Assumption 4

1. There exists a metric k · ks such that the product space V × Γ is

compact. Moreover, the space {q ∞ (s)} × Γ is dense in V × Γ for the chosen metric.
2. For the covering number in the family of the moment functions defined by consecutive
series approximations


log N ε, {q

k(M T )



(s)} × Γ, k · ks ≤ Ck(M T ) log



k(M T )


3. The weighting matrix can be estimated consistently such that


Ab (s, da ) − A (s, da ) = op (M T )−1/4 .

26


.

k(M T )

Moreover for each kµ − µ0


k < C(M T )−1/4 and each kγ − γ0 k < C(M T )−1/4

 



Ab (s, da ) − A (s, da ) ϕ s0 , s, a; µ0 q k(m) (s), γ = op (M T )−1/4


4. The variance of the moment function Var

ϕ (s0 , s, a; V0 , γ0 )


s is positive definite for

all s ∈ S.
5. For each direction h ∈ C k(m) (S) we define the directional derivative of the moment func  

∂ϕ
,
, where
tion as a vector ∂h ϕ = ∂ϕ
∂γ
∂V
h

∂ϕi
∂Πi (ai , a−i , s; γ)
=
, and
∂γ
∂γ



∂ϕi
∂Vi


=
h

∞
X



hj 1 − βλi,k
Θi,k
j
j (s) .

j=0

We assume that in the ball of radius C(M T )−1/4 around the true value (V0 , γ0 ) in V × Γ
the directional derivative ∂h ϕ is Hölder-continuous with respect to norm k · ks and bounded
above by a linear functional of h, F [h] such that E [F [h]] < ∞. Choose h∗ such that



E ∂h ϕ (V0 , γ0 )0 E A (st+1 , da ) A (st+1 , da )0 st=s ∂h ϕ (V0 , γ0 )
is minimized with respect to h. Then uniformly in the chosen ball




E k∂h∗ ϕ (V0 , γ0 ) − ∂h∗ ϕ (V, γ)k2 = o (M T )−1/4 ,
where we use a standard Euclidean norm.
The following theorem is an immediate consequence of Ai and Chen (2003), which we
state without proof.
Theorem 4 Under assumptions 3 and 4, for γ̂ defined in steps 1 and 2 of the previous
p

section, γ̂ −→ γ0 , and for V (γ) given in theorem 3
√

d

M T (γ̂ − γ0 ) −→ N (0, V (γ)) .

27

4.3

Nonparametric estimation

The moment equation (23) in general does not depend on the dimensionality of the payoff parameter γ. While making γ infinite-dimensional will cost the loss of the parametric
convergence rate, a fully nonparametric estimation procedure of the per-period payoff function is feasible because of the identification results, and is implementationally essentially
equivalent to the efficient estimation procedure in the semiparametric case.
Step 1 Estimate conditional choice probabilities non-parametrically using the orthogonal series representation:
!−1
σ
bi (ai = p | s) = q k(M T )0 (s)

X

q k(M T ) (sm,t ) q k(M T )0 (sm,t )

m,t

X

q k(M T ) (sm,t ) di,p
t .

m,t

Step 2
Consider a series approximation for the value function
Vi (ai = p, s) = q k(M T )0 (s) bi,p + ∆k(M T ) ,
where ∆k(M T ) is a numerical approximation error, and consider a similar expansion for the
payoff function
Πi (ai = p, a−i , s) = q k(M T )0 (s) γ i,p,a−i + ∆0k(M T ) .
For implementability of the procedure at this step we need the payoff function to be continuous (or, at least, to have a finite set of points of first-order discontinuity). Next we form
an instrument zm,t by stacking the state variables sm,t across the markets to form vectors
st , and then choosing the linearly independent subset of vectors from the collection

q0 (sm,t−τ ) , . . . , qk(M ) (sm,t−τ ) ,
for all 0 ≤ τ ≤ t − 1. Additional instruments come from other functions of am,t and the
estimated choice probabilities σ
bi (j|sm,t+1 ). This produces an empirical moment vector with

28

2k(M ) unknown expansion coefficients with the elements

TP
−1

i,p0 q k(M ) (s
k(M ) (s
ϕ
bi,p (γ, b) = T1
di,p
z
m,t ) − βq
m,t+1 )
t b
t
t=1



− 1 − di,0
t




q k(M )0 (s) γ i,p,a−i − β log σ
bi (ai |sm,t+1 )
!
K
P
i,0
+dt β log 1 −
σ
bi (j|sm,t+1 )
.
j=1

Then we introduce a weighting matrix W with dimensions n K m dim (zt ) × n K m dim (zt ).
In the simplest case we can use the identity matrix in lieu of W. For this weighting matrix
we form a GMM objective and minimize it with respect to parameters of interest γ as well
as the parameters of the expansion of the value function
min ϕ
b (γ, b)0 W ϕ
b (γ, b) .
γ, b

In this estimation procedure the object of interest is the entire surface of the profit function,
which can be computed as
b i (ai = p, a−i s) = q k(M )0 (s) γ
Π
bi,p,a−i .
We need to determine the conditions that assure consistency and non-degeneracy of the
asymptotic distribution of the pointwise estimate of the payoff function as well as find
the rate of convergence of the estimator. Previous we imposed conditions that assure
convergence of the semiparametric estimator. We can supplement them with additional
assumptions which will provide consistency and asymptotic normality in the non-parametric
case.
Assumption 5

1. The payoff function Πi (ai , a−i , ·) belongs to the functional space C p (S)

for p > 1. Moreover, the orthocomplement of projecting the payoff function onto some
Hilbert space H, defined by the set of basis functions {qt (·)}pt=0 with the scalar product
h·, ·i has a norm in C ∞ (S) decreasing in p. Moreover its projection on the first p basis
vectors converge absolutely, uniformly in the argument as p → ∞.
2. For a truncation sequence k(m) < m2r the error of approximation of Πi (·) and V (·)by

k(m)
the basis function {qt (·)}t=0 is o m−2r with respect to the norm implied by the scalar
product in H.
29

3. σ
bi (ai |ai , ·) is asymptotically normal pointwise in Ω and converges at rate q. The truncation sequence k(m)0 giving the convergence rate mq is o (k(m)0 ). The approximation
error of hi (·) with respect to the norm in H is of order smaller than mq .
This set of assumptions allows us to formulate the following theorem, which is proven in
the appendix. The asymptotic variances ωv2 and ωπ2 are also defined in the appendix.
Theorem 5 Given assumption 3, 4 and 5,



d
k(m)
(s) − Vi (s) −→ N 0, ωv2 ,
mmin {q,r} Vbi
and



d
b k(m) (ai , a−i , s) − Πi (ai , a−i , s) −→
mmin {q,r} Π
N 0, ωπ2 .
i

5

Simulations

To demonstrate the performance of proposed estimators in finite samples, we conduct two
sets of numerical simulations. The first set is a simple two by two entry game with discrete
state variables and the second set is a single agent dynamic discrete choice model with
continuous state variables.

5.1

Simulation setup

In the first set of numerical simulations, each of the two players has one state variable
that takes two possible values. Each player simultaneously decides whether to enter a
market. The payoff to not entering into the market is normalized to zero regardless of
the action of the competing player. We construct the payoff function as Πi (ai , a−i ) =
U1 1(ai = 1) + U2 1(a−i = 1) where U1 and U2 for each Monte Carlo sample are taken
as independent draws from the uniform distribution between -2 and 2. The payoffs of
players are independent across both the combination of the states and across the actions of
the competing players. Therefore, we do not impose restrictions on how the action of the
competing player affects the payoff to entering into the market, and allow the actions of
both players to be either substitutes or complements. The transition probability matrices
30

for a new state condition on the previous state and the actions of both players are also
randomly generated from uniform distributions between 0 and 1. They are normalized so
that the transition probability matrix is a proper stochastic matrix. The discount rate is
set to 0.9.
Once generated, the payoff matrix and the transition probability matrices are held
constant across the simulation runs. Following the recipe described in the estimation section,
we first estimate the entry probabilities from independently generated data on the entry
indicators, and then invert out the choice specific continuation value function and the choice
specific static expected utility function. Finally, the primitive payoffs are recovered from
the choice specific static expected utility functions.
Tables 1 to 4 report the results across 1000 simulation runs. The number of markets
(nmarket), reported in the following tables refer to the number of observations (markets)
generated for each combination of the state variables. The columns labelled “1st quartile”,
“median”, “mean”, “3rd quartile” and “std” refer to the deviation of the estimates from
the true parameters.
These tables show that the estimator performs well in finite sample, and that the amount
of estimation error decreases monotonically as the sample size increases.
In the second set of numerical simulations for a single agent dynamic discrete choice
model. We construct this exercise in a “reverse” way. We generate the data from a reduced form system of choice probabilities. Given that we know the functional form of the
reduced-form probabilities, we can also use the methods of numerical integration to recover
the per-period payoff function that corresponds to the specific choice probabilities and a
specific state transition process. The goal of this empirical exercise is to compare the payoff
function estimated from the sample, generated by the state variable and the policy function using our one-stage estimation method and the utility function that we can recover
by numerically solving the first-order condition for the player. We keep indexing variables
by i to maintain the coherence with our theoretical analysis. The state variable follows a
continuous distribution and evolves continuously according to a normal AR(1) process:
st = ϕ (ai ) st−1 + σ εt ,
where εt is a standard normal random variable and ϕ (ai ) = 0.81(ai = 0) + 0.31(ai = 1).
31

The probability of choosing action 1 is assumed to take the following flexible functional
form:
σi (ai = k | st ) = α0ik + α1ik st +

α2ik s2t

+

J
X

[β0j + β1j cos (pj st ) − β2j sin (pj st )] ,

j=1

where parameters α are fixed. Now for known state transition and choice probabilities we
can recover the corresponding per period payoff function using a high-order finite-point
approximation formulas for integrals. We normalize the payoff Πi (·, ai = 0) = 0 and aim at
recovering the function Πi (·, ai = 1). We begin with describing the numerical computation
algorithm.

5.2

Determining the base value function

For each player i the value function associated with choice 0 can be expressed as

K
+∞
(s0 −ϕ(0) s)2
R
P
0
ds0 .
exp (Vi,r (s )) √ 1 2 e− 2σ2
Vi (0, s) = β
log
−∞

Using the relation σi (k | s) =

2πσ

r=0

exp(Vi,k (s))
,
K
P
exp(Vi,r (s))

this expression can be written as a functional

r=0

relation to solve for the continuation value function:
Vi (0, s) = β

+∞
R

[V0 (0, s0 ) − log σi (0 | s0 )] √

−∞

1
e−
2πσ 2

(s0 −ϕ(0) s)2
2σ 2

ds0 .

The value function will be approximated on a discrete uniform grid using linear extrapolation and the integral will be approximated by a Gauss-Hermite Gaussian quadrature
method. The value function for the grid points will be solved from a system of linear
equations. In particular, by a change of variables
β
Vi (0, s) = √
π

+∞
Z
h  √

 √
i
2
Vi 0, 2σ x + ϕ (0) s − log σi 0 2σ x + ϕ (0) s e−x dx
−∞

N


i
√
√
β X h 
≈√
ωn Vi 0, ± 2σ xn + ϕ (0) s − log σi 0 ± 2σ xn + ϕ (0) s ,
π n=1

32

where ωn are the weights and xn are the points of 2N -point Gauss-Hermite quadrature
approximation for the integral of interest. We aim to solve for the value function at a
uniform grid SG = {s1 , s2 . . . , sG } for the state variable: Vi (0, sg ) = Vi,0,g . For numerical
computations we will use linear interpolation. The intermediate values of the value function
will be approximated by linear interpolation: for instance, if s ∈ [sg , sg+1 ] then Vi (0, s) ≈
Vi,0,g+1 −Vi,0,g
sg+1 −sg

(s − sg ). Let ξg,n,p correspond to the index of the grid point that is
√
not further from the point (−1)p 2σ xn + ϕ (0) sg than the cell length and has the smallest

Vi,0,g +

absolute value. Then the discretized Bellman equation can be written as G linear equations
for the grid function:
N
1

β XX
Vi,0,g − √
ag,n,p V1,0,ξg,n,p + bg,n,p Vi,0,ξg,n,p +1
π n=1 p=0
N P
1
√

P
= − √βπ
ωn log σi 0 (−1)p 2σ xn + ϕ (0) sg
n=1 p=0

Denote ∆ the step of the grid. Then we can express the above coefficients as
√


ag,n,p = ∆β√π ωn sξg,n,p +1 − (−1)p 2σ xn − ϕ (0) sg ,
bg,n,p =

5.3


β
√ ω
(−1)p
∆ π n

√


2σ xn + ϕ (0) sg − sξg,n,p .

Simulation Results

We compare the utility function that we obtain from a numerical solution of the Bellman
equation with the estimated payoff that we obtain using our method. The following table
tabulates the integrated difference between the utility function that is numerically computed
and the utility function that is estimated from a randomly generated sample. We use the
b i,T (·, ai = 1) is
stationary density of the state variable for the comparison. Specifically, if Π
the estimated utility from sample of size T and Πi (·, ai = 1) is the numerical solution, the
reported criterion is
QT =


√ Z 
b i,T (s, ai = 1) − Πi (s, ai = 1) π(s) ds,
T
Π
S

where π(·) is the stationary density of the state variable. We obtain this integral using
the Monte-Carlo integration technique. To do so we make the joint draws from the state
33

variable transition and the decision rules using a preliminary draw of the state variable. We
generate the state variable as well as the policy rule as a Markov chain until it reaches the
stationary distribution (we determine that by the behavior of the distribution mean across
the blocks of consecutive draws). Then if Ns is the number of draws from the stationary
distribution, we compute the approximate criterion
√

s
QN
T

Ns 

T X
b i,T (st , ai = 1) − Πi (st , ai = 1) .
Π
=
Ns
t=1

This object converges to the integral of interest as the number of draws increases. For our
purposes we use 2.5 million draws.
As table 5 shows, the nonparametric procedure for recovering the primitive utilities
works well in finite samples. In particular, just to the give the reader a visual sense of the
shape of the value function that is being recovered in the simulation, the following figure
illustrates the median of numerically recovered utility with top and bottom 10% quantiles
for 600 Monte-Carlo draws. The horizontal axis represents the value of the state variable,
while the vertical axis represents the value of the recovered utilities.

6
6.1

Empirical Application
Data

We apply our identification and estimation results to analyze an empirical model of consumer choices using an IRA scanner data set of supermarket purchases of potato chips.
The scanner data include multiple supermarket locations in two separate geographic areas.
It contains over 900 different product types, some of which are not available in all areas.
The panel data structure cover 312 weeks of purchases at 54 supermarkets in Pittsfield,
MA and Eau Claire, WI. The products are categorized into 20 major brands that account
for over 97% of the total market. The remaining brands are combined into a single brand
category “other brands”. The market is dominated by “Lays” (the label of Pepsico inc.),
which has a 45% share, and the second largest brand is “Pringles” (the label of Procter
& Gamble). The empirical question we investigate is the demand elasticity with respect
to price discounts. Since potato chips have long expiration periods and can be purchased
34

outside vendors outside of the supermarkets, we expect that demand reacts elastically to
price discounts due to substitution and stockpiling effects.
The purchase prices in this data set vary substantially from 5 cents to $6.99, and the
average time between purchases varies from 1 to 285 weeks for returning consumers (Table
8). On average, the market share of a brand increases by 20% when it is offered at a
discounted price. For most brands, market shares are highly correlated with the shares
of inventory on sale. Volume discounts are prevalent. The price per ounce for the largest
packages is almost half the price per ounce for the smallest packages. These reduced-form
evidence indicates a high correlation between price discounts and purchase behaviors.
The market shares of various Potato chip products are persistent over time. In Figure
2, the cross product variation at a given time substantially exceeds the variation of product
share over time for the same product. In the data price promotions occur regularly. Some
brands having price discounts as frequently as 50 % of the time. Consumers appear to be
responding to the posted price drops. Table 6 displays summary sale statistics and frequency
of promotions across products. .7The reported statistics correspond to the parameters of
distribution of sales aggregated by time and markets and sales aggregated by time and
brand, to the consumers surveyed in the panel. The sales averaged over time and market
range from 11 cents to $1795. The sales averaged over brand and time range from 25 cents
to $1849 per week. The sale distribution has a long tail with a visible concentration at the
bottom. This is due to small sales in some markets and small sales of certain brands.
Table 7 compares the market shares of brands following a week with price promotion and
the market shares of brands during the same number of weeks when no price promotion has
previously occurred. The mean as well as the 25, 50 and 75% quantiles of the market share
distribution are all significantly higher for the promoted products. Figure 3 also shows that
the histogram of log-market shares has visibly lower mode and mean for periods following a
week without price promotion. In contrast, log-market shares concentrate at higher levels
following a period of price promotions. The effect of promotion effect can also be visualized
by the time path of log-market share and promotion timing for particular products. Figure
4 shows the market share of Classic Lay’s chips over time with a spline-smoothed graph.
The market share of Classic Lay tends to increase following the price promotion, and it

35

decreases when the price promotion is absent.
Additional evidence on the effect of price promotion on the transition of the market
shares over time is reported in Figure 5, which summarizes the results of a nonparametric
regression of the log-market share on the lagged log-market shares, separately for the cases
where there was a price promotion in the previous period and where there were no promotions. It is clear from figure 5 that log-market share tends to be higher in the periods
following the price promotion. Even the periods without the price promotion, we observe a
strong positive relationship between the past and the present log-market shares, suggesting
persistent non-price product-specific fixed effects. While a similar pattern is also observed
in the period following a price promotion, the effect of price promotion is very large and
outweighs the effect of the product characteristics.
Table 12 reports the results of a set of models in which we regress log market shares
on price, a dummy variable for promotion and various product characteristics. Product
characteristics include package size, fat content, sodium content, cooking method, brand
name and shape. The three columns in table 12 correspond to OLS, a linear IV regression
using the sums of product characteristics of the other products and the demographic information of consumers as instrument, and nonlinear BLP IV demand function with the same
instruments. The largest value for the price coefficient was obtained in the BLP model with
fixed coefficients. To estimate the BLP we used the same instruments as in the IV setup.
The price promotion dummy has a similar range for all of the estimated models.
Brand level demand estimates accounting for time lags from the previous discount promotion are reported in table 13. The demand elasticity is estimated at 1.6 for the entire
sample which varies from 1.7 for estimates in the sale periods only to 1.5 in the periods
not on sale. In addition, the overall demand is lower for the products that are on sale less
frequently, although the effect of sale frequency on demand is diminishing. The estimates
of the price elasticity are compatible with those obtained using the BLP approach on the
product level. As expected, the fraction of purchases of potato chips on sale is higher for
households with lower income and higher for larger households. The share of products
purchased on sale is higher for unemployed individuals as well as for students and retirees.

36

6.2

The Empirical Model

To account for forward-looking consumers and their stockpiling behavior, we need to estimate a dynamic choice model to distinguish between short term demands and long term
demands. Applying the nonparametric and semiparametric estimators discussed earlier in
the paper, however, is complicated by the presence of unobserved heterogeneity in consumer
demand at the individual level. The presence of unobserved heterogeneity is reflected in
the higher price elasticity in the household level demand than in the aggregate brand level
demand. Unobserved consumer characteristics that affects their tendency to stockpile are
likely to be persistent but can also vary over time.
Methods to account for the presence of unobserved heterogeneity are developed by Aguirregabiria and Mira (2007), Arcidiacono and Miller (2006), Kasahara and Shimotsu (2008)
among others. In particular, Hu and Shum (2008) allows for nonparametric identification of
continuously distributed and serially correlated unobserved heterogeneity. These methods
are not only more advantageous in nonparametric identification but also more computationally feasible. It is prohibitive to compute the consumer decision rules in the nested fixed
point maximum likelihood method due to the rich state space in most consumer choice
models. In our data of price promotion with 21 brands over 1000 households, storing 1000
value functions defined over 20 continuous variables of market shares on a discretized grid
of 100 points in single precision will require a total memory of exceeding 10200000 Terabytes.
We augment an infinite horizon heterogeneous consumer model using the nonparametric
identification and estimation method cited above. Each period t = 1, . . . , ∞ is associated
with the visit of a particular consumer to the store. Each product j = 1, . . . , J is characterized by a vector of observable characteristics xjt , price pjt , and scalar product-consumer
specific unobservable characteristic νijt . The utility for consumer i from purchasing product
j in period t is given by
uijt = x0jt β − αpjt + νijt + εijt = vj (pjt , xjt ) + νijt + εijt ,
where pjt is the price of product j and εijt is an i.i.d. idiosyncratic preference shock
according to the extreme value distribution. We assume that pjt follows a first-order Markov
process the stationary distribution being continuous on compact support. Consumers are
37

forward looking and maximize the expected lifetime discounted utility. We also assume that
conditional on ξt , δt , dt , (ξt+1 , δt+1 ) are independent of (pt+1 , xt+1 ).
Denote pt = (p1t , . . . , pJt ) the vector of current period prices and νit = (νi1t , . . . , νiJt )
the vector of product-consumer-specific characteristics. The ex ante continuation value of
consumers, denoted Vi (pt , νit ), only depends on the current state variables because of the
Markov transition assumption. The choice-specific value function of choosing product j is
Vij (pt , νit ) = vj (pjt , xjt ) + νijt + βE [V (pt+1 , νi,t+1 ) | pt , νit , dit = j] .
The static utility of the outside option of no purchase, indexed by k = 0, is normalized to
zero. The corresponding choice specific value function of outside purchase is
Vi0 (pt , νit ) = βE [V (pt+1 , νi,t+1 ) | pt , νit , dit = 0] .
We consider a model in which νijt = ξjt + δit , where the unobserved product characteristic
has both a product-specific component ξjt that is common across the consumers a the same
instance of time, and a consumer-specific component δit that is common across different
brands for the same consumer. We assume that ξjt and δit both have finite support with
K points, denoted by {zk }K
k=1 , and that they follow first-order Markov processes according
to the choice d.
In the presence of unobserved product characteristics both the value functions and the
choice probabilities depend on the unobserved components. For example,
Vij (p, x, ξ, δ) = vj (pj , xj ) + ξj + δ − βE [log σij (pt+1 , xt+1 , ξt+1 , δi,t+1 ) | p, x, ξ, δ]
+ βE [Vij (pt+1 , xt+1 , ξt+1 , δi,t+1 ) | p, x, ξ, δ] ,
for choices j = 1, . . . , J, and
σij (p, x, ξ, δ) =

exp (Vij (p, x, ξ, δ))
J
P

, j = 0, . . . , J.

exp (Vik (p, x, ξ, δ))

k=0

While σij (p, x, ξ, δ) are not observed, they are related to the observed choice probabilities
through the relation
σij (p, x) =

K X
K
X

σij (p, x, ξ = zk , δ = zp )πi,δ (zp )πj,ξ (zk ).

k=1 p=1

38

where πi,δ (zp ) and πj,ξ (zk ) correspond to the stationary distribution of δi and ξj . Also define
matrixes Π1 with elements Π1lmnp = Pr (δi,t = zl , ξi,t = zm , δi,t+1 = zn , ξi,t+1 = zp ), and Π2 =
Π1 Π2 . In the above, πi,δ (zp ) and πj,ξ (zk ) are the corresponding marginal distribution of
δi,t , ξi,t implied by Π1 .
As shown in Hu and Shum (2008), in addition to the conditional choice probabilities
σij (p, x), the conditional covariance between choices over different periods also contain useful information to identify the unknown parameters in σij (p, x, ξ, δ). In particular, consider
the choice correlations between one and two periods apart:


γijh (p0 , x0 , p, x) = E dij,t+1 diht | pt+1 = p0 , xt+1 = x0 , pt = p, xt = x
=

K
X


σij p0 , x0 , zp , zk σih (p, x, zp , zk ) Π1pklm ,

p,k,l,m=1

and


κijh (p0 , x0 , p, x) = E dij,t+2 diht | pt+2 = p0 , xt+2 = x0 , pt = p, xt = x
=

K
X


σij p0 , x0 , zp , zk σih (p, x, zp , zk ) Π2pklm .

p,k,l,m=1

These provide additional moment conditions that we will use to estimate the distribution
of the unobserved heterogeneity components.
We use ζk , k = 1, . . . , K 2 to denote all the support points of δ, ξ. To implement the model
we represent the choice probabilities given both the observed and unobserved components
using a polynomial:
N
σ̂ij (p, x, ζk ) = aN,k
ij H (p, x),

where H N (p, x) are basis functions and aN,k
are unknown coefficients to be estimated.
ij
Similarly define the observable conditional value function
V̂ij (p, x) =

K X
K
X

Vij (p, x, zk , zp )πi,δ (zp )πj,ξ (zk ),

k=1 p=1

and represent it with a polynomial expansion V̂i0 (p, x) = viN H N (p, x). Using instruments
Zt = H N (pt , xt ), we form two sets of moment conditions to estimate the model. The first
39

set of moments relate to the conditional correlation of the choices over time:
 
1,jh
ρ (A, v(·)) = E Zt dij,t+1 diht
2

−

K
X



N,p N
N
Πkh aN,k
ij H (pt+1 , xt+1 )aij H (pt , xt )

k,p=1

2,jh

ρ

 
(A, v(·)) = E Zt dij,t+2 diht
2

−

K
X

N,p N
N
Πkr Πrp aN,k
ij H (pt+2 , xt+2 )aij H (pt , xt )


.

k,p,r=1

The second set of moment conditions are the conditional choice probabilities in relation to
the Bellman equations:
 
K2


X
N N
N
ρ (A, v(·)) = E Zt vi H (pt , xt ) + β
Πkp log aN,k
H
(p
,
x
)
t+1 t+1
i0
3

k,p=1


− βviN H N (pt+1 , xt+1 ) ,
and
4,j

ρ

 
K2


X
N N
N
(A, v(·)) =E Zt vi H (pt , xt ) + β
Πkp log aN,k
H
(p
,
x
)
t+1 t+1
i0
k,p=1
2

−

βviN H N (pt+1 , xt+1 )

− vj (xjt , pjt ) +

K
X
k,p=1

Πkp log

N
aN,k
ij H (pt , xt )
N
aN,k
i0 H (pt , xt )

! 
.

We estimate the parameters in this system using a conventional GMM method.

6.3

Empirical Results

The additive individual-specific unobserved heterogeneity component with serial correlation
over time can represent the reactions of consumers purchasing potato chips to purchasing
potato chips can react to price variations over time by either socking up potato chips, or
using the alternative retail locations such as gas stations. While consumer individual unobserved heterogeneity can be interpreted either as their stocking behavior or as their tendency
40

to switch to alternative outlets, and may have other interpretations, the data pattern of the
clear responses of consumer purchases to the timing of large price discounts is consistent
with the stock piling interpretation of unobserved individual components. We implement
a model specification where the unobserved heterogeneity component has a support of 20
points, and we use second-order approximations to the choice probabilities. As a result,
we estimate the period utility as a function of demographic and brand characteristics for
each of the 20 brands (excluding the “combined” brand #21). The obtained structural
estimates are given in Tables 17- 20. The structural elasticity estimates reported in these
tables are much higher than those in the static BLP model. This suggests that the presence
of consumer-level persistent unobserved heterogeneity has a substantial impact on the coefficient estimates. The estimates that we obtain in the structural model exceed the estimates
reported in the static BLP model by a factor of two. We also that find that an increase in
the package size has a positive impact on consumer utility. Consumer demographic information also plays important roles in the utility function. Higher income individuals tend to
extract smaller utility from purchasing potato chips uniformly over brands. larger family
size makes consumer more prone to purchasing potato chips. Furthermore, education tends
to decrease the utility from purchasing potato chips. In addition, the families where the
oldest male works tend to value potato chips less than those where the oldest male stays
at home. Finally, we find that Hispanic households tend to value potato chips more than
other households.
Our findings show that the elasticity of demand in the dynamic model is very different
from that obtained in a static BLP style demand model. These findings reinforces the
insights in Hendel and Nevo (2006) that short term and long term demand elasticities
can be substantially different because of unobserved stockpiling behaviors by consumers.
Qualifying this difference between short term and long term demand is difficult, however,
using conventional demand estimation techniques in the BLP style. A semiparametric
dynamic discrete choice model that is computationally flexible and attractive, provides a
powerful tool to distinguish long term behavior from short term demands, and can be useful
to obtain meaningful demand elasticity estimates for consumers.
By comparison, we also estimate the structural discrete choice without the serially cor-

41

related unobserved heterogeneity component. The brand-by-brand estimates are reported
in tables 21-24. One can immediately see that the price coefficients are lower in the model
with serially correlated unobserved component, which provides evidence of consumption
smoothing behavior by consumers who purchase larger quantities of products on sale.
We also present a direct comparison between the results from the two models with and
without unobserved heterogeneities in Table 25. To construct this table we consider how
the price elasticity of demand evolve over time in response to an unanticipated price decline
for Lay’s potato chips by 10% in Week 1 (10% price discounts are typical in our data).
Only the model with unobserved heterogeneity allows for time-varying elasticity. A direct
comparison between the OLS and IV results shows that price endogeneity indeed creates a
serious bias in the point estimates. Then when we compare the fixed and random coefficient
BLP model, we notice that the random coefficient BLP produces a higher price elasticity.
Furthermore, when we compare elasticity between the structural models with and without
serially correlated unobserved heterogeneity we can see that, the model without serially
correlated unobserved heterogeneity overstates both the short term and the long-term price
elasticity. The price elasticity tends to decline over time following the weeks after the
one-time price drop for Lay’s.

7

Conclusion

We study nonparametric identification of a dynamic discrete game model of incomplete
information, and develop nonparametric and semiparametric estimators that have flexible
computational properties and desirable statistical properties. Our identification analysis
provides a unified framework for both discrete and continuous state variables, and suggests a natural implementation of a nonparametric estimator. In addition, we derive the
semiparametric efficiency bound and propose a one-step semiparametric efficient estimator
under the assumptions that the transition process is nonparametrically specified while the
static payoff functions are parametric. The properties of the model are illustrated in a set
of numerical simulations and by an empirical application. Similarly, the
The identification and estimation framework in this paper is not without limitations.
Assumption 1 requires the independence and identical extreme value distribution of the error
42

terms. Additionally, these errors enter additively into the agent’s static payoffs. While
this is a common assumption in the literature, it is also very strong. It is possible to
relax some of these restrictions if we are willing to comprise the other components of the
model. For example, if a linear index functional form is imposed on the static payoffs,
the error term distribution can be identified nonparametrically and does not need to be
assumed entirely known. This is well known in static linear index discrete choice models,
but requires more complex deconvolution arguments in dynamic models through nonlinear
functional relations. Similarly, the normalization assumption is a necessary identification
condition and is innocuous in a static model. But it might not be innocuous in a dynamic
model. Adding a function of the state variables to the payoffs of all actions will not change
the static choice probabilities, but might change the dynamic choice probabilities, especially
if one of the choices tends to shift the distribution of the future state variables towards a
higher utility area. In these cases assumption 2 is not necessarily more appealing than
making a parametric static utility assumption. These can be interesting future research
directions.

References
Ackerberg, D., X. Chen, and J. Hahn (2011): “A practical asymptotic variance estimator for two-step semiparametric estimators,” Cowles Foundation Discussion Paper
No. 1803.
Aguirregabiria, V., and P. Mira (2002): “Swapping the nested fixed point algorithm: a
class of estimators for discrete Markov decision models,” Econometrica, 70(4), 1519–1543.
(2007): “Sequential estimation of dynamic discrete games,” Econometrica, 75(1),
1.
Ai, C., and X. Chen (2003): “Efficient Estimation of Models with Conditional Moment
Restrictions Containing Unknown Functions,” Econometrica, 71(6), 1795–1843.
(2009): Semiparametric efficiency bound for models of sequential moment restric-

43

tions containing unknown functions. Yale University, Cowles Foundation for Research in
Economics, forthcoming, Journal of Econometrics.
Anderson, S., A. DePalma, and J. Thisse (1992): Discrete Choice Theory of Product
Differentiation. MIT Press.
Arcidiacono, P., and R. Miller (2006):

“CCP estimation of dynamic discrete

choice models with unobserved heterogeneity,” Manuscript, Duke University, forthcoming
Econometrica.
Bajari, P., C. Benkard, and J. Levin (2007): “Estimating Dynamic Models of Imperfect Competition,” Econometrica, 75(5), 1331–1370.
Berry, S., A. Pakes, and M. Ostrovsky (2003): “Simple estimators for the parameters
of dynamic games (with entry/exit examples),” Technical Report, Harvard University.
Bresnahan, T., and P. Reiss (1991): “Empirical Models of Discrete Games,” Journal of
Econometrics, 48, 57—81.
Chen, X., O. Linton, and I. Van Keilegom (2003): “Estimation of Semiparametric
Models when the Criterion Function Is Not Smooth,” Econometrica, 71(5), 1591–1608.
Dunford, N., and J. Schwartz (1958): Linear operators. Part 1: General theory. pp285–
305, Wiley, New York.
Fan, J., and I. Gijbels (1992):

“Variable bandwidth and local linear regression

smoothers,” The Annals of Statistics, pp. 2008–2036.
Fershtman, C., and A. Pakes (2009): “Finite state dynamic games with asymmetric
information: A framework for applied work,” SSRN working paper.
Hendel, I., and A. Nevo (2006): “Measuring the implications of sales and consumer
inventory behavior,” Econometrica, 74(6), 1637–1673.
Holmes, T. J. (2011): “The Diffusion of Wal-Mart and Economies of Density,” Econometrica, 79(1), 253–302.
44

Hotz, J., and R. Miller (1993): “Conditional Choice Probabilties and the Estimation
of Dynamic Models,” Review of Economic Studies, 60, 497–529.
Hu, Y., and M. Shum (2008): “Nonparametric identification of dynamic models with unobserved state variables,” Jonhs Hopkins University, Dept. of Economics working paper,
543, 2009.
Jenkins, M., P. Liu, D. McFadden, and R. Matzkin (2004): “The Browser War:
Econometric Analysis of Markov Perfect Equilibrium in Markets with Network Effects,”
UC Berkeley, working paper.
Jia, P. (2008): “What happens when Wal-Mart comes to town: An empirical analysis of
the discount retailing industry,” Econometrica, 76(6), 1263–1316.
Jofre-Bonet, M., and M. Pesendorfer (2003): “Estimation of a dynamic auction
game,” Econometrica, 71(5), 1443–1489.
Kasahara, H., and K. Shimotsu (2008): “Nonparametric identification of finite mixture
models of dynamic discrete choices,” Econometrica, 77(1), 135–176.
Magnac, T., and D. Thesmar (2002): “Identifying dynamic discrete decision processes,”
Econometrica, 70(2), 801–816.
Nekipelov, D., P. Bajari, and H. Hong (2010): “Identification and Inference in Discrete Games with Unknown Distributions of Private Shocks,” manuscript, UC Berkeley,
Minnesota and Stanford University.
Newey, W. (1990): “Semiparametric Efficiency Bounds,” Journal of Applied Econometrics, 5(2), 99–135.
(1994): “The Asymptotic Variance of Semiparametric Estimators,” Econometrica,
62, 1349–82.
Newey, W., and D. McFadden (1994): “Large Sample Estimation and Hypothesis Testing,” in Handbook of Econometrics, Vol. 4, ed. by R. Engle, and D. McFadden, pp.
2113–2241. North Holland.
45

Newey, W., and J. Powell (2003): “Instrumental variable estimation of nonparametric
models,” Econometrica, pp. 1565–1578.
Pesendorfer, M., and P. Schmidt-Dengler (2010): “Sequential estimation of dynamic
discrete games: A comment,” Econometrica, 78(2), 833–842.
Pesendorfer, M., P. Schmidt-Dengler, and H. Street (2008): “Asymptotic least
squares estimators for dynamic games,” Review of Economic Studies, 75(3), 901–928.
Rust, J. (1987): “Optimal Replacement of GMC Bus Engines: An Empirical Model of
Harold Zurcher,” Econometrica, 55, 999–1033.
Somaini, P. (2011): “Competition and Interdependent Costs in Highway Procurement,” .
Stokey, N., R. Lucas, and E. Prescott (1989): Recursive methods in economic dynamics. Harvard Univ Pr.

A

Proof of theorem 3

First we need to characterize the tangent set of the model. The likelihood of the model will be
determined by the choice probabilities and the transition density for the state variable. Given that
choices of players are observed by the econometrician, the log-likelihood of the model can be written
as
L (s, s0 , d) =

n X
K
X

di,k log σi (ai = k | s) +

i=1 k=0

X

da log g (s | s0 , a) + log p (s0 ) ,

a∈A

0

where g(·|s , a) is the transition density of the state variable, da is the indicator of the action profile
a, and p(·) is the stationary density of the state variable. We choose a particular parameterization
path θ for the model and compute the score by differentiating the model along the path:

n K−1
X
X
X  di,k
di,K
Sθ (s, s0 , d) =
da s1θ (s | s0 , a) + s2θ (s0 ) +
−
σ̇i (k|s) ,
σi (k|s) σi (K|s)
i=1 k=0
a∈A
h
i
2
2
where E [s1θ (s | s0 , a) |s0 , a] = 0, E [s2θ (s0 )] = 0, E |s1θ (s | s0 , a)| |s0 , a < ∞, E |s2θ (s0 )| < ∞,
2

and E |σi (k|s)| < ∞. Then we characterize the tangent set as
(
 i,k
)
n K−1
X
X
X
d
di,K
a
0
0
T =
d η1 (s | s , a) + η2 (s ) +
η3 (s)
−
,
σi (k|s) σi (K|s)
i=1
a∈A

k=0

46

h
i
2
2
with E [η1 (s | s0 , a) |s0 , a] = 0, E [η2 (s0 )] = 0, E |η1 (s | s0 , a)| |s0 , a < ∞, E |η2 (s0 )| < ∞, and
2

E |η3 (s)| < ∞. We will derive the semiparameric efficiency bound for this model under the absence
of parametric restrictions on the state transition density. To derive the bound we find the parametric
and the non-parametric parts of the score of the model using a particular parametrization path for
the non-parametric component. For the chosen parametric path θ we denote
∂Vi (k, s)
∂Vi (k, s)
= ζ̃i (k, s) .
= ζi (k, s) and
∂θ
∂γ 0
Also denote πi (k, s) =

∂Π(k,s;β)
.
∂γ 0
0

0
0
We form vectors V i = (Vi (1, s) , . . . , Vi (K, s)) , V = V 1 , . . . , V n ,

σ i = (σi (1|s) , . . . , σi (K|s)) and
0

ζ = (ζ1 (1, s) , . . . , ζ1 (K, s) , . . . , ζn (K, s)) . First of all, we note that we can transform the original
moment equation. Consider the operator
Pi ◦ f = E [f (s0 ) | s, ai ] ,
P
where expectation is defined for the conditional density a−i g (s0 |s, ai = k, a−i ) σ−i (a−i |s). This
n
o∞
n
o∞
i,k
operator has a discrete spectrum with eigenfunctions Θi,k
(s)
and
eigenvalues
λ
difj
j
j=0

j=0

ferent from zero. This follows directly from the properties of the Hibert-Schmidt operators which
can be found in Dunford and Schwartz (1958). Then we can represent the value function as
Vi (k, s) =

∞
X

i,k
ai,k
j Θj (s) .

j=0

Then we can transform the moment equation to


∞
P
ϕ
e (s, s0 , a ; γ, Vi , σi ) =
ai,k
1 − βλi,k
Θi,k
j
j
j (s)
j=0

+ 1−d


i,0

[−Πi (ai , a−i , s; γ) + β log σi (ai |s0 )] + di,0 β log 1 −

K
P

!
σi (j|s0 ) .

j=1

Then we can define a directional derivative of the moment function with respect to Vi in the direction
h as


for all h with

∞
P
j=0

|hj | Θi,k
j (s)

∂ϕi
∂Vi


=
h

∞
X



hj 1 − βλi,k
Θi,k
j
j (s) ,

j=0

< ∞. Differentiating the unconditional moment equation with

respect to the parametrization path we obtain
h
  i


∂ϕ
ḣ
E A (s, da ) π (s) 1 − da,0 γ̇ − E A (s, da ) ∂V
h
h
 a6=0
i
d
da,0
= βE A (s, da ) σ(a|s
+ E [A (s0 , da ) ϕ s1θ ] .
0 ) − σ(0|s0 )

47

e such that the expression on the rightWe consider the right-hand side and try to find a function Ψ
hand side can be represented as hΨ, Sθ i. This function can be obtained as


da6=0 − σ (a|s) da,0 − σ (0|s)
a
e
.
Ψ = A (s, d ) (ϕ − E [ϕ | s, a]) +
−
σ (a|s0 )
σ (0|s0 )
We note that conditional moment equation (23) holds and we can differentiate it with respect
to the parameterization path. Then we can substitute the expression for the derivative into the
expression for the unconditional moment. This allows us to express the directional derivative of γ
and, consequently, the efficient influence function for a fixed instrument matrix:
h

  ∂ϕ  i−1
e
Ψ.
Ψ = E A (s, da ) π (s) 1 − da,0 − ∂V
h

The semiparametric efficiency bound as a minimum variance of the influence function. Denoting


da,0
da6=0
−
s,
a
.
Ω(s, a) = Var ϕ +
σ (a|s0 ) σ (0|s0 )
Using standard GMM arguments, we can express the efficiency bound for fixed instrument as


  ∂ϕ  
  ∂ϕ  −1
0
−1
.
Vh (β) = π (s) 1 − da,0 − ∂V
ζ (da , s) Ω (s, a) ζ (da , s) π (s) 1 − da,0 − ∂V
h

h

∗

The efficiency bound overall can be found as Vh∗ (β) for h solving


  ∂ϕ  
  ∂ϕ  
0
−1
inf π (s) 1 − da,0 − ∂V
ζ (da , s) Ω (s, a) ζ (da , s) π (s) 1 − da,0 − ∂V
.
h

h

h

The optimal instrument matrix can be explicitly written as
"
#
!
∞

P
0
−1
s .
M(s) = E
π (s) 1 − da,0 −
h∗j (1 − βλj ) Θj (s) ζ (da , s) Ω (s, a)
j=0

Q.E.D.

Proof of theorem 5
We can use the Bellman equation to express the estimate of the payoff function in terms of the
estimate of the value function. We use a series projection estimator to estimate Vi (k, s) − Vi (0, s).
To evaluate the elements of the Bellman equation for player i we need to analyze the right hand side
function
(
hi (s) = E

log

K
X

)
(Vi (k, s0 ) − Vi (0, s0 )) s .

k=0

48

Function hi (s) admits a series representation hi (s) =

k(m)
P
j=1

k(m)

qj (s)λi,j


+ o kqk(m) (s)k , where we

use the standard Sobolev norm. The coefficients for this representation can be obtained from the
coefficients for Vi (k, s) − Vi (0, s). This result can be used to find a series representation for Vi (0, s)
which needs to be estimated. To do that we proceed by analyzing the nonparametric conditional
expectation estimation component of step two, which takes the form of
Z
Vi (s, 0) = β
where gi (s0 |s, 0) =

P

Vi (s0 , 0) gi (s0 |s, 0) ds0 + hi (s) = (Ki ◦ Vi ) (s, 0) + hi (s) ,

(25)

g (s0 |s, 0, a−i ) σ (a−i |s).

a−i ∈A−i

This is an integral equation for Vi (·, 0). We assume that the integral operator Ki and the term
hi (·) satisfy the standard assumptions assuring the existence of a smooth solution of this equation.
In particular s ∈ S, Vi : S 7→ R+ , both the kernel function gi (·) and the function hi (·) have
derivatives up to order p ≥ k(m), which assures a high degree of smoothness of the value function.
Thus Vi ∈ C p (S), and Ki : C p (S) 7→ C p (S). A standard method for solving this equation is to
represent solution by a series expansion over a particular basis in C p (S). We will use the basis
0
q k(m) (s) = q1 (s), . . . , qk(m) (s) for these purposes. Then the approximation for the value function
can be written as:
k(m)

Vi (·, 0) = q k(m) (s)0 θi

.

We endow the space C p (S) with an inner product h·, ·i and introduce matrices
k(m)

Γ = (hqt (s), qj (s)i)t,j=1

k(m)

and Gi = (hK qt (s), qj (s)i)t,j=1 .

We define the inner product for two functions f, g ∈ C p (S) as:
Z
hf, gi =
f (s)g(s)π (ds) = E [f (s) g(s)] ,
S

where π(·) is a stationary distribution measure for the state space S. In general, this measure is
not available. For this reason, we substitute it with the empirical measure π m (·), which we require
to be weekly converging to π(·). We call the space associated with the inner product generated by
π m (·) by C pm (S). This space is only a semi-Hilbert space as the inner product in it might have a
non-empty kernel (and, thus, the associated norm is only a seminorm). We will use the same basis
in C pm (S) as before.
We can use the expansion for hi (·) to derive the series approximation for the value function
Vi (·, 0). In this case the vector of coefficients in the series representation of the value function can

49

be found as:
k(m)

θi

= (Γ − βGi )

−1

k(m)

Γ λi

.

This result is obtained from substituting series expansions for hi (·) and Vi (·, 0) into equation (25)
and projecting both sides of this equation on the basis vectors q k(m) (·).
These coefficients allow us to obtain an approximation for the value of the function Vi (·, 0) which
can be expressed as:
k(m)

Vi

−1

(s, 0) = q k(m) (s)0 (Γ − βGi )

k(m)

Γ λi

For sufficiently smooth coefficients of the original integral equation, this expression will provide an
approximation of order k(m) such that the norm of the deviation of the approximation from the
true solution will be bounded from above by

L
k(m)!

k(m)

sup ks − s0 k

, where Ω ⊂ S is a subset of

s,s0 ∈Ω

the state space where the value function is approximated by the series expansion. Note that all
components of this formula are exactly known, although the matrices are specific to a particular
basis.3
We estimate coefficients in the series representation of the value function from the data. To do
so, first, we estimate the state transition probability. We assume that an estimator with the rate
r ∈ (0, 1/2] is available which produces the estimate that is point-wise asymptotically normal at s0
uniformly over s in Ω:

d
nr (b
gi (s0 | s, 0) − gi (s0 | s, 0)) −→ N 0, σg2 (s0 , s) .
We assume for convenience that this estimate is obtained using an estimation procedure which can
be approximated by a series expansion with the order of precision at least op (n−r ). To estimate the
vector of coefficients λk(m) we use the data from the observed states and values of hi (·) to estimate
it. Note that the values of hi (·) are obtained from the Hotz-Miller-type inversion and thus contain
noise. By the nature of this inversion we can in principle evaluate b
hi (·) at any point of Ω. Although
the probabilities of actions are estimated non-parametrically, by Delta-method we can assure that
for some q ∈ (0, 1/2] we obtain a point-wise asymptotically normal estimator of hi (·) in Ω. In
particular we use a spectral representation of hi (·) to estimate it non-parametrically and obtain the
coefficients λp . Thus



d
nq b
hi (s) − hi (s) −→ N 0, σh2 (s) .
3

For instance, if q k(m) (·) is a system of Legendre polynomials then Γ = diag

50

nq

2
2k(m)+1

o

.

We consider the properties of the pointwise approximation error for the value function:
k(m)

V̂i

−1
(s, 0) − Vi (s, 0) = q k(m) (s)0 (Γ − βGi ) hb
hi (s) − hi (s), q k(m) (s)i


−1
b i − Ki q k(m) (s), q k(m) (s)0 i (Γ − βGi )−10 Γ λk(m) + ∆k(m) .
+βq k(m) (s)0 (Γ − βGi ) h K

In this expression ∆k(m) is a residual function. In the expression for the error in the estimate of
the value function the matrices only play the role of normalization while the asymptotic behavior of
the error is governed by the integrated error in the estimated components of the Bellman equation.
This normalization does not change the rate of convergence of the estimators, and the order of
polynomial expansion is determined only by the degree of smoothness of the function approximation.
Assumption 5 restricts the operator K to be bounded. Consider the transformation λ 7→ Γ1/2 λ and
q k(m) (·) 7→ Γ−1/2 q k(m) (·). This a rotation of the basis which does not change the asymptotic
properties. In fact, indicating the rotated variables by tildes we get:



d
ek(m)
k(m)
mq q̃ k(m) (s)0 λ̂i
− q̃ k(m) (s)0 λ̃i
−→ N 0, σψ2 .
o
n

Specifically, σV2 = lim trace m2q Ω̃λ q̃ k(m) (s)q̃ k(m) (s)0 = lim trace m2q Ωλ q k(m) (s)q k(m) (s)0 =
m→∞

m→∞

σψ2 (s).

Next, note that Ik(m) ≤ Ik(m) − βΓ−1/2 Gi Γ−1/2

−1

≤ (1 − β)

−1

Ik(m) , where inequality should

be treated as the difference between the two matrices is a positive semi-definite matrix. We can show
that the last inequality is valid in to steps. First, the matrix Γ − Gi is positive semi-definite because
the operator K is defined by a density function. Second, the matrix (1 − β)

−1


Ik(m) − βΓ−1/2 Gi Γ−1/2 −

Ik(m) is positive semi-definite. To see that, consider decomposition
Ik(m) − βΓ−1/2 Gi Γ−1/2 = (1 − β) Ik(m) + βΓ−1/2 (Gi − Γ) Γ−1/2 ≥ (1 − β) Ik(m) .
As a result:
n
o
−1
−1
trace m2q (Γ − βGi ) ΓΩλ Γ (Γ − βGi ) q k(m) (s)q k(m) (s)0
n
o
−1
−1 k(m)
= trace m2q Ik − βΓ−1/2 GΓ−1/2
Ω̃λ Ik(m) − βΓ−1/2 GΓ−1/2
q̃
(s)q̃ k(m) (s)0 .
This means that
n
o
−1
−1
ω12 = lim trace m2q (Γ − βGi ) ΓΩλ Γ (Γ − βGi ) q k(m) (s)q k(m) (s)0 <
m→∞

σψ2

2,

(1 − β)

and it does not vanish. This proves that the rate of convergence of the non-parametric estimate for
Vi (·, 0) is the same as the rate for hi (·).

51

The approximation for the value function can be expressed in terms of subsequent projections.
From the Bellman’s equation it follows that
h
i
 



k(m)
Vbi
(s, 0) − Vi (s, 0) − βE V̂i (s0 , 0) − Vi (s0 , 0) s = β Ê Vi (s0 , 0) s − E Vi (s0 , 0) s + ∆, (26)
with the residual ∆. Using the spectral representation for the expectation in the basis q k(m) (·)
(where the coefficients of Vi (·, 0) in this basis are denoted θk(m) ) we obtain that up to the error of
order smaller than ∆:


Ê [V (s0 , 0) | s] − E [V (s0 , 0) | s] = q k(m) (s)0 Γ−1 Ĝi − Gi θk(m) ,
h
i


E V̂ (s0 ) − V (s0 ) s = q k(m) (s)0 Γ−1 Gi θ̂k(m) − θk(m) .
From spectral representation of the Bellman’s equation it follows that (up to the series approximation
error):
θk(m) = (Γ − βGi )

−1

Γλk(m) .

Substitution of these expressions into (26) gives:
k(m)
k(m)
Vbi
(s, 0) − Vi
(s, 0) = βq k(m) (s)0 Γ−1/2 I − βΓ−1/2 Gi Γ−1/2


−1 1/2 k(m)
× Ĝi − Gi Γ−1/2 I − βΓ−1/2 Gi Γ−1/2
Γ λi
.

−1

Γ−1/2

This suggests that the method of approximating value function by consecutive conditional expectations (26) is equivalent to the spectral approach up to approximation error.
Now we will discuss the case where we substitute the stationary measure Gi (·) by its empirical
m

analog. In this case for the sample {sl }l=1 the inner product for f, g ∈ C p (S) can be defined as:
hf, gim =

m
X

f (sl ) g (sl ) .

l=1

We can describe the quality of approximation only outside the kernel of the seminorm in C pm (S).
In that part of the subspace the norm of the elements of the basis is well-defined. For this reason,
we can write the same expressions for the coefficients for expansion of the value function in the basis
q k(m) (·) but in terms of matrices Γm and Gm defined by the inner product in C pm (S). In this case,
the problem of evaluation of the difference between the estimate of the value function obtained from
Γm and Gm and the true value reduces to two separate problems. The first one is evaluation of the
error due to series approximation, which was considered above. The second one is evaluation of the
quality of approximation when using empirical measure instead of the true stationary measure. The

52

general results regarding these properties are given, for instance, in (Billingsley, 1968). Here we will
consider a special case when the stationary and empirical measures have densities. We can evaluate
the quality of approximation of the value function as:
m,k(m)

Vi

−1

k(m)

−1

(s) = βq p (s) (Γ − βGi ) (Gm
Γλp
i − Gi ) (Γ − βGi )
h
i
k(m)
−1
−1
+βq k(m) (s) (Γ − βGi ) (Γm − Γ) I − (Γ − βGi ) Γ λi
+ o (kΓm − Γk, kGm
i − Gi k) ,

(s) − Vi

where the norm in the residual term is a standard matrix norm. This expression has similar structure
as the expression for the errors due to estimation of hi (·). From Assumption 5 it follows that traces
max{q,r}
of matrices Γm − Γ and Gm
. This means that in the
i − Gi approach to zero faster than m

asymptotic expansion the corresponding term vanishes as well.
This result proves that we can, in general, substitute the matrices Gi and Γ by their sample
versions without affecting the asymptotic variance. The estimate of the value function will take the
form:
k(m)

V̂i

0

(s, 0) = q k(m) (s)



Γ̂ − β Ĝi

−1

k(m)

Γ̂0 λ̂i

,

where Γ̂ and Ĝi are sample averages for estimating Γ and G. For example:
Ĝi =

m
T −1
1 X 1 X k(m)
0
q
(sj,t+1 ) q k(m) (sj,t ) .
m j=1 T t=1
k(m)

In the previous step we have estimated Vi (s, l) − Vi (s, 0) non-parametrically as q k(m)0 γi,l

.

This means that the non-parametric estimate for the choice-specific value function is a combination
of the obtained estimate for Vi (s, 0) and this difference and:


k(m)
k(m)
k(m)
V̂i
(s, l) = q k(m)0 θ̂i
+ γ̂i,l
.
This variable will be normal as it is non-degenerate and computed as a sum of two asymptotically
k(m)

normal estimates. This fact becomes
straightforward
in

 if we explicitly express coefficients θi
k(m)
k(m)
k(m)
k(m)
terms of γi,l . Let γi
= 0, γi,1 , . . . , γi,K
be the stacked matrix of coefficients in the
expansions for Vi (s, l) − Vi (s, 0). We introduce the following vector of logit probabilities:


exp(Vi (s,l)−Vi (s,0)) 
Λ=P
K
exp(Vi (s,j)−Vi (s,0))

j=0

k(m)

Then we can express λi

l=1,...,K

(up to the error of approximation) as:
k(m)

λi

k(m)

= Γ−1 Gi γi

53

Λ.

Therefore, the corresponding coefficients for the value function can be expressed as:
k(m)

θi

−1

= (Γ − βGi )

k(m)

G i γi

Λ.

k(m)

Value function can be explicitly estimated from coefficients γ̂i
and matrices Gi and Γ as:



−1
k(m)
k(m)
k(m)
V̂i
(s, l) = q k(m)0 γ̂i,l + Γ̂ − β Ĝi
Ĝi γ̂i
Λ̂ .
From this estimate one can see that the estimate for the value function is obtained from the estimates for the choice-specific probabilities by permuting them by bounded linear transformations (as
P
−1/2
Gi Γ−1/2 is bounded
t Λt = 1 and Λt > 0, while the operator represented by the matrix I − βΓ
as shown above). This motivates asymptotic normality with non-degenerate distribution for their
estimates. Estimated profit will be, again, a non-degenerate linear combination of the estimates for
the choice-specific probabilities, and pointwise normality of the estimate with the rate of convergence, corresponding to the minimum of the convergence rate for the choice specific probability or
transition density.
To formalize this recall that we can compute the profit function from the value function by the
formula:


Πi (s, l) = Vi (s, l) − βE Vi (s0 ) s, ai = l .
(l)

(l)

Let Gi be the matrix corresponding to the state transition density gi (s0 | s, l) such that Gi,tr =
RR
k(m) 0 k(m)
gi (s0 | s, l) qt
(s )qr (s)π(ds) ds0 . We can then express the spectral representation for the
profit as:
k(m)

Πi

o

i

nh
ih
k(m)
k(m)
(l)
−1
Λ .
(s, l) = q k(m)0 (s) γi,l + Ik(m) − Γ−1 Gi
(Γ − βGi ) Gi + Ik(m) − Ik(m) γi

Then we can transform the expression for the profit function as:
h
i
(l)
k(m)
k(m)
k(m)0
k(m)0
Πi
(s, l) = q
(s)γi,l + q̃
(s) Ik(m) − Γ−1/2 Gi Γ−1/2
×

h

Ik(m) − βΓ

−1/2


−1/2 −1

Gi Γ

+Γ

1/2

1/2
G−1
i Γ

i

−1/2

Γ

−1/2

Gi Γ

−Γ

−1/2



k(m)

γ̃i

Λ.

In this expression tildes denote the rotation of the basis considered before. The matrix in the second
expression represents a bounded linear transformation due to assumption 3. Therefore the estimate
for the profit function is a bounded transformation of the estimate of the choice probabilities. Then
we can evaluate the variance-covariance matrix as


nh
ih
i
o

k(m)
k(m)
(l)
−1
ωπ2 = lim trace q k(m)0 (s) γi,l + Ik(m) − Γ−1 Gi
(Γ − βGi ) Gi + Ik(m) − Ik(m) γi
Λ
m→∞


nh
ih
i
o
0
k(m)
(l)
k(m)
−1
(Γ − βGi ) Gi + Ik(m) − Ik(m) γi
× γi,l + Ik(m) − Γ−1 Gi
Λ q k(m)0 (s)

54

Table 1: Simulation summary for entry utilities, nmarket=100
i
1
1
1
1
2
2
2
2

a−i
1
1
2
2
1
1
2
2

state
1
2
1
2
1
2
1
2

1st quartile
-0.238
-0.22
-0.33
-0.21
-0.25
-0.36
-0.31
-0.38

median
-0.006885
0.00004
-0.011
0.0038
0.027
-0.021
-0.022
0.013

mean
-0.0028
0.0071
-0.0349
0.017
0.023
-0.005
0.0032
-0.021

3rd quartile
0.225
0.2304
0.28
0.24
0.31
0.35
0.31
0.36

std
0.36
0.343
0.48
0.34
0.44
0.57
0.482
0.619

true Pi
-0.52
0.749
-1.023
0.81
0.53
-1.005
1.15
-1.600

Table 2: Simulation summary for entry utilities, nmarket=500
i
1
1
1
1
2
2
2
2

a−i
1
1
2
2
2
2
2
2

state
1
2
1
2
1
2
1
2

1st quartile
-0.109
-0.095
-0.15
-0.092
-0.109
-0.164
-0.13
-0.15

median
-0.006
0.0017
-0.0044
-0.0059
0.013
0.0085
0.0017
0.0001

mean
-0.002
0.0011
-0.0068
0.00004
0.009
-0.0013
0.0043
0.002

3rd quartile
0.102
0.097
0.13
0.1
0.12
0.15
0.14
0.16

std
0.161
0.146
0.211
0.146
0.18
0.23
0.203
0.24

true Pi
-0.52
0.749
-1.02
0.812
0.53
-1.005
1.15
-1.60

Table 3: Simulation summary for entry utilities, nmarket=1000
i
1
1
1
1
2
2
2

a−i
1
1
2
2
2
2
2

state
1
2
1
2
1
2
1

1st quartile
-0.073
-0.075
-0.107
-0.066
-0.078
-0.11
-0.098

median
-0.00002
-0.0049
-0.003
0.0053
0.0023
0.0024
-0.0021

55

mean
0.001
-0.0032
-0.005
0.004
0.0046
-0.0033
-0.001

3rd quartile
0.077
0.072
0.092
0.075
0.086
0.107
0.091

std
0.109
0.106
0.14
0.108
0.127
0.166
0.14

true Pi
-0.52
0.749
-1.023
0.812
0.537
-1.005
-1.60

Table 4: Simulation summary for entry utilities, nmarket=2000
i
1
1
1
1
2
2
2
2

a−i
1
1
2
2
2
2
2
2

state
1
2
1
2
1
2
1
2

1st quartile
-0.05
-0.053
-0.078
-0.045
-0.055
-0.088
-0.066
-0.079

median
0.005
-0.00017
-0.0066
0.0018
0.0017
-0.005
-0.004
0.011

mean
0.0038
-0.00037
-0.0062
0.0017
0.0039
-0.0049
-0.0021
0.0051

3rd quartile
0.059
0.051
0.0603
0.05
0.064
0.07
0.059
0.086

std
0.0772
0.074
0.1007
0.075
0.089
0.119
0.097
0.124

true Pi
-0.52
0.749
-1.023
0.812
0.537
-1.005
1.150
-1.600

Table 5: Simulation summary for entry utilities
sample size
50
100
150
200
250
300

mean
-0.2075
-0.2064
-0.2075
-0.2056
-0.2047
-0.2041

variance
1.0898
1.1111
0.9341
1.0461
1.0346
0.9111

median
-0.2371
-0.1776
-0.1935
-0.1934
-0.1936
-0.1851

56

90% quantile/10% quantile ratio
0.0007
0.0012
0.0011
0.0010
0.0009
0.0010

Table 6: Summary statistics for sales and promotions
Variable
Total sales across brands
in dollars
in units
Total sales across markets
in dollars
in units
Frequency of promotions

Obs

Mean

Std. Dev.

Min

Max

25%

50%

75%

68102
68103

15.997
9.025

51.492
24.566

0.11
1

1795.4
721

2.39
1

5.38
3

12.88
8

7499
7499

145.282
81.958

216.266
120.995

0.25
0.25

1848.5
156

6.56
5

33.8
23

196.1
107

5166

0.283

0.322

0

1

0

0.16

0.5

Table 7: Product market shares following the weeks with
promotion
Variable Obs
Mean Std.Dv. Min
All sample
log-market share 149460 -4.134 1.178
-7.355
Promotion
log-market share 22496
-3.916 1.144
-7.355
No promotion
log-market share 126964 -4.173 1.179
-7.355

a price promotion and without a
Max

25%

50%

75%

0

-4.997

-4.241

-3.423

0

-4.751

-3.985

-3.135

0

-5.037

-4.290

-3.481

Table 8: Summary of purchases
Obs Mean Std. Dev.
Price per purchase 335230 1.875
0.820
# of items purchased 345952 1.278
0.737
Average size of item 345952 0.591
0.251
Time between purchases, weeks 335608 5.588
10.552
Average number of brands purchased 345952 1.114
0.348

Min
0.059
0.25
0.031
1
1

Max
6.99
70
3
285
6

50%

75%

Variable
All sample
log-market share
Promotion
log-market share
No promotion
log-market share

Obs

Table 9: Summary of price promotions
Mean Std.Dv. Min
Max 25%

149460

-4.134

1.178

-7.355

0

-4.997

-4.241

-3.423

22496

-3.916

1.144

-7.355

0

-4.751

-3.985

-3.135

126964

-4.173

1.179

-7.355

0

-5.037

-4.290

-3.481

57

Table 10: Summary of package sizes
volume, rounded
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1.1
1.2
1.3
1.4
≥1.5

# of observations
563
22253
3787
88309
78056
15491
27189
88105
116989
20376
17960
319
238
10040
63
413

quantity on discount, %
69%
13%
8%
34%
30%
32%
19%
47%
51%
39%
12%
18%
30%
19%
56%
6%

58

% time on sale
13%
8%
11%
23%
23%
18%
13%
41%
33%
38%
14%
11%
32%
17%
42%
13%

Average discount
41%
13%
12%
35%
28%
16%
22%
33%
34%
25%
19%
27%
16%
21%
6%
-1%

Table 11: Characteristics of brands in the sample
Rank
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20

Brand

Company

LAYS

PEPSICO INC

PRINGLES

PROCTER & GAMBLE

PRIVATE LABEL

PRIVATE LABEL

RUFFLES

PEPSICO INC

WISE

PALLADIUM EQUITY PARTNERS

OLD DUTCH

OLD DUTCH FOODS INC

UTZ

UTZ QUALITY FOODS

CAPE COD

CAPE COD POTATO CHIP

JAYS

UBIQUITY BRANDS

BARREL O FUN

KLN ENTERPRISE

POORE BROTHERS

THE INVENTURE GROUP INC

TERRA

THE HAIN CELESTIAL GROUP INC

STATE LINE

STATE LINE SNACKS CORP

KETTLE CHIPS

KETTLE FOODS INC

HERRS

HERR FOODS INC

GIBBLES

MARTIN SNACKS

COTTAGE FRIES

PALLADIUM EQUITY PARTNERS

BACHMAN GOLDEN RIDGES

BACHMAN CO

GRANDMA UTZ

UTZ QUALITY FOODS

UTZ DELITES

UTZ QUALITY FOODS

59

Share (vol.)
0.4561
0.1304
0.1191
0.0630
0.0536
0.0398
0.0311
0.0276
0.0197
0.0193
0.0094
0.0029
0.0025
0.0024
0.0013
0.0012
0.0008
0.0004
0.0003
0.0002

% on sale
0.4325
0.2964
0.2180
0.2306
0.4183
0.4739
0.5347
0.2984
0.5002
0.4562
0.5740
0.1980
0.0755
0.1995
0.0109
0.1403
0.1023
0.1734
0.1203
0.4479

Share (rev.)
0.5018
0.0939
0.0964
0.0917
0.0456
0.0481
0.0247
0.0350
0.0224
0.0173
0.0070
0.0045
0.0026
0.0031
0.0010
0.0015
0.0007
0.0004
0.0003
0.0003

Table 12: Estimated demand for products in potato chips category
log-price
promotion
Observations

OLS
-0.29
[74.69]***
0.153
[19.67]***
149460

IV
-1.2
[56.14]***
0.137
[13.99]***
125401

t-statistics are in the braces

60

BLP
-1.979
[44.59]***
0.144
[7.32]***
125401

log(price)
time
time2
Constant
brand FE
Observations
R-squared

Table 13: Aggregate demand estimates
All sample
On sale
log(quantity) log(quantity) log(quantity) log(quantity)
-1.594
-1.293
-1.741
-1.627
[0.01]***
[0.01]***
[0.03]***
[0.02]***
-0.006
-0.006
[0.0004]***
[0.0004]***
0.00005
0.00006
[0.000005]*** [0.000005]***
2.126
1.736
2.215
2.098
[0.01]***
[0.01]***
[0.03]***
[0.02]***
Yes
No
Yes
No
139058
139058
37709
37709
0.16
0.2
0.11
0.16

61

Not on sale
log(quantity) log(quantity)
-1.539
-1.176
[0.01]***
[0.01]***
-0.008
-0.005
[0.0004]***
[0.0004]***
0.00006
0.00005
[0.000005]*** [0.000005]***
2.09
1.557
[0.02]***
[0.01]***
Yes
No
101033
101033
0.11
0.16

Table 14: Fraction of products purchased on sale as function of household characteristics
Pre-tax income
Family size
Education male
Age male
Education female
Age female
I(not employed, male)
I(Part time, male)
I(Full time, male)
I(Retired, male)
I(Retired, male)
I(Student, male)
I(not employed, female)
I(Part time, female)
I(Full time, female)
I(Retired, female)
I(Retired, female)
I(Student, female)
Market FE
Time FE
Marital status FE
Occupation, male FE
Occupation, Female FE
HH race FE
Demographics variables: I(N/A)
Constant
Observations
R-squared

Fraction of purshase made on
-0.001
-0.001
-0.001
[0.000]*
[0.000]**
[0.000]
0.014
0.012
0.014
[0.001]*** [0.001]*** [0.001]***
0.001
0.001
0
[0.001]
[0.001]
[0.001]
-0.002
0.001
-0.002
[0.001]**
[0.001]
[0.001]*
-0.001
-0.002
-0.002
[0.001]** [0.001]*** [0.001]***
0.008
0.007
0.007
[0.001]*** [0.001]*** [0.001]***
0.095
0.006
0.023
[0.010]***
[0.010]
[0.010]**
0.022
-0.018
0.002
[0.024]
[0.024]
[0.024]
0.018
-0.017
-0.003
[0.024]
[0.024]
[0.024]
0.118
0.089
0.094
[0.028]*** [0.028]*** [0.028]***
0.061
-0.005
0.002
[0.003]***
[0.004]
[0.004]
0.028
-0.036
-0.022
[0.019]
[0.019]*
[0.018]
0.067
-0.023
-0.016
[0.009]***
[0.010]**
[0.010]*
-0.019
-0.024
-0.045
[0.021]
[0.021]
[0.021]**
-0.021
-0.026
-0.048
[0.021]
[0.021]
[0.021]**
-0.049
-0.048
-0.08
[0.025]**
[0.025]* [0.024]***
0.029
-0.027
-0.023
[0.008]*** [0.008]*** [0.008]***
0.053
0.021
0.002
[0.015]***
[0.015]
[0.014]
Yes
No
Yes
No
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
0.211
0.216
-0.128
[0.036]***
[0.036]*** [0.039]***
62
354380
354380
354380
0
0
0.04

sale
-0.001
[0.000]**
0.012
[0.001]***
0.001
[0.001]*
0.001
[0.001]
-0.002
[0.001]***
0.008
[0.001]***
0.094
[0.010]***
0.006
[0.025]
0.009
[0.025]
0.118
[0.029]***
0.067
[0.003]***
0.027
[0.019]
0.079
[0.010]***
0.009
[0.021]
0.008
[0.021]
-0.007
[0.025]
0.037
[0.009]***
0.086
[0.015]***
No
No
Yes
Yes
Yes
Yes
Yes
0.195
[0.037]***
354380
0

Table 15: Demand as a function of sale parameters
log(quantity)
log(price)
-0.05
-0.038
-0.022
-0.046
[0.003]*** [0.003]*** [0.003]*** [0.003]***
I(sale)
0.13
0.154
0.197
0.149
[0.004]*** [0.004]*** [0.004]*** [0.005]***
I(sale) X log(price)
-0.086
-0.096
-0.136
-0.09
[0.004]*** [0.004]*** [0.004]*** [0.004]***
Size
2.018
2.118
2.128
2.115
[0.003]*** [0.003]*** [0.003]*** [0.003]***
Household FE
Time FE
Market FE
Flavour FE
Fat content FE
Produser FE
Cooking stile FE
Salt/sodium content
Cut type FE
Packegae type FE
Constant
Observations
R-squared

-0.023
[0.003]***
0.194
[0.004]***
-0.137
[0.004]***
2.128
[0.003]***

Yes
No
No

No
No
Yes

No
Yes
No

No
Yes
Yes

No
No
No

Yes
Yes
Yes
Yes
Yes
Yes
Yes
-0.044
[0.327]
471953
0.62

Yes
Yes
Yes
Yes
Yes
Yes
Yes
-0.083
[0.349]
471953
0.67

Yes
Yes
Yes
Yes
Yes
Yes
Yes
-0.16
[0.351]
471953
0.67

Yes
Yes
Yes
Yes
Yes
Yes
Yes
0.643
[0.372]*
471953
0.68

Yes
Yes
Yes
Yes
Yes
Yes
Yes
-0.171
[0.352]
471953
0.68

63

Brand rank
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21

Table 16: Brands of potato chips in the considered markets
Brand Name
Brand owner
LAYS
PEPSICO INC
PRINGLES
PROCTER & GAMBLE
PRIVATE
PRIVATE LABEL
RUFFLES
PEPSICO INC
WISE
PALLADIUM EQUITY PARTNERS
OLD DUTCH OLD DUTCH FOODS INC
UTZ
UTZ QUALITY FOODS
CAPE CODE CAPE COD POTATO CHIP
JAYS
UBIQUITY BRANDS
BARREL
KLN ENTERPRISE
POORE
THE INVENTURE GROUP INC
TERRA
THE HAIN CELESTIAL GROUP INC
STATE
STATE LINE SNACKS CORP
KETTLE
KETTLE FOODS INC
HERRS
HERR FOODS INC
GIBBLES
MARTIN SNACKS
COTTAGE
PALLADIUM EQUITY PARTNERS
BACHMAN
BACHMAN CO
GRANDMA
UTZ QUALITY FOODS
UTZ
UTZ QUALITY FOODS
OTHER
OTHER

64

Table 17: Coefficient estimates for consumer choice model with serially correlated consumer
and brand-specific unobserved heterogeneity: part 1
Variables
log(Price)
Pkg. quantity (oz)
Packaging: bag
Box
Canister
other
Flavor: Barbeque
Cheddar
Classic
Dill
Other
Missing
Cut: Flat
Rippled
Wavy
Other
Missing
Fat indication: Reduced
Regular
Missing
Cooking: Crispy
Kettle cooked
Other
Missing
Sodium indication: Reduced
Regular
Missing
Pre-tax income
Family size
Age male
Education male
Age Female
Education Female
Work male
Work female
Hispanic

Brand 1
-3.093084
0.023648
1.083336
0.167489
2.126507
2.130894
2.516947
0.002148
0.081069
0.09442
0.894347
0.401883
17.504062
0.563384
2.054767
1.893328
0.767867
0.412106
3.331358
2.954277
3.358041
0.87759
0.588135
2.564087
1.055897
1.993188
1.902018
-2.771089
5.349905
-0.422976
-12.245675
-5.205421
-8.045068
-2.347099
0.077111
0.97801

Brand 2
-2.839459
0.027227
2.257118
0.710799
1.08645
0.857171
1.121407
2.123562
3.319681
1.97255
1.443588
1.362309
11.922788
6.881071
1.529476
2.60554
1.453247
0.660561
1.393665
3.163212
1.506079
2.51677
0.294594
2.952459
3.10707
3.427846
2.761925
-1.819382
4.103607
-0.751685
-4.573244
-2.352651
-1.045667
-0.738439
0.070068
0.246425
65

Brand 3
-2.731196
0.113665
2.076922
0.989843
0.918042
3.322598
0.927539
2.887561
0.056023
0.983903
3.086589
0.945448
16.878971
2.475236
3.308461
3.370363
3.402031
1.31856
1.095798
0.911828
3.125307
3.264619
2.573136
1.128398
2.399652
1.26847
1.884527
-2.430073
5.144125
-0.173533
-2.860647
-5.136977
-15.690651
-0.881929
0.06911
2.268229

Brand 4
-3.163044
0.052785
0.160061
0.443545
2.380979
0.313321
2.578106
0.81756
1.339931
2.120143
3.301995
3.126884
5.546945
4.990139
2.575336
2.50533
3.001584
1.450738
1.610804
2.750444
1.668809
3.215015
1.256161
0.632139
3.10766
0.947693
2.683362
-2.297347
5.241447
-0.101178
-7.009571
-2.208746
-8.1239
-2.716539
0.06611
2.124053

Brand 5
-2.692065
0.056427
1.120758
0.412596
0.004586
1.393228
0.830753
1.116835
0.726215
0.336933
0.839248
0.871189
18.11449
4.607974
0.23931
2.519205
2.016039
2.816783
2.088087
3.085395
0.502346
2.202708
1.134427
0.373934
3.029386
2.653605
3.241812
-0.248018
0.725615
-0.522588
-30.733799
-2.728967
-2.483252
-2.984811
0.003634
1.485854

Table 18: Coefficient estimates for consumer choice model with serially correlated consumer
and brand-specific unobserved heterogeneity: part 2
Variables
log(Price)
Pkg. quantity (oz)
Packaging: bag
Box
Canister
other
Flavor: Barbeque
Cheddar
Classic
Dill
Other
Missing
Cut: Flat
Rippled
Wavy
Other
Missing
Fat indication: Reduced
Regular
Missing
Cooking: Crispy
Kettle cooked
Other
Missing
Sodium indication: Reduced
Regular
Missing
Pre-tax income
Family size
Age male
Education male
Age Female
Education Female
Work male
Work female
Hispanic

Brand 6
-2.911434
0.077634
1.381033
0.177706
1.570065
0.431822
0.62645
2.235641
2.038993
0.487649
2.965642
1.134811
13.151739
5.639751
2.818587
0.912543
1.983328
1.241271
2.018017
1.531191
3.004646
2.932436
1.932747
2.235834
3.339568
0.857643
1.587419
-2.265123
2.361773
-0.253109
-31.260136
-3.391082
-5.893146
-3.223599
0.060679
2.097809

Brand 7
-2.998795
0.156119
1.113762
0.102814
2.636845
0.309739
1.018675
2.613372
2.156949
0.054597
0.104623
0.427577
2.881501
4.017684
1.890329
3.296327
2.267515
2.117671
1.582632
0.998216
0.930495
0.864896
1.154702
2.947569
0.92091
0.135918
2.271327
-2.31245
2.349088
-0.62194
-24.93648
-5.489202
-0.327465
-1.585419
0.05034
2.375445
66

Brand 8
-2.950773
0.090197
0.708142
0.658632
0.598895
2.399878
0.734392
3.331874
1.807655
2.637733
0.129827
2.267329
1.738296
6.745104
3.394326
2.683909
1.093936
0.777772
0.866518
2.905236
1.357602
0.136
0.164381
2.862703
0.371203
1.918062
2.661004
-3.10701
2.489815
-0.731417
-29.108916
-1.12166
-23.465545
-2.77831
0.011888
2.443606

Brand 9
-2.672683
0.175843
0.975481
0.757247
3.094523
2.287465
0.183648
2.859479
1.38874
2.900615
1.592186
0.306437
18.662324
3.429067
0.61501
2.52803
1.991945
0.544591
1.31806
0.728097
3.364759
1.778929
2.008287
2.566581
1.002449
3.303149
1.24907
-1.603886
2.285943
-1.028493
-8.994038
-4.483172
-33.513486
-3.06848
0.066718
1.414577

Brand 10
-2.473143
0.192358
0.81713
0.039964
0.452339
0.130452
1.669077
1.202645
0.774996
2.676727
0.989739
0.172047
22.868188
5.441019
3.239276
0.541938
1.574072
2.787941
0.939611
1.663594
2.223727
0.213116
2.578632
2.177511
0.12617
1.49087
2.247563
-3.144913
1.438528
-1.187941
-31.168224
-5.019412
-33.660915
-2.867074
0.033457
1.602941

Table 19: Coefficient estimates for consumer choice model with serially correlated consumer
and brand-specific unobserved heterogeneity: part 3
Variables
log(Price)
Pkg. quantity (oz)
Packaging: bag
Box
Canister
other
Flavor: Barbeque
Cheddar
Classic
Dill
Other
Missing
Cut: Flat
Rippled
Wavy
Other
Missing
Fat indication: Reduced
Regular
Missing
Cooking: Crispy
Kettle cooked
Other
Missing
Sodium indication: Reduced
Regular
Missing
Pre-tax income
Family size
Age male
Education male
Age Female
Education Female
Work male
Work female
Hispanic

Brand 11
-2.832483
0.049913
1.600841
0.66783
0.139967
1.064437
2.461822
4.808022
1.07844
2.687815
3.090167
1.208416
0.569647
9.962334
1.224002
3.228049
1.025563
0.494604
0.977317
0.453452
1.282562
0.846958
0.490823
3.066277
0.220772
3.278297
1.769905
-3.107872
5.085033
-0.308294
-11.639638
-3.958591
-22.979569
-2.465584
0.073555
1.636374

Brand 12
-3.377132
0.230882
0.118706
0.353583
1.525342
1.152173
3.416663
2.221313
1.917593
2.200718
1.616635
1.091454
13.65379
7.662772
1.545203
2.306742
1.182387
0.618838
1.664291
1.897675
1.199485
2.254751
1.409014
2.290534
2.03641
0.896235
0.108077
-2.114851
4.436701
-0.933368
-10.194708
-2.246844
-15.827254
-2.559206
0.005894
1.335034
67

Brand 13
-2.771604
0.053747
0.617699
0.037915
1.816851
0.740411
2.033453
3.301636
1.685969
1.338211
0.548024
1.163744
4.337904
6.120877
2.729351
0.349161
1.9929
2.900136
3.103324
2.550097
0.76986
0.684318
0.613642
1.426655
2.992886
0.785438
0.465667
-0.482997
5.358412
-0.518613
-20.207561
-0.810577
-11.254127
-0.994668
0.063267
0.645398

Brand 14
-3.497284
0.058217
2.056933
0.630748
2.932369
2.18755
0.193975
0.329845
0.338605
2.977077
1.587683
1.782808
0.914032
7.448297
0.558106
2.128965
1.314187
0.315187
1.754553
0.366025
0.922236
1.126301
0.085044
2.805567
0.761481
0.877279
1.745102
-0.726054
4.696524
-0.942868
-14.761104
-5.343278
-39.739514
-1.205902
0.048208
1.331692

Brand 15
-2.529089
0.041049
0.869879
0.320821
2.517147
1.210693
3.045213
3.980536
0.856008
1.352452
0.538777
2.062348
9.027001
7.093168
0.695127
1.702242
0.275021
2.544821
1.279596
2.723793
2.201934
2.962456
2.266251
0.900059
2.594839
2.438604
3.205335
-1.734766
0.313327
-1.336357
-21.938081
-0.145376
-12.535587
-1.376537
0.080662
2.231147

Table 20: Coefficient estimates for consumer choice model with serially correlated consumer
and brand-specific unobserved heterogeneity: part 4
Variables
log(Price)
Pkg. quantity (oz)
Packaging: bag
Box
Canister
other
Flavor: Barbeque
Cheddar
Classic
Dill
Other
Missing
Cut: Flat
Rippled
Wavy
Other
Missing
Fat indication: Reduced
Regular
Missing
Cooking: Crispy
Kettle cooked
Other
Missing
Sodium indication: Reduced
Regular
Missing
Pre-tax income
Family size
Age male
Education male
Age Female
Education Female
Work male
Work female
Hispanic

Brand 16
-2.65456
0.214722
0.329038
0.456768
2.430506
3.304824
2.318563
1.248369
0.740903
2.418467
2.925802
1.738911
5.157646
8.278694
1.759582
0.073455
1.698027
3.12346
1.667674
0.862517
2.948857
0.591628
3.078843
2.520156
0.188314
1.760145
1.216696
-3.150911
4.497552
-0.243806
-7.518827
-4.674357
-38.776416
-3.174855
0.076362
1.311957

Brand 17
-2.671703
0.069933
2.010122
0.808673
1.36155
2.336067
2.898738
3.641905
3.341088
0.927911
1.586381
1.001665
8.127552
4.803991
1.992636
0.367029
0.919257
0.740612
2.186504
2.932301
2.600496
0.549288
0.158544
0.240018
3.335747
3.061989
1.309844
-0.298756
0.147249
-0.640892
-20.366765
-3.098578
-18.424189
-3.153605
0.019372
1.313039
68

Brand 18
-3.402789
0.023916
1.392058
0.767574
0.801319
1.889204
0.661945
3.100562
2.813865
1.732779
2.942008
2.457159
9.455298
6.586358
3.14824
1.069979
1.581047
1.941488
0.131235
1.131967
1.024544
2.21809
1.708176
2.243487
1.835417
2.362086
1.665115
-1.584276
1.090846
-0.126559
-32.768399
-0.587867
-30.783284
-0.373659
0.015398
0.871052

Brand 19
-2.876268
0.117554
0.508031
0.344338
1.837389
1.383907
3.182186
4.430765
1.194648
3.373826
1.538393
1.28895
1.931442
7.938665
1.00224
3.27423
2.866553
1.099642
0.039267
2.435796
2.865601
1.650761
2.033724
2.816472
0.158818
1.47624
1.864185
-0.723553
4.11252
-0.497055
-22.227705
-3.512758
-0.613146
-0.98848
0.052889
1.5276

Brand 20
-2.610249
0.080076
0.265844
0.916292
1.128458
3.423793
2.134064
2.862633
2.614328
3.333253
3.146978
2.800001
8.526636
1.443765
3.244111
0.015846
0.445962
2.53422
2.979704
1.551027
2.281548
2.90468
1.019161
2.67039
1.007104
3.291899
0.148474
-1.788233
3.563815
-1.641209
-23.662763
-3.791617
-39.625269
-0.507682
0.049528
1.721466

Table 21: Coefficient estimates for consumer choice model without unobserved heterogeneity: part 1
Variables
log(Price)
Pkg. quantity (oz)
Packaging: bag
Box
Canister
other
Flavor: Barbeque
Cheddar
Classic
Dill
Other
Missing
Cut: Flat
Rippled
Wavy
Other
Missing
Fat indication: Reduced
Regular
Missing
Cooking: Crispy
Kettle cooked
Other
Missing
Sodium indication: Reduced
Regular
Missing
Pre-tax income
Family size
Age male
Education male
Age Female
Education Female
Work male
Work female
Hispanic

Brand 1
-4.165822
0.110578
0.326362
0.021068
0.13326
2.212735
0.309188
1.926521
0.178167
2.423557
0.783219
0.547649
17.424891
2.459214
1.788228
0.562744
1.102998
0.588252
0.279152
1.378011
0.790333
1.506478
2.493808
0.516302
1.525073
1.019638
0.161072
-0.855846
2.691766
-1.041996
-6.242541
-6.627981
-40.128482
-4.449358
0.052662
0.880216

Brand 2
-5.386564
0.158264
0.341004
0.650912
0.476179
0.813927
0.715059
0.746351
1.317739
0.80767
0.675258
0.359212
2.951845
8.556563
1.713201
0.725479
0.022778
2.558548
1.561708
2.576356
1.125594
1.301525
0.426577
0.22664
1.469333
1.781308
1.434877
-4.250458
2.314595
-2.443184
-40.394791
-0.727685
-26.834798
-1.87242
0.03255
0.282617
69

Brand 3
-5.365204
0.068733
0.864795
0.374105
0.473303
2.457802
1.573114
2.479831
2.055443
1.831116
1.011162
0.936272
8.680732
4.837721
0.039203
1.555318
0.68523
1.009842
0.329483
1.370222
1.361933
1.977683
0.866939
2.414835
1.995248
1.90269
1.625611
-4.463546
4.08801
-1.534026
-19.719089
-6.96913
-61.137031
-3.109071
0.108231
0.579385

Brand 4
-4.193513
0.010223
0.2872
0.37723
1.558845
0.536493
0.651692
0.163897
1.609769
1.547685
0.922373
1.351815
14.586069
6.878325
0.199366
2.634525
0.808989
1.806997
0.764724
0.298344
1.990712
2.078281
1.715311
1.236038
1.673107
0.744342
0.744006
-1.127139
7.095724
-1.110189
-16.976177
-8.556765
-1.390044
-1.798329
0.023519
3.555073

Brand 5
-4.300462
0.011204
0.292761
0.080592
1.417243
1.168099
0.565978
1.361593
2.047781
0.127566
0.884892
1.139046
8.236349
4.889042
1.706493
2.449236
0.654261
0.704029
1.387526
0.339283
0.328233
0.896909
1.046856
1.472778
2.143054
2.298365
0.474184
-5.5819
2.540808
-0.93047
-29.850739
-7.504168
-53.885656
-3.875555
0.094144
0.895571

Table 22: Coefficient estimates for consumer choice model without unobserved heterogeneity: part 2
Variables
log(Price)
Pkg. quantity (oz)
Packaging: bag
Box
Canister
other
Flavor: Barbeque
Cheddar
Classic
Dill
Other
Missing
Cut: Flat
Rippled
Wavy
Other
Missing
Fat indication: Reduced
Regular
Missing
Cooking: Crispy
Kettle cooked
Other
Missing
Sodium indication: Reduced
Regular
Missing
Pre-tax income
Family size
Age male
Education male
Age Female
Education Female
Work male
Work female
Hispanic

Brand 6
-5.942396
0.100403
1.528673
0.262017
2.208332
1.198789
1.640518
2.138886
1.720011
0.19335
0.198886
1.228729
10.755164
5.560848
1.122226
0.96761
0.090624
1.008904
1.053043
0.270797
0.408829
1.650217
0.284677
0.992637
0.727254
1.524695
1.388155
-4.487869
6.77549
-1.537945
-45.872031
-6.204733
-15.772796
-0.062776
0.113847
2.772715

Brand 7
-6.631553
0.015798
1.262471
0.248657
0.935361
0.458909
0.963101
1.101339
0.016727
1.558747
1.760965
1.48904
12.723075
3.575512
0.519879
0.947765
1.813063
0.377457
0.139044
1.558468
1.690843
1.177204
1.255097
0.273154
0.928646
1.783301
0.185051
-5.50511
9.872027
-1.975047
-30.453402
-4.661933
-63.238631
-3.253028
0.110697
2.507646
70

Brand 8
-5.33314
0.046498
0.397429
0.11899
1.631955
0.613683
1.434067
0.476418
0.56878
0.680782
2.352432
1.226602
11.819334
1.021045
1.279616
0.868797
0.23638
1.356393
1.877635
0.532695
1.941648
0.948795
0.860667
0.341603
0.406623
1.887261
1.613794
-0.798736
6.009347
-1.061209
-42.889598
-5.370452
-40.137163
-0.825571
0.045031
1.522741

Brand 9
-5.463779
0.062104
0.052525
0.140372
0.604184
1.63443
0.596472
0.622793
1.235842
0.835989
1.586522
0.543439
9.378905
4.216397
1.113999
0.934202
2.639069
1.069813
1.168561
1.197255
0.603736
2.162084
0.244123
2.016055
1.989706
1.243915
1.575446
-1.827621
5.543223
-2.063721
-25.072204
-1.054304
-63.13209
-3.887503
0.048243
0.235443

Brand 10
-4.585297
0.015571
0.42474
0.084643
1.933457
1.100732
0.835032
1.272544
0.899407
2.193451
1.508106
1.694876
1.896329
1.677433
1.249871
1.361492
0.572035
0.394479
0.61018
1.424094
1.931615
0.329338
2.039686
1.901628
0.056746
1.597559
2.259512
-3.104033
8.759527
-1.270058
-13.63651
-6.491553
-55.651209
-2.180464
0.051391
2.912699

Table 23: Coefficient estimates for consumer choice model without unobserved heterogeneity: part 3
Variables
log(Price)
Pkg. quantity (oz)
Packaging: bag
Box
Canister
other
Flavor: Barbeque
Cheddar
Classic
Dill
Other
Missing
Cut: Flat
Rippled
Wavy
Other
Missing
Fat indication: Reduced
Regular
Missing
Cooking: Crispy
Kettle cooked
Other
Missing
Sodium indication: Reduced
Regular
Missing
Pre-tax income
Family size
Age male
Education male
Age Female
Education Female
Work male
Work female
Hispanic

Brand 11
-5.701579
0.052347
0.599797
0.539036
1.328678
1.003705
0.707111
0.781812
0.036601
0.140996
0.094312
1.173771
5.477097
3.444869
1.92152
1.011258
0.825069
1.483487
0.226998
0.005091
0.336888
2.398844
2.569468
0.028339
0.511914
1.41527
0.237487
-0.471282
2.840776
-2.444957
-30.61355
-2.084504
-0.098408
-3.686434
0.017135
2.782203

Brand 12
-6.153897
0.044234
1.20975
0.117165
2.239394
0.999802
0.099615
1.745907
1.054822
1.009944
1.269004
0.206495
4.056816
3.747512
0.341824
1.269357
0.065132
1.72401
0.878857
1.563122
0.320954
0.459408
2.021763
0.764783
1.184127
0.619621
2.2337
-2.858001
2.882248
-1.277594
-2.350366
-6.290976
-44.789743
-4.003346
0.008615
3.744826
71

Brand 13
-5.569636
0.065901
0.585687
0.400723
0.685635
1.294024
0.710088
2.550642
1.081916
1.145985
0.766857
1.116473
4.275265
3.94062
2.036878
1.062805
0.967002
0.301453
0.60496
0.359839
0.735975
0.514702
0.302024
0.058601
1.130265
0.74064
2.702513
-0.793913
5.98188
-2.089676
-6.891827
-1.038558
-41.493357
-4.008495
0.049143
3.835797

Brand 14
-4.179997
0.123
0.570026
0.48628
1.858454
2.080618
1.994047
2.369324
0.555373
1.509845
0.341079
1.512532
6.66029
2.655449
1.138402
1.50636
0.363923
0.96603
2.126524
0.829744
1.530435
2.343202
1.608572
0.243557
0.835812
1.438851
1.726688
-1.134544
5.830896
-2.057892
-14.514786
-0.632368
-33.137318
-5.977308
0.060251
2.177668

Brand 15
-6.387933
0.004293
0.71747
0.452487
0.569346
0.485416
1.773578
3.359982
2.8331
1.1288
0.458858
1.621733
3.848013
6.212754
0.472894
1.926623
1.275612
1.035122
1.648472
1.657967
1.16523
2.022477
1.834448
1.648182
2.112263
0.617883
1.460125
-3.011794
4.483393
-0.212153
-11.433809
-8.778083
-60.581205
-4.636364
0.148519
0.887173

Table 24: Coefficient estimates for consumer choice model without unobserved heterogeneity: part 4
Variables
log(Price)
Pkg. quantity (oz)
Packaging: bag
Box
Canister
other
Flavor: Barbeque
Cheddar
Classic
Dill
Other
Missing
Cut: Flat
Rippled
Wavy
Other
Missing
Fat indication: Reduced
Regular
Missing
Cooking: Crispy
Kettle cooked
Other
Missing
Sodium indication: Reduced
Regular
Missing
Pre-tax income
Family size
Age male
Education male
Age Female
Education Female
Work male
Work female
Hispanic

Brand 16
-3.657458
0.072216
0.323703
0.130689
2.34006
0.651848
1.537395
2.241224
1.650107
0.04128
1.270501
0.977024
15.983062
7.974686
0.918974
0.036814
0.634043
0.550543
0.306531
2.011747
1.040639
0.542647
0.867668
0.579038
1.744876
0.189598
0.103778
-5.897316
3.071121
-1.217371
-26.642239
-7.719932
-30.140097
-5.456659
0.055232
0.428278

Brand 17
-5.087297
0.096999
1.503906
0.643636
0.310726
0.510269
1.627388
1.9829
0.098588
2.20342
1.698583
2.53051
17.587212
2.273874
0.797805
1.513505
1.121361
0.402566
0.495048
1.592642
0.526655
0.891644
1.614956
0.933107
1.80043
0.499006
0.658885
-3.518929
6.79469
-0.225644
-22.698188
-0.72764
-23.681847
-2.276498
0.14906
4.600718
72

Brand 18
-5.721577
0.005196
0.791686
0.62666
1.182337
0.123232
0.584187
1.292326
0.210854
0.390171
0.205198
0.448205
9.795252
0.534869
0.756303
0.217719
1.650162
2.045991
0.741667
0.263512
0.264302
0.51518
1.297056
1.665178
1.284818
1.413911
0.133986
-1.44832
0.691731
-2.478639
-42.233385
-0.979365
-43.966854
-2.56086
0.014044
1.283886

Brand 19
-5.394077
0.12646
0.708138
0.627598
1.183339
0.399809
0.763447
3.110279
0.777324
1.445992
2.352648
0.086543
15.078067
0.222243
2.344447
1.01393
2.136423
1.852582
1.402807
0.151334
1.35717
2.021249
0.286831
1.621085
0.372325
0.750868
1.628518
-3.32489
6.581674
-0.362583
-29.881693
-4.417174
-46.336628
-2.113586
0.060431
0.585398

Brand 20
-5.820561
0.101312
0.55918
0.002174
1.397798
0.872859
2.562344
1.123984
2.025672
0.368976
2.173152
0.735897
11.286216
3.023763
0.462558
2.10527
1.058599
0.301347
1.923906
1.203223
1.548327
1.438555
1.274577
0.555817
0.590017
1.271185
0.977413
-3.572895
1.513708
-0.681375
-15.795049
-7.825331
-31.340084
-1.737959
0.013366
3.790626

Table 25: Impact of an unexpected 10% price drop for “Lay’s potato chips” on the price
elasticity
Week

1
2
3
4
5
6
7
8
9
10

OLS

IV

-0.29134
-0.29134
-0.29134
-0.29134
-0.29134
-0.29134
-0.29134
-0.29134
-0.29134
-0.29134

-1.21362
-1.21362
-1.21362
-1.21362
-1.21362
-1.21362
-1.21362
-1.21362
-1.21362
-1.21362

Demand model
BLP
BLP
(random coefficients) (no random coefficients)
-2.92362
-2.92362
-2.92362
-2.92362
-2.92362
-2.92362
-2.92362
-2.92362
-2.92362
-2.92362

73

-3.69832
-3.69832
-3.69832
-3.69832
-3.69832
-3.69832
-3.69832
-3.69832
-3.69832
-3.69832

Dynamic decision model
(random coefficients
+ serial correlation)
-2.85327
-2.83287
-2.82933
-2.63647
-2.51385
-2.49583
-2.47564
-2.46541
-2.45695
-2.44564

Figure 1: Median and Percentiles of numerically recovered utility

−20

−25

−30

−35

−40

−45
−3

−2

−1

0

74

1

2

3

Figure 2: Histogram of variances of log-market shares over products and over markets

75

Figure 3: Histogram of log-market shares following the weeks with and without price promotions
Pr
omot
i
on

Nopr
omot
i
on

76

Figure 4: Histogram of log-market shares following the weeks with and without price promotions

77

Figure 5: Dependence of the current log-market share from lagged log-market share the
weeks with and without price promotions
Pr
omot
i
on

NoPr
omot
i
on

78

