NBER WORKING PAPER SERIES

STRUCTURAL GRAVITY AND FIXED EFFECTS
Thibault Fally
Working Paper 21212
http://www.nber.org/papers/w21212

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2015

I would like to thank Jim Anderson, Justin Caron, Keith Head, Russell Hillberry, Xiaodong Liu, Jim
Markusen, Keith Maskus, Thierry Mayer, João Santos Silva, Silvana Tenreyro, Daniel Trefler, Yoto
Yotov and participants to the AEA meetings for helpful comments and discussions. The views expressed
herein are those of the author and do not necessarily reflect the views of the National Bureau of Economic
Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2015 by Thibault Fally. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.

Structural Gravity and Fixed Effects
Thibault Fally
NBER Working Paper No. 21212
May 2015
JEL No. C13,C50,F10,F15
ABSTRACT
The gravity equation for trade flows is one of the most successful empirical models in economics and
has long played a central role in the trade literature (Anderson, 2011). Different approaches to estimate
the gravity equation, i.e. reduced-form or more structural, have been proposed. This paper examines
the role of adding-up constraints as the key difference between structural gravity with "multilateral
resistance" indexes and reduced-form gravity with simple fixed effects by exporter and importer. In
particular, estimating gravity equations using the Poisson Pseudo-Maximum-Likelihood Estimator
(Poisson PML) with fixed effects automatically satisfies these constraints and is consistent with the
introduction of "multilateral resistance" indexes as in Anderson and van Wincoop (2003).

Thibault Fally
Department of Agricultural and Resource Economics
University of California at Berkeley
301 Giannini Hall
Berkeley, CA 94720-3310
and NBER
fally@berkeley.edu

1

Introduction

The gravity equation is one of the most successful empirical models in economics and has been
the focus of a very extensive literature in international trade (Anderson 2011). The very good
fit of the gravity equation for bilateral trade flows has long been recognized since Tinbergen
(1962) and the many papers that followed.1
Various ways to specify and estimate the gravity equation have been proposed (see Feenstra
2004, Head and Mayer 2014). Specifications vary broadly along two dimensions. A first dimension concerns the error term. The second is the degree of model structure that is imposed
on the estimation. Among the estimation approaches available, one possibility is to use the
Poisson pseudo-maximum likelihood method (Poisson-PML). Santos Silva and Tenreyro (2006)
show that Poisson-PML consistently estimates the gravity equation for trade and is robust to
different patterns of heteroskedasticity and measurement error, which makes it preferable to
alternative procedures such as ordinary least squares (using the log of trade flows) or non-linear
least squares (in levels).2
There are also different trends in the specification of supply-side and demand-side effects in
the gravity equation. Early papers have simply used total (multilateral) expenditures and total
output for supply- and demand-side terms. It has been recognized, however, that adjustments
are necessary to account for differences in market thickness across destinations (captured by
the “inward multilateral-resistance index” in Anderson and van Wincoop 2003) and source
countries (captured by the “outward multilateral resistance index”). There are now two main
ways to account for these adjustments. A set of papers introduces exporter and importer
fixed effects to capture both market-size effects and multilateral-resistance indexes in a simple
way (e.g. Harrigan 1996, Redding and Venables 2004). Another trend instead imposes more
structure on the gravity equation. This approach has been put forward by Anderson and van
Wincoop (2003), Anderson and Yotov (2010), and Balistreri and Hillberry (2007), with some
variations in the restrictions imposed on the demand side (e.g., Fieler 2012) or supply side (e.g.,
Costinot, Donaldson and Komunjer, 2012).3
In this paper, I show that estimating gravity with Poisson PML and fixed effects is consistent with the equilibrium constraints imposed by more structural approaches such as those
of Anderson and van Wincoop (2003) and Anderson and Yotov (2010). In particular, the
1

Note that most gravity equation estimates focus on the cross-section. Lai and Trefler (2002) is one of the
few exceptions; they find that the gravity equation framework does not perform as well in time series.
2
Poisson-PML is also consistent with the presence of zero bilateral trade flows, which are highly prevalent
in disaggregated data. An alternative method by Helpman, Melitz and Rubinstein (2008) involves a 2-step
estimation to structurally account for zeros.
3
A growing literature also uses the MPEC approach, as in Balistreri et al (2011).

2

estimated fixed effects in the Poisson PML specification are consistent with the definition of
outward and inward multilateral resistance indexes and the equilibrium constraints that they
need to satisfy. Therefore, gravity regressions with fixed effects and Poisson PML can be used
as a simple tool to solve the estimation problem raised by Anderson and van Wincoop (2003).
More generally, the constraints imposed on multilateral-resistance indexes in the structuralgravity framework are equivalent to imposing adding-up constraints on the sum of trade flows
for each source country and each destination. This result is valid for any estimator. However,
when the Poisson-PML estimator is used, these constraints are automatically satisfied as long
as we have exporter and importer fixed effects and consistent data. This adding-up property
is specific to Poisson-PML regressions and could also be useful for other applications where
we want to constrain the sum of fitted values to be fixed, because other estimators do not
automatically satisfy adding-up constraints.4
In the last section, I estimate gravity equations and provide quantitative examples to illustrate these points. First, these results imply that the test of structural gravity performed
by Anderson and Yotov (2010) is bound to support structural gravity when Poisson-PML is
used. I verify this assertion using consistent data where outward trade flows sum up to output and inward trade flows sum up to expenditures. Secondly, I find large deviations between
fitted output and observed output when gravity is estimated with importer and exporter fixed
effects, especially with ordinary least squares (OLS) and Gamma-PML estimators. I also find
large differences between multilateral-resistance indexes depending on whether they are constructed from importer or exporter fixed effects, unless we impose additional constraints on
these indexes. Thirdly, there are systematic biases depending on market size. With OLS and
Gamma-PML, the sum of fitted trade flows tends to be larger than observed output for large
countries and smaller than observed output for small countries. This points to undesirable
properties of OLS and Gamma-PML when no constraints on multilateral-resistance indexes are
imposed.

2

The gravity model

A wide range of trade models generate relationships in bilateral trade flows that can be expressed by the following set of equations. For each exporter i and importer j, trade flows Xij
should satisfy:
Ej
Yi
−θ
. −θ
(1)
Xij = −θ . Dij
Πi
Pj
4

For instance, Poisson-PML could be useful in consumption choice models where the sum of expenditures is
fixed for given subsets of observations.

3

In this equation, Yi refers to total output in country i; Ej refers to total expenditure in country
j; Dij captures trade costs from i to j; and the parameter θ reflects the elasticity of trade flows
to trade costs, which may have different structural interpretations depending on the model, as
described below. Finally, the terms Pj−θ and Π−θ
i are called “multilateral resistance” indexes by
Anderson and van Wincoop (respectively “inward” and “outward” resistance indexes). These
two resistance terms should satisfy the following constraints for consistency, which define the
“structural gravity” framework (Anderson 2011):

Definition: “structural gravity”: The patterns of trade flows Xij are consistent with the
“structural gravity” framework if they satisfy equation (1) with the following two constraints on
multilateral-resistance terms Pj and Πi :
Pj−θ =

−θ
X Yi Dij
i

Π−θ
i =

Π−θ
i

−θ
X Ej Dij
j

Pj−θ

(2)

(3)

−θ
These equations define Pj and Πi . Given output Yi , expenditures Ej and trade costs Dij
,
−θ
−θ
the solution in Pj and Πi to this system of two equations is unique, up to a constant (the
proof of uniqueness is provided with Lemma 3 in Appendix A). As noted by Anderson and
Yotov (2010), when Pj−θ and Π−θ
satisfy equations (2) and (3), λPj−θ and Π−θ
i
i /λ are also
solutions, for any number λ > 0. This indeterminacy calls for a normalization; we thus impose
P0 = 1 for a benchmark importer j = 0. These equations can also be defined at the industry
or product level. For convenience, I do not add industry subscripts but all results in the paper
hold within each industry (as in Anderson and Yotov, 2010 and 2012).
This system of equations can be derived from various types of models. It is consistent with
models based on Armington (1979) and Krugman (1980) with a constant elasticity of substitution in consumer preferences (Anderson and Van Wincoop, 2003, Redding and Venables, 2004,
Fally, Paillacar and Terra, 2010, among many others). In these models, θ + 1 corresponds to
the elasticity of substitution. Models based on Melitz (2003), such as Chaney (2008), can also
generate gravity equations, as above. In this case, the equivalent of θ would be the coefficient of
the Pareto distribution of firm productivity; the coefficient is inversely related to productivity
dispersion. As shown by Eaton and Kortum (2002), Ricardian models of trade are also fully
consistent with gravity. In this case, the trade-cost elasticity θ corresponds to one of the coefficients of the Frechet distribution of productivity across product varieties (again, the coefficient

4

is inversely related to productivity dispersion).5 In all of the above-mentioned models, the
inward multilateral resistance index Pj−θ can be expressed as a function of the price index in
the importing market. In turn, Π−θ
captures the degree of competition faced by exporter i.
i
Various theoretical features have been used to generate structural gravity equations, including a constant elasticity of substitution, Pareto distributions of productivity (Chaney, 2008,
Costinot et al., 2012) and Frechet distributions (Eaton and Kortum, 2002). The key ingredient
is that trade flows can be written as a product of an exporter term, an importer term and
a term reflecting trade costs (separability condition). Another key ingredient is a consistent
definition of output and expenditures.
Formally, Head and Mayer (2014) define “general gravity” when trade flows can be written
as Xij = exp[ei − θ log Dij + mj ] where ei is invariant across importers and mj is invariant
across importers j. “General gravity” is in fact equivalent to “structural gravity” when output
P
equals the sum of outward trade Yi = j Xij and expenditures equal the sum of inward trade
P
Ej = i Xij . When trade satisfies the “general gravity” condition, we can re-express trade as in
equation (1) with a unique set of inward and outward multilateral-resistance indexes satisfying
equations (2) and (3). This is shown formally in Lemma 3 in Appendix A. This equivalence
has important empirical implications, which are illustrated with Lemma 1A and 1B in the next
section.

3

Gravity with fixed effects

To estimate equation (1), there are broadly two approaches which differ in the treatment of
j
i
and importer terms PE−θ
.
exporter terms ΠY−θ
i
j
A first approach, the reduced-form, simply introduces exporter and importer fixed effects ei
and mj without imposing any constraints on these terms. This approach ignores the structure
proposed by equations (2) and (3). The estimated equation can then be written:
Xij = exp [ei − θ log Dij + mj ] . εij

(4)

where εij denotes an error term. Note that the two full sets of exporter and importer fixed
c0 = 0 is imposed for
effects are not of full rank.6 In the remainder of the paper, the restriction m
the benchmark country j = 0. The trade cost variable, log Dij , is often assumed to be a linear
combination of the log of physical distance, dummies for common language, colonial links and
5

Gravity equations can also be motivated by Heckscher-Ohlin and specific-factor models (see Evenett and
Keller, 2004).
6
The sum of importer dummy variables equals the sum of exporter dummy variables.

5

free trade agreements, etc.7 The use of fixed effects makes the gravity equation very easy to
estimate. Various estimators have been used: ordinary least squares (in log), non-linear leastsquares, Poisson-PML, Gamma-PML and negative binomial estimators have been employed to
estimate equation (4). The results in this section apply to any of these estimators while the
next section highlights particular properties of Poisson-PML.
Instead of using dummy variables, a more structural approach pioneered by Anderson and


i
and mj =
van Wincoop (2003) is to define exporter and importer terms as ei = log ΠY−θ
i

log



Ej
Pj−θ



and impose the following conditions on estimated multilateral resistance indexes Π−θ
i
d

and Pj−θ (along with the normalization P0 = 1):8
d

d
−θ

Pj

d
−θ
X Yi D
ij
=
d
−θ

(5)

d
−θ
X Ej D
ij
=
d
−θ

(6)

i

d
−θ

Πi

j

Πi

Pj

−θ
where Ej refers to observed expenditure by country j, Yi refers to observed output in i, and Dij
is the estimated term for trade cost. Anderson and van Wincoop (2003) minimize the sum of
squared errors in log while imposing equations (5) and (6) as constraints in the minimization.
d
−θ
Anderson and Yotov (2010) estimate equation (4) with fixed effects in a first step to obtain Dij
and then solve equations (5) and (6) in a second step to obtain inward and outward resistance
indexes. Head and Mayer (2014) propose estimating gravity with “structurally reiterated least
d
−θ
squares” (SILS) by: i) estimating equation (4) with fixed effects to obtain Dij
; ii) solving
equations (5) and (6) to obtain inward and outward resistance indexes (which depend on
d
−θ
Dij
); iii) reiterating the first step using the second-step estimates of multilateral resistance

d

−θ
indexes instead of fixed effects to obtain an updated estimate of Dij
. Steps ii) and iii) are then
reiterated until convergence is achieved.
While the structural approach exploits additional restrictions on multilateral-resistance indexes, these two approaches are not very different. In fact, the fixed-effect estimation is conP c
sistent with the structural-gravity framework if we use fitted output Ybi ≡ j X
ij and fitted
P
c instead of observed output and expenditures (where X
c refers to
expenditures Ebj ≡ i X
ij
ij

d

7

Note that θ cannot be identified from the coefficients for physical distance and usual trade costs variables.
What is estimated is the product of θ with the elasticity of trade costs w.r.t these variables. A special case
would be to use tariffs (as in Caliendo and Parro, 2011), for which the coefficient should in principle equal θ.
8
Anderson and van Wincoop (2003) focus on a special case with symmetric trade costs and output being
equal to expenditures. The results here allow for asymmetry so that they are also valid at the industry level
where output and expenditures can largely differ. See e.g., French (2014) for potential aggregation issues.

6

fitted trade flows from the estimation of equation 4 with fixed effects). We can then redefine
the system of equations (5) and (6) (where Pj−θ and Π−θ
are the two unknowns) in terms of
i
b
b
fitted output and expenditures Yi and Ej instead of observed values Yi and Ej :
Pj−θ

=

d
−θ
X Ybi D
ij
i

Π−θ
i

=

(7)

Π−θ
i

d
−θ
b D
XE
j ij
j

(8)

Pj−θ

Thus, we obtain Lemma 1A:
Lemma 1 A) Substituting fitted output and expenditures:
If equation (4) is estimated with importer and exporter fixed effects, the terms Pj−θ and Π−θ
dei
g

g

Ej
−θ
b b
c
b
fined by Pj−θ ≡ E
b0 exp(−mj ) and Πi ≡ E0 Yi exp(−ei ) are the unique solutions of equations (7)
d
−θ 9
and (8) (using fitted output, fitted expenditures and estimated trade costs Dij
).

g

b

g

In other words, fitted values from the fixed effects regressions are consistent with the two
general-equilibrium conditions imposed by the gravity model if we use fitted expenditures and
output instead of solving for multilateral-resistance indexes with observed expenditures and
output.10 Another illustration of the role adding-up constraints and separability is the following
equivalence. The estimation of structural gravity (using observed output and expenditures) is in
fact equivalent to including fixed effects and imposing the sum of fitted trade to equal observed
output and expenditures for each source and each destination:
Lemma 1 B) Imposing observed output and expenditures:
cj , imposing
If equation (4) is estimated with importer and exporter fixed effects ebi and m




P c
P c
Ej
Y
i
bi = log
cj = log
and
m
j Xij = Yi and
i Xij = Ej is equivalent to imposing e
−θ
−θ
d
d
Πi

Pj

and the restrictions (5) and (6) using observed output Yi and expenditures Ej .
It is important to note that, in general, the sum of fitted trade does not add up to observed
output and expenditures unless such a constraint is explicitly added in the estimation. Hence,
−θ
The normalization Pg
= 1 is satisfied given that we impose m
b 0 = 0 in the estimation.
0
Note that the fixed effects should not be held constant for counter-factual simulations (such as the border
removal in Anderson and van Wincoop, 2003). While fixed effects may be consistent with estimated trade costs,
fitted output and expenditures, multilateral-resistance indexes need to be recomputed and fixed effects adjusted
accordingly if trade costs are changed in the counter-factual exercise.
9

10

7

it is important to either redefine output and expenditures (Lemma 1A) or impose fitted trade
to sum up to observed expenditures and output (Lemma 1B). In Section 5, I illustrate the
deviations between observed output and fitted output with various estimators. Section 5 shows
that there are systematic deviations between fitted output and observed output depending on
market size, which constitutes an argument for estimating structural gravity and imposing the
sum of fitted trade. As shown in the next section, the Poisson-PML estimator is an exception:
fitted output and expenditures always equal observed output and expenditures as long as
exporter and importer fixed effects are included.

4

Structural fit of Poisson PML

A now widely-used strategy (following Santos Silva and Tenreyro 2006) is to estimate equation (4) using Poisson pseudo-maximum-likelihood. The Poisson-PML estimator identifies the
coefficients using the same first-order conditions that are used by the maximum-likelihood estimator derived from the Poisson distribution. However, Poisson-PML does not require the
dependent variable to be Poisson distributed. The estimation procedure is fairly easy to implement and robust to misspecifications (Gourieroux, Monfort and Trognon, 1984). As shown
by Santos Silva and Tenreyro (2006), the first-order conditions associated with Poisson-PML
provide a natural estimator, whether or not trade flows follow a Poisson distribution.11
In addition, the Poisson-PML estimator has special properties if we compare fitted output
and expenditures to their observed counterparts. When there are no missing observations,12
we obtain the following result:
Lemma 2 If equation (4) is estimated using Poisson PML with exporter fixed effects, fitted
production equals observed production. Similarly, when importer fixed effects are included, fitted
expenditures by importer and product equal observed expenditures:
X
j

c =
X
ij

X

Xij = Yi and

j

X
i

c =
X
ij

X

Xij = Ej

i

This lemma is directly derived from the first-order conditions associated with the PoissonPML approach (see Appendix for details).13
11

Poisson-PML does not require the dependent variable to be an integer and is consistent with over-dispersion
(i.e. with a conditional variance larger than the conditional expectation). Santos Silva and Tenreyro (2011)
provide additional evidence on the good performance of PPML by also allowing for a large fraction of zeros.
For more details, see also: http://privatewww.essex.ac.uk/˜jmcss/LGW.html
12
The case of missing observations for internal trade flows is discussed in Appendix B.
13
Independent work by Arvis and Shepherd (2013) uncovers a similar property of Poisson-PML estimators

8

According to Lemma 1B, imposing consistency of the multilateral-resistance indexes with
the structural gravity framework is equivalent to imposing the sum of fitted trade to equal
output and expenditures for each country. Because these constraints are systematically satisfied
with Poisson-PML, we obtain this very practical result:
Proposition 1 If equation (4) is estimated using Poisson PML with exporter and importer
d
d
Ej
cj ) and Π−θ
fixed effects, the two multilateral-resistance terms defined by Pj−θ ≡ E
exp(−m
≡
i
0
E0 Yi exp(−ebi ) are the unique solutions of equations (5) and (6), where Ej and Yi refer to
observed expenditures and output.
Anderson and Yotov (2012) suggest comparing unconstrained fixed effects and theoryconsistent multilateral-resistance indexes (solving equations 5 and 6) as a “test” of structural
gravity. Unfortunately, Proposition 1 shows that such a test is bound to succeed if the PoissonPML is used as an estimator; it is therefore not a test of structural gravity. Anderson and Yotov
(2012) do not actually find a perfect fit. An explanation is that trade flows do not perfectly
add up to output Yi and expenditures Ej in the data (information on output and international
trade flows generally comes from different sources). I do find a perfect fit using GTAP data
with harmonized information on trade, output and expenditures (see Section 5).
Proposition 1 adds to other advantages of using fixed effects and Poisson PML, and complements the arguments provided by Santos Silva and Tenreyro (2006). An important point to
note is that Lemma 2 and Proposition 1 hold even if the dependent variable does not actually
follow a Poisson distribution. No assumption is needed on the distribution of trade flows except
that the conditional mean of trade flows is positive (Poisson-PML also allows for zero trade
flows).
Moreover, these properties are specific to Poisson-PML, which is the only PML estimator
that yields Lemma 2. If we estimate the gravity equation in logs with OLS and fixed effects,
P
c = P log X and P log X
c = P log X , which do not imply equality
we obtain: j log X
ij
ij
ij
ij
j
i
i
between the sums in level. If we estimate gravity by taking trade flows in levels and minimizing
the sum of squared errors (NLLS), the inclusion of exporter and importer fixed effects implies
P c
P
P c
P
2
2
j Xij Xij =
j Xij and
i Xij Xij =
i Xij . For Gamma-PML, the inclusion of fixed effects
Xij
implies that the ratio X
b averages to unity for each exporter and each importer. None of these
ij

equalities implies equality between

P c
P
P c
P
14
j Xij and
j Xij or between
i Xij and
i Xij .

as preserving the total sum of the dependent variable. They do not, however, examine applications to the
structural gravity framework. Arvis and Shepherd (2013) also argue that this property is unique to PoissonPML, but their argument implicitly relies on an assumption that a solution always exists, which is not true for
PPML.
X
14
Moreover, this property is not satisfied if we use trade shares Eijj (share of imports from i for each importer
j) with Poisson-PML. The sum of fitted trade for each exporter would not sum up to output in general.

9

This specificity of Poisson-PML is stated formally in Proposition 2 below. In a more general
setting, let us denote by yi the left-hand-side variable for observations indexed by i, with
∗
yi ∈ R+ , and by ŷi ∈ R+ the fitted value. A pseudo-maximum-likelihood estimator maximizes
the following objective function:
X
max
log f (yi , λi )
λi

i

where, for each λ > 0, f (y, λ) is the p.d.f. of a random variable with mean λ. We further
(k)
impose that λ depends log-linearly on K independent variables xi indexed by k where the
coefficients bk have to be estimated:
λi = exp

X

(k)
bk x i

!

k

Hence ŷi = λi when λi is the solution of the above maximization. For any subset A of observations, we define the dummy variable DA as having a value 1 for observations in A and zero
otherwise. We can now uniquely characterize the Poisson-PML estimator as follows:

Proposition 2 The Poisson-PML estimator is the only pseudo-maximum-likelihood estimator
such that, for any subset A of observations and its associated dummy variable DA , the inclusion
P
of DA in the set of right-hand-side variables implies that the sum of fitted values i∈A ŷi equals
P
the sum of observed values i∈A yi over the set A.
Since maximum-likelihood estimators can be considered as a special case of PML (when
the likelihood function to maximize is derived from the assumed distribution of the dependent
variable), Proposition 2 also implies that no ML-estimator other than Poisson-ML satisfies this
adding-up property.15
The proof (in the appendix) is organized in two steps. First, such an estimator is necessarily
f
is a linear function of y. I
from the linear-exponential family, i.e. estimators for which ∂∂ log
log λ
show that this is the only class of estimators for which regressing a variable yi on a constant
P
term yields the average ȳ = N1 i yi as the fitted value (Lemma 4 in Appendix A). The second
f
step shows that ∂∂ log
must also be linear in λ to satisfy the properties of Proposition 2; this
log λ
corresponds to the Poisson-PML estimator.
15

In turn, PML estimators can be seen as a special case of generalized-moment-method (GMM) estimators
where moment conditions are exactly identified.

10

5

Illustrations

To what extent does the estimation of structural gravity differ from reduced-form gravity with
fixed effects? In this section, I examine various specifications to illustrate the previous findings.
I compare output and expenditures to the sum of fitted trade flows for each country, as well as
multilateral-resistance indexes implied by either importer or exporter fixed effects.

5.1

Data

Data on trade flows come from the Global Trade Analysis Project (GTAP).16 The dataset has
the main advantage of providing harmonized information on production, consumption and
international trade flows by country and sector. It is micro-consistent to the extent that
domestic and international trade flows sum up to output for each source country and sum
up to expenditures for each destination country. This is an important property since Lemma 2
and Proposition 1 would not apply otherwise. If such equalities were not satisfied in the data,
the multilateral-resistance indexes implied by the fixed effects with Poisson-PML would not
satisfy the structural gravity constraints based on actual output and expenditures.17
As usual in the gravity equation literature, I regress trade flows on various trade-cost proxies. In addition to the fixed effects or multilateral-resistance indexes, right-hand-side variables
include the log of distance, a border-effect dummy (equal to one for international flows), contiguity, as well as dummies for colonial ties and common language. Data on distance and other
trade costs are provided by the CEPII.

5.2

Specifications

Table 1 below describes the trade costs coefficients for various specifications using aggregate
data across country pairs (excluding services). In column (1), I regress trade flows on importer
and exporter fixed effects as well as on trade cost proxies using Poisson-PML. In column (2),
I redo the same exercise with OLS using the log of trade flows as the dependent variable. In
column (3), I minimize the sum of the squared error term, defined as the difference between
observed trade flows and fitted trade flows (in log), by simultaneously imposing the structural
constraints on multilateral-resistance indexes (equations 5 and 6 using observed output and
expenditures). In column (4), I follow the “structurally-iterated-least-squares” approach devel16

GTAP data version 7 (Narayanan and Walmsley, 2008). Another excellent dataset with consistent information on trade flows is provided by the CEPII (Head and Mayer 2014). The key results presented here are
robust to using CEPII and Comtrade data.
17
Because of missing observations, this requirement was not met by the data used in Anderson and Yotov
(2010), which explains the discrepancy in our results.

11

Table 1: Gravity equation: trade cost coefficients
Dependent variable:
Log or level:
Specification:
Distance (log)
Border effect
Contiguity
Common language
Colonial link
Imposing MR constraints
Countries
Observations

Trade flows
(3)
(4)
Log
Log
OLS+MR
SILS

(1)
Level
PPML

(2)
Log
OLS

-0.818
[0.072]
2.740
[0.218]
0.404
[0.120]
0.502
[0.146]
0.036
[0.146]
/
94
8836

-1.106
[0.028]
4.331
[0.271]
1.029
[0.120]
0.737
[0.067]
0.539
[0.111]
No
94
8836

-1.225
[0.029]
2.353
[0.118]
3.534
[0.080]
-0.189
[0.078]
0.376
[0.108]
Yes
94
8836

-1.362
[0.032]
3.472
[0.109]
0.266
[0.128]
0.716
[0.089]
1.383
[0.127]
Yes
94
8836

(5)
Level
NLLS

(6)
Level
Gamma

-1.251
[0.193]
1.882
[0.354]
-0.009
[0.221]
0.288
[0.252]
-0.122
[0.280]
No
94
8836

-1.189
[0.037]
4.823
[0.295]
0.929
[0.133]
0.663
[0.096]
0.745
[0.160]
No
94
8836

Notes: The dependent variable is bilateral trade, either in log or level; Columns (1), (2), (5) and (6) include
simple fixed effects by importer and exporter while columns (3) and (4) impose additional constraints on
multilateral-resistance indexes (equations 5 and 6 using observed output and expenditures); bootstrap standard
errors in brackets; in bold: coefficients significant at 5%.

oped by Head and Mayer (2014).18 Finally, I use non-linear least squares in column (5) and
the Gamma-PML estimator in column (6), using trade flows in levels without imposing further structural constraints. I provide bootstrap standard errors for all specifications. Beyond
the constraints imposed on multilateral-resistance indexes, an important source of differences
across these specifications is the weight each of them places on small versus large trade flows
(Santos Silva and Tenreyro 2006, Head and Mayer 2014). Poisson-PML and especially least
squares in level (NLLS) put relatively more weight on large trade flows than do least squares
in log (OLS and SILS) and Gamma-PML.
As already known in the literature, the trade cost coefficients differ across specifications. In
particular, the Poisson-PML estimator yields the smallest distance coefficient while the largest
coefficient is obtained with OLS and SILS (column 2 and 4). As illustrated in Head and
18
In column (3), the sum of squared errors (in log) is minimized by simultaneously imposing structural
constraints. In column (4), trade costs coefficients are obtained by minimizing the sum of squared errors
(in log) conditional on multilateral-resistance indexes. Multilateral-resistance indexes are then recomputed
conditional on estimated trade costs. These two operations are repeated until convergence is achieved. As a
result, the trade costs proxies are orthogonal to the error term with SILS (as in simple OLS) but not with the
simultaneously-constrained least squares (OLS + MR). However, the R-squared is lower for the simultaneouslyconstrained least squares (OLS + MR) than for SILS. Hence, the second method (SILS) is more robust if we
focus on the trade costs coefficients but less robust if the primary goal is to estimate MR indexes.

12

Mayer (2014), this difference can potentially be explained by a non-linear effect of distance,
with a stronger effect on small trade flows (captured by OLS, SILS and Gamma-PML) and a
weaker effect on large trade flows (captured by NLLS and Poisson-PML). Poisson-PML also
yields a relatively small border effect. The estimated border effect is largest with GammaPML and OLS when simple fixed effects are used (reduced-form gravity). As in Anderson and
Van Wincoop (2003), the border effect dramatically decreases when structural constraints on
multilateral-resistance indexes are added (columns 3 and 4 for OLS). Other differences between
specifications include a small colonial link coefficient for Poisson-PML, a negative language
coefficient for OLS when MR constraints are simultaneously imposed, and larger standard
errors with non-linear least squares (NLLS).
Given these differences in trade costs estimates, it is important to gauge the relative merit
of each specification. I show in the remainder of this section that traditional gravity estimates
relying on OLS or Gamma-PML with fixed effects (without imposing multilateral-resistance
constraints) have undesirable properties in terms of predicted output and expenditures.

5.3

Output and multilateral-resistance indexes

While equations (7) and (8) are automatically satisfied across all specifications when we use
fitted output and expenditures (Lemma 1A), I examine here quantitatively to what extent the
traditional multilateral-resistance equations (5) and (6) are violated when they are not imposed
in the estimation procedure (with observed output and expenditures). Using estimates on trade
costs and fixed effects, we can construct implied multilateral-resistance indexes in various ways,
using either exporter or importer fixed effects. For instance, the inward multilateral-resistance
index Pbj−θ implied by importer fixed effects m̂j can be constructed as follows:


Pbj−θ

F M

= exp[−m̂j ]

Ej
EU SA

which satisfies the normalization imposed on the reference country (PU SA = 1). Alternatively,
d
−θ
we can use exporter fixed effects19 combined with estimated trade costs Dij
:


Pbj−θ

F X

=

X

−θ −1
exp[êi ]Dij
EU SA

d

i

The two approaches are equivalent with Poisson-PML or with additional constraints on the
multilateral-resistance indexes (columns 1, 3 and 4 of Table 1 and Table 3). In other cases,
there are large differences between the two definitions, comparing indexes based on importer
19

Redding and Venables (2004) use exporter fixed effects to construct “Market Access” Pbj−θ .

13

10
Fitted output (in log)
0
5
-5
0

2

4
6
Observed output (in log)

8

Figure 1: Comparing fitted output (using OLS) and observed output
fixed effects versus
exporter fixed effects.
An indicator of this misalignment is the interquartile

F X 
F M 
range of log Pbi−θ
/ Pbi−θ
. It is zero for structural gravity (columns 3 and 4) and
Poisson-PML (column 1), but it equals 2.769 for OLS with fixed effects (column 2), 0.369 for
NLLS (column 5) and 2.290 for Gamma-PML (column 6) when only simple fixed effects are
included. I find very similar results by comparing the outward multilateral-resistance index


b −θ F X to the one constructed with importer fixed
constructed with exporter fixed effects: Π
i


F M

b −θ
.
effects: Π
i
As Lemma 1B suggests, the violations of the constraints on multilateral resistance indexes
P c
(using observed output and expenditures) imply that fitted output Ybi ≡ j X
ij also largely
P
differs from observed output Yi = j Xij . To be more precise, we can link the difference
between fitted and actual output (in log) to the difference between the two outward multilateral



b −θ F X and Π
b −θ F M :
resistance indexes Π
i
i


b −θ
∆log Yi = log Π
i

F M



b −θ
− log Π
i

F X

(9)

with a similar expression for actual and fitted expenditures:


∆log Ej = log Pbi−θ
h

F X



− log Pbi−θ

F M

(10)

i

h

where ∆log Yi ≡ log Ybi /Yi denotes the bias in fitting output and ∆log Ej ≡ log Ebj /Ej


b −θ
denotes the bias in fitting expenditures. Hence, the large differences between Π
i

14

F X

i

and

F M



b −θ
Π
translate into equally large differences between fitted and actual output. This also
i
illustrates the point of Lemma 1B: imposing equations (5) and (6) on the multilateral-resistance
indexes implies that Ybi = Yi and Ebj = Ej .

Table 2: Do gravity equations inflate large countries? ∆log Y , ∆log E and country size:
Dependent variable:

Log output

First-stage gravity:
Imposing MR constraints
Countries

(1)

∆log Yi
(2)

(4)

∆log Ei
(5)

(3)

(6)

0.738
[0.065]

-0.069
[0.021]

0.544
[0.066]

0.688
[0.061]

-0.083
[0.014]

0.539
[0.065]

OLS
No
94

NLLS
No
94

Gamma
No
94

OLS
No
94

NLLS
No
94

Gamma
No
94

Notes: OLS regressions; dependent variables: ∆log Yi (see Equation 9) and ∆log Ei (see Equation 10); robust
standard errors in brackets; all coefficients are significant at the 1% level; each column corresponds to a different
specification of the gravity equation estimation in the first stage to construct ∆log Yi and ∆log Ei . Note that
the dependent variables ∆log Yi and ∆log Ei equal zero when we use Poisson-PML to estimate gravity or when
we impose MR constraints.

These differences are far from innocuous as the bias varies systematically with country
size. For instance, OLS estimates inflate trade for large markets and reduce trade for small
markets. This is illustrated in Figure 1: fitted output exceeds output for the largest countries
(points above the diagonal line) and tends to be smaller than observed output for the smallest
markets.20 As shown in Table 2, regressing the bias ∆log Yi ≡ log Ybi −log Yi on observed output
(in log) yields a coefficient that is large and significant for OLS and Gamma-PML (columns 1
and 3), which confirms that fitted output tends to be overinflated for larger economies. The
coefficient is negative for NLLS (column 2). Similar results are obtained for ∆log Ei .
Concretely, this means that importer and exporter fixed effects tend to be biased downward
for large countries and upward for small countries. These biases have important implications
for multilateral-resistance indexes. With OLS and Gamma-PML, the inward multilateral
F M


b −θ F X tend to be
resistance term Pbi−θ
and the outward multilateral-resistance term Π
i
underestimated for large markets and overestimated for small markets. Table 3 illustrates this

F M
point: log Pbi−θ
is positively correlated with (log) output for Poisson-PML and structural
gravity estimations (columns 1, 3 and 4). When OLS or Gamma-PML is used without imposing any constraint on multilateral-resistance indexes, it is slightly negatively correlated with
log output (columns 2 and 6). If we instead use exporter fixed effects to construct Pbi−θ , these
20

I find the same results when I examine trade within each sector: these deviations are driven by market size
rather than by per capita income or other country characteristics.

15

results are reversed for OLS and Gamma-PML, with much larger correlations with market size
than with other specifications (columns 7 and 9).21
Table 3: Regressing constructed inward MR indexes on observed output


Dependent Var:
(1)

(2)

Log output

0.263
[0.018]

-0.096
[0.028]

First-stage
MR constraints
Countries

PPML
/
94

OLS
No
94

log Pbi−θ
(3)

F M



log Pbi−θ
(7)
(8)

F X

(4)

(5)

(6)

0.228
[0.045]

0.369
[0.049]

0.345
[0.043]

0.039
[0.023]

0.591
[0.048]

0.262
[0.034]

0.578
[0.056]

OLS+MR
Yes
94

SILS
Yes
94

NLLS
No
94

GPML
No
94

OLS
No
94

NLLS
No
94

GPML
No
94

(9)

Notes: OLS regressions; dependent variable: log inward MR based on importer fixed effects (columns 1 to 6)
or exporter fixed effects (columns 7 to 9); robust standard errors in brackets; all coefficients are different from
zero at a 1% significance level except in column (6); each column corresponds to a different specification of the
gravity equation estimation in the first stage to construct the inward multilateral resistance index.

Tables 2 and 3 focus on correlations between market size and either ∆log Yi , ∆log Ei or
Pbi−θ to illustrate the differences between specifications, but similar results are obtained if per
capita income or other country characteristics are substituted for market size. In light of these
results, one should be wary of trade costs coefficients and should be cautious in interpreting
multilateral-resistance indexes with an estimator other than Poisson-PML if structural gravity
constraints are not imposed. Imposing these constraints or using Poisson-PML appear to be
good practices especially when the multilateral-resistance indexes are used in a second step
for other empirical purposes (e.g., to explain wages, as in Redding and Venables 2004, or final
demand, as in Caron et al. 2014). There are still large differences in coefficients among PoissonPML and other specifications that do impose the full structure. It is beyond the scope of the
paper to argue for a specific estimator, but Poisson-PML seems particularly appealing because
structural gravity constraints are automatically satisfied and the method is easy to implement.

6

Concluding remarks

This paper shows that Poisson-PML regressions exhibit interesting properties that can be
particularly useful for the estimation of gravity equations for trade flows. Specifically, the
estimation of gravity with Poisson-PML and exporter and importer fixed effects is consistent
The results presented in Table 2 focus on the inward multilateral-resistance index Pbi−θ but the same results
b −θ .
hold for the outward multilateral-resistance index Π
i
21

16

with a more structural approach (as in Anderson and van Wincoop, 2003) that imposes further
restrictions on exporter and importer terms (“multilateral resistance” indexes). Furthermore,
the inclusion of exporter and importer fixed effects in the Poisson-PML estimation of gravity
implies that fitted output and expenditures (defined as the sum of fitted outward and inward
trade flows for each country) perfectly match observed output and expenditures, respectively.
This property is unique to the Poisson-PML estimator.
When other estimators are used, estimating gravity with simple fixed effects is no longer
consistent with the structural gravity framework defined by Anderson and Van Wincoop (2003),
unless multilateral-resistance indexes are redefined using fitted output and expenditures instead
of observed output and expenditures. In practice, however, there are large differences between
observed output and fitted output implied by gravity equations with simple fixed effects, especially with OLS and Gamma-PML: total output and expenditures are biased upward for large
economies and downward for smaller economies. Similarly, inward and outward multilateralresistance indexes appear to be biased with OLS and Gamma-PML, with the sign of the bias
depending on market size and on whether these indexes are constructed using importer or exporter fixed effects. Given these results, one should put more trust in specifications of gravity
equations where either Poisson-PML is used or the full gravity structure is imposed.

References
[1] Anderson, James E. and Eric van Wincoop (2003), “Gravity with Gravitas: A Solution to
the Border Puzzle,” American Economic Review, vol. 93(1), pages 170-192, March.
[2] Anderson (2011) “The Gravity Model”, Annual Review of Economics, Vol. 3, pp. 133-160.
[3] Anderson, James E. and Yoto V. Yotov (2010) “The Changing Incidence of Geography”,
American Economic Review, 100, 2157-86.
[4] Anderson, James E. and Yoto V. Yotov (2012) “Gold Standard Gravity”, NBER Working
Paper 17835.
[5] Arvis, Jean-Francois and Ben Shepherd (2013) “The Poisson quasi-maximum likelihood
estimator: a solution to the ’adding up’ problem in gravity models” Applied Economics
Letters, vol. 20(6), pages 515-519.
[6] Balistreri, Edward J. and Hillberry, Russell H. (2007), “Structural estimation and the border
puzzle,” Journal of International Economics, vol. 72(2), pages 451-463.
[7] Balistreri, Edward J., Hillberry, Russell H. and Rutherford, Thomas F., (2011), “Structural
estimation and solution of international trade models with heterogeneous firms,” Journal
of International Economics, vol. 83(2), pages 95-108.

17

[8] Caliendo, Lorenzo and Fernando Parro (2011), “Estimates of the Trade and Welfare Effects
of NAFTA”, forthcoming in the Review of Economic Studies.
[9] Caron, Justin, Thibault Fally and James Markusen (2014), “International Trade Puzzles: A
Solution Linking Production and Preferences”, the Quarterly Journal of Economics, August
2014.
[10] Chaney, Thomas (2008), “Distorted Gravity: The Intensive and Extensive Margins of International Trade,” American Economic Review, vol. 98(4), pages 1707-21, September.
[11] Costinot, Arnaud, Dave Donaldson and Ivana Komunjer (2012) “What Goods Do Countries
Trade? A Quantitative Exploration of Ricardo’s Ideas”, Review of Economic Studies, 2012,
vol. 79, issue 2, pp. 581-608.
[12] Eaton, Jonathan and Samuel Kortum (2002), “Technology, Geography, and Trade”, Econometrica 70, 1741-1779.
[13] Evenett, S. and W. Keller (2002) “On Theories Explaining the Gravity Equation”, Journal
of Political Economy, 110:281-316.
[14] Fally, Thibault, Rodrigo Paillacar and Cristina Terra (2010), “Economic geography and
wages in Brazil: Evidence from micro-data,” Journal of Development Economics, Elsevier,
vol. 91(1), pages 155-168, January
[15] Fieler, Ana Cecilia (2011), “Non-Homotheticity and Bilateral Trade: Evidence and a Quantitative Explanation”, Econometrica, volume 79, issue 4, p. 1069-1101.
[16] Feenstra, Robert (2004), Advanced International Trade, Princeton University Press.
[17] French, Scott (2014), “The Composition of Trade Flows and the Aggregate Effects of Trade
Barriers”, working paper
[18] Gourieroux, C. Monfort, A. and Trognon, A. (1984) “Pseudo Maximum Likelihood Methods:
Applications to Poisson Models” Econometrica, Vol. 52, No. 3, pp. 701-720
[19] Head, K., and T. Mayer (2014) “Gravity Equations: Workhorse, Toolkit, and Cookbook”,
Handbook of International Economics Vol. 4, eds. Gopinath, Helpman, and Rogoff.
[20] Harrigan, James (1996), “Openness to trade in manufactures in the OECD,” Journal of
International Economics, Elsevier, vol. 40(1-2), pages 23-39, February.
[21] Helpman, Elhanan, Marc J. Melitz and Yona Rubinstein (2008) “Estimating Trade Flows:
Trading Partners and Trading Volumes”, Harvard University, Quarterly Journal of Economics, 123: 441-487.
[22] Lai, Huiwen and Trefler, Daniel (2002) “The Gains from Trade with Monopolistic Competition: Specification, Estimation, and Mis-Specification”, NBER Working Paper No. 9169.
[23] Narayanan, Badri G. and Terrie L. Walmsley (2008) “Global Trade, Assistance, and Production: The GTAP 7 Data Base”, Center for Global Trade Analysis, Purdue University.
18

[24] Redding, S. and A.J.Venables (2004). “Economic geography and international inequality,”
Journal of International Economics 62(1): 53-82.
[25] Santos Silva, J. and S. Tenreyro (2006) “The Log of Gravity”, Review of Economics and
Statistics Vol. 88, No. 4, Pages 641-658.
[26] Santos Silva, J. and S. Tenreyro (2010), “On the existence of the maximum likelihood
estimates in Poisson regression,” Economics Letters, vol. 107(2), pages 310-312.
[27] Santos Silva, J. and S. Tenreyro (2011) “Further simulation evidence on the performance
of the Poisson pseudo-maximum likelihood estimator,” Economics Letters, vol. 112(2), p
220-222.
[28] Tinbergen, Jan (1962) Shaping the World Economy: Suggestions for an International Economic Policy, New York: The Twentieth Century Fund.

Appendix A: Proofs of propositions
Before proving the two lemmas and propositions from the main text, Lemma 3 (below) formally
states the equivalence between separability with adding-up constraints and “structural gravity”
(see Section 2 on the theory background):
Lemma 3: Suppose that trade flows satisfy:
log Xij = ei − θ log Dij + mj

(11)

such as θ is a constant parameter, ei is invariant across importers and mj is invariant across
importers j. Suppose also that output and expenditures are consistent with the sum of outward
P
P
and inward trade flows: Yi = j Xij and Ej = i Xij . There exists a unique pair of variables
Pj and Πi (with P0 = 1) such that Xij is consistent with the “structural gravity” framework.
Proof of Lemma 3:
Suppose that Xij can be written as a function of exporter and importer effects as well as
bilateral trade costs:
i
h
−θ
Xij = exp ei + log Dij
+ mj
Suppose also that output and expenditures are defined by Yi ≡
two equalities can be rewritten as:

P

j

Xij and Ej ≡

 P
h
i
−θ

j exp hei + log Dij + mj i = Yi
 P exp ei + log D −θ + mj
= Ej
i
ij

or equivalently:
( P
−θ
Dij
E0 exp(mj ) =
P j −θ
−1

E0 Yi exp(−ei )
−1
D
E
exp(e
)
=
E
i
i
0
0 Ej exp(−mj )
ij

19

P

i

Xij . These

After defining Pj−θ ≡ E0−1 Ej exp(−mj ) and Π−θ
i ≡ E0 Yi exp(−ei ), and incorporating into the
previous two equations, we obtain equations (2) and (3):
X
j

−θ
Dij

X
Ej
−θ
−θ
−θ Yi
and
Dij
−θ = Πi
−θ = Pj
Pj
Π
i
i

(12)

This proves that Π−θ
and Pj−θ are solutions of equations (2) and (3). Moreover, we can check
i
that P0−θ = 1 for j = 0.
−θ
We still need to prove uniqueness: for a given set of trade costs Dij
, output Yi and ex−θ
−θ
penditures Ej , the solution in Pj and Πi to equations (2) and (3) is unique, up to the
normalization P0−θ = 1.
Suppose that Π−θ
and Pj−θ , as well as (Π0i )−θ and (Pj0 )−θ are two solutions to equations (2)
i
and yj as the ratio of (Pj0 )−θ to Pj−θ . To
and (3). Let us define xi as the ratio of (Π0i )−θ to Π−θ
i
prove that the solution is unique, we need to show that xi = 1 and yj = 1 for all i and j.
Using equation (3), we can re-write yj as:

P

i

−θ
Yi Dij
(Π0i )θ
−θ −θ
i Yi Dij Πi

yj = P

Given that xi is defined as the ratio of (Π0i )−θ to Π−θ
i , we can rewrite yj as an average of 1/xi
−θ θ
with weights Yi Dij Πi :
 
P
−θ θ 1
Y
D
Π
i i ij
i xi
yj = P
−θ θ
i Yi Dij Πi
Similarly, we can express xi as a weighted average of 1/yj :
−θ θ
i Ej Dij Pj

P

xj =



1
yj
P
−θ θ
j Ej Dij Pj



Let us now proceed by contradiction and suppose that yj differs from unity for at least one
country. Since y0 = 1 for j = 0 with our normalization, it means that the y’s are strictly
different between at least two countries j. Let us denote the minimum value by y ∗ = minj {yj }.
If there are at least two yj with strictly different values, the same holds for 1/yj and there is
at least one country j for which 1/yj < 1/y ∗ . Since xi is a weighted average of all the 1/yj ’s,
it implies that all xi ’s are strictly smaller than 1/y ∗ . This inequality is strict as long as the
−θ θ
weights Ej Dij
Pj are all strictly positive, which is implicitly assumed here (zero weights for
country j would imply zero inward trade for country j).
Since all xi ’s are strictly smaller than 1/y ∗ , we obtain that mini x1i is strictly larger than y ∗ .
In turn, since all y’s correspond to a weighted average of 1/xi ’s, we obtain that yi is strictly
larger than y ∗ for all i. The strict inequality contradicts the assumption that the lower bound
y ∗ is reached for at least one country and that at least two values of y differ. It proves that
yj = 1 for all j, and we can also conclude that xi = 1.

20

Proof of Lemma 1A:
Let us denote:



d
−θ
c
cj
Xij = exp ebi + log Dij + m

where hats refer to the fitted variable in the gravity equation (4) estimated with fixed effects.
P c
P c
b
We define fitted output and fitted expenditures by Ybi ≡ j X
ij and Ej ≡
i Xij .
The proof of Lemma 1A follows exactly the same steps as the proof of Lemma 3 by using
fitted trade, fitted output and fitted expenditures, where the solution of equations (7) and (8)
would be the same as for Lemma 3 (above) using fitted expenditures and fixed effects:
cj )
Pj−θ ≡ Eb0−1 Ebj exp(−m

b b
bi )
Π−θ
i ≡ E0 Yi exp(−e

and

g

g

instead of Pj−θ ≡ E0−1 Ej exp(−mj ) and Π−θ
i ≡ E0 Yi exp(−ei ).
Given fitted output, fitted expenditures and fitted expenditures, we can show that Pj−θ and
g

Π−θ
are the unique solutions. The proof is the same as above in Lemma 3 using fitted values.
i
g

Proof of Lemma 1B:
The proof is again similar to Lemma 3 (above in Appendix) and Lemma 1A. Let us denote:


c = exp eb + log D −θ + m
cj
X
ij
i
ij



d

where the hats refer to estimated coefficients. If we use observed output Yi and observed
d
d
cj ) and Π−θ
expenditures Ej to define Pj−θ ≡ E0−1 Ej exp(−m
≡ E0 Yi exp(−ebi ), the above
i
equation becomes:
d
−θ Ej
c = Yi D
X
ij
ij d
d
Π−θ
Pj−θ
i
where Π−θ
and Pj−θ replace fixed effects.
i
P c
P c
In the estimation, imposing j X
ij = Yi and
i Xij = Ej is equivalent to imposing:
d

d

 P
−θ Ej
Yi d

Dij

j d

−θ
−θ
d
Πi
P
j
P Yi d
−θ Ej


Dij

i d
−θ
−θ
d
Π
P
i

= Yi
= Ej

j

which, in turn, is equivalent to the constraints (5) and (6):
 P
d
−θ Ej


j Dij d

Pj−θ
P
d

−θ Yi


i Dij d
Π−θ

= Π−θ
i
d

= Pj−θ
d

i

Again, the proof of uniqueness is the same as for Lemma 3 above.

21

Proof of Lemma 2:
As shown in Gourieroux, Monfort and Trognon (1984), the maximization of the log-likelihood
associated with Poisson distributions yields simple first-order conditions and the solution is
(k)
unique. They show that, if a variable yi is regressed on a set of K variables xi with k = 1, ..., K,
the first-order conditions are:
X (k)
xi (yi − ŷi ) = 0
i

for each variable k, where ŷi denotes the fitted value and takes the functional form: ŷi =
P
(k)
exp[ k b̂k xi ].
(k)
When one of the independent variables xi is a dummy variable DiA equal to one for a subset
of observations i ∈ A, the first-order condition associated with this variable can be written:
X

DiA (yi − ŷi ) =

i

X

(yi − ŷi ) = 0

i∈A

which also implies that the sum of fitted values equals the sum of observed values on this
P
P
subset: i∈A yi = i∈A ŷi . Using this result for the gravity equation, Lemma 2 is obtained by
simply writing this first-order condition for exporter and importer fixed effects. When one of
the independent variables is a dummy variable that takes the value 1 for a given exporter i and
zero otherwise the first-order condition related to this dummy variable can be written:
X

c )=0
(Xij − X
ij

j

which proves the first part of Lemma 2. The second part of Lemma 2 is obtained by looking
at the first-order condition related to importer fixed effects when we include a dummy variable
that takes the value 1 only for a given importer j.
Proof of Proposition 1: Proposition 1 follows from Lemma 1B using the additional result
that Ybi = Yi and Ebj = Ej when Poisson-PML is used (Lemma 2).
Proof of Proposition 2: To prove Proposition 2, I use of the following lemma which provides
a simple characterization of PML estimators from the linear-exponential family:
Lemma 4: With a PML estimator from the linear-exponential family, the average ȳ ≡ N1 i yi
is the fitted value when regressing the dependent variable yi on a constant term. Conversely,
if a PML estimator always yields the average as the fitted value of a regression on a constant
term, then this estimator is from the linear-exponential family.
P

Proof of Lemma 4:
f
Let us denote by log f (y, λ) the log-likelihood function and by ϕ(y, λ) = ∂∂ log
its first
log λ
derivative w.r.t λ. The linear-exponential family of PML estimators corresponds to the special
case where:
ϕ(y, λ) = g(λ) . (y − λ)
22

(see Gourieroux et al. 1984).22 With this family of estimators, it is simple to verify that the
P
average ȳ ≡ N1 i yi satisfies the first-order condition associated with the constant term since
we would have:
N
X
i=1

ϕ(yi , ȳ) =

N
X

g(ȳ)(yi − ȳ) = g(ȳ)

i=1

N
X

(yi − ȳ) = 0

i=1

The reciprocal part of Lemma 4 is also useful to prove Proposition 2. It mirrors Theorem
2 in Gourieroux et al. (1984) stating that strongly-consistent PML estimators are necessarily
from the linear-exponential family.
Suppose that, for a PML-estimator, the average ȳ is always the fitted value when regressing
yi on a constant term. The primary goal is to prove that ϕ(λ, y) is linear in y.
2y
nλ
− n−2
For any given pair (y, λ) with y > 0 and λ > 0, and for n sufficiently large, y 0 ≡ n−2
2y
nλ
− n−2
for all
is also positive. I apply the property for y1 = y − ε, y2 = y + ε and yi = n−2
i = 3, ..., n. One can check that λ is the arithmetic average of the yi ’s and therefore we should
have:
2y
nλ
− n−2
ϕ(y − ε, λ) + ϕ(y + ε, λ) + (n − 2)ϕ( n−2
, λ) = 0

I apply again the above property to the same set of y’s and λ’s with ε = 0 instead. I obtain:
2y
nλ
− n−2
2ϕ(y, λ) + (n − 2)ϕ( n−2
, λ) = 0

Combining with the previous equation, we obtain:
ϕ(y, λ) =

ϕ(y − ε, λ) + ϕ(y + ε, λ)
2

which is true for any λ and y > 0 and any small enough ε > 0. Further assuming that g is
twice differentiable in y with a continuous second derivative, the above equality implies that g
is linear in y. Hence there exist two real functions g(λ) and h(λ) such that:
ϕ(y, λ) = g(λ) y − h(λ)
Since ϕ(y, λ) = 0 for λ = y, we also obtain that h(λ) = g(λ)λ and ϕ(y, λ) = g(λ)(y − λ).
Proof of Proposition 2 (continued):
Since the constant term is a dummy for the full set of observations, the assumptions in
Proposition 2 implies that a PML estimator satisfying the adding-up properties also yields
the arithmetic average as the fitted variable of a regression on a constant term. Hence, using
Lemma 4, such an estimator is from the exponential family. The exponential family is however
quite large (Gaussian, Poisson, Gamma, Binomial, etc.). Now, we need to show that only the
Poisson-PML estimator satisfies the adding-up properties of Proposition 2.
More specifically, we need to show that the function g(λ) is constant and does not depend
on λ. If g(λ) is constant, the estimator would then be equivalent to the Poisson-PML estimator.
22

Gourieroux et al. (1984) define the exponential family by f (y, λ) = exp [A(λ) + B(y) + C(λ)y] where A(λ)
has to satisfy: A0 (λ) = −C 0 (λ)y (Property 1 in Gourieroux et al. 1984). These two definitions are equivalent.

23

We want to prove by contradiction that g 0 (λ) = 0 for all λ > 0. To do so, suppose that
g 0 (a) > 0 for a given a (the proof works the same way if we assume instead that g 0 (a) < 0).
There exists b strictly greater than a but sufficiently close to a such as g 0 (λ) > 0 and g(λ)
is strictly increasing on λ ∈ [a, b]. Without loss of generality, we can also assume that g(λ)
never equals zero on the segment [a, b].23 We then construct a dependent and an independent
variable based on these two values a and b, and show that the first-order conditions imply a
contradiction.
Given these two distinct values a and b, we define a dependent and an independent variable
for four observations:
• Dependent variable: y1 = y2 =

a+b
,
2

y3 = a and y4 = b

• Independent variable: x1 = x3 = log a and x2 = x4 = log b
Let us then regress y on x with two dummy variables: a dummy equal to one for the first two
observations and a dummy equal to one for the last two observations (note that a constant
term would be redundant). Let us denote by λi the predicted value for yi , by α the coefficient
for xi , by γ12 the coefficient for the dummy variable for the first two observations and by γ34
the coefficient for the dummy variable for the last two observations. The fitted values are then:
λ1 = exp[α log a + γ12 ]

λ2 = exp[α log b + γ12 ]

λ3 = exp[α log a + γ34 ]

λ4 = exp[α log b + γ34 ]

Given the assumptions made in Proposition 2, having a dummy for the first two observations
implies that the sum of the fitted values equals the sum of the dependent variables for the first
two observations:
exp[α log a + γ12 ] + exp[α log b + γ12 ] = a + b
Similarly, for the last two observations:
exp[α log a + γ34 ] + exp[α log b + γ34 ] = a + b
These two conditions imply that the coefficient for the dummy variable is the same for both
subsets of observations: γ12 = γ34 ≡ γ and imply also that λ1 = λ3 and λ2 = λ4 .
The first-order condition for the dummy for the first two observations gives:
a + b

g(λ1 )

2



− λ1 + g(λ2 )

a + b

2



− λ2 = 0

(13)

In turn, the first-order condition for the dummy for the last two observations gives:
g(λ3 )(a − λ3 ) + g(λ4 )(b − λ4 ) = 0

(14)

Taking the difference between the two conditions, and using the fact that λ1 = λ3 and λ2 = λ4 ,
we obtain:


a + b
a + b
+ g(λ2 ) b −
=0
g(λ1 ) a −
2
2
23

Otherwise, we can restrict our attention on an interior segment [a0 , b0 ] that satisfies this property.

24

which also implies that g(λ1 ) = g(λ2 ). To obtain a contradiction, the next step is to show that
the two fitted values λ1 and λ2 are distinct and lie on the [a, b] segment.
The first-order condition in α (with λ1 = λ3 and λ2 = λ4 ) gives:
 3a + b

(log a) g(λ1 )

4



− λ1 + (log b) g(λ2 )

 a + 3b

4



− λ2 = 0

while the sum of equations (13) and (14) gives:
 3a + b

g(λ1 )

4



− λ1 + g(λ2 )

 a + 3b

4



− λ2 = 0

Given that g(λ1 ) and g(λ2 ) are non-zero, these two equations imply the following fitted values:
a + 3b
3a + b
and
λ2 =
4
4
3a+b
Hence, combining with the results above, we obtain that: g( 4 ) = g( a+3b
) which contradicts
4
the strict monotonicity of g on the [a, b] segment.
λ1 =

Appendix B: Estimation of gravity with missing values
What happens when internal trade flows are missing? Or, equivalently, when output data have
missing observations? Internal trade flows are often imputed as the difference between output
and total exports. Output data are largely available at the aggregate level but industry-level
data are more scarce at the industry level for developing countries.
If internal trade flows are missing for country i, then total fitted trade flows (i.e. total
fitted exports) perfectly match total observed exports when exporter fixed effects are included
in a Poisson-PML estimation of gravity. The same result holds for imports when importer
fixed effects are included. For each exporter i for which internal flows Xii are missing, the
Poisson-PML estimator imposes:
X
j, j6=i

c =
X
ij

X

Xij = Xitot

and

X

c =
X
ji

j, j6=i

j, j6=i

X

Xji = Mitot .

j, j6=i

We could then use fixed effects estimates êi and m̂i and trade costs estimates Dii−θ to infer
c and then reconstruct output and expenditures as: Yb ≡ X
c +
missing internal trade flows X
ii
i
ii
P c
P c
tot
tot
b
c
Xi = j Xij and Ei ≡ Xii + Mi = j Xji . Using Lemma 1A, inferred trade flows, output
and expenditures would then be consistent with the multilateral resistance indexes implied by
the fixed-effects estimates. Moreover, fitted output would still equal observed output in all the
cases where output data are not missing.
d

Appendix C: Inclusion of border dummies
In general, the estimation of equation (4) involves a dummy for international trade flows as one
of the variables to proxy for trade costs (dummy variable Bij being equal to one if i 6= j). Such
a dummy can be identified when data on internal trade flows (Xii ) are available. Estimates
typically exhibit large border effects (“home-bias puzzle” raised by McCallum 1995).
25

With Poisson-PML, the inclusion of a border effect in the gravity equation also has important implications for the sum of fitted exports. In particular, the Poisson-PML first-order
condition associated with the border effect implies that the sum of fitted exports across all
countries equals the sum of observed exports:
X

c =
X
ij

i,j, i6=j

X

Xij

i,j, i6=j

The proof is similar to Lemma 2. Given Lemma 2, it also means that the ratio of total fitted
cross-border trade over total fitted output
cross-border
Pequals the ratio
P of total
 observed
P
 P trade

c
c
over total observed output in the data:
X
/
X
=
X
/
X
.
ij
ij
ij
ij
i,j, i6=j
i,j
i,j, i6=j
i,j

Log or level:
Specification:
Ratio

(1)
Level
PPML

(2)
Log
OLS

(3)
Log
OLS+MR

(4)
Log
SILS

(5)
Level
NLLS

(6)
Level
Gamma

(7)
DATA

0.728

0.961

0.531

0.889

0.703

0.982

0.728

The table below shows this ratio for the same estimators as in Table 1. The first column
is the ratio for Poisson-PML, which is the same as in the data. With other estimators, this
fitted ratio can widely differ from the data even if further constraints on multilateral-resistance
indexes are imposed. OLS, SILS and Gamma-PML do not put a large weight on large trade
flows, which could explain why it does not do a good job at matching international trade
and output sums. It is interesting to see that simultaneously imposing the constraints on
multilateral-resistance indexes (OLS+MR) has a very different outcome compared to iterating
OLS and adjustments of multilateral-resistance indexes (SILS).

26

