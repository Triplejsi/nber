NBER WORKING PAPER SERIES

ON THE GEOGRAPHY OF GLOBAL VALUE CHAINS
Pol Antràs
Alonso de Gortari
Working Paper 23456
http://www.nber.org/papers/w23456

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2017

We thank Arnaud Costinot and Iván Werning for useful conversations during the most upstream
stages of this project. Roc Armenter, Rob Johnson, Myrto Kalouptsidi, Sam Kortum, Marc
Melitz, Eduardo Morales, Felix Tintelnot, and Kei-Mu Yi provided very useful feedback on
preliminary versions of the paper. We are also grateful to seminar audiences at Princeton, the
North American Econometric Society Summer Meeting in Philadelphia, the SED in Toulouse, the
Federal Reserve Bank of Dallas, Geneva, Chicago Booth, MIT, Stanford, Harvard, Brown, Clark,
UCLA, Wisconsin, CREI-UPF, Autònoma in Barcelona, Toulouse, CEMFI and Toronto for
useful feedback. Le Kang, Daniel Ramos, BooKang Seol, Maria Voronina, and Diana Zhu
provided valuable research assistance at various stages of this paper's production chain. Antràs
acknowledges support from the NSF (proposal #1628852). All errors are our own. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2017 by Pol Antràs and Alonso de Gortari. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

On the Geography of Global Value Chains
Pol Antràs and Alonso de Gortari
NBER Working Paper No. 23456
May 2017
JEL No. C67,D21,D57,D58,F11,F14,F60
ABSTRACT
This paper develops a multi-stage general-equilibrium model of global value chains (GVCs) and
studies the specialization of countries within GVCs in a world with barriers to international trade.
With costly trade, the optimal location of production of a given stage in a GVC is not only a
function of the marginal cost at which that stage can be produced in a given country, but is also
shaped by the proximity of that location to the precedent and the subsequent desired locations of
production. We show that, other things equal, it is optimal to locate relatively downstream stages
of production in relatively central locations. We also develop and estimate a tractable,
quantifiable version of our model that illustrates how changes in trade costs affect the extent to
which various countries participate in domestic, regional or global value chains, and traces the
real income consequences of these changes.

Pol Antràs
Department of Economics
Harvard University
1805 Cambridge Street
Littauer Center 207
Cambridge, MA 02138
and NBER
pantras@fas.harvard.edu
Alonso de Gortari
Department of Economics
Harvard University
1805 Cambridge Street
Littauer Center
Cambridge, MA 02138
adegortaribriseno@fas.harvard.edu

An online appendix is available at http://www.nber.org/data-appendix/w23456

1

Introduction

In recent decades, technological progress and falling trade barriers have allowed …rms to slice up
their value chains, retaining within their domestic economies only a subset of the stages in these
value chains. The rise of global value chains (GVCs) has dramatically changed the landscape of
the international organization of production, placing the specialization of countries within GVCs at
the center stage. Where in GVCs are di¤erent countries specializing? Should countries use speci…c
policies to place themselves in particularly appealing segments of GVCs? These are questions being
posed in the policy arena for which the academic literature has yet to provide satisfactory answers.
This paper studies the specialization of countries within GVCs in a world with barriers to
international trade. Although we are motivated by normative questions, the focus of this paper is
on outlining the implications of the existence of exogenously given trade costs for the equilibrium
shape of GVCs. The role of trade barriers on the geography of GVCs is interesting in its own right
and has been relatively underexplored in the literature, perhaps due to the technical di¢ culties
that such an analysis entails. More speci…cally, characterizing the allocation of production stages
to countries is not straightforward because the optimal location of production of a given stage in
a GVC is not only a function of the marginal cost at which that stage can be produced in a given
country, but is also shaped by the proximity of that location to the precedent and the subsequent
desired locations of production.
We start o¤ our analysis in section 2 by illustrating these interdependencies in a simple partial
equilibrium environment. We consider the problem of a lead …rm choosing the location of its various
production stages in an environment with costly trade. A key insight from our partial-equilibrium
framework is that the relevance of geography (or trade costs) in shaping the location of the various
stages of a GVC is more and more pronounced as one moves towards more and more downstream
stages of a value chain. Intuitively, whenever trade costs are largely proportional to the gross value
of the good being transported, these costs compound along the value chain, thus implying that
trade costs erode more value added in downstream relative to upstream stages. In a parameterized
example of our framework, this di¤erential e¤ect of trade costs takes the simple form of a stagespeci…c ‘trade elasticity’that is increasing in the position of a stage in the value chain. The fact
that trade costs are proportional to gross value follows from our iceberg formulation of these costs,
a formulation that is not only theoretically appealing, but is also a reasonable approximation to
reality.1
Having characterized the key properties of the solution to the lead-…rm problem, we next show
how it can be ‘decentralized’. More speci…cally, we consider an environment in which there is
no lead …rm coordinating the chain, and instead stand-alone producers of the various stages in a
GVC make cost-minimizing sourcing decisions by purchasing the good completed up to the prior
1

The fact that import duties and insurance costs are approximately proportional to the value of the goods being
shipped should be largely uncontroversial. For shipping costs, weight and volume are naturally also relevant, but as
shown by Brancaccio, Kalouptsidi and Papageorgiou (2017), search frictions in the shipping industry allow shipping
companies to extract rents from exporters by charging shipping fees that are increasing in the value of the goods in
transit.

1

stage from their least-cost source. The partial equilibrium of this decentralized economy coincides
with the solution to the lead-…rm problem –and in fact can be recast as a dynamic programming
formulation of the lead-…rm problem – but it is dramatically simpler to compute. For a chain
entailing N stages with each of these stages potentially being performed in one of J countries,
characterizing the J optimal GVCs that service consumers in each country requires only J
computations, instead of the lead …rm having to optimize over
J locations of consumption (for a total of J

JN

JN

N

J

potential paths for each of the

computations).

Although the results of our partial equilibrium model suggest that more central countries should
have comparative advantage in relatively downstream stages within GVCs, formally demonstrating
such a result requires developing a general-equilibrium model of GVCs in which production costs
are endogenously determined and also shaped by trade barriers. With that goal in mind and also to
explore the real income implications of changes in trade costs, in section 3 we develop a Ricardian
model of trade in which the combination of labor productivity and trade costs di¤erences across
countries shapes the equilibrium position of countries in GVCs. More speci…cally, we adapt Eaton
and Kortum’s (2002) Ricardian model to a multi-stage production environment and derive sharp
predictions for the average participation of countries in di¤erent segments of GVCs.
Previous attempts to extend the Ricardian model of trade to a multi-stage, multi-country
environment (e.g., Yi, 2003, 2010, Johnson and Moxnes, 2016, Fally and Hillberry, 2016) have
focused on the quanti…cation of relatively low-dimensional models with two stages or two countries.
Indeed, as we describe in section 3, it is not obvious how to exploit the extreme-value distribution
results invoked by Eaton and Kortum (2002) in a multi-stage environment in which cost-minimizing
location decisions are a function of the various cost ‘draws’ obtained by producers worldwide at
various stages in the value chain. The reason for this is that neither the sum nor the product of
Fréchet random variables are themselves distributed Fréchet, and thus previous approaches have
been forced to resort to numerical analyses and simulated method of moments estimation.
We propose two alternative approaches to restore the tractability of Eaton and Kortum (2002)
in a Ricardian model with multi-stage production. The …rst approach consists in simply treating
the overall unit cost of production of a GVC ‡owing through a sequence of countries as a draw from
a Fréchet random variable with a location parameter that is a function of the states of technology
and wage levels of all countries involved in that GVC, as well as of the trade costs incurred in
that chain. The second approach maintains the standard assumption that labor productivity is
stage-speci…c and drawn from a Fréchet distribution, but instead considers a decentralized equilibrium in which, producers of a particular stage in a GVC have incomplete information about the
productivity of certain suppliers upstream from them. More speci…cally, we assume that …rms know
their productivity and that of the suppliers immediately upstream from them (i.e., their tier-one
suppliers) when they commit to sourcing from a particular supplier, but they do not know the
precise productivity of their suppliers’suppliers (i.e., tier-two suppliers, tier-three suppliers, and so
on). Interestingly, we …nd that these two alternative approaches are isomorphic, in the sense that

2

they yield the exact same equilibrium equations.2
Under these two alternative assumptions, we show in section 4 that our model generates a
closed-form expression for the probability of any potential path of production constituting the
cost-minimizing path to service consumers in any country. These probabilities are analogous to
the trade shares in Eaton and Kortum (2002), and indeed our model nests their framework in the
absence of multi-stage production. Exploiting properties of the resulting distribution of …nal-good
and input prices, we show that our model also delivers closed-form expressions for …nal-good and
input trade ‡ows across countries, which can easily be mapped to the various entries of a world
Input-Output table, or WIOT for short. Various versions of these type of world Input-Output
tables have become available in recent years, including the World Input Output Database, the
OECD’s TiVA statistics, and the Eora MRIO database. Our Ricardian multi-stage framework
also delivers a simple formula relating real income to the relative prevalence of purely domestic
value chains, a formula that generalizes the ‘gains from trade’formula in Arkolakis et al. (2012).
Although our set of general-equilibrium equations is a bit more cumbersome than in Eaton and
Kortum (2002), we show how the proof of existence and uniqueness in Alvarez and Lucas (2007)
can be easily (though tediously) adapted to our setting. Finally, we formally establish the existence of a centrality-downstreamness nexus, by which the average downstreamness of a country in
GVCs should be increasing in this country’s centrality (holding other determinants of comparative
advantage constant). After introducing our main data sources, in section 5, we provide suggestive
empirical evidence for this centrality-downstreamness nexus and for a key mechanism of the model
–namely, the fact that the trade elasticity is larger for downstream stages than for upstream stages.
In section 6, we leverage the tractability of our framework to back out the model’s fundamental
parameters from data on the various entries of a WIOT. Our empirical approach constitutes a blend
of calibration and estimation. First, we show that when abstracting from variation in domestic costs
across countries, our equilibrium conditions unveil a simple way to back out the matrix of bilateral
trade costs across countries from data on …nal-good trade ‡ows within and across countries. Our
approach is akin to that in Head and Ries (2001), but it requires the use of only …nal-good trade
‡ows. We also …x a key parameter that governs the shape of the Fréchet distributions of productivity
to (roughly) match the aggregate trade elasticity implied by our model. Conditional on a set of
countries J and a number of stages N , we then estimate the remaining parameters of the model
via a generalized method of moments (GMM), in which we target the diagonal entries of a WIOT.
We perform this exercise for two distinct and complementary samples. First, we use 2014
data from the World Input-Output Database, a source which is deemed to provide high-quality
and reliable data on intermediate input and …nal-good bilateral trade ‡ows across countries for a
sample of 43 countries and the rest of the world. The main downside of this database is that the
bulk of the countries in the database are high- and medium-income countries in Europe, Asia and
North America. In order to study the geography of GVCs worldwide, we also present results using
2

The approach of building some form of incomplete information (or ex-ante uncertainty) into the Eaton and
Kortum (2002) framework is similar in spirit to the one pursued by Tintelnot (2017) and Antràs, Fort and Tintelnot
(forthcoming).

3

the broader sample of 190 countries in the Eora MRIO database. This data source is admittedly
less reliable, but it allows us to estimate the model for 101 countries (or consolidated countries) in
which all continents and income-levels are more properly represented. In both cases, we …nd that
the model is able to match the targeted moments remarkably well, and it also provides a very good
…t for the cells of the WIOT that are not directly targeted in the estimation.
Armed with estimates of the fundamental parameters of the model, we conclude the paper in
section 7 by performing counterfactual exercises that illustrate how changes in trade barriers a¤ect
the extent to which various countries participate in domestic, regional or global value chains, and
traces the real income consequences of these changes. We …nd that the gains from trade (i.e.,
the income losses from reverting to autarky) emanating from our model are modestly larger than
those obtained from a version of our model without multi-stage production. This variant of our
model is a generalization of the Eaton and Kortum (2002) model calibrated to match exactly the
WIOT. When studying trade costs reductions relative to their calibrated levels, we …nd much
higher income gains, both in absolute terms, but also relative to the version of our model without
multi-stage production. These larger gains partly re‡ect the increased participation of low-income
countries in GVCs.
Our paper most closely relates to the burgeoning literature on GVCs. On the theoretical
front, in recent years a few theoretical frameworks have been developed highlighting the role of the
sequentiality of production for the global sourcing decisions of …rms. Among others, this literature
includes the work of Harms, Lorz, and Urban (2012), Baldwin and Venables (2013), Costinot
et al. (2013), Antràs and Chor (2013), Kikuchi et al. (2014), Fally and Hillberry (2014), and
Tyazhelnikov (2016).3 A key limitation of this body of theoretical work is that it either completely
abstracts from modeling trade costs or it introduces such barriers in highly stylized ways (i.e.,
assuming common trade costs across all country-pairs). On the empirical front, a growing body
of work, starting with the seminal work of Johnson and Noguera (2012), has been concerned
with tracing the value-added content of trade ‡ows and using those ‡ows to better document the
rise of GVCs and the participation of various countries in this phenomenon (see Koopman et al.,
2014, Johnson, 2014, Timmer et al., 2014, de Gortari, 2017).4 A parallel empirical literature has
developed indices of the relative positioning of industries and countries in GVCs (see Fally, 2012,
Antràs et al., 2012, Alfaro et al., 2015). On the quantitative side, and as mentioned above, our
work builds on and expands on previous work by Yi (2003, 2010), Johnson and Moxnes (2016)
and Fally and Hillberry (2016). Other authors, and most notably Caliendo and Parro (2015), have
developed quantitative frameworks with Input-Output linkages across countries, but in models with
a roundabout production structure without an explicit sequentiality of production. The connection
between our framework and these previous contributions is further explored in de Gortari (2017),
who blends several strands of this literature by generalizing the formulas on value-added content and
3

This literature is in turn inspired by earlier contributions to modeling multi-stage production, such as Dixit and
Grossman (1982), Sanyal and Jones (1982), Kremer (1993), Yi (2003) and Kohler (2004).
4
An important precursor to this literature is Hummels et al. (2001), who combined international trade and
Input-Output data to construct indices of vertical specialization.

4

downstreamness within the context of a multi-sector Ricardian model with sequential production.
Finally, some implications of the rise of o¤shoring and GVCs for trade policy have been studied
by Antràs and Staiger (2012) and Bown et al. (2016), but in much more stylized frameworks than
studied in this paper.
The rest of the paper is structure as follows. Section 2 develops our partial equilibrium model
and highlights some of its key features. Section 3 describes the assumptions of the general equilibrium model, and section 4 characterizes its equilibrium. Section 5 introduces our data sources and
provides suggestive empirical evidence for some of the key features of our model. Section 6 covers
the estimation of our model and section 7 explores several counterfactuals. All proofs and several
details on data sources and the estimation are relegated to the Appendix and Online Appendix.

2

Partial Equilibrium: Interdependencies and Compounding

In this section, we develop a simple model of …rm behavior that formalizes the problem faced by
a …rm choosing the location of its various production stages in an environment with costly trade.
For the time being, we consider the problem of a …rm (or, more precisely, of a competitive fringe
of …rms) producing a particular good. We defer a discussion of the general equilibrium aspects of
the model to section 3.

2.1

Environment

There are J countries in which consumers derive utility from consuming a …nal good. The good is
produced combining N stages that need to be performed sequentially. The last stage of production
can be interpreted as assembly and is indexed by N . We will often denote the set of countries
f1; :::; Jg by J and the set of production stages f1; :::; N g by N . At each stage n > 1, production

combines a local composite factor (which encompasses primitive factors of production and a bundle
of materials), with the good …nished up to the previous stage n

1. Production in the initial stage

n = 1 only uses the composite factor. The cost of the composite factor varies across countries and
is denoted by ci in country i.5 Countries also di¤er in their geography, as captured by a J
matrix of iceberg trade coe¢ cients

ij

1, where

ij

J

denotes the units of the …nished or un…nished

good that need to be shipped from i for one unit to reach j. Firms are perfectly competitive and
the optimal location ` (n) 2 J of the di¤erent stages n 2 N of the value chain is dictated by cost
minimization. Because of marginal-cost pricing, we will somewhat abuse notation and denote by

pn`(n) the unit cost of production of a good completed up to stage n in country ` (n). That good is
available in country ` (n + 1) at a cost pn`(n)

`(n)`(n+1) .

We summarize technology via the following sequential cost function associated with a path of
5
For now we take this cost as given, but in the general equilibrium analysis in section 3, we will break ci into
the cost of labor and of a bundle of intermediate inputs we call materials. This will allow our model to encompass
previous Ricardian models – and most notably Eaton and Kortum (2002) – featuring roundabout production.

5

production ` = f` (1) ; ` (2) ; :::; ` (N )g:
n
c`(n) ; pn`(n1 1) (`)
pn`(n) (`) = g`(n)

`(n 1)`(n)

; for all n 2 N .

(1)

n
The stage- and country-speci…c cost functions g`(n)
in equation (1) are assumed to feature constant-

returns-to-scale and diminishing marginal products. As mentioned before, we let the cost of the
…rst stage depend only on the local composite factor, so constant returns to scale implies p1`(1) (`) =
1
1
g`(1)
c`(1) for all paths `, with the function g`(1)
necessarily being linear in c`(1) .

Note that equation (1) also applies to the assembly stage N , and a good assembled in ` (N )
after following the path ` is available in any country j at a cost pFj (`) = pN
`(N ) (`)

`(N )j

(we use

the superscript F to denote …nished goods). For each country j 2 J , the goal is then to choose the

optimal path of production `j = `j (1) ; `j (2) ; :::; `j (N ) 2 J N that minimizes the cost pFj (`) of
providing the good to consumers in that country j.

At various points in the paper, we will …nd it useful to focus on the case in which cross-country
di¤erences in technology are associated with Ricardian di¤erences in the e¢ ciency with which
n
the local composite factor is used in di¤erent stages, and in which the function g`(n)
is a Cobb-

Douglas aggregator of the composite factor and the product …nished up to the previous stage. More
speci…cally, we write
n

pn`(n) (`) = an`(n) c`(n)
where

n

pn`(n1 1) (`)

1

n

`(n 1)`(n)

; for all n 2 N ,

(2)

denotes the cost share of the composite factor at stage n and an`(n) is the unit factor

requirement at stage n in country ` (n). Because the initial stage of production uses solely the local
composite factor, we have

2.2

1

= 1.

Lead-Firm Problem

We consider …rst the problem of a lead …rm choosing the location of production of all stages
n 2 N , in order to minimize the overall cost of serving consumers in a given country j. Using
pFj (`) = pN
`(N ) (`)

`(N )j

and iterating (2), this problem reduces to:

`j = arg min pFj (`) = arg min
`2J N

`2J N

N
Q

n=1

an`(n) c`(n)

where
n

and where we use the convention

QN

N
Q

(1

n n

NQ1

`(n)`(n+1)

n

`(N )j

(3)

n=1

m) ;

(4)

m=n+1

m=N +1 (1

m)

= 1. Note that

PN

n=1

n n

= 1.

We next highlight two important features of program (3). First, notice that when trade costs are
identical for all country-pairs (i.e.,

ij

=

for all i and j), the last two terms reduce to a constant

that is independent of the path of production. In such a case, we can break the cost-minimization

6

problem in (3) into a sequence of N independent cost-minimization problems in which the optimal
location of stage n is simply given by `j (n) = arg mini fani ci g ; and is thus independent of the
country of consumption j. Notice, however that this result requires no di¤erences between internal
and external trade costs (i.e.,

ij

=

also for i = j), and thus this case is isomorphic, up to a

productivity shifter, to an environment with costless trade. With a general geography of trade costs,
a lead …rm can no longer perform cost minimization independently stage-by-stage, and instead it
needs to optimize over the whole path of production. Intuitively, the location ` (n) minimizing
production costs an`(n) c`(n) might not be part of a …rm’s optimal path if the optimal locations for
stages n

1 and n + 1 are su¢ ciently far from ` (n). A direct implication of this result is that

the presence of arbitrary trade costs turns a problem of dimensionality N

J into J much more

complex problems of dimensionality J N each. As we will see below, however, the dimensionality of
program (3) can be dramatically reduced using dynamic programming.
A second noteworthy aspect of the minimand in equation (3) is that the trade-cost elasticity of
the unit cost of serving consumers in country j increases along the value chain. More speci…cally,
note from equation (4) that, as long as

n

> 0 for all n, we have

1

<

2

< ::: <

= 1. For the

N

particular case in which overall value added is a symmetric Cobb-Douglas aggregator of the value
added of all stages (i.e.,

n n

= 1=N , for all n), the program in (3) reduces to

`j = arg min pFj (`) = arg min
`2J N

`2J N

N
Q

n=1

an`(n) c`(n)

1=N

NQ1

n=N
`(n)`(n+1)

`(N )j

,

(5)

n=1

and the trade-cost elasticity increases linearly with the downstreamness n of a stage.
The reason for this compounding e¤ect of trade costs stems from the fact that the costs of
transporting goods have been modeled (realistically, as we argued in the Introduction) to be proportional to the gross value of the good being transacted, rather than being assumed proportional
to the value added at that stage. Thus, as the value of the good rises along the value chain, so does
the amount of resources used to transport the goods across locations. An implication of this compounding e¤ect is that, in choosing their optimal path of production, …rms will be relatively more
concerned about reducing trade costs in relatively downstream stages than in relatively upstream
stages. As we will illustrate below and formally demonstrate when exploring the general equilibrium of our model, this feature of the cost function will generate a centrality-downstreamness nexus
by which, ceteris paribus, relatively more central countries will tend to gain comparative advantage
and specialize in relatively downstream stages.6
Although we have derived this compounding e¤ect of trade costs for the case of Ricardian
technological di¤erences and Cobb-Douglas cost functions, we show in Appendix A.1 that the same
result applies for arbitrary constant-returns-to-scale technologies of the type in equation (1). More
6

Building on the results in Costinot (2012), we can brie‡y anticipate this result with the following example.
1
Suppose that trade costs can be decomposed as ij =
, where we take i is an index of the centrality
i j
of country i. In such a case, it is straightforward to show that leaving aside other determinants of comparative
advantage, the unit cost of servicing consumers in country j is log-supermodular in a country’s centrality i and a
stage’s downstreamness n (see more on this in section 4).

7

speci…cally, denoting by

n

the elasticity of pFj (`) with respect to

`(n)`(n+1) ,

we show that

n

is

again necessarily non-decreasing in n even when these elasticities are not pinned down by exogenous
parameters. Thus, the result that …rms will be particularly concerned about minimizing trade costs
in downstream stages is quite general.7

2.3

Decentralization and Dynamic Programming

We have so far characterized the problem of a lead …rm with full information on the productivity
of the various potential producers of each stage n in each country j. This characterization relies
on strong informational assumptions, so we now consider an alternative environment in which no
individual …rm coordinates the whole value chain. Instead, we assume that a value chain consists
of a series of stage-speci…c producers that simply minimize their cost of production taking into
account their composite factor cost, their productivity, and the cost at which they can obtain the
good …nished up to the immediately preceding stage. Similarly, consumers in country j simply
purchase the …nal good from whichever assembler (i.e., stage N producer) worldwide can provide
the …nished good at the lowest price.
From equation (1), a producer of stage n in country n` (n) would choose
o to procure the good
n 1
…nished up to stage n 1 by simply solving min`(n 1)2J p`(n 1) `(n 1)`(n) , where pn`(n1 1) is the

optimal (free-on-board) price charged by producers of stage n 1 in country ` (n

1). Importantly,

producers seek to simply minimize sourcing costs regardless of their own composite factor cost, their
productivity and the future path of the good after ‡owing through ` (n) at stage n. Furthermore,
the resulting price at which this producer can sell the good …nished up to stage
of
n n to producers o
n 1
n
stage n + 1 is only a function of a`(n) c`(n) and this minimum price min`(n 1)2J p`(n 1) `(n 1)`(n) .

Producers of the initial stage n = 1 only use their local composite factor, and thus p1`(1) = a1`(1) c`(1) .
With constant returns to scale, the identity of the speci…c …rms making these decisions is
of course immaterial, so this formulation is entirely consistent with our previous lead …rm using
dynamic programming to solve for the optimal path of production leading to consumption in each
country j 2 J . More speci…cally, instead of solving program (3) in a brute force manner, the lead

…rm can break the problem into a series of stage- and country-speci…c optimal sourcing problems (as

in the decentralized formulation above), and then solve the problem via forward induction (starting
in the most upstream stages). Invoking the principle of optimality, we can then establish (see
Appendix A.2) that the resulting optimal path of production `j = `j (1) ; `j (2) ; :::; `j (N ) 2 J N

that minimizes the cost pFj (`) in this decentralized formulation of the problem will coincide with
the one we obtained solving the lead-…rm problem in (3) by exhaustive search.
A key advantage of this dynamic programming approach is that it only requires J

N

J

computations to obtain the optimal production path for all destinations of …nal consumption,
7
For example, for the case of a symmetric Leontief technology and production costs equal to 1 in all countries and
stages (i.e., an
`(n) c`(n) = 1 for all n and ` (n)), we obtain

pF
j (`) =

`(N )j + `(N )j `(N

1)`(N ) + `(N )j `(N

1)`(N ) `(N

2)`(N

1) + `(N )j `(N

1)`(N ) `(N

which again illustrates the larger relative importance of downstream trade costs.

8

2)`(N

1) `(N

3)`(N

2) +

;

WEST

EAST
𝜏𝜏𝐴𝐴𝐴𝐴 = 1.75

𝜏𝜏𝐴𝐴𝐴𝐴 = 1.3

𝜏𝜏𝐶𝐶𝐶𝐶 = 1.3
𝜏𝜏𝐵𝐵𝐵𝐵 = 1.5

Figure 1: An Example with Four Countries
instead of having to optimize over J N potential paths for each country j.8 For example, with
200 countries and 5 stages, this amounts to only 200; 000 computations rather than 64 trillion
computations.9 Although it might be clear from our discussion above, it is worth stressing that
the isomorphism between the lead-…rm problem and the decentralized problem holds true for any
constant-returns-to-scale technology, and not only for the Cobb-Douglas one in (2).

2.4

An Example

We close this section by illustrating some of the salient and distinctive features of this partial model
of sequential production via a simple example. We consider a world with four countries (J = 4)
and four stages (N = 4). Technology is given by the symmetric Cobb-Douglas speci…cation in (5),
with

n n

= 1=4 for all n. The four countries are divided into two regions, the West (comprising

countries A and B) and the East (comprising countries C and D). The ‘geography’of this example
is illustrated in Figure 1. Note that we impose a great deal of symmetry: intra-regional trade
costs are common in both regions, and inter-regional costs between A and C are identical to those
between B and D. On the other hand, trade costs between B and C are lower than between A
and D. For simplicity, all domestic trade costs are set to 0, so

ii

= 1 for i = A; B; C; D. We are

interested in solving for the optimal path of a four-stage production process leading to consumption
in country D (in green in the …gure). Note that shipping to D directly is least costly when shipping
from D itself, followed by C (the other country in the East), then by A and …nally by B, which is
the most remote country relative to D.
We compute the optimal path leading to D for di¤erent levels of trade costs starting with
a benchmark with

AB

=

CD

= 1:3,

BC

= 1:5,

8

AD

= 1:75,

AC

=

BD

= 1:8, and then

See Appendix A.2 for more details. This same point has been made in contemporaneous work by Tyazhelnikov
(2016).
9
Though the dimensionality of the lead …rm’s problem is huge, for the particular case with Cobb-Douglas technologies, in Appendix A.2 we show that the problem can also be written as a zero-one integer programming problem,
for which many extremely quick and e¢ cient algorithms are available (see, for instance, http://www.gurobi.com).

9

3

100

80

Average Position

% of GVCs

2.5
60

40

GVCs with A
GVCs with B
GVCs with C
GVCs with D

2

1.5
20

0

1
0 1/8 1/4 1/2 3/4 1 3/2 2

3

5 10 25 50

0 1/8 1/4 1/2 3/4 1 3/2 2

s

3

5 10 25 50

s
100

% of GVCs

80

60

Domestic GVCs
Regional GVCs
Global GVCs

40

20

0
0 1/8 1/4 1/2 3/4 1 3/2 2

3

5 10 25 50

s

Figure 2: Some Features of Optimal Production Paths
scale these international trade costs up or down by a shifter s (so starting from
use ~ij (s) = 1 + s

(

with production costs

ij
anj cj

ij ,

we instead

1)).10 For each matrix of trade costs, we run one million simulations
being drawn independently for each stage n and each country j from

a lognormal distribution with mean 0 and variance 1. By choosing a common distribution across
countries and stages, we seek to isolate the role of trade costs in shaping the optimal path of
sequential value chains.
The results of these simulations are depicted in Figure 2 for various levels of s ranging from 0
(free trade) to 50 (which results in close to prohibitive trade costs). The upper left panel shows the
average propensity of each country to appear in GVCs leading to consumption in D. The upper
right panel depicts the average position (or downstreamness) of countries in these GVCs. Finally,
the lower panel decomposes GVCs into purely domestic ones (with all production stages in D),
purely regional ones (with some stages in C and D, but not in A or B) and global ones (involving
at least one stage in A or B).
Several aspects of Figure 2 are worth highlighting. First, focusing on the upper left panel,
notice that country B, which is farthest away from country D, appears slightly more often in value
chains leading to D than its Western neighbor A does. The reason for this surprising fact is tightly
related to the sequential nature of production. Even though, A is closer to D than B is, B is
10

These parameters are chosen such that for all values of s considered, the triangle inequality holds for any three
given countries.

10

relatively close to D’s Eastern neighbor C, and this makes this ‘remote’country B a particularly
appealing location from which to set o¤ value chains that will ‡ow to D through C.11 A second
noteworthy aspect, apparent from the upper right panel of Figure 2, is that remoteness appears to
shape the average position of a country in GVCs, a fact we anticipated above. More speci…cally,
country B, which is farthest away from D, is on average the most upstream of all countries, followed
by its Western neighbor A, and then by C, with D being naturally the country positioned most
downstream in value chains leading to consumption in D. Finally, the lower panel of Figure 2
illustrates how the progressive reduction of international trade costs …rst gives rise to GVCs that
are largely regional in nature, and then later to truly global value chains involving inter-regional
trade. It is also worth highlighting that even for fairly low trade costs, purely domestic GVCs
remain quite prevalent, much more so than would be predicted by an analogous model without
sequentiality (see the Online Appendix B.1). The reason for this is the compounding e¤ect of trade
costs, which other things equal makes it costly to o¤shore intermediate production stages in chains
in which D has comparative advantage in the most upstream and downstream stages.

3

General Equilibrium Model

We next embed the model of …rm behavior developed in the last section into a full-‡edged general
equilibrium model.

3.1

Environment

We continue to assume a world with J countries (indexed by i or j) where consumers now derive
utility from consuming a continuum of …nal-good varieties (indexed by z). Preferences are CES
and given by
u

yiN

(z)

1
z=0

=

Z

0

1

yiN (z)

(

1)=

=(

dz

1)

,

> 1.

(6)

Production of each of the …nal-good varieties is as described in the previous section: production
processes entail N sequential stages (indexed by n) and are characterized by the Ricardian, CobbDouglas speci…cation in (2).
We let countries di¤er in three key aspects: (i) their technological e¢ ciency, as determined by
the unit composite factor requirements ani (z), (ii) their geography, as captured by a J
of iceberg trade cost

ij

J matrix

1, and (iii) their size, as re‡ected by the measure Li of ‘equipped’labor

available for production in each country i (labor is inelastically supplied and commands a wage
wi ).
The local composite factor used at each stage comprises labor and an aggregator of …nal-good
varieties that corresponds exactly to the CES aggregator in (6). In other words, part of …nal-good
11

As we show in Online Appendix B.1, in an analogous world without sequentiality, the above pattern would not
hold and the relative prevalence of countries would be strictly monotonic in the level trade costs incurred when
shipping to the assembly location.

11

production is not absorbed by consumers, but rather by …rms that use those goods as a bundle
of materials. This roundabout structure of production is standard in recent Ricardian models (see
Eaton and Kortum, 2002, Alvarez and Lucas, 2007, or Caliendo and Parro, 2014), so we adopt
it for comparability (see, in particular, section 7). We should stress, however, that our model
features intermediate input ‡ows across countries even in the absence of these production ‘loops’.
We let the cost ci of the composite factor in country i be captured by a Cobb-Douglas aggregator
ci = (wi ) i (Pi )1

i

, where Pi is the ideal price index associated with the CES aggregator in (6).

Although allowing for variation in value added shares

i

across countries is not important for our

theoretical results, it will prove useful in allowing our model to better match world Input-Output
tables.
This completes the discussion of the structure of our general-equilibrium model. In principle,
given values for the unit composite factor requirements ani (z) and all other primitive parameters,
the equilibrium of the model could be computed by (i) solving for the cost-minimizing path of
production for each good z and each destination of consumption j given a vector of wages, and (ii)
invoking labor-market clearing to reduce equilibrium wages to the solution of a …xed point problem.
Such an approach, however, would not be particularly useful in order to formally characterize certain
features of the equilibrium or to estimate the model in a computationally feasible and transparent
manner. With that in mind, we next explore a particularly convenient parametrization of the unit
factor requirements ani (z).

3.2

Technology

Building on the seminal work of Eaton and Kortum (2002), we propose a probabilistic speci…cation
of the unit factor requirements ani (z) that delivers a remarkably tractable multi-stage, multi-country
Ricardian model. We are certainly not the …rst ones to explore such a multi-stage extension of the
Eaton and Kortum (2002) framework. Yi (2010) and Johnson and Moxnes (2016), for instance,
consider a ‘natural’extension in which each productivity parameter 1=ani (z) is assumed stochastic
and drawn independently (across goods and stages) from a type II (or Fréchet) extreme-value
probability distribution, as in Eaton and Kortum (2002). A key limitation of their approach is
that the minimum cost associated with a given GVC path is not characterized by a particularly
tractable distribution. The reason for this is that, although the minimum of a series of Fréchet draws
is itself distributed Fréchet, the product of Fréchet random variables is not distributed Fréchet.12
As a result, these papers need to resort to numerical methods to approximate the solution of their
models, even when restricting the analysis to two-stage chains. We instead develop two alternative
approaches that will permit a sharp and exact characterization of some of the features of the
equilibrium for an arbitrary number of stages, and that will be readily amenable to structural
(generalized method of moments) estimation using world Input-Output tables.
12

Assuming a linear cost function (i.e., perfect complementarity) does not provide tractability either because the
sum of Fréchet random variables is not distributed Fréchet either.

12

A. Lead-Firm Approach
We begin by revisiting the problem of a lead …rm choosing the location of the various stages of production with full knowledge of the realized unit requirements ani (z) for each stage in each country.
The key innovation we propose, relative to Eaton and Kortum (2002), is to introduce randomness
to the overall cost of production of a given value chain, rather than to the productivity of each
stage independently. Intuitively, a given production path ` = f` (1) ; ` (2) ; :::; ` (N )g 2 J N will be
associated with an average cost that is naturally a function of trade costs, composite factor costs

and the state of technology of the various countries involved in the chain. Yet, compatibility problems, production delays, or simple mistakes can generate idiosyncratic noise around that average.
More formally, and building on the cost function in (3), we assume that the overall ‘productivity’
of a given chain ` is characterized by
Pr

N
Q

n=1

an`(n) (z)

which amounts to assuming that

N
Q

n=1

n n

a

an`(n) (z)

= exp

n n

(

a

N
Y

T`(n)

n n

n=1

)

;

(7)

is distributed Fréchet with a shape parameter

given by , and a location parameter that is a function of the states of technology in all countries in
N
Q
the chain, as captured by
T`(n) n n . A direct implication of this assumption is that the unit
n=1

cost associated with serving consumers in a given country j via a given chain ` is also distributed

Fréchet. More precisely, denoting by pFj (`; z) the price paid by consumers in j for a good z produced
following the path `, we have
Pr pFj (`; z)

p = exp

(

p

N
Y

c`(n)

T`(n)

n n

NQ1

`(n)`(n+1)

n=1

n=1

n

`(N )j

)

;

(8)

independently of the …nal good z under consideration. This result will be key for neatly characterizing the equilibrium, as we will show in the next section.
B. Decentralized Approach
We also develop an alternative approach closer in spirit to the stage-speci…c productivity randomness in Yi (2010) and Johnson and Moxnes (2016), which also achieves tractability and, in fact,
delivers an identical set of equilibrium conditions to those we will derive under the speci…cation in
(7). On the technology side, we now assume that 1=ani (z) is drawn independently (across goods
and stages) from a Fréchet distribution satisfying
Pr ani (z)

n n

a = exp

n

a (Ti )

n n

o

.

(9)

Note that this formulation imposes a common variance (as captured by the shape parameter ) of
the contribution of each stage n’s productivity –i.e., ani (z)
13

n n

–to the overall productivity of a

value chain. This assumption ensures that we do not mechanically introduce heterogeneity across
stages in the trade-cost elasticity related to the importance of these stages in production.13
In order to make this alternative approach tractable, we relax the assumption that …rms choose
the optimal path of production with full knowledge of the productivity levels with which all stages of
production in their chain could be produced in di¤erent countries. More speci…cally, we explore an
environment akin to the decentralized equilibrium developed in section 2.3, in which stage-speci…c
producers simply attempt to minimize the cost of production of their stage. Unlike in section 2.3,
we assume, however, that these stage-speci…c producers do not observe realized upstream prices
before making sourcing decisions, and can only forecast these prices based on information on the
productivity levels of their potential direct (or tier-one) suppliers in various countries. These tierone supplier productivity levels are not su¢ cient statistics for sourcing prices because upstream
marginal costs also depend on the productivity of suppliers further upstream (i.e., tier-two suppliers,
tier-three suppliers and so on). The idea behind this formulation is that …rms need to pre-commit to
purchase from particular suppliers based on information they gather from inspecting (e.g., through
factory visits) all their potential immediate suppliers. Ex-post, a supplier’s marginal cost might be
higher or lower than expected because this supplier may face unexpectedly high or low sourcing
costs itself. Although the pre-commitment to buy from a particular source naturally a¤ects the
nature of ex-post competition, we assume that buyers have all the bargaining power and continue
to be able to source upstream inputs at marginal cost.
Because this decentralized approach with incomplete information is a bit more cumbersome
than the formulation in (7), we only illustrate how it works for the simple case with only two
stages, input production (stage 1) and assembly (stage 2). In Appendix A.3, we show how the
approach naturally generalizes to the case N > 2.
Input producers of a given good z in a given country ` (1) 2 J observe their productivity

1=a1`(1) (z),

and simply hire labor and buy materials to minimize unit production costs, which

results in p1`(1) (z) = a1`(1) (z) c`(1) . Assemblers of good z in any country ` (2) 2 J observe their
productivity 1=a2`(2) (z), as well as that of all potential input producers worldwide, and solve
p2`(2) (z) = min

`(1)2J

a2`(2) (z) c`(2)

Independently of the values of a2`(2) (z), c`(2) , and

2

a1`(1) (z) c`(1)
2,

1
`(1)`(2)

2

own

.

the solution of this problem simply entails

procuring the input from the location ` (1) satisfying ` (1) = arg min

a1`(1) (z) c`(1)

1

2

`(1)`(2)

As is well-known, the Fréchet assumption in (9) will make characterizing this problem fairly straightforward. Consider …nally the problem of retailers in each country j seeking to procure a …nal good
z to local consumers at a minimum cost. These retailers observe the productivity 1=a2`(2) (z) of all
13

There is no economic reason to think that that the trade-cost elasticity should vary with the contribution of a
stage to value added, and such variation would obviously obfuscate our result showing that this elasticity rises along
the value chain.

14

.

assemblers worldwide, but not the productivity of input producers, and thus seek to solve
pFj

a2`(2) (z) c`(2)

(z) = min

`(2)2J

2

E

h

a1` (1) (z) c` (1) ` (1)`(2)

i1

2

`(2)j

.

(10)

If retailers could observe the particular realizations of input producers, the expectation in (10)
would be replaced by the realization of a1`(1) (z) c`(1)

`(1)`(2)

in all ` (1) 2 J , and characterizing

the optimal choice would be complicated because it would depend on the joint distribution of
a2`(2) (z) and a1`(1) (z),which is not Fréchet under (9). As we will demonstrate in section 4, with
our incomplete information assumption, the expectation in (10) does not depend on the particular
realizations of upstream productivity draws, and this will allow us to apply the well-know properties
of the univariate Fréchet distribution in (9) to characterize the problem of retailers.

4

Characterization of the Equilibrium

In this section, we characterize the general equilibrium of our model. We proceed in …ve steps.
First, we leverage our extreme-value representation of GVC productivity to obtain closed-form
expressions for the relative prevalence (in value terms) of di¤erent GVCs in the world equilibrium.
Second, we show how to manipulate these relative market shares of di¤erent GVCs to obtain
expressions for bilateral intermediate input and …nal-good ‡ows across countries, which can be
mapped to observable data from world Input-Output tables. Third, we study the existence and
uniqueness of the general equilibrium. Fourth, we obtain expressions for the gains from trade in
our model and compare them to those in Eaton and Kortum (2002). Fifth, we formalize the link
between downstreamness and centrality that we hinted at in section 2.

4.1

Relative Prevalence of Di¤erent GVCs and Equilibrium Prices

Let us begin with the lead-…rm version of our model, in which the price paid by consumers in j
for a good produced following the path ` 2 J N is given by the Fréchet distribution in (8). In
such a case, we can readily invoke a few of the results in Eaton and Kortum (2002) to characterize
the equilibrium prices and the relative prevalence of di¤erent GVCs. First, it is straightforward to
verify that the probability of a given GVC ` being the cost-minimizing production path for serving
consumers in j is given by

`j

=

NQ1

T`(n)

n

c`(n)

n

n

T`(N )

`(n)`(n+1)

N

c`(N )

N

`(N )j

n=1

,

(11)

j

where

j

=

P NY1

`2J N

T`(n)

n

c`(n)

n

n

`(n)`(n+1)

n=1

15

T`(N )

N

c`(N )

N

`(N )j

,

(12)

and where remember that ci = (wi ) i (Pi )1

i

. With a unit measure of …nal goods,

`j

also

corresponds to the share of GVCs ending in j for which ` is the cost-minimizing production path.14
Second, and as in Eaton and Kortum (2002), the distribution of …nal-good prices pFj (`; z) paid
by consumers in j satis…es
Pr pFj (`; z)

p =1

exp

n

jp

o

.

(13)

Because the distribution of …nal-good prices in j is independent of the path of production `, it
follows that the probabilities in

`j

also constitute the shares of country j’s income spent on …nal

goods produced under all possible paths ` 2 J N .

As is clear from equation (11), GVCs that involve countries with higher states of technology

Ti or lower composite factor costs ci will tend to feature disproportionately in production paths
leading to consumption in j. Furthermore, and consistently with our discussion in section 2, high
trade costs penalize the participation of countries in GVCs, but such an e¤ect is disproportionately
large for downstream stages relative to upstream stages. This is captured by the fact that the
‘trade elasticity’associated with stage n is given by

n,

and

n

is increasing in n with

N

= 1:

Following the same steps as in Eaton and Kortum (2002), we can further solve for the exact
ideal price index Pj in country j associated with (6)
Pj =
where

+1

=

we impose

1=(1

)

and

(

j)

1=

;

(14)

is the gamma function. For the price index to be well de…ned,

1< .

So far we have focused on the ‘randomness-in-the-chain’formulation in (8). Consider now our
alternative approach with stage-speci…c randomness captured by (9) and incomplete information.
As in section 3, we will focus here on the case with two stages and leave the more general case to
Appendix A.3. Take two countries ` (1) and ` (2) and consider the probability

`j

of a GVC ‡owing

through ` (1) and ` (2) before reaching consumers in j. This probability is simply the product of
(i) the probability of ` (1) being the cost-minimizing location of input production conditional on
assembly happening in ` (2), and (ii) the probability of ` (2) being the cost-minimizing location of
h
i1 2
assembly for GVC serving consumers in j. Denoting E`(2) = E ` (1)`(2) a1` (1) (z) c` (1)
; and
using the properties of the Fréchet distribution, it is easy to verify that we can write
1

`j

2
T`(1)
c`(1) `(1)`(2)
= P
1
(Tk ) 2 ck k`(2)
k2J
|
{z

Pr(`(1)j`(2))

(1
(1

2)
2)

}

|

T`(2)
P

i2J

2

(Ti )

c`(2)
2

((ci )

2

`(2)j
2

{z

(

Pr(`(2))

ij ))

E`(2)

(Ei )

`j

.

as

(15)

}

A bit less trivially, but also exploiting well-known properties of the Fréchet distribution, it can
14

Note that when N = 1, we necessarily have N = 1, and the formulas (11) and (12) collapse to the well-know
trade share formulas in Eaton and Kortum (2002).

16

be shown that
E`(2) = E

h

1
` (1)`(2) a` (1) (z) c` (1)

i1

2

P

=&

1

2

(Tk )

ck

(1

2)

k`(2)

k2J

!

1=

,

for some constant & > 0. This allows us to reduce (15) to
(1

1

`j

2
c`(1)
T`(1)
=
P P
(Tk )1

2)

`(1)`(2)
2

(ck

ki )

(1

T`(2)
2)

(Ti )

2

c`(2)

2

2

((ci )

2

`(2)j

(

.

ij ))

(16)

k2J i2J

It should be clear that this expression is identical to (11) –plugging in (12) – for the special case
N = 2. It is also straightforward to verify that the distribution of …nal-good prices pFj (`; z) paid
by consumers in j is independent of the actual path
` and is again characterized, as
n of production
o
F
~ j p , where ~ j is the denominator in (16),
in equation (13), by Pr pj (`; z) p = 1 exp
and is the analog of

j

in (12) when N = 2.

In sum, this alternative speci…cation of the stochastic nature of technology delivers the exact
same distribution of GVCs and of consumer prices as the one in which the overall GVC unit cost is
distributed Fréchet. As mentioned above and as demonstrated in Appendix A.3, this isomorphism
carries over to the case N > 2.

4.2

Mapping the Model to Observables

So far, we have just described how to adapt the Eaton and Kortum (2002) probabilistic approach
to apply to trade shares in terms of speci…c production paths (or GVCs) rather than in terms of
trade volumes. Unfortunately, these ‘GVC trade shares’are not observable in the data, so we next
describe how to map the model to the type of information available in world Input-Output tables.
These sources of data provide information on (i) the value of …nal-good consumption in country
j originating in assembly plants (producing stage N ) in all other countries i, and (ii) the value of
intermediate input purchases used by …rms in j originating from producers in all other countries i.
Consider …rst the implications of our model for …nal-good consumption. Notice that for …nal
goods to ‡ow from a given source country i to a given destination country j, it must be the case
that country i is in position N in a chain serving consumers in country j. De…ne the set of GVCs
n
i

‡owing through i at position n by
that

N
i

2 JN

1,

or formally,

n
i

= ` 2 J N j ` (n) = i . Note then

corresponds to the set of chains in which assembly is carried out in i. With this notation,

the overall relative prevalence of all GVCs serving consumers in j in which country i is in assembly
(position N ) can be expressed as

F
ij

=

P

`2

N
i

NQ1

T`(n)

n

c`(n)

n

n

`(n)`(n+1)

(Ti )

N

((ci )

N

ij )

n=1

.
j

17

(17)

Because these ‡ows occur at the same expected price for all goods regardless of the actual source
F
ij

country i, it follows that the shares

also correspond to the …nal consumption shares reported in

world Input-Output tables. Our model thus provides explicit formulas for these world Input-Output
entries as a function of the parameters of our model and the endogenous composite factor cost ci ,
which we can solve for in general equilibrium. Note also that …nal-good trade ‡ows between any
two countries i and j are then simply given by

F
ij

wj Lj , since spending on …nal goods in country

j must equal aggregate income, and labor is the only factor of production (when we estimate the
model, we will incorporate trade imbalances).
Computing intermediate input ‡ows between any two countries i and j is a bit more tedious,
but equally straightforward. To begin, we need to distinguish between two types of intermediate
input ‡ows. First, at any stage of production, …rms in country j purchase a bundle of materials
at cost Pj from …rms worldwide, and part of that spending originates in country i. Because the
bundle of intermediate corresponds exactly to the consumption CES aggregator, the share of j’s
F
ij

input purchases originating in i is again given by

in (17).15 Furthermore, note that any time

the bundle of intermediates is used in production, spending on it in country j equals a multiple
1

=

j

of spending on labor. As a result, aggregate ‡ows between i and j of this type of

j

F
ij

intermediates are given by

1

j

=

wj Lj .

j

In our multi-stage model, there is a second type of intermediate input ‡ows across countries.
In particular, …rms in j also import a semi-…nished product from i in sequential GVCs in which
i immediately precedes j. To compute these ‡ows, let us begin by denoting by
set of GVCs that ‡ow through k at position n
n
k!i

formally,

= `2

JN

N

n
k!i

2 JN

2

the

1 and through i at position n + 1, or more

j ` (n) = k and ` (n + 1) = i . The probability that this subset of GVCs

emerges in equilibrium in GVCs serving consumers in j is given by

Pr (

n
k!i ; j)

=

P

`2

n
k!i

NQ1

T`(n)

n

c`(n)

n

n

`(n)`(n+1)

n=1

T`(N )

N

c`(N )

N

`(N )j

:
j

Note further that all …nal goods sold in j, command the same expected price regardless of the actual
chain, and thus Pr (

n ; j)
k!i

corresponds to the share of total spending in country j associated with

chains that ‡ow through k at position n

N

1 and through i at position n + 1 before reaching

country j after assembly. Moreover, the value of the trade ‡ow between countries k and i at
positions n and n + 1 is a share

n

of the total spending on that chain in country j.16 The latter

spending comprises …nal-good consumption (wj Lj ) and spending in the intermediate input bundle
( 1

j

=

j

wj Lj ). To …nd the overall spending of intermediate input purchases by …rms in i

importing from …rms in k immediately upstream from them, we thus just need to aggregate across
15
In the Eaton and Kortum (2002) model, these are the only type of intermediate input ‡ows and thus there is a
unique ‘trade share’ ij regardless of the nature of the goods ‡owing between country i and country j.
16
This can be veri…ed by iterating (2) and referring to the de…nition of n in (4).

18

destinations markets j and neighboring stages n and n + 1 to obtain
P NP1

Xki =

1

n
n Pr ( k!i ; j)

j2J n=1

wj Lj .

j

Together with the input ‡ows associated with the more standard roundabout structure of production, we …nally obtain that the share of input purchases by …rms in i originating in country k
is given by:
F 1
ki
X
ki

=

P

F 1
k0 i

k0 2J

wi Li +

i
i

P NP1

1
n
n Pr ( k!i ; j) j wj Lj

j2J n=1

wi L i +

i
i

P P NP1

k0 2J j2J n=1

.
n Pr

1

n
k0 !i ; j

j

(18)

wj L j

Although computing these intermediate input shares is somewhat cumbersome, notice that our
model provides an explicit expression for these shares, which have an empirical counterpart in
world Input-Output tables (see more on this in section 5).17

4.3

General Equilibrium

So far, we have characterized trade ‡ows as a function of the vectors of equilibrium wages w =
(w1 ; :::; wJ ) and of input bundle costs P = (P1 ; :::; PJ ). We next describe how these vectors are
pinned down in general equilibrium.
Notice …rst that invoking (14) and ci = (wi ) i (Pi )1

i

, we can solve for the vector P as a

function of the vector w from the system of equations:

Pj =

N 1
P Y

n

T`(n)

c`(n)

n

n

`(n)`(n+1)

T`(N )

N

c`(N )

`2J N n=1

N

`(N )j

!

1=

,
(19)

for all j 2 J .

To solve for equilibrium wages, notice that for all GVCs, stage n value added (or labor income)

accounts for a share

`(n) n n

of the value of the …nished good emanating from that GVC. Fur-

thermore, total spending in any country j is given by the sum of …nal-good spending (wj Lj ) and
spending in the intermediate input bundle ( 1

wj Lj ). The share of that spending going
P
to GVCs in which country i is in position n is given by Pr ( ni ; j) = `2 n `j , where remember
that we have de…ned

n
i

j

=

j

= ` 2 J N j ` (n) = i and

i

`j

is given in equation (11). It thus follows

that the equilibrium wage vector is determined by the solution of the following system of equations
1
i

wi Li =

P P

n n

Pr (

j2J n2N

n
i ; j)

1

wj Lj .

(20)

j

The system of equations is nonlinear because Pr (
17

n ; j)
i

is a nonlinear function of wages themselves,

We have demonstrated how trade ‡ows within GVCs aggregate into bilateral intermediate input ‡ows. De Gortari
(2017) develops a more general framework to study the complementary problem of disentangling the shape of GVCs
from aggregate data on bilateral intermediate input ‡ows.

19

and of the vector P , which is in turn a function of the vector of wages w.
When N = 1, we have that

N

N

= 1 and Pr (

n ; j)
i

=

ij

=(

ij ci )

Ti =

P

(

kj ck k)

Tk .

k

The equilibrium then boils down to a simple generalization of the general equilibrium in Eaton and
Kortum (2002) and Alvarez and Lucas (2007), with cross-country variation in how the composite
factor aggregates value added and the bundle of intermediate inputs.
In Online Appendix B.2, we build on Alvarez and Lucas (2007) to show that, given a vector of
wages w, the system of equations in (19) delivers a unique vector of input bundle costs P . In that
Appendix, we also demonstrate the existence of a solution w 2 RJ++ to the system of equations
in (20) – with (19) plugged in – and we derive a set of su¢ cient conditions that ensure that this
solution is unique.

4.4

Gains from Trade

We next study the implications of our framework for how changes in trade barriers a¤ect real
income in all countries. Consider a ‘purely-domestic’value chain that performs all stages in a given
country j to serve consumers in the same country j. Let us denote this chain ` = (j; j; :::; j) by j N .
From equation (11), such a value chain would capture a share of country j’s spending equal to

jN

= Pr j N =

where we have used the fact that
(wj )

j

1

(Pj )

j

(

PN

jj )

n n

n=1

PN

1+

1
n=1

n

(cj )

Tj

,

j

= 1. Combining this equation with (14) and cj =

, we can establish that real income in country j can be expressed as
wj
=
Pj

(

1+
jj )

PN

1=

1
n=1

n

j

Tj

1=(

j

)
.

(21)

jN

Consider now a prohibitive increase in trade costs that brings about autarky, but leaves all
other technological parameters (

n,

Tj ,

j,

, ) unchanged. Because under autarky

jN

= 1, we

can conclude that the (percentage) real income gains from trade, relative to autarky, are given by
1=( j )
1. This formula is analogous to the one that applies in the Eaton and Kortum
jN

(2002) framework (and the wider class of models studied by Arkolakis et al., 2012). An important
di¤erence, however, is that

jN

is not the share of spending on domestic …nished goods (

F
jj

in

equation (17)), but rather the share of spending on goods that only embody domestic value added.
The latter share

jN

is necessarily lower than

F
jj

(and increasingly so, the larger number of stages),

and thus the gains from trade emanating from our model are expected to be larger on this account.
This result is similar to the one derived by Melitz and Redding (2014) in an Armington framework
with sequential production, and also bears some resemblance to Ossa’s (2015) argument that the
gains from trade can be signi…cantly larger in a multi-sector models, with stages in our model playing
the role of sectors in his framework. One can also show that our Cobb-Douglas assumption in
1=( j )
technology is not essential for this result: the gains from trade would still be given j N
1
20

for any CES multi-stage production technology with an elasticity of substitution lower than one
between the value added at di¤erent stages.18
Another key distinctive feature of the formula in (21) is that, unlike

F,
jj

jN

cannot be directly

observed in the data, and thus the su¢ cient statistic approach advocated by Arkolakis et al. (2012)
is not feasible in our setting. Instead, one needs a model to structurally back out

jN

from available

data. For a similar reason, the hat algebra approach to counterfactual analysis proposed by Dekkle
et al. (2008) is not feasible in our setting.
Although we have argued above that

jN

<

F
jj

implies larger gains from trade in our model

than in models without sequential production, it should be noted that the values of

j

and

that

are appropriate for our model might be di¤erent from those appropriate for a model without multistage production. First, remember that our model features an additional type of intermediate input
‡ows relative to a model with roundabout production. In order to match the empirical ratio of
value added to gross output in each country, our model will thus require setting relatively higher
values of

j,

which other things equal, will lead to lower gains from trade. As for the parameter

governing the elasticity of trade ‡ows to iceberg trade costs, we can no longer rely on simple
gravity equation speci…cations to back out that parameter. Furthermore, our model suggests that
the trade elasticity should on average be lower for intermediate inputs than for …nal goods, a
prediction we will …nd some suggestive empirical support for below. This suggests that the proper
way to calibrate our model entails setting a value of

higher than the one that would be suitable

to calibrate a Ricardian model without multi-stage production. As in the case of
a larger value of

j,

the use of

would again generate a downward correction to the gains from trade. Overall,

whether our model generates larger or smaller gains from trade than models without multi-stage
production is an empirical question, and one which we will explore in section 7.

4.5

The Centrality-Downstreamness Nexus

We …nally exploit the tractability of our framework to formally explore the role of a country’s
geography (and, in particular, its centrality) in shaping its average position in GVCs. In order
to isolate the role of geography in shaping GVC positioning, we further focus on the ‘symmetric’
case

n n

= 1=N for all stages n, which amounts to assuming

n

= 1=n and

n

= n=N for all

n 2 N . Without this assumption, technology would not be symmetric in the value added originated
at di¤erent stages, and thus the state of technology Ti of a country would a¤ect di¤erent stages
di¤erentially, thereby generating technological comparative advantage.19
In order to formalize a centrality-downstreamness nexus, let us de…ne the average upstreamness
18
We thank Arnaud Costinot for this observation. It should be clear, however, that the iN one would back out
from available data would depend on the multi-stage production function one speci…es.
19
For instance, if downstream stages contributed more to overall value added than upstream stages, we would
obtain a prediction analogous to that in Costinot et al. (2013), namely that countries with better technologies Ti
have comparative advantage in downstream stages.

21

of production of a given country i in value chains that seek to serve consumers in country j, by
U (i; j) =

N
X

(N

n + 1)

n=1

where remember that Pr (

n ; j)
i

n ; j)
i
n0 ; j
Pr
0
n =1
i

PN

Pr (

,

(22)

is the probability that country i features in position n in value
P
chains leading to consumption in country j, and corresponds to Pr ( ni ; j) = `2 n `j , with `j
i

given in equation (11). The index U (i; j) in (22) is thus a weighted average distance of country i

from …nal consumers in value chains that service consumers in country j, and it is closely related to
measure proposed by Antràs et al. (2012).20 Although U (i; j) in equation (22) uses probabilities
rather than expenditure shares as weights, it can be veri…ed that given our symmetry assumption,
these probabilities correspond to the share of country i’s value added at each stage in chains ending
in consumption in country j.
We seek to establish a connection between the measure of upstreamness U (i; j) and the centrality of country i. As in section 2, the structure of equation (11) already hints at a negative
association between the two, since high values of trade costs (high

ij )

in relatively downstream

stages (high n) have a disproportionately negative e¤ect on the likelihood of a given permutation of
countries forming an equilibrium value chain. In order to develop a more precise formulation of this
result, we assume that the easiness of trade between any two countries i and j can be decomposed
as (

ij )

=

i j,

where we take

i

to be an index of the centrality of country i. Notice that if

country i is more central than country j, then it is cheaper to ship from i to any other country in
the world than it is to ship from country j. This is a rather strong notion of centrality but it has
the virtue of providing the following stark result (which we prove in Appendix A.4):
Proposition 1 The more central a country i is (i.e., the higher is

i ),

the lower is the average

upstreamness U (i; j) of this country in global value chains leading to consumers in any country
j 2 J.
In the next section, we will provide suggestive evidence consistent with this prediction.

5

Data Sources and Suggestive Evidence

Before turning to the structural estimation of our model, in this section we describe the data used
in the paper and provide suggestive evidence for some of the key mechanisms in our model.
Our structural estimation relies exclusively on the data contained in world Input-Output tables
(WIOTs). To understand the nature of the data, it is useful to refer to the schematic representation
of a WIOT in Figure 3. This matrix is split into two blocks with the block on the left containing
data on bilateral intermediate input trade ‡ows across countries (denoted by Xij ) and the block on
20

To be precise, the index U (i; j) in (22) re‡ects the average distance of country i from …nal consumers ignoring
country i’s contribution to GVCs via the composite of materials used by …rms worldwide in all production stages.
See de Gortari (2017) for additional details.

22

Intermediate Country 1
inputs
supplied
Country J
Value added
Gross output

Input use & value added
Country 1
Country J
X11
X1J
XJ1
w1 L1
Y1

Final use
Country 1
Country J
F11
F1J

XJJ
wJ LJ
YJ

FJ1

Total use
Y1

FJJ

YJ

Figure 3: A schematic world Input-Output table.
the right containing the data for …nal good trade ‡ows (denoted by Fij ). Each row represents the
sales of each country to every other country, while each column represents the purchases of each
country from every other country. More speci…cally, each row breaks down the sales of a country to
every other country into sales for production purposes (i.e., intermediate input sales) and sales for
consumption purposes (i.e., …nal good sales). Hence, the sum across a row equals a country’s gross
output (denoted by Yj ). Meanwhile, columns in the left block contain intermediate input purchases
by each country so that the sum across a column equals gross output minus value added (the latter
denoted by wj Lj ). Finally, summing down a column on the right block delivers aggregate …nal
good consumption.21
Given the cells of a WIOT, it is straightforward to construct empirical analogs to our model’s
key equilibrium variables, namely the …nal-good

F
ij

and intermediate input shares

X
ij

in (17) and

(18), as well as gross output and value added in each country. More speci…cally, denoting by a ‘hat’
these empirical moments, we have
^ Fij = P

Fij
i0 2J

Fi0 j

;

Xij
;
i0 2J Xi0 j

^X
ij = P

Y^j =

X
i2J

Xji +

X
i2J

Fji ;

w
^j Lj = Y^j

X

Xij :

i2J

(23)

Building a WIOT of the type in Figure 3 is a formidable endeavor because it requires collecting
trade and production data from many di¤erent sources, including national and supra-national
statistical o¢ ces, but also because it necessarily requires assumptions and data analysis in order to
make the data comparable. In this paper we work, for the most part, with the World Input Output
Database (or WIOD for short), the outcome of a project that was carried out by a consortium
of 12 research institutes headed by the University of Groningen in the Netherlands (see Timmer
et al., 2015). We choose this dataset for our benchmark estimation because we believe that the
assumptions put into its construction are less heroic than those contained in other sources. The
main limitation of the WIOD is that it only covers 43 relatively developed countries, and includes
no African country and only two countries in Latin America (Brazil and Mexico).22 With that in
21
Note that the di¤erence between aggregate …nal consumption and value-added is the trade de…cit/surplus. These
de…cits are nontrivial for certain countries and are taken into account in both our estimation and counterfactual
exercises, as discussed below.
22
Two releases of the WIOD are available. The 2016 release contains a WIOT covering 43 countries and the rest
of the world for the period 2000-2014. A previous relase (2013) contained information for 40 countries and the rest
of the world, for the period 1995-2011. See http://www.wiod.org.

23

mind, we will also estimate our model using the more comprehensive Eora MRIO database, which
provides yearly WIOTs covering 190 countries and the rest of the world for the period 1990-2013.
Although we …nd this dataset less reliable than the WIOD, its broader sample will enrich the set
of counterfactuals studied in section 7.
Figure 4 depicts some salient characteristics of the data we employ in our structural estimation.
The left panel plots the diagonal elements ^ Fii of the …nal-good matrix against the diagonal elements
^X
ii of the input matrix in the WIOD for the year 2014, with the size of each observation being
proportional to each country’s GDP. As is clear from the graph, most observations lie above the
F
45 degree line, indicating that the input ^ X
ij and output ^ ij matrices are asymmetric, and that

countries tend to rely on foreign sources more prevalently for inputs than for …nal goods. This
pattern, which is also observed in the Eora dataset (see Figure A.2 in the Appendix), is consistent
with the notion that trade costs are more detrimental for downstream versus upstream stages.
The right panel of Figure 4 plots each country’s gross output to …nal-good sales (GO/F) against
its gross output to value added ratio (GO/VA). In a closed economy, these two ratios would naturally
coincide and all observations would lie on the 45 degree line. In a globalized world, di¤erences in
these ratios provide a rough measure of the positioning of countries in GVCs. More speci…cally,
for a given GO/VA, a high share of …nal output in overall sales (i.e., a low GO/F in the vertical
axis) would indicate that a country is relatively downstream in GVCs. Similarly, for a given
GO/F, a high ratio GO/VA would indicate that a country uses a relatively large amount of foreign
inputs in production, which again would suggest a relatively downstream position of this country in
GVCs. Hence, in a world in which countries are in markedly di¤erent segments of GVCs, the ratio
GO/VA and GO/F might be expected to be negatively correlated. With this background, the …gure
indicates that although there are some deviations from the 45 degree line, cross-country variation
in these ratios is much larger than within-country di¤erences. These considerations motivate the
introduction of cross-country variation in the value-added shares

j

in our model. Without such

variation, it would be impossible for our model to match the stark positive correlation of the ratios
GO/VA and GO/F documented in the right panel of Figure 4.
Suggestive Evidence
Having described our main data sources, we complete this section by exploring the empirical relevance of a key mechanism of the model – namely, the fact that the trade elasticity is larger for
downstream stages than for upstream stages –and of the centrality-downstreamness nexus result in
Proposition 1. The empirical tests in this section are reduced-form in nature and not structurally
related to our model, but we deem them to be informative nonetheless. We also note that the tests
below use additional sources of data that are not employed in the structural estimation, so we will
only discuss them succinctly as we introduce them.
We begin by studying empirically the compounding e¤ect of trade costs, a key feature of our
model. A crude way to assess the di¤erential sensitivity of trade ‡ows to trade costs at di¤erent
stages of the value chain is to compare the elasticity of intermediate-input and …nal-good ‡ows to
24

1

3.5

0.65

2.5

0.3
0.3

0.65

1.5
1.5

1

2.5

3.5

Figure 4: Some Key Features of the World Input Output Database
various proxies for trade costs

ij .

In particular, and building on the gravity equation literature,

consider projecting the bilateral trade cost parameters

ij

on a vector of pair-speci…c variables

including distance, contiguity and a common language indicator. More speci…cally, let
ln

ij

= ln +

dist ln Distanceij

As long as the coe¢ cients

dist ,

con

and

+

con Contiguityij

lang

+

lang SameLanguageij .

are common for intermediate inputs and …nal

goods, then any di¤erence in the sensitivity of …nal-good versus intermediate-input trade ‡ows to
these bilateral gravity variables will be indication of a di¤erential sensitivity of ‘upstream’versus
‘downstream’ trade ‡ows to trade costs. To assess the plausibility of this approach, consider the
case of the distance elasticity

dist .

Our key identi…cation assumption in that case is that trade

costs, as a percentage of the value of the good being shipped, are identical regardless of whether
the good is an input or a …nal-good. If we observe …nal-good trade being more sensitive to distance
than input trade, we will then conclude that …nal-good trade is more sensitive to trade costs than
input trade is.
We implement this test in Table 1. In columns (1) and (2) of that table we report the results of
a standard gravity speci…cation in which the log of aggregate shipments from country i to country
j are run on exporter and importer …xed e¤ects, as well as the log of distance between i and j and
dummy variables for whether i and j share a contiguous or share a common border. Our shipments
data are from 2011 and correspond to the Eora MRIO database (described above). The data cover
190 countries and include information on domestic shipments (i.e., sales from i to i). The gravity
variables are from the CEPII dataset for the year 2006 (the most recent one available), and the
merge between these two data sources leaves us with information on 180 countries.
Our results in columns (1) and (2) are fairly standard. Distance reduces trade ‡ows with an
elasticity of around

1, while contiguity and common language have a sizeable positive e¤ect on

bilateral ‡ows. Starting in column (3), we exploit a key advantage of the Eora MRIO database,
25

namely the fact that it reports separately bilateral shipments of intermediate inputs (Xij ) and of
…nished goods (Fij ). In columns (3) and (4), we pool these observations and re-run the speci…cations in columns (1) and (2), while clustering at the country-pair level. It is clear that the results
are almost identical to those in columns (1) and (2). More interestingly, in column (5) we document
that the elasticity of trade ‡ows to distance is signi…cantly larger for …nal-good trade ( 1:210) than
for intermediate-input trade ( 1:077). The di¤erence is sizeable and highly statistically signi…cant.
In column (6), we document a similar phenomenon: the positive e¤ect of contiguity and common
language on trade ‡ows is signi…cantly attenuated when focusing on the intermediate-input component of trade. Finally, in column (7) we introduce a dummy variable for intranational shipments
as well as its interaction with input trade. As is well-known from the border-e¤ect literature, the
domestic trade dummy is very large, but we again observe that it is signi…cantly lower for input
trade, a result consistent with the scatter plot in the left panel of Figure 4 discussed above.

Table 1. Trade Cost Elasticities for Final Goods and Intermediate Inputs

Distance

(1)

(2)

(3)

(4)

(5)

(6)

(7)

-1.111

-0.823

-1.144

-0.851

-1.210

-0.903

-0.794

(0.019)
Distance

(0.014)

(0.019)

(0.014)

Input

Contiguity
Contiguity

(0.021)

(0.015)

(0.015)

0.133

0.106

0.098

(0.006)

(0.006)

(0.006)

2.187

2.198

2.287

1.184

(0.111)

(0.112)

(0.120)

(0.099)

Input

-0.177

Language
Language

-0.054

(0.037)

(0.040)

0.480

0.507

0.596

0.513

(0.026)

(0.027)

(0.029)

(0.027)

Input

-0.179
(0.013)

Domestic

-0.169
(0.013)
5.635
(0.187)

Domestic

Input

-0.599
(0.067)

Observations

R2

32,400

32,400

64,800

64,800

64,800

64,800

64,800

0.98

0.982

0.972

0.974

0.972

0.974

0.976

Notes: Standard errors clustered at the country-pair level reported.

, **, and * denote 1, 5 and 10 percent

signi…cance levels. All regressions include exporter and importer …xed e¤ects. Regressions in columns (3)-(7) also
include a dummy variable for inputs ‡ows.

Taken together, the results in Table 1 are highly suggestive of trade barriers impeding trade
more severely in downstream stages than in upstream stages. In Online Appendix B.4, we further
26

show that our results are not materially a¤ected when pooling data from all years (1995-2013)
for which the Eora dataset is available (instead of just using 2011 data).23 We also repeat our
tests using data from the two releases of the WIOD database, which cover a smaller and more
homogenous set of countries. The results with the 2013 release of the WIOD continue to indicate a
signi…cantly lower distance elasticity and lower ‘home bias’in intermediate-input relative to …nalgood trade. Nevertheless, with the 2016 release of the same dataset, we only …nd support for the
second di¤erential e¤ect (see Online Appendix B.4 for details). This last result makes us interpret
our results with caution. Another important caveat with the evidence above is that it is based on
gravity-style speci…cations that, technically, are inconsistent with our theoretical framework. As
equations (17) and (18) indicate, bilateral trade ‡ows of …nal goods and intermediate inputs will
typically be a¤ected by trade costs associated with third countries (see Morales et al., 2014, and
Adao et al,. 2017, for recent evidence of these third-market e¤ects).
We next turn to examining the empirical relevance of the downstreamness-centrality nexus
formalized in Proposition 1. For that purpose, we build on Antràs et al. (2012) who propose a
measure of the positioning of countries in GVCs and study how this measure correlates with various
country-level variables. More speci…cally, Antràs et al. (2012) propose a measure of industry
“upstreamness”(or average distance of an industry’s output from …nal use) and then compute the
average upstreamness of a country’s export vector using trade ‡ow data from the BACI dataset
for the year 2002. Column (1) of Table 2 reproduces exactly their baseline speci…cation, which
includes 120 countries, and correlates a country’s upstreamness with its GDP per capita, rule of
law, …nancial development, capital-labor ratio and human capital (schooling).24 Only …nancial
development and schooling have a statistically signi…cant partial correlation with upstreamness.
In order to assess the relationship between upstreamness and centrality, we simply add a measure of centrality to the core speci…cation in column (1). In particular, for each country j we comP
P
pute CentralityjGDP = i (GDPi =Distanceji ) and Centralityjpop = i (P opulationi =Distanceji ),

which capture a country’s proximity to other countries with either large GDP or large population
(or both). We are able to compute these measures for only 118 of the original 120 countries in
Antràs et al. (2012), so for completeness, column (2) reproduces the results of running the same
speci…cation as in column (1) with only those 118 countries. Clearly, the results are not materially
a¤ected. More interestingly, in columns (3) and (4) we document a highly statistically signi…cant
negative relationship between upstreamness and each of the two measures of centrality. This partial
correlation is not driven by the presence of the other covariates: column (5) shows that it persists
when only controlling for GDP per capita, and column (6) demonstrates that it holds even unconditionally. In Online Appendix B.4, we plot this relationship and show that it is not driven by any
outliers. Though these correlations cannot be interpreted causally, they are again suggestive of the
empirical relevance of the nexus between centrality and downstreamness highlighted in Proposition
1.
23

In fact, we have obtained extremely stable results when running these same regressions year by year for this same
period 1995-2013.
24
The source for each of these variables is discussed in Antràs et al. (2012).

27

Table 2. Export Upstreamness and Centrality
(1)

(2)

Centrality (GDP weighted)

(3)

(4)

(5)

(6)

0.173

0.233

0.155

(0.065)

(0.061)

(0.044)

Centrality (population weighted)

0.228
(0.084)

Log(Y/L)

0.083

0.082

0.102

0.046

0.083

(0.142)

(0.142)

(0.138)

(0.148)

(0.046)

0.029

0.026

0.010

0.010

(0.103)

(0.104)

(0.105)

(0.105)

0.437

0.440

0.375

0.407

(0.136)

(0.137)

(0.130)

(0.135)

0.156

0.159

0.163

0.188

(0.131)

(0.132)

(0.129)

(0.132)

0.085

0.085

0.083

0.094

(0.031)

(0.031)

(0.030)

(0.029)

120

118

118

118

118

118

0.154

0.153

0.194

0.199

0.083

0.056

Rule of Law
Credit/Y
Log(K/L)
Schooling
Observations

R2

Notes: Robust standard errors reported.

6

, **, and * denote 1, 5 and 10 percent signi…cance levels.

Estimation

We next turn to a more structural empirical exploration of our multi-stage model. In our baseline,
we will employ data from the WIOD for the year 2014, but we will subsequently replicate our
estimation using the broader Eora dataset for the year 2013.
It is useful to begin by outlining the parameters we need to estimate or calibrate for a given
number J of countries and N of stages. Geography is pinned down by the J
trade costs

ij .

J matrix of iceberg

Production depends on the Cobb-Douglas input expenditure shares

stage-speci…c but common across countries, while the labor value-added shares
speci…c but common across stages. There are thus N
labor productivity depends on a vector J

1

n ’s

n,
j

to estimate and J

which are

are countryj ’s.

Lastly,

1 of country-speci…c state-of-technology levels Tj , while

comparative advantage is governed by a single parameter . Although countries are also allowed to
vary in terms of their supply of equipped labor, the particular values of Lj only a¤ect the estimates
of Tj and of equilibrium wages, but have no bearing on the counterfactuals discussed below. In order
to keep the estimates of Tj in economically meaningful levels, we simply normalize equipped labor
1

2

as Lj = (capitalj ) 3 (populationj ) 3 , where both capital and population are drawn from the Penn
World Tables for the year 2013 (in the Eora estimation) and for 2014 (in the WIOD estimation).

28

To pin down trade costs, we follow the method proposed by Head and Ries (2001) and make the
simplifying assumption that domestic trade costs are common across countries and normalized to
0, i.e.,

jj

= 1 for all j 2 J . International trade costs, up to a power

, can then be immediately

read o¤ the data through the use of equation (17) and our empirical analogs in (23):

ij

v
u F F
u ^ ij ^ ji
=t F F :
^ ii ^ jj

Trade costs are symmetric by construction, i.e.
(i.e.,

ij

ik kj )

ij

=

ji ,

(24)

and in practice the triangle inequality

holds across more than 99:9% of triples.

A consequence of our approach to backing out trade costs is that the calibrated values for
we obtain are una¤ected by the particular value of
equilibrium of our model beyond its e¤ect on

chosen. Although the value of

ij

a¤ects the

, it turns out that the moments we employ for

ij

our structural estimation (see below) do not identify . More precisely, for every possible value of
, there exists a re-normalization of Tj that yields the same equilibrium (conditional on the same
set of parameters

j

and

n ).

With that in mind, we simply set

= 5 in our estimation. This

value is slightly higher than is typically assumed in the literature, but our model predicts that the
trade elasticity for …nal goods (i.e., ) should be larger than the elasticity one would estimate with
overall trade ‡ows (which is a weighted average of
below, after having estimated the

n ’s

(i.e., the

1,

2 ,...,

).25 We will return to this point

n ’s).

Another tricky parameter to calibrate is the number of stages N . We initially estimate the
model for the case N = 2. This is the simplest multi-stage model one could estimate, and as we
will discuss extensively below, the data actually appears to favor this value of N over larger ones.
Having pinned down the matrix of trade costs

ij

,

, and N; we estimate the remaining

parameters of the model by targeting speci…c moments of a WIOT via the generalized method
of moments (GMM). More speci…cally, we target four sets of moments, each constituting a J
vector: (i) the diagonal elements

^ Fjj

of the …nal-good matrix; (ii) the diagonal elements

^X
jj

1

of the

input matrix, (iii) the gross output to value added ratio GOj =V Aj in each country, and (iv) the
P
GDP share w
^j Lj = i w
^i Li of each country.26
The choice of these moments is motivated by the following considerations. First, note that

the vector of state of technology parameters Tj naturally shapes wages and thus (for given Lj )
variation in GDP shares across countries. These technology parameters also a¤ect the extent to
which countries rely on local versus foreign sources of inputs and …nal goods (and thus the shares
F
^X
jj and ^ jj ). Meanwhile, the input expenditure shares

n

determine how fast the trade elasticity

increases along GVCs, and are thus crucial in shaping the observed di¤erences between the domestic
25

Simonovska and Waugh (2014), in a widely cited study, …nd a range for the elasticity of trade between 2:47 and
5:51. Using U.S. import data, Antràs et al. (2017) estimate an elasticity of trade of 4:54. Finally, Caliendo and Parro
(2014) …nd an aggregate elasticity of 4.49 using the previous release of the WIOD data.
26
In order to guarantee that our model provides a proper quantitative evaluation of the general-equilibrium workings
of the world economy, we place a higher weight on matching the empirical moments of larger economies. More
precisely, our weighting matrix is a diagonal matrix with GDP shares in the diagonal.

29

F
input share ^ X
jj and the domestic …nal expenditure share ^ jj . With N = 2, we need only estimate
2

(since

1

= 1 by assumption). If

2

were to be close to 1, the sequentiality of production would

become immaterial, and all input trade would re‡ect a roundabout structure of production, as in
Eaton and Kortum (2002). In such a case, we would not expect large asymmetries between ^ X
jj and
^ Fjj . Our previously discussed evidence in the left panel of Figure 4 already indicated the empirical
importance of those asymmetries, so we would not expect

2

to be too close to 1.

Finally, the vector of gross output to value added ratios GOj =V Aj is a natural target for the
vector of country-speci…c value-added share parameters

j.

To see this, note that with N = 1, the

gross output to value-added ratio is given by
1

j
wj Lj
wj Lj +
GOj
Yj
1
j
=
=
= :
V Aj
wj Lj
wj Lj
j

When N > 1, the expression for the gross output to value-added ratio is more complicated and
the other parameters of the model – and most notably the input shares

n

over GOj =V Aj . To see this, consider our estimation with N = 2: For a given
to value-added ratio will be close to 1=
production (i.e., when
2

2

j

– have an in‡uence
j,

the gross-output

when the upstream stage of production is irrelevant for

! 1), since this corresponds to reducing N from 2 to 1. Conversely, when

! 0, the downstream stage of production adds very little value, and the gross output to value

added ratio is close to 2= j , since the same output is shipped twice but value is added essentially
only once. In practice, for a general N , the gross output to value added ratio features variation

(see the right panel of Figure 4 above) both because countries have di¤erent labor value-added
shares but also because they …nd themselves at di¤erent degrees of upstreamness along the GVC;
the interaction of both forces determine this statistic.
Before turning to a discussion of our estimation results, we brie‡y comment on our treatment of
trade imbalances. As mentioned above (see footnote 21), these imbalances are empirically nontrivial
and correspond to the di¤erence between aggregate …nal consumption and value added. Following
a common approach in the trade literature (see, in particular, Costinot and Rodríguez-Clare, 2015),
we treat these de…cits as exogenous parameters, and we adjust our general-equilibrium equations
to account for the di¤erence between income and spending (see Online Appendix B.3).
Estimation Results
We now turn to discussing our estimation results and overall …t of the model. We mostly focus our
discussion on the results we obtain using the WIOD, but at the end of this section, we also brie‡y
describe the results with the broader Eora database.
As anticipated above, the asymmetries between the input and …nal-output diagonal elements
of the WIOD lead to an estimate of

2

The estimated values for the vectors of

far removed from one. In particular, we obtain
j

2

= 0:16:

and Tj are reported in Appendix Table A.1. Figure 5

presents a comparison between the data and the targeted moments, with the size of each observation
proportional to GDP. The values for the diagonal elements
30

X,
jj

the gross output to GDP ratios,

1

Calibration

Calibration

1

0.65

0.3
0.3

0.65

0.8

0.6
0.6

1

Data

1

0.25

Calibration

Calibration

3.5

2.5

1.5
1.5

0.8

Data

0.125

0
2.5

3.5

0

Data

0.125

0.25

Data

Figure 5: Targeted Moments

and GDP shares are all estimated very accurately, with correlations equal to 0.99, 0.97, and 0.99
with their empirical counterparts, respectively. The …t of the …nal-output diagonal elements

F
jj

is

also very good (the correlation with data is 0.90), but it also presents some slight discrepancies,
especially for some small countries (remember that our estimation algorithm weighs observations
by country size).
Figure 6 performs a similar comparison between model and data but for moments that were not
directly targeted in the estimation. The upper two charts present the non-diagonal elements of
and

F,

X

and those entries are also matched relatively accurately in both cases (with correlations

equal to 0.83 and 0.91, respectively). The lower two charts explore how well our model matches
the backward and forward GVC participation of various countries. Because we will later explore
counterfactuals exercises that illustrate changes in the participation of countries in GVCs, it is
desirable that our calibration matches these type of moments properly. These two measures of
the positioning of countries in GVCs are proposed in Wang et al. (2017). The backward GVC
participation index measures the share of a country’s production of …nal goods and services that
is accounted for by imported value added. More speci…cally, the numerator in the share includes
foreign value added that is embodied in intermediate input imports used to produce …nal goods in a
country, and it also includes domestic value added that has returned home embodied in those same
imported inputs. The forward GVC participation index measures the share of a country’s domestic

31

value added that is exported worldwide embodied in intermediate goods that are consumed by both
foreign and domestic …rms downstream. Note that this second measure excludes domestic value
added embodied in …nal goods that are exported directly to consumers. Our benchmark calibration
…ts both moments very well with correlations of 0.99 and 0.96, respectively.

10 0

Calibration

Calibration

10 0

10 -3

10

-6

10 -6

10 -3

10 -3

10

10 0

-6

10 -6

Data

10 0

0.6

Calibration

0.6

Calibration

10 -3

Data

0.3

0

0.3

0
0

0.3

0.6

0

Data

0.3

0.6

Data

Figure 6: Untargeted Moments.
We next repeat our estimation with the use of the Eora data for 2013. Though the full Eora
database contains 190 countries we consolidate it into a set of 101 country/regions in order to
alleviate the burden of calibrating so many parameters.27 Remarkably, we estimate an upstream
input share of

2

= 0:19, which is very similar to the value of

2

= 0:16 found for the WIOD. In

Appendix A.5, we provide estimates for the remaining parameters, and also illustrate the …t of the
estimation via …gures analogous to those in Figure 5 and 6. For both targeted and non-targeted
moments, the …t continues to be extremely good.28
It is useful to compare our estimates of

2

with those implied by our reduced-form results in

Table 1, which also used the Eora dataset. Although the gravity-style speci…cation in Table 1
cannot be mapped structurally to our model, the di¤erential e¤ect of distance on input and …nal27

Speci…cally, we keep all countries with a population of 10 million or more and aggregate the rest into a set of 9
regions: Latin America and Caribbean, Central Europe, Eastern Europe, Western Europe, Scandinavia, Middle East
and North Africa, Sub-Saharan Africa, Central Asia, and East Asia and Paci…c
28
The correlations between data and model for the four targeted moments are 0.96, 0.92, 0.89, and 0.99, respectively.
The correlations for the o¤ diagonal elements of X and F are 0:81 and 0:90, while the correlations for the backward
and forward participation index stand at 0:84 and 0:69.

32

good trade is informative on the relative size of

2.

More speci…cally, the ratio of the elasticity of

stage 1 output trade to stage 2 output trade is given by 1

2

in our model. Given the distance

elasticities estimated in column (7) of Table 1, and assuming that all input trade is stage 1 output,
we would then infer

2

=1

0:696=0:794 = 0:12. Now, of course, in our model not all input trade

is stage 1 output, since value added is combined with a bundle of materials at each stage, and
the trade elasticity of that “roundabout” input trade is equal to that of …nal-good trade. Using
the structural estimates of our model we …nd that around 18 percent of input trade takes this
“roundabout” form. The actual elasticity of stage 1 input is thus lower than is implied by the
results in Table 1 (0:675 rather than 0:696), and the implied

2

is slightly larger (

2

= 0:15), and

very close to the one we have estimated structurally.
Revisiting the Calibration of N
Up to now, we have …xed the number of stages to N = 2. Estimating our model for N > 2 is
computationally more demanding but straightforward to carry out. In terms of the parameters to
estimate, notice that this only amounts to estimating a longer vector of input shares

n.

Perhaps

surprisingly, we have found that the structural estimation shuts down production stages that are
more than one stage removed from …nal consumption, and delivers estimates for the other parameters that are identical to those in the benchmark with N = 2: To give a precise example, when
we estimate the model with N = 3, our calibration delivers

3

= 0:16 and

2

= 1. The most

upstream stage of production, n = 1, is thus e¤ectively shut down (i.e., its output is negligible).
The recovered parameters for

j

are exactly the same as in our benchmark calibration while those

for Tj are exactly those consistent with our benchmark calibration as well.29
Why does our model reject N > 2? A …rst important point to make is that we are calibrating
an average N for the whole world economy, including sectors in which chains might be large (e.g.,
in some manufacturing sectors) but sectors in which they might be very short (e.g., certain types of
services). Relatedly, the worldwide ratio of gross output to value added is 3:82 in manufacturing (in
the 2014 WIOD), while it is 1:78 for non-manufacturing sectors. The fact that the aggregate value
of N appears to be tightly related to the aggregate gross output to value added ratio (which is 2:13
in the WIOD) resonates with the theoretical results in the Input-Output model of Fally (2012).
Yet, we should stress that Fally’s result does not apply in our setting: by appropriate choices of

n,

a variant of our model with a large number of stages could be made consistent with gross output to
value added ratios in the neighborhood of 2. Doing so, however, would demand setting relatively
high values for the value-added intensity parameters

2

and

3,

but those high values would in

turn generate excessively high asymmetries between the diagonal elements of the input and …nal
output matrices. Because, our GMM estimation penalizes those excessive deviations, we estimate
a relatively low value of

3

(

3

= 0:16), and a very large value for

29

2

(

2

= 1), which e¤ectively

Note that the model with N = 3 involves an additional summatory for n = 1 in the country level index j
even when this stage is shut down. Hence, the calibrated Tj ’s for N > 2 should equal 1=J N 2 times the Tj ’s for the
benchmark calibration with N = 2.

33

shuts down the most upstream stage.
Some readers might still object that recovering the same estimated values for N > 2 is not
synonymous with correctly identifying N = 2. For example, the moments that we target may
be misspeci…ed or not contain su¢ cient information for backing out the correct N . We next show
through simulations that there is a precise sense in which recovering the same calibration for N

2

implies that the true N is indeed equal to 2 and that N > 2 can be rejected.
Let us work with several values for the chain length ranging from N = 1, which is the model
of Eaton and Kortum (2002), all the way to N = 4, and for a set of J = 5 imaginary countries.
For each N , we simulate a set of primitives of the model and compute the general equilibrium.
We then take the resulting simulated WIOT entries and apply our GMM estimation method with
the exact same four sets of moments as above. Furthermore, for each true value of N we run our
^ = 1; 2; 3; 4. The spirit of the
calibration for various possible values for the number of stages, i.e., N
exercise is thus to examine whether our estimation method can successfully recover the true value
of N . We perform this exercise 100 times for each N , so this amounts to 1600 calibrations in total
^ = 1; 2; 3; 4).
(100 simulations for each N and four estimations per simulation, for each value N
Figure 7 plots our simulation results split into four panels, one for each true value of N . In each
panel, the x axis plots the value of the objective function that the calibration minimizes, i.e. the
di¤erence between the observed and estimated moments, while the y axis plots the sum of squared
percentage di¤erences between the true values of the parameters underlying the simulated data and
those estimated in the calibration (note the log-scale on both axis). In a nutshell, a lower value
in the x axis implies that our calibration is …tting the data more accurately while a lower value
in the y axis implies that our calibrated parameters are closer to the true parameters. Obviously,
estimations that place us in the bottom left corner of each plot are particularly accurate.
^ do very
Focus …rst on the top left scatterplot for N = 1, and note that the calibrations for all N
^ > N is more ‡exible and thus nests
well. This should not be surprising since the model with N
^ . A crucial observation, however, is that all the points in the scatterplot
a model with a lower N
lie in the bottom left of the graph, implying that a good …t of the moments occurs only if the
true parameters are recovered. Turn next to the bottom right scatterplot for N = 4. In this case
^ = 4 …t the data well, and notice that the true
only the estimates for the empirical model with N
parameters are again recovered. In that same scatter plot, it is clear that the empirical model with
^ = 3 does better than N
^ = 2, and both do better than N
^ = 1. This is also obvious since lower
N
^ implies less degrees of freedom. The key takeaway from Figure 7 is that in order to recover
N
^
the correct N one need only have N
N and the calibration will recover the correct parameters
^ . This appears to be analogous to what occurs in our datasets
regardless of the particular value of N
with N = 2 and thus, to the extent that the data generating process behind the observable data is
consistent with our model, we are able to reject N > 2.
It is important to stress, however, that our identi…cation of N relies heavily on our assumption
that the matrix of trade costs

ij

and the vector of technology levels Tj is common for inputs

and …nal goods. For example, one can show that an extension of the Eaton and Kortum (2002)

34

10 8

3

10

Parameter Fit

Parameter Fit

10

10 8

10 -2

10 -7

10

10 -2

10 -7

-12

10 -15

3

10 -9

10 -3

10

10 3

-12

10 -15

10 -9

Moment Fit
10 8

3

10

10 -2

10 -7

10 -12
10 -15

10 3

10 8

Parameter Fit

Parameter Fit

10

10 -3

Moment Fit

3

10 -2

10 -7

10 -9

10 -3

10 -12
10 -15

10 3

10 -9

Moment Fit

10 -3

10 3

Moment Fit

Figure 7: Calibration of N through simulations.
framework without multi-stage production (i.e., N = 1) could be calibrated to exactly match a
WIOT, provided that one allows for (i) cross-country variation in value added shares

j,

and (ii)

arbitrary and potentially asymmetric trade costs for inputs and …nal goods. Intuitively, one could
choose appropriate trade costs matrices
input and output matrices

X
ij

and

F.
ij

X
ij

and

F
ij

The vector

to reproduce the observed asymmetries in the
j

could then be set to ensure that the GO/VA

ratios across countries are exactly nailed, while the technology parameters Tj could be chosen to
match the observed cross-country variation in GDP levels. In sum, the data we use cannot reject
N = 1 if one allows enough ‡exibility in the modeling of input and output trade costs.

7

Counterfactuals

Having estimated the fundamental parameters of the model, we next explore how counterfactual
changes in trade costs, holding other parameters constant, alter the entries of world Input-Output
tables, thereby a¤ecting the real income and positioning of countries in GVCs.
Autarky and Zero Gravity
We begin by revisiting two focal counterfactual exercises in quantitative international trade, namely
an increase in trade costs large enough to bring back autarky, and a complete elimination of trade
barriers. Both of these counterfactuals are extreme in nature, but they are useful in understanding
some distinctive features of our framework.
35

The real income gains of trade relative to autarky can be computed with the formula
1; as indicated by equation (21), although

jN

1=(

jN

j

is not directly observable in the data and needs to

be inferred from our model. For the sample of countries in the WIOD, the gains from trade range
from a value of 3.3 percent for the United States to 75.9 percent for Luxembourg. The left-panel
of Figure 8 plots these real income gains for the largest 25 economies in the WIOD sample.30
1.5
GVC Gains from Trade
EK Gains from Trade

Relative Gains from Trade
GDP-Weighted Mean Relative Gains from Trade

Ratio GVC/EK

20

15

10

1

0

0.5

AUS
ROW
RUS
GBR
CAN
USA
BEL
JPN
SWE
ESP
KOR
POL
FRA
CHE
BRA
TUR
ITA
DEU
IDN
IND
NLD
TWN
NOR
MEX
CHN

5

USA
BRA
AUS
IND
JPN
RUS
CHN
IDN
GBR
ITA
ESP
FRA
TUR
CAN
NOR
MEX
DEU
SWE
CHE
ROW
KOR
POL
TWN
NLD
BEL

% Change in Real Income

25

Figure 8: Gains from trade relative to autarky in GVC model (N = 2) versus
EK model (N = 1), WIOD sample.
The …gure also compares these gains (labeled ‘GVC Gains from Trade’) with those obtained in
a comparison model without multi-stage production (labeled ‘EK Gains from Trade’) calibrated to
match the WIOD for the year 2014. This comparison model is a modi…ed Eaton and Kortum (2002)
framework, with input trade re‡ecting roundabout production, but with cross-country variation in
value added shares

j,

and di¤erential (and potentially asymmetric) trade costs for inputs and

…nal goods. As mentioned at the end of section 6, by an appropriate choice of parameters, such a
model can always exactly match a WIOT. Furthermore, similarly to Arkolakis et al. (2012), the real
income losses from going to autarky can be computed using the formula ^ Fjj ^ X
jj
1, where

EK
j

1=

EK
j

1

1=

EK

= GOj =V Aj is the value added to gross output ratio in country j, and where the

variables with hats can be read o¤ the data as in (23). As explained in section 4.4, the value of
relevant for this Eaton and Kortum (2002) model (i.e.,
than the one relevant for our framework (i.e.,
of overall trade, while

EK

= 5), since

in the formula) is naturally smaller

EK

here corresponds to the elasticity

in our GVC model corresponds to the trade elasticity for only …nal good

trade. Using our estimate of

2

and the relative prevalence of …nal-good trade, sequential input

trade, and ‘roundabout’input trade in our structural estimation leads us to calibrate

EK

= 4:635,

which is very much consistent with available estimates of the overall trade elasticity (see footnote
25).
With this background in mind, the left panel of Figure 8 shows that our model with GVCs
generates gains from trade that are generally higher than those emanating from a comparable
30
This formula still measures the real income gains from trade in the presence of trade imbalances. The implications
for real spending, however, may be quite di¤erent since autarky implies a closing of trade imbalances.

36

)

model without multi-stage production. The di¤erences are, however, modest. Averaging across
all 44 countries in the WIOD, the ratio of the (net) gains from trade in our GVC model versus
those in a modi…ed Eaton-Kortum model equals 1:075.31 These modest di¤erences arise despite
the fact that the share
trade share
to

j

F
ij

jN

of purely domestic GVCs is on average 29% lower than the …nal-good

(0:60 versus 0:85). As anticipated in section 4.4, the lower

EK
j

and

EK

(relative

and ) are key factors attenuating the di¤erence in the real income gains from trade. The

right-panel of Figure 8 shows, however, that there is quite a lot of variation in the understatement
of the gains from trade. China and Mexico, two of USA’s largest trading partners, are the countries
for which the Eaton-Kortum model underestimates these gains the most (by a factor 1:29 and 1:22,
respectively). On the other hand, in a world with sequential production, the gains from trade are
lower for certain countries, such as Australia and Russia.
So far, we have discussed our benchmark results with the WIOD. When performing counterfactuals with the broader sample of 101 countries and regions in the Eora database, we …nd similar
results. The gains from trade in a world with GVCs are on average a factor 1:188 larger than in
a comparable model without multi-stage production. Although this average ratio is larger than in
the WIOD sample, we again …nd substantial heterogeneity in the relative gains across countries
(see Figure A.5 in Appendix A.5), with the ratio being smaller for larger economies. As a result
the GDP-weighted ratio of gains from trade in our model relative to a comparable Eaton-Kortum
model is just 1:123, and quite in line with our WIOD results.32

2

600

400

Relative Gains from Trade
GDP-Weighted Mean Relative Gains from Trade

1.5

1

200

0.5

0

0

POL
CHE
ESP
TUR
SWE
AUS
ITA
GBR
FRA
BEL
DEU
CAN
NLD
KOR
JPN
BRA
MEX
IDN
IND
RUS
TWN
USA
ROW
CHN
NOR

Ratio GVC/EK

800

2.5
GVC Gains from Trade
EK Gains from Trade

USA
ROW
DEU
JPN
GBR
FRA
CHN
ITA
BRA
ESP
CAN
AUS
IND
CHE
MEX
RUS
TUR
SWE
NLD
POL
KOR
IDN
BEL
NOR
TWN

% Change in Real Income

1000

Figure 9: Gains from moving to zero gravity in GVC model (N = 2) versus EK
model (N = 1), WIOD sample.
We next explore the implications of a (hypothetical) complete elimination of trade barriers. The
real income consequences of a move to a world with zero gravity are much pronounced. Focusing
on the 25 largest economies in the WIOD, Figure 9 shows that these gains range from 163% for
the United States to a staggering 913% for Taiwan. Furthermore, these (net) percentage gains
31

This corresponds to the unweighted average of these ratios. The GDP-weighted average is very similar (1:076)
and is depicted as a dashed line in the right panel of Figure 8.
32
Because of its minuscule own trade share, Ethiopia’s gains from trade are extremely large (see the Online Appendix), so we remove this country when computing both the unweighted and weighted average welfare gains.

37

are on average a factor 1:099 higher than in a model without multi-stage production. For some
countries, such as Norway or China, the modi…ed EK model underestimates the real income gains
by a very large factor (1:66 and 1:64, respectively). Furthermore, the di¤erences are greater for
richer countries. Overall, the GDP-weighted average of these ratio is 1:274, and appears as a dashed
line in the right panel of Figure 9.
When repeating this exercise for the sample of countries in Eora, we …nd that the real income
gains with GVCs are about one third larger than an Eaton-Kortum model without sequential
production, with the average ratio equalling 1:303. Yet, this average masks substantial variation
across countries and continents. Figure 10 breaks these real income gains by continent. As is clear,
the Eaton-Kortum model underestimates the real income gains the most for Africa and the Middle
East. In this case, the downward bias in the predicted income gains is uncorrelated with country
income size, and the GDP-weighted average ratio is 1:345, which is similar to the one found with
the WIOD. In Appendix A.5, we provide more details on the counterfactual exercises using the
Eora dataset (see, in particular, Figure A.6).33
1500

% Change in Real Income

GVC Gains from Trade
EK Gains from Trade

1000

500

100
0
North
America

Asia

RoW

Europe LA & C M. East Africa
& N. Africa

Figure 10: Gains from moving to zero gravity in GVC model (N = 2) versus EK model (N = 1),
Eora sample

A Fifty Percent Reduction in Trade Barriers
We next consider a less extreme counterfactual associated with international trade costs falling by
…fty percent, i.e.,

0
ij

= 1+0:5(

ij

1). We focus on studying the implications of this change for the

equilibrium positioning of countries in GVCs in the WIOD sample. The real income implications
of this change are reported in the Online Appendix.
33

In the Online Appendix, we report the real income implications of these counterfactuals for all countries in the
WIOD and Eora databases.

38

0.6

Benchmark
50% Fall in Trade Costs

Forward Participation

0.5
0.4

% of GDP

0.4
0.3

0.3

0.2

0.2

0.1

0.1

0

0

USA
BRA
JPN
AUS
IND
CHN
GBR
ROW
FRA
ITA
IDN
ESP
CAN
TUR
MEX
RUS
DEU
SWE
CHE
POL
KOR
BEL
NLD
NOR
TWN

0.5

Backward Participation

USA
BRA
AUS
IND
JPN
RUS
IDN
NOR
GBR
CHN
ITA
FRA
ESP
CAN
TUR
MEX
SWE
DEU
CHE
KOR
POL
ROW
NLD
TWN
BEL

% of Final Good Production

0.6

Figure 11: Change in GVC participation following a 50% trade cost reduction.
We begin in Figure 11 by plotting the resulting increase in backward and forward GVC participation in the largest 25 economies in the WIOD sample. As a reminder, the backward GVC
participation index measures the extent to which a country’s production of …nal goods uses imported inputs, while the forward GVC participation index measures the share of domestic value
added that is exported embodied in intermediate goods. As Figure 11 indicates, both GVC participation indices increase markedly for all countries, but more so for countries that begin with
small participation indices. For instance, the world’s largest economy –the United States –is the
least integrated according to both indices, both before and after this trade cost reduction, but its
backward GVC participation doubles in size, while its forward GVC participation index more than
triples in size.34 The …fty percent reduction in trade barriers also shifts the relative positioning
of countries in GVCs. For example, the Netherlands increases its backward participation substantially, with little impact on its forward participation rate and, as a result, the Netherlands becomes
a more downstream producer in GVCs. In contrast, the USA moves upstream in GVCs, given the
larger impact of the trade cost reduction on its forward GVC participation index. When repeating
this exercise with the Eora dataset, we …nd very similar results (see Figure A.7 in the Appendix).
As discussed in the partial equilibrium example in section 2.4, the e¤ects of trade cost reductions
on the formation of regional versus global value chains is non-monotonic and depends on the degree
of initial GVC integration. This result continues to hold in our general equilibrium model. To
illustrate this, Figure 12 decomposes the change in the USA’s GVC participation indices into
seven bilateral indices related to USA’s GVC participation indices vis-a-vis itself, its major trading
partners and the main regions of the world. To give a precise example, the USA’s backwards
GVC participation with Canada equals the share of US production of …nal goods that is accounted
for by Canadian value added embodied in imported intermediate inputs (used for US …nal-good
34

The dispersion in GVC participation across countries falls dramatically in this counterfactual scenario since
implies that the variance in ij is higher when iceberg trade costs are at a higher level.

39

>1

Change in GVC Participation

700

160

Backward
Forward

600

Change in Relative GVC Participation

120

500

80

%

%

400
40

300
0

200

-40

100
0

-80
USA

CHN

CAN

MEX Europe Asia

RoW

USA

CHN

CAN

MEX Europe Asia

RoW

Figure 12: Change in USA bilateral GVC participation following a 50% trade cost reduction.
production), while the USA’s forward GVC participation with Canada represents the share of US
value added that is exported from the USA embodied in intermediate goods and is eventually
consumed in Canada.
The left panel of Figure 12 then shows that a 50 percent reduction in trade barriers would
naturally increase the USA’s GVC participation with all regions of the world. Yet, the increase
would be smallest for NAFTA countries (other than the USA). This indicates that most of the
resulting GVC integration would be global rather than regional. Although the growth in the USA’s
GVC participation with itself is remarkable, we should stress that this does not re‡ect an increase
in domestic value chains. Instead, this re‡ects an increase in the extent to which (i) US production
of …nal goods uses domestic value added that was exported and re-imported upstream, and (ii)
US value added that was exported but later re-imported and eventually consumed as …nal goods
in the USA. The large growth rate in these USA-USA bilateral indices is largely explained by the
fact that they start from a very low level (0.2% for the backward index and 0.4% for the forward
index).
To further illustrate these di¤erences, the right panel of Figure 12 plots the change in each
bilateral GVC participation as a share of USA’s total GVC participation. This graph further
con…rms that relative GVC participation actually falls for the NAFTA countries while increasing
for China, Europe and other Asian countries (as well as the USA itself). When repeating this same
exercise with the Eora sample of countries, our results are largely unchanged (see Figure A.8 in the
Appendix).
Regional versus Global Value Chain Integration
The patterns unveiled in Figure 12 resonate with those in our partial equilibrium example in
Figure 2, in which we emphasized that while the relative importance of global GVC integration
monotonically increases when trade costs fall, the relative importance of regional GVC participation
40

initially rises but eventually falls when trade costs are lowered su¢ ciently. Indeed, Figure 12 appears
to indicate that current trade costs are at the level at which further reductions will boost global
integration relative to regional integration.
10

80

8

60

0.2

6

%

%

Domestic GVCs (lhs)
NAFTA GVCs (rhs)
Global GVCs (lhs)

40

4

20

2

0

0
1/32 1/16 1/8 1/4 1/2

1

3/2

2

3

5

NAFTA GVCs / Global GVCs

100

0.15

0.1

0.05

0

10

1/32 1/16 1/8 1/4 1/2

s

1

3/2

2

3

5

10

s

Figure 13: Regional vs Global Integration.
To further analyze the non-monotonic relation between regional and global integration, and in
the spirit of section 2.4, we next explore the relative importance of domestic, regional and global
value chains across several trade equilibria de…ned by a value of s such that
with

ij

0
ij

= 1 + s(

ij

1),

being our calibrated trade costs for the WIOD sample in 2014. Focusing on our estimated

SA
global economy with N = 2, we de…ne a domestic GVC as `U
= fU SA; U SAg and associate
d

the prevalence of domestic value chains in overall US consumption with the share

SA
`U
;U SA
d

(see

equation (16)). Similarly, we capture the relative prevalence of regional (or NAFTA) value chains
P
SA
in overall US consumption by `Ur SA `Ur SA ;U SA , where `U
are all chains that only include the
r

SA
USA, Canada or Mexico, with the exception of the chain `U
. Finally, we de…ne the relative
P d
SA
prevalence of global value chains in US consumption as `Ug SA `Ug SA ;U SA ; where `U
are all the
g

possible chains that involve at least one country outside of NAFTA. Naturally, the sum of these
three relative measures is one. An important caveat is that, due to the use of a bundle of materials
at each stage, what we label as domestic and regional value chains actually embody value added
from countries outside NAFTA. In fact, for bounded trade costs, our model features no purely

domestic value chains. Yet, the above taxonomy is useful for understanding the broad orientation
of value chains serving US consumers for di¤erent levels of trade costs.
The left panel in Figure 13 plots these three measures for various values of s between 1=32 '

0:031 and 10. The resemblance of this chart with our partial-equilibrium Figure 2 is quite remarkable and provides evidence that the intuition presented in the partial equilibrium model carries
through to this more general setting. Furthermore, the right panel of Figure 13 plots the ratio of
the relative importance of regional (NAFTA) versus global value chains for the same values of s.
Interestingly, our benchmark equilibrium, s = 1, is very close to the point at which the relative

41

importance of regional value chains is maximized. Thus, as anticipated above in Figure 12, further
reductions in trade costs will reduce the relative importance of regional global value chains in US
consumption. In the Appendix, we demonstrate that the picture that emerges when repeating this
exercise with the Eora dataset is again very similar (see Figure A.9).

8

Conclusion

In this paper, we have studied how trade barriers shape the location of production along GVCs.
Relative to an environment with free trade, trade costs generate interdepencies in the sourcing
decisions of …rms. More speci…cally, when deciding on the location of production of a given stage,
…rms necessarily take into account where the good is coming from and where it will be shipped
next. As a result, instead of solving N location decisions (where N is the number of stages), …rms
need to solve the much more computationally burdensome problem of …nding an optimal path of
production. Despite these complications, we have proposed tools to feasibly solve the model in
high-dimensional environments.
After deriving these results in partial equilibrium, we have developed a multi-stage generalequilibrium model in which countries specialize in di¤erent segments of GVCs. We have demonstrated that, due to the compounding e¤ect of trade costs along value chains, relatively central
countries gain comparative advantage in relatively downstream stages of production. We have also
borrowed from the seminal work of Eaton and Kortum (2002) to develop a tractable quantitative
model of GVCs in a multi-country environment with costly trade. Relative to previous quantitative models of multi-stage production, our suggested approach maps more directly to world
Input-Output tables, and allows for a straightforward structural estimation of the model. We
…nally illustrated some distinctive features of the model by performing counterfactual analyses.
Our framework is admittledly stylized and abstracts from many realistic features that we hope
will be explored in future work. For instance, we have abstracted from explicitly modeling crossindustry variation in trade costs, the average level of technology of countries, and the length of
production chains. In contemporaneous work, de Gortari (2017) develops a multi-industry version
of our model – in a manner analogous to the Caliendo and Parro (2015) extension of the Eaton
and Kortum (2002) model –and maps it to the industry-level information available in world InputOutput tables. Another potentially interesting avenue for future research would be to introduce
scale economies (external or internal) into our analysis. In a previous version of the paper, we
explored a variant of our model with external economies of scale featuring a proximity-concentration
tradeo¤. The interaction of trade costs and scale economies substantially enriches – but also
complicates – the analysis. Although our dynamic programming approach is no longer feasible
in that setting, the integer linear programming approach developed in the Appendix is still quite
powerful in that environment. We believe that variants of that approach could also prove useful
in extending our framework to include internal economies of scale and imperfect competition. It
would also be interesting to incorporate contractual frictions into our framework and study the

42

optimal governance of GVCs in a multi-stage, multi-country environment.
Beyond these extensions of our framework, we view our work as a stepping stone for a future
analysis of the role and scope of man-made trade barriers in GVCs. Although we have focused
on an analysis of the implications of exogenously given trade barriers, our theoretical framework
should serve as a useful platform to launch a study of the role of trade policies, and of policies
more broadly, in shaping the position of countries in value chains. Should countries actively pursue
policies that foster their participation in GVCs? Should they implement policies aimed at moving
them to particular stages of those chains? If so, what are the characteristics of these particularly
appealing segments of GVCs? These are the type of questions we hope to tackle in future research.

43

References
Adao, Rodrigo, Arnaud Costinot and Dave Donaldson (2017) “Nonparametric Counterfactual Predictions in Neoclassical Models of International Trade,”American Economic Review, 107(3):
633-89.
Alfaro, Laura, Pol Antràs, Paola Conconi, and Davin Chor (2015), “Internalizing Global Value
Chains: A Firm-Level Analysis,” NBER Working Paper 21582, September.
Anderson, James E., and Eric van Wincoop (2003), “Gravity with Gravitas: A Solution to the
Border Puzzle,” American Economic Review 93(1): 170-192.
Antràs, Pol, and Davin Chor (2013), “Organizing the Global Value Chain,” Econometrica 81(6):
2127-2204.
Antràs, Pol, Davin Chor, Thibault Fally, and Russell Hillberry, (2012), “Measuring the Upstreamness of Production and Trade Flows,” American Economic Review Papers & Proceedings
102(3): 412-416.
Antràs, Pol, Teresa Fort, and Felix Tintelnot (forthcoming), “The Margin of Global Sourcing:
Theory and Evidence from U.S. Firms,” American Economic Review.
Antràs, Pol, and Robert W. Staiger (2012), “O¤shoring and the Role of Trade Agreements,”
American Economic Review 102, no. 7: 3140-3183.
Arkolakis, Costas, Arnaud Costinot, and Andrés Rodríguez-Clare (2012), “New trade models,
same old gains?” The American Economic Review 102.1: 94-130.
Baldwin, Richard, and Anthony Venables (2013), “Spiders and Snakes: O¤shoring and Agglomeration in the Global Economy,” Journal of International Economics 90(2): 245-254.
Blanchard, Emily, Chad Bown, and Robert Johnson (2016), “Global Supply Chains and Trade
Policy”, mimeo Dartmouth College.
Brancaccio, Giulia, Myrto Kalouptsidi, and Theodore Papageorgiou (2017), “Geography, Search
Frictions and Trade Costs,” mimeo Harvard University.
Caliendo, Lorenzo, and Fernando Parro (2015), “Estimates of the Trade and Welfare E¤ects of
NAFTA,” Review of Economic Studies 82 (1): 1-44.
Costinot, Arnaud (2009), “An Elementary Theory of Comparative Advantage,” Econometrica
77:4, pp. 1165-1192.
Costinot, Arnaud, and Andrés Rodríguez-Clare (2015), “Trade Theory with Numbers: Quantifying the Consequences of Globalization” in Handbook of International Economics, vol. 4: pp.
197-261.
Costinot, Arnaud, Jonathan Vogel, and Su Wang, (2013), “An Elementary Theory of Global
Supply Chains,” Review of Economic Studies 80(1): 109-144.
44

de Gortari, Alonso (2017), “Disentangling Global Value Chains,” mimeo Harvard University.
Dekle, Robert, Jonathan Eaton, and Samuel Kortum (2008), “Global rebalancing with gravity:
measuring the burden of adjustment.” IMF Economic Review 55.3: 511-540.
Dixit, Avinash, and Gene Grossman, (1982), “Trade and Protection with Multistage Production,”
Review of Economic Studies 49(4): 583-594.
Ethier, Wilfred J. (1984), “Higher Dimensional Issues in Trade Theory,” Ch. 3 in Handbook of
International Economics, Grossman, Gene M., and Kenneth Rogo¤ (Eds), Vol. 1.
Eaton, Jonathan and Samuel Kortum, (2002), “Technology, Geography, and Trade,” Econometrica, 70:5, 1741-1779.
Fally, Thibault (2012), “Production Staging: Measurement and Facts” mimeo University of Colorado Boulder.
Fally, Thibault, and Russell Hillbery (2015), “A Coasian Model of International Production
Chains,” mimeo UC Berkeley.
Harms, Philipp, Oliver Lorz, and Dieter Urban, (2012), “O¤shoring along the Production Chain,”
Canadian Journal of Economics 45(1): 93-106.
Head, Keith, and Philippe Mayer (2014), “Gravity Equations: Workhorse, Toolkit, and Cookbook,” Ch. 3 in Handbook of International Economics, Gopinath, Gita, Elhanan Helpman
and Kenneth Rogo¤ (Eds), Vol. 4.
Head, Keith, and John Ries (2001), “Increasing Returns Versus National Product Di¤erentiation
as an Explanation for the Pattern of U.S.-Canada Trade,”American Economic Review, 91(4):
858-876.
Hummels, David, Jun Ishii, and Kei-Mu Yi (2001), “The Nature and Growth of Vertical Specialization in World Trade,” Journal of International Economics 54 (1): 75–96.
Johnson, Robert, and Andreas Moxnes (2013), “Technology, Trade Costs, and the Pattern of
Trade with Multi-Stage Production,” mimeo.
Johnson, Robert C. and Guillermo Noguera (2012), “Accounting for Intermediates: Production
Sharing and Trade in Value Added,” Journal of International Economics 86(2): 224-236.
Johnson, Robert (2014), “Five Facts about Value-Added Exports and Implications for Macroeconomics and Trade Research,” Journal of Economic Perspectives, 28(2), pp. 119-142.
Lenzen, M., Kanemoto, K., Moran, D., Geschke, A. (2012), “Mapping the Structure of the World
Economy,” Environmental Science and Technology, 46(15) pp 8374-8381.
Lenzen, M., Moran, D., Kanemoto, K., Geschke, A. (2013), “Building Eora: A Global Multiregional Input-Output Database at High Country and Sector Resolution,”Economic Systems
Research, 25:1, 20-49.
45

Kikuchi, Tomoo, Kazuo Nishimura, and John Stachurski (2014), “Transaction Costs, Span of
Control and Competitive Equilibrium,” mimeo.
Kohler, Wilhelm, (2004), “International Outsourcing and Factor Prices with Multistage Production,” Economic Journal 114(494): C166-C185.
Koopman, Robert, William Powers, Zhi Wang, and Shang-Jin Wei (2010), “Give Credit Where
Credit Is Due,” NBER Working Paper 16426, September.
Koopman, Robert, Zhi Wang, and Shang-Jin Wei (2014), “Tracing Value-Added and Double
Counting in Gross Exports”, American Economic Review 104 (2): 459-94.
Kremer, Michael, (1993), “The O-Ring Theory of Economic Development,” Quarterly Journal of
Economics 108(3): 551-575.
Melitz, Marc J, and Stephen J Redding (2014), “Missing Gains from Trade?”American Economic
Review 104 (5): pp. 317-21.
Morales, Eduardo, Gloria Sheu, and Andrés Zahler (2014), “Gravity and Extended Gravity: Using
Moment Inequalities to Estimate a Model of Export Entry,”NBER Working Paper No. 19916.
Ossa, Ralph (2015), “Why Trade Matters After All,” Journal of International Economics 97(2):
pp. 266-277.
Sanyal, Kalyan K., and Ronald W. Jones, (1982), “The Theory of Trade in Middle Products,”
American Economic Review 72(1): 16-31.
Timmer, Marcel P., Abdul Azeez Erumban, Bart Los, Robert Stehrer, and Gaaitzen J. de Vries
(2014), “Slicing Up Global Value Chains.” Journal of Economic Perspectives 28, no. 2: 99118.
Timmer, Marcel P., Eric Dietzenbacher, Bart Los, Robert Stehrer, and Gaaitzen J. de Vries
(2015), “An Illustrated User Guide to the World Input–Output Database: the Case of Global
Automotive Production,” Review of International Economics, 23: 575–605.
Tintelnot, Felix (2017), “Global Production with Export Platforms,” Quarterly Journal of Economics, 132 (1): 157-209.
Tyazhelnikov, Vladimir (2016), “Production Clustering and O¤shoring,” mimeo UC Davis.
Wang, Zhi, Shang-Jin Wei, Xinding Yu, Kunfu Zhu (2017), “Measures of Participation in Global
Value Chains and Global Business Cycles,” NBER Working Paper 23222, March.
Yi, Kei-Mu, (2003), “Can Vertical Specialization Explain the Growth of World Trade?” Journal
of Political Economy 111(1): 52-102.

46

A
A.1

Appendix
Increasing Trade-Cost Elasticity

De…ne p~n`(n)1 (`) = pn`(n1 1) (`) `(n 1)`(n) as the price paid in ` (n) for the good …nished up to stage
n 1 in country ` (n 1), so that we can express the sequential unit cost function as
n
c`(n) ; p~n`(n)1 (`) :
pn`(n) (`) = g`(n)

De…ne the elasticity of pFj (`) with respect to the trade costs that stage n’s production faces as
j
n

=

@ ln pFj (`)
,
@ ln `(n)`(n+1)

with the convention that ` (N + 1) = j so that jN is the elasticity of pFj (`) with respect to the trade
costs faced when shipping assembled goods to …nal consumers in j. Because `(n)`(n+1) increases
p~n`(n+1) (`) with a unit elasticity, the following recursion holds for all n0 > n
0

0

@ ln pn`(n+1
0 +1) (`)
@ ln

=

`(n)`(n+1)

0

n
@ ln pn`(n+1
0 +1) (`) @ ln p`(n0 ) (`)
0

@ ln p~n`(n0 +1) (`) @ ln

.

`(n)`(n+1)

At the same time, the unit cost elasticity at stage n + 1 satis…es
@ ln pn+1
`(n+1) (`)
@ ln

=

`(n)`(n+1)

@ ln pn+1
`(n+1) (`)
@ ln p~n`(n+1) (`)

.

Hence, the elasticity of …nished good prices can be decomposed as
j
n

=

N
Y

0

@ ln pn`(n0 ) (`)

n0 =n+1

0

@ ln p~n`(n0 1) (`)

,

(A.1)

Q
0
invoking the convention N
n0 =N +1 f (n ) = 1 for any function f ( ). Constant returns to scale in
n
production implies that the function g`(n)
is homogeneous of degree one. As a result, the elasticity
of unit costs with respect to input prices is always less or equal than one, so for all n > 1 we have
@ ln pn`(n) (`)
@ ln p~n`(n)1 (`)

1,

with strict inequality whenever a stage adds value to the product. From equation (A.1), it is then
clear that
1
2
N
j
j
j = 1,
with strict inequality when value added is positive at all stages.

47

A.2

Fighting the Curse of Dimensionality: Dynamic and Linear Programming

When discussing the lead-…rm problem in section 2.2, we mentioned that there are J N sequences
that deliver distinct …nished good prices pFj (`) in country j. Hence, solving for the optimal sequences `j for all j by brute force requires J N +1 computations and is infeasible to do when J and
N are su¢ ciently large. However, we show below that use of dynamic programming surmounts this
problem by reducing the computation of all sequences to only J N J computations. Furthermore, in the special case in which production is Cobb-Douglas, the minimization problem can be
modeled with zero-one linear programming, for which very e¢ cient algorithms exist.
Dynamic Programming
De…ne `jn 2 J n as the optimal sequence for delivering the good completed up to stage n to producers
in country j. This term can be found recursively for all n = 1; : : : ; N by simply solving
`jn = arg minpnk `kn
k2J

1

kj ,

(A.2)

since the optimal source of the good completed up to stage n is independent of the local factor cost
cj at stage n, of the speci…cs of the cost function gjn , or of the future path of the good. For this
same reason, we have written the pricing function pnk in terms of the n 1 stage sequence `kn 1 since
it does not depend on future stages of production (though it should be clear that pnk will also be a
function of the production costs and technology available for producers at that chosen location k).
The convention at n = 1 is that there is no input sequence so that `k0 = ? for all k 2 J and the
price depends only the composite factor cost: p1k (?) = gk1 (ck ).
The formulation in (A.2) makes it clear that the optimal path to deliver the assembled good to
consumers in each country j, i.e., `j = `jN , can be solved recursively by comparing J numbers for
each location j 2 J at each stage n 2 N , for a total of only J N J computations.
To further understand this dynamic programming approach, Figure A.1 illustrates a case with
3 stages and 4 countries. Instead of computing J N = 64 paths for each of the four locations of
consumption, it su¢ ces to determine the optimal source of (immediately) upstream inputs (which
entails J J = 16 computations at stages n = 2 and n = 3, and for consumption). In the example,
the optimal production path to serve consumers in A, B, and C is A ! B ! B, while the optimal
path to serve consumers in D is C ! D ! D.
Linear Programming
In the special case in which production is Cobb-Douglas, the optimal sourcing sequence can be
written as a log-linear minimization problem
j

` = arg min

`2J N

N
X1

n ln `(n)`(n+1)

+ ln

n=1

`(N )j

+

N
X

n=1

48

n n ln

an`(n) c`(n) .

𝑛𝑛 = 1

𝐴𝐴

𝐵𝐵

𝐶𝐶

𝐷𝐷

𝑛𝑛 = 2

𝐴𝐴

𝐵𝐵

𝐶𝐶

𝐷𝐷

𝑛𝑛 = 3

𝐴𝐴

𝐵𝐵

𝐶𝐶

𝐷𝐷

𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶𝐶

𝐴𝐴

𝐵𝐵

𝐶𝐶

𝐷𝐷

Figure A.1: Dynamic Programming

An Example with Four Countries and Three Stages

This can in turn be reformulated as the following zero-one integer linear programming problem
`j = arg min

N
X1

n

k2J k0 2J

n=1

s.t.

X

k0 2J

X

k0 2J

X

X X

n
k0 k

=

N 1
k0 k
N
k

X

k0 2J

=

n
kk0

(ln

kk0

+

n
n ak ck )

+

X

N
k

ln

kj

+

N
N ak ck

k2J
n+1
kk0 ; 8k

N
k ; 8k

2 J ; n = 1; : : : ; N

2

2J

=1

k2J

n
N
kk0 ; k

A.3

2 f0; 1g :

Decentralized Approach with N 2 N+

This Appendix demonstrates how to generalize our approach with stage-speci…c randomness and
incomplete information to an environment with more than two stages. It should be clear that the
input sourcing decisions for the two most upstream stages work in the same way as outlined in
section 3.2.B for a general number of stages N > 2. Let us quickly recap those decisions. Input
producers of good z at the …rst stage set prices equal to the cost of labor and materials needed
to produce a unit of the …rst-stage good: p1`(1) (z) = a1`(1) (z) c`(1) . Meanwhile, a producer of z at
stage n = 2 in country j observes the productivity
draws of its tier-one
input suppliers and thus
o
n
1
j
2
sources inputs from `z (1) = arg min`(1)2J a`(1) (z) c`(1) (1)j)
. However, producers at stage
n > 2 only observe the productivity draws of their tier-one suppliers (i.e., those at n 1), and are
forced to use their expectations over the productivity draws of upper tier input suppliers in order
to form expectations over the prices at which they will ultimately buy from their tier-one suppliers

49

(at n 1). This is because we have assumed that sourcing decisions are made before observing the
prices at which tier-one suppliers will ultimately be able to sell at. In other words, when deciding
on their optimal input sources, …rms producing at stage n + 1 can only form expectations over the
input prices from stage n 1 that each of its own possible suppliers producing at stage n faces (or
will face).
Let `jz (n) be the tier-one sourcing decision of a …rm producing good z at stage n + 1 in j.
Generalizing the approach in the main text, de…ne the expectation
Ejn [s] = En

h

pn`j (n) (z)
z

`jz (n)j

si

,

for any s > 0 and where we have written the expectation with an n subscript indicating that the
expectation takes that unit costs (and prices) from stages 1; : : : ; n as unobserved. To be fully clear,
a …rm at n+2 observes the productivity draws from stage n+1 but does not know previous sourcing
decisions. Hence it must form an expectation over the location from which its stage n suppliers
source, `jz (n), and use this to calculate the expected input prices Ejn [s]. As will become clear in
the next paragraph, denoting the expectations for a general s > 0 is useful since downstream …rms
between n + 2; : : : ; N and …nal consumers will all use the information on expected input prices at
n but in di¤erent ways depending on the objective function they seek to minimize.
Substituting in the Cobb-Douglas production process in (2), we can write
Ejn [s] = En

h

an`j (n) (z) c`jz (n)

ns

z

E nj

1
[(1
`z (n)

n ) s]

`jz (n)j

si

.

The crucial observation is that to determine expected input prices from stage n a …rm must also
incorporate expected input prices from stage n 1, and so on until input prices from all upstream
stages have been incorporated. Note that productivity draws across stages of production are independent, but even more importantly, sourcing decisions across stages of production are also
independent. Hence, one can use the law of iterated expectations to compute expected input prices
from n 1, E nj 1 [ ], in the computation of expected prices at n in Ejn [ ]. The latter expectation
`z (n)

is over `jz (n) but once we condition on a speci…c value for `jz (n), the expectation E nj

1
[
`z (n)

] is a

constant. Finally, note also that this recursion starts at n = 1 with Ej0 [s] = 1 since only labor and
materials are used in that initial stage.
Let us next illustrate why these de…nitions are useful. Consider the optimal sourcing strategies
related to procuring the good …nished up to stage n < N: Given the sequential cost function in (2),
the problem faced by a stage n + 1 producer in j can be written as
`jz (n) = arg min

`(n)2J

an`(n) (z) c`(n)

n (1

n+1 )

n 1
E`(n)
[(1

n ) (1

n+1 )]

1
`(n)j

n+1

.

where the 1
n+1 superscript comes from the stage n + 1 producer wanting to minimize its own
expected input price and in which the stage n input price enters its own unit cost to this power.

50

Meanwhile, …nal consumers (or local retailers on their behalf) source their goods by solving
`jz (N ) = arg min

`(N )2J

n

N

aN
`(N ) (z) c`(N )

N 1
E`(N
) [1

N]

`(N )j

o

.

The probability of sourcing inputs from a speci…c location i at any stage n can be determined
by invoking the properties of the Fréchet distribution, given that 1=ani (z) is drawn independently
(across goods and stages) from a Fréchet distribution satisfying
Pr anj (z)

n n

a = exp

n

a (Tj )

n n

o

.

In particular, we obtain

Pr

`jz

(Ti )
(n) = i =

P

n

((ci )

(Tl )

l2J

n

n

((cl )

n

ij )
n

Ein
n

lj )

1

[(1

n ) (1

n+1 )]

n+1

.
Eln

1

[(1

n ) (1

n+1 )]

n+1

These probabilities can now be leveraged in order to compute expected input prices. De…ne
a
~ij = (ci )

ns

Ein

1

s
n ) s] ( ij )

[(1

so that 1= (ai n s a
~ij )

Fréchet Ti

n n

a
~ij

n
s

;

(note that

n

s

the above distribution is the special case in which s = 1
n+1 ). Then using the moment generating
formula for the Fréchet distribution, it can be veri…ed that
Ejn [s]

=

"

X

Tl

n n

a
~lj

n
s

l2J

#

s
n

1+

n

,

s

where is the gamma function. From this equation it should also be clear why we are denoting
Ejn [s] as a function of s, since as we move down the value chain we need to compute the upstream
expectations at di¤erent ’moments’.
We are now ready to determine the equilibrium variables: (1) material prices Pj and (2) the
distribution of GVCs. Material prices can be derived recursively using our expectations:
Pj = EjN [1

=

"

=

"

1

]

1

X

(Tl )

N

((cl )

N

l2J

N
XY

T`(n)

n

lj )

ElN

c`(n)

`2J n=1

1

[(1

N ) (1

)]

n

n

`(n)`(n+1)

#

1

1

#
N
Y

1

1+

1+

1

1

n=1

Finally, since input decisions from n are independent from the decisions that …rms at n

51

1

1

n

1 made

then
`j

)
= Pr `jz (N ) = ` (N ) ``(N
(N
z
N
Y1

1) = ` (N

Pr ``(n+1)
(n) = ` (n) ``(n)
(n
z
z

1)

1) = ` (n

Pr ``(2)
(1) = ` (1)
z

1)

n=2

N
Y

= Pr `jz (N ) = ` (N )

Pr ``(n+1)
(n) = ` (n)
z

n=1

=

QN

1
n=1

P

`0 2J

n

T`(n)

QN

1
n=1

n

T`0 (n)

n

n

c`(n)

n

n

c`0 (n)

N

T`(N )

`(n)`(n+1)

c`(N )
N

T`0 (N )

`0 (n)`0 (n+1)

N

`(N )j

c`0 (N )

,

N

`0 (N )j

which is identical to equation (11) in the main text obtained in the ‘randomness-in-the-chain’
formulation of technology.

A.4
Let (

Proof of Centrality-Downstreamness Nexus
ij )

=

i j.

In such a case, the probability of country j sourcing through ` reduces to

`j

=

N
Q

m 1+ m

m m

T`(m) c`(m)

`(m)

m=1

P

`2J

QN

m 1+ m

m m

T`(m) c`(m)

m=1

`(m)

and is thus independent of the destination country j. The aggregate probability of observing
country i in location n can thus be expressed as

Pr (

n
i)

=

P

`2

n
i

`j

=

N
P Q

`2

n
i

k2J `2

`(m)

m=1

P P QN

m=1

n
k

m 1+ m

m m

T`(m) c`(m)
T`(m) c`(m)

m 1+ m

m m

.

(A.3)

`(m)

But note that we can decompose this as
Ti (ci )
Pr (

n
i)

=

n n

( i)

n 1+ n

`2

P

Tk (ck )

n n

( k)

n 1+ n

Ti (ci )
P

n
i

Tk (ck )

n n

( i)

n n

n 1+ n

( k)

T`(m) c`(m)

m 1+ m

m m

`(m)

m6=n

P Q

`2

k2J

=

P Q
n
k

T`(m) c`(m)

m 1+ m

m m

`(m)

m6=n

n 1+ n

k2J

where the second line follows from the fact that, for GVCs in the sets ni and nk , the set of all
possible paths excluding the location of stage n are necessarily identical (and independent of the
52

country where n takes place), and thus the second terms in the numerator and denominator of the
…rst line cancel out.
For the special symmetric case with n n = 1=N and n = 1=n we obtain that

Pr (

n
i)

Ti (ci )
=

P

Tk (ck )

1
N

( i)
1
N

2n 1
N

( k)

2n 1
N

k2J

Now consider our de…nition of upstreamness
U (i) =

N
X

(N

n + 1)

n=1

Pr (
N
P
Pr

n0 =1

n)
i

.

(A.4)

n0
i

This is equivalent to the expect distance from …nal-good demand at which a country will contribute
to global value chains. The expectation is de…ned over a country-speci…c probability distribution
P
n0 .
over stages, fi (n) = Pr ( ni ) = N
i
n0 =1 Pr
Finally, note that for two countries with i0 > i and two inputs with n0 > n we necessarily
have
2(n0 n)=N
fi0 (n0 ) =fi0 (n)
i0
=
> 1.
fi (n0 ) =fi (n)
i
As a result, the probability functions fi0 (n) and fi (n) satisfy the monotone likelihood ratio property
in n. As is well known, this is a su¢ cient condition for fi0 (n) to …rst-order stochastically dominate
fi (n) when i0 > i . But then it is immediate that Efi0 [n] > Efi [n], and thus the expected value in
(A.4), which is simply N + 1 Efi [n], will be lower for country i0 than for country i when i0 > i .

A.5

Further Estimation Results

WIOD for 2014
Table A.1 presents the values of j and Tj for the sample of 44 countries in the WIOD found in
our benchmark estimation with N = 2.

53

Table A.1: WIOD Calibration
j

Australia
Austria
Belgium
Bulgaria
Brazil
Canada
Switzerland
China
Cyprus
Czech Republic
Germany
Denmark
Spain
Estonia
Finland
France
Great Britain
Greece
Croatia
Hungary
Indonesia
India

0.93
0.91
0.84
0.78
1.00
0.96
0.89
0.59
0.99
0.73
0.92
0.93
0.93
0.81
0.88
0.97
0.97
1.00
0.94
0.83
0.94
0.97

Tj

j

31.587
6.134
0.789
0.006
0.011
5.395
670.238
0.116
0.169
0.129
47.132
7.269
5.065
0.023
1.543
19.680
36.013
0.028
0.036
0.008
1.26E-05
2.05E-06

Ireland
Italy
Japan
South Korea
Lithuania
Luxembourg
Latvia
Mexico
Malta
Netherlands
Norway
Poland
Portugal
Romania
Russia
Slovakia
Slovenia
Sweden
Turkey
Taiwan
USA
Rest of World

54

0.87
0.89
0.96
0.72
0.95
0.52
0.79
1.00
0.64
0.88
0.93
0.84
0.95
0.85
0.90
0.77
0.85
0.94
0.91
0.75
1.00
0.79

Tj
0.396
10.419
6.997
0.555
0.056
0.117
0.028
0.001
0.018
1.108
0.444
0.521
0.163
0.015
0.009
0.229
0.541
25.031
0.045
0.009
121.919
0.009

1

3.5

0.65

2.25

0.3
0.3

1
0.65

1

1

2.25

3.5

Figure A.2: Some Key Features of the Eora MRIO Dataset
Eora for 2013
Figure A.2 depicts some salient features of the Eora MRIO dataset for the year 2013. The …gure is
analogous to Figure 4 in the main text, and depicts the same qualitative patterns. The domestic
shares are on average higher for …nal output than for inputs and there is wide dispersion in gross
output to value added ratios and gross output to …nal output ratios, with both ratios being highly
positively correlated.
We next turn to the estimation results for the Eora 2013 database when our model is calibrated
to the same moments as the WIOD and with N = 2. As mentioned in the main text, we …nd
2 = 0:19. Table A.2 presents the values of j and Tj for the sample of 101 country/regions.
Figures A.3 and A.4 illustrate the goodness of …t of our model. As mentioned in the main text,
the correlation between model and data is very high, even when considering untargeted moments.
Figure A.5 presents the gains from trade with respect to autarky for the GVC and EK models for
the largest 25 countries/regions. The gains are on average 19% higher across the full sample (12%
when weighting by GDP size). Meanwhile, Figure A.6 presents the gains of a zero gravity world.
Real income gains are on average 30% higher in the GVC world (34% when weighting by GDP size)
than in a world without sequential production. Finally, Figures A.7 and A.8 present the changes
in GVC participation following a 50% reduction in trade costs and Figure A.9 plots the dynamics
of regional versus global integration when lowering trade costs; all three graphs look very similar
to the ones with the WIOD data.

55

Table A.2: Eora Calibration

j

Afghanistan
Eastern Europe
Algeria
Western Europe
Angola
Latin America & Caribbean
Argentina
Australia
Central Europe
Central Asia
Middle East & North Africa
Bangladesh
Belgium
Benin
South Asia
Bolivia
Sub-Saharan Africa
Brazil
East Asia & Paci…c
Burkina Faso
Burundi
Cambodia
Cameroon
Canada
Chad
Chile
China
Colombia
Cuba
Czech Republic
Cote dIvoire
North Korea
DR Congo
Scandinavia
Dominican Republic
Ecuador
Egypt
Eritrea
Ethiopia
France
Germany
Ghana
Greece
Guatemala
Guinea
Haiti
Hong Kong
India
Indonesia
Iran
Iraq

0.70
0.79
0.98
0.72
0.95
0.85
1.00
0.85
0.89
0.86
0.96
0.94
0.77
0.59
0.40
0.88
0.92
0.86
0.79
0.94
0.87
0.82
0.85
0.91
0.84
0.91
0.63
1.00
0.95
0.69
0.98
0.89
0.86
0.89
0.93
0.93
1.00
0.81
0.02
0.94
0.82
0.94
0.99
0.97
0.76
0.84
0.65
0.87
0.94
0.97
1.00

Tj
3.79E-05
4.11E-05
3.08E-06
0.098
0.052
0.605
0.394
270.496
17.669
0.001
1.079
5.38E-05
0.115
0.001
0.020
0.162
3.80E-04
0.300
6.598
1.37E-06
6.52E-07
2.38E-04
1.99E-04
6.272
2.84E-04
0.070
0.082
0.001
0.004
0.125
0.015
0.002
3.877
10.130
0.004
0.012
0.001
1.03E-05
2.22E-05
21.699
6.599
1.81E-04
0.105
0.316
1.83E-06
7.87E-05
0.024
0.003
0.004
0.002
1.65E-10

56

j

Israel
Italy
Japan
Kazakhstan
Kenya
Madagascar
Malawi
Malaysia
Mali
Mexico
Morocco
Mozambique
Myanmar
Nepal
Netherlands
Niger
Nigeria
Pakistan
Peru
Philippines
Poland
Portugal
South Korea
Romania
Russia
Rwanda
Saudi Arabia
Senegal
Singapore
Somalia
South Africa
South Sudan
Spain
Sri Lanka
Sudan
Syria
Taiwan
Thailand
Tunisia
Turkey
Uganda
Ukraine
UK
Tanzania
USA
Uzbekistan
Venezuela
Viet Nam
Yemen
Zambia

0.96
0.88
0.97
0.86
0.93
0.87
0.61
0.85
0.82
1.00
0.96
0.99
0.69
0.90
0.80
0.97
1.00
0.90
0.89
0.99
0.81
0.87
0.51
0.81
0.93
0.94
1.00
0.87
0.68
0.53
0.88
0.84
0.84
0.98
0.91
0.84
0.82
0.73
0.93
1.00
0.83
0.73
0.90
0.43
0.94
0.95
0.94
0.69
0.91
0.93

Tj
383.437
3.575
102.429
0.002
2.80E-05
0.001
1.72E-05
0.012
0.002
0.001
0.004
2.95E-06
0.967
2.84E-05
0.057
3.33E-08
2.61E-07
0.002
0.047
3.69E-05
0.186
0.394
0.347
0.010
0.058
0.001
0.058
0.001
0.383
4.49E-05
0.012
0.047
3.924
0.001
3.991
0.865
6.672
0.383
0.010
0.001
1.30E-05
0.001
11.837
8.08E-06
133.312
0.001
0.030
9.67E-05
2.45E-05
1.06E-04

1

Calibration

0.75

0.5

0.25
0.25

0.5

0.75

0.8

0.6
0.6

1

Data

0.8

1

Data

4

0.25

3

Calibration

Calibration

Calibration

1

2

0.125

1

0
1

2

3

4

0

Data

0.125

Data

Figure A.3: Eora Targeted Moments.

Figure A.4: Eora Untargeted Moments.

57

0.25

2
GVC Gains from Trade
EK Gains from Trade

25

Relative Gains from Trade
Average Relative Gains from Trade

1.5

Ratio GVC/EK

20
15
10

1

0.5
5
0

BRA
RUS
USA
IND
JPN
CHN
IDN
MENA
AUS
SAU
LAm
FRA
ITA
ESP
CAN
Snd
MEX
GBR
TUR
GER
CEu
EEu
KOR
BEL
NLD

0

BEL
LAm
NLD
FRA
RUS
GBR
GER
IND
EEu
ESP
USA
MENA
CEu
Snd
CHN
ITA
JPN
BRA
IDN
CAN
SAU
AUS
KOR
TUR
MEX

% Change in Real Income

30

Figure A.5: Gains from trade relative to autarky in GVC model (N = 2) versus
EK model (N = 1), Eora sample.
2
GVC Gains from Trade
EK Gains from Trade

Relative Gains from Trade
GDP-Weighted Mean Relative Gains from Trade

Ratio GVC/EK

1.5
1000

500

1

0

0

LAm
AUS
SAU
IND
MENA
IDN
EEu
BRA
ESP
JPN
GBR
CEu
FRA
RUS
Snd
CAN
ITA
KOR
TUR
GER
MEX
BEL
USA
CHN
NLD

0.5

USA
JPN
FRA
GBR
IND
CHN
GER
ITA
BRA
AUS
CAN
IDN
MENA
RUS
ESP
Snd
CEu
MEX
SAU
TUR
LAm
EEu
NLD
BEL
KOR

% Change in Real Income

1500

Figure A.6: Gains from moving to zero gravity in GVC model (N = 2) versus
EK model (N = 1), Eora sample.
Backward Participation

0.75

Forward Participation

Benchmark
50% Fall in Trade Costs

0.5

0.25

0.25

0

0

USA
BRA
LAm
IND
SAU
TUR
JPN
CHN
RUS
MENA
AUS
GBR
IDN
ESP
FRA
CAN
MEX
Snd
ITA
EEu
CEu
GER
KOR
NLD
BEL

% of GDP

0.5

RUS
BRA
USA
IND
JPN
IDN
MENA
CHN
AUS
FRA
SAU
ITA
MEX
CAN
LAm
Snd
ESP
GBR
GER
TUR
CEu
BEL
NLD
EEu
KOR

% of Final Good Production

0.75

Figure A.7: Change in USA bilateral GVC participation following a 50% trade cost reduction, Eora
sample.
58

Change in GVC Participation

600

Backward
Forward

500

Change in Relative GVC Participation

200
150

400

100

%

%

300
50

200
0

100

-50

0
-100

-100
USA

CHN

CAN

MEX Europe Asia

RoW

USA

CHN

CAN

MEX Europe Asia

RoW

Figure A.8: Change in USA bilateral GVC participation following a 50% trade cost reduction, Eora
sample.

10

80

8

60

0.25

6

%

%

Domestic GVCs (lhs)
NAFTA GVCs (rhs)
Global GVCs (lhs)

40

4

20

2

0

0
1/32 1/16 1/8 1/4 1/2

1

3/2

2

3

5

NAFTA GVCs / Global GVCs

100

0.2

0.15

0.1

0.05

0

10

1/32 1/16 1/8 1/4 1/2

s

1

s

Figure A.9: Regional vs Global Integration, Eora sample.

59

3/2

2

3

5

10

